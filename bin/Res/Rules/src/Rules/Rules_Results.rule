; -------------------------------------------------------------------------
; Rules pertaining to:   Simulation and Compliance Analysis Results
; CEC Title-24 Residential Energy Code
; -------------------------------------------------------------------------
; Copyright (c) 2012-2014, California Energy Commission
; Copyright (c) 2012-2014, Wrightsoft Corporation
; All rights reserved.
; Redistribution and use in source and binary forms, with or without modification,
; are permitted provided that the following conditions are met:
; - Redistributions of source code must retain the above copyright notice, this
;   list of conditions and the following disclaimer.
; - Redistributions in binary form must reproduce the above copyright notice, this
;   list of conditions, the following disclaimer in the documentation and/or other
;   materials provided with the distribution.
; - Neither the name of the California Energy Commission nor the names of its
;   contributors may be used to endorse or promote products derived from this
;   software without specific prior written permission.
; DISCLAIMER: THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
; THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
; NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION,
; WRIGHTSOFT CORPORATION, ITRON, INC. OR ANY OTHER AUTHOR OR COPYRIGHT HOLDER OF
; THIS SOFTWARE (COLLECTIVELY, THE "AUTHORS") BE LIABLE FOR ANY DIRECT, INDIRECT,
; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
; OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
; LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
; OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  EACH LICENSEE AND SUBLICENSEE OF THE
; SOFTWARE AGREES NOT TO ASSERT ANY CLAIM AGAINST ANY OF THE AUTHORS RELATING TO
; THIS SOFTWARE, WHETHER DUE TO PERFORMANCE ISSUES, TITLE OR INFRINGEMENT ISSUES,
; STRICT LIABILITY OR OTHERWISE.
; -------------------------------------------------------------------------


;*************************************************************************
RULELIST "ProcessResults" 1 0 0 1
;*************************************************************************
; SAC 3/17/14 - addded clean-up of LayerParams & Mat objects created during SimulationPrep rules
	"Blast all LayerParams objects"			Proj:Action	= {	DeleteAllComps( LayerParams )  }
	"Blast Mats marked for deletion"			Mat:Action	= {	if (IfValidAnd( MarkForDeletion == 1 )) then  DeleteComp()  else  UNCHANGED  endif  }
;	"Blast Mats not referenced by Cons:*"	Mat:Action	= {	if (CountRefs( Cons:CavityPathMats ) < 1 .AND. CountRefs( Cons:FramePathMats ) < 1) then  DeleteComp()  else  UNCHANGED  endif  }		; SAC 3/21/14


	"Store and process simulation results for this run"	Proj:Action = {	EvalRulelist( "CARes_ProcessResults" )  }


   ;--------------------------------------------------------------------
   ; Blast Proposed Design components that were created for compliance analysis
   ;--------------------------------------------------------------------
; "debug"		HVACSys:Action	= {	MessageBox( "ProcessResults - HVACSys: %s  HtPumpDucted  %g  RunNumber  %g", Name, HtPumpDucted, Proj:RunNumber )  }

	"Remove DistribSystem  from HtPump Systems if needed"
			HVACSys:DistribSystem	= {	if ( LocalCompAssigned( DistribSystem ) .AND. Proj:RunNumber == 1 .AND. Type == 2 ) then
														if ( CA13HeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) != 0 ) then DeleteComp()
														else UNCHANGED endif	
													else UNCHANGED endif	}

	"Remove Fan from HtPump Systems if needed"
			HVACSys:Fan					= {	if ( LocalCompAssigned( Fan ) .AND. Proj:RunNumber == 1 .AND. Type == 2 ) then 
														if ( CA13HeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) != 0 ) then DeleteComp()
														else UNCHANGED endif	
													else UNCHANGED endif	}

	"Remove DistribSystem  from Room AC Systems if needed"
			HVACSys:DistribSystem	= {	if ( LocalCompAssigned( DistribSystem ) .AND. Proj:RunNumber == 1 .AND. Type == 1 ) then
														if ( CA13CoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) != 0 ) then  DeleteComp()
														else UNCHANGED endif	
													else UNCHANGED endif	}

	"Remove Fan from Room AC Systems if needed"
			HVACSys:Fan					= {	if ( LocalCompAssigned( Fan ) .AND. Proj:RunNumber == 1 .AND. Type == 1 ) then
														if ( CA13CoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) != 0 ) then  DeleteComp()
														else UNCHANGED endif	
													else UNCHANGED endif	}

	"Reset CoolDuctedRpt based on User Inputs"
			HVACSys:CoolDuctedRpt	= {	if (Type == 2)		; heat pump system
													then	if (HtPumpSysType < 1 .OR. LocalCompAssigned( HtPumpSystem[1] ) == 0) then  0
														else if (CA13HeatingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HtPumpSysTypeAbbrev ) != 0) then  1
														else  0  endif endif
													else	if (CoolSysType < 1 .OR. LocalCompAssigned( CoolSystem[1] ) == 0) then  0
														else if (CA13CoolingEquipment:DuctFlag( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSysTypeAbbrev ) != 0) then  1
														else  0  endif endif endif  }

	"Blast AC Charge populated for analysis, but not in User Model"
			HVACHtPump:ACCharge	=	{	if ( FloorAreaServed > 0.5 .AND. Proj:RunNumber == 1 ) then
													if ( CA13HeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) != 0) then 1 
													else UNCHANGED endif	
												else UNCHANGED endif	}
	"Blast CFMperTon populated for analysis, but not in User Model"
			HVACHtPump:CFMperTon	=	{	if ( FloorAreaServed > 0.5 .AND. Proj:RunNumber == 1 ) then
													if ( CA13HeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) != 0) then UNDEFINED 
													else UNCHANGED endif	
												else UNCHANGED endif	}
;	"debugging"		HVACHtPump:Action	= {	if (FloorAreaServed > 0.5) then MessageBox( "ProcessResults:  Name = %s  ACCharge = %s  CFMperTon = %g", Name, EnumString(ACCharge), CFMperTon) else UNCHANGED endif }

	"Blast AC Charge populated for analysis, but not in User Model"
			HVACCool:ACCharge		=	{	if ( FloorAreaServed > 0.5 .AND. Proj:RunNumber == 1 ) then
													if ( CA13CoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) != 0) then UNDEFINED
													else UNCHANGED endif	
												else UNCHANGED endif	}
															
	"Blast CFMperTon populated for analysis, but not in User Model"
			HVACCool:CFMperTon	=	{	if ( FloorAreaServed > 0.5 .AND. Proj:RunNumber == 1 ) then
													if ( CA13CoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) != 0) then UNDEFINED
													else UNCHANGED endif	
												else UNCHANGED endif	}

; SAC/mjb 10/22/14 - moved to 'ProposedReportPrep' rulelist
;; mjb relocated from PostProposed rulelist on 8/26/14
;   ;--------------------------------------------------------------------
;   ; Setup SCSysRpt reporting object properties (if none exist yet)
;   ;--------------------------------------------------------------------
;	"Setup SCSysRpt objects (if needed)"		Proj:Action	= {	;  if (ComponentCount( SCSysRpt ) > 0 .OR. Proj:NumSCSysEquipUnits < 1) then  UNCHANGED
;																					if (Proj:NumSCSysEquipUnits < 1) then  UNCHANGED
;																					else	EvalRulelist( "Setup_SCSysReportingObjects" )  endif  }
;
;   ;--------------------------------------------------------------------
;   ; Setup DHWSysRpt reporting object properties (if none exist yet)
;   ;--------------------------------------------------------------------
;	"Setup DHWSysRpt objects (if needed)"		Proj:Action	= {	;  if (ComponentCount( DHWSysRpt ) > 0 .OR. Proj:NumDHWEquipUnits < 1) then  UNCHANGED
;																					if (Proj:NumDHWEquipUnits < 1) then  UNCHANGED
;																					else	EvalRulelist( "Setup_DHWSysReportingObjects" )  endif  }
;
;   ;--------------------------------------------------------------------
;   ; Setup IAQVentRpt reporting object properties (if none exist yet)
;   ;--------------------------------------------------------------------
;	"Setup IAQVentRpt objects (if needed)"		Proj:Action	= {	;  if (ComponentCount( IAQVentRpt ) > 0) then  UNCHANGED
;																					;  else	EvalRulelist( "Setup_IAQVentReportingObjects" )  endif  }
;																					EvalRulelist( "Setup_IAQVentReportingObjects" )  }

END

;*************************************************************************
RULELIST "CARes_ProcessResults" 1 0 0 1
;*************************************************************************
; "store BEMProc details"		Proj:Action = {  StoreBEMProc( "Before ProcRes", 0 )  }
; "debug"		Proj:Action	= {	MessageBox( "About to evaluate 'CARes_ProcessResults' rules." )  }

; SAC 4/21/15 - modified all rules to base results/summary rulelist evals on Proj:RunAbbrev so that each rule needn't include logic determining which run was performed based on user inputs
	"Copy initial EnergyUse:Proposed properties"	Proj:Action = {	if (RunAbbrev == "dr") then    EvalRulelist( "CARes_EnergyUse_CopyProposedResults" )
																						else  UNCHANGED  endif  }
																				;		if ( (AllOrientations < 0.5 .AND. RunNumber == 3) .OR.
																				;			  (AllOrientations > 0.5 .AND. RunNumber == 6) ) then  EvalRulelist( "CARes_EnergyUse_CopyProposedResults" )
																				;		else  UNCHANGED  endif  }

	"Store sim energy use results for this run"	Proj:Action = {	switch (RunAbbrev)
																							case  "p-N"	:  EvalRulelist( "CARes_ProposedResults_N" )
																							case  "p-E"	:  EvalRulelist( "CARes_ProposedResults_E" )
																							case  "p-S"	:  EvalRulelist( "CARes_ProposedResults_S" )
																							case  "p-W"	:  EvalRulelist( "CARes_ProposedResults_W" )
																							case  "s"	:  if (AllOrientations < 0.5)
																												then	EvalRulelist( "CARes_StandardResults" )
																												else	EvalRulelist( "CARes_StandardResults_NESW" )  endif
																							case  "dr"	:  if (AllOrientations < 0.5)
																												then	EvalRulelist( "CARes_DesignRatingResults" )
																												else	EvalRulelist( "CARes_DesignRatingResults_NESW" )  endif
																							default		:  EvalRulelist( "CARes_ProposedResults" )	; for 'u' or 'p' run
																						endswitch  }
																				;		if (RunNumber == 0) then	EvalRulelist( "CARes_ProposedResults" )		; run 0 to support Research runs
																				;		else if (AllOrientations < 0.5)
																				;		then	switch (RunNumber)
																				;					case  1 :	EvalRulelist( "CARes_ProposedResults" )
																				;					case  2 :	EvalRulelist( "CARes_StandardResults" )
																				;					case  3 :	EvalRulelist( "CARes_DesignRatingResults" )
																				;					default :	UNCHANGED	endswitch
																				;		else	switch (RunNumber)
																				;					case  1 :	EvalRulelist( "CARes_ProposedResults_N" )
																				;					case  2 :	EvalRulelist( "CARes_ProposedResults_E" )
																				;					case  3 :	EvalRulelist( "CARes_ProposedResults_S" )
																				;					case  4 :	EvalRulelist( "CARes_ProposedResults_W" )
																				;					case  5 :	EvalRulelist( "CARes_StandardResults_NESW" )
																				;					case  6 :	EvalRulelist( "CARes_DesignRatingResults_NESW" )
																				;					default :	UNCHANGED	endswitch  endif endif  }

; SAC 12/10/12 - revised rule to calc TDV for Research simulations
	"Calc & store TDV results for this run"		Proj:Action = {	if (Local( ClimateZone ) > 0.9 .AND. Local( ClimateZone ) < 16.1)
																						then	switch (RunAbbrev)
																									case  "p-N"	:  EvalRulelist( "CARes_ProposedTDVResults_N" )
																									case  "p-E"	:  EvalRulelist( "CARes_ProposedTDVResults_E" )
																									case  "p-S"	:  EvalRulelist( "CARes_ProposedTDVResults_S" )
																									case  "p-W"	:  EvalRulelist( "CARes_ProposedTDVResults_W" )
																									case  "s"	:  if (AllOrientations < 0.5)
																														then	EvalRulelist( "CARes_StandardTDVResults" )
																														else	EvalRulelist( "CARes_StandardTDVResults_NESW" )  endif
																									case  "dr"	:  if (AllOrientations < 0.5)
																														then	EvalRulelist( "CARes_DesignRatingTDVResults" )
																														else	EvalRulelist( "CARes_DesignRatingTDVResults_NESW" )  endif
																									default		:  EvalRulelist( "CARes_ProposedTDVResults" )	; for 'u' or 'p' run
																								endswitch
																						else  UNCHANGED  endif  }
																				;		if (Local( ClimateZone ) > 0.9 .AND. Local( ClimateZone ) < 16.1)
																				;		then	if (RunNumber == 0) then	EvalRulelist( "CARes_ProposedTDVResults" )		; run 0 to support Research runs
																				;				else if (AllOrientations < 0.5)
																				;				then	switch (RunNumber)
																				;							case  1 :	EvalRulelist( "CARes_ProposedTDVResults" )
																				;							case  2 :	EvalRulelist( "CARes_StandardTDVResults" )
																				;							case  3 :	EvalRulelist( "CARes_DesignRatingTDVResults" )
																				;							default :	UNCHANGED	endswitch
																				;				else	switch (RunNumber)
																				;							case  1 :	EvalRulelist( "CARes_ProposedTDVResults_N" )
																				;							case  2 :	EvalRulelist( "CARes_ProposedTDVResults_E" )
																				;							case  3 :	EvalRulelist( "CARes_ProposedTDVResults_S" )
																				;							case  4 :	EvalRulelist( "CARes_ProposedTDVResults_W" )
																				;							case  5 :	EvalRulelist( "CARes_StandardTDVResults_NESW" )
																				;							case  6 :	EvalRulelist( "CARes_DesignRatingTDVResults_NESW" )
																				;							default :	UNCHANGED	endswitch  endif endif
																				;		else  UNCHANGED  endif  }

	"Store energy use summary for this run"		Proj:Action = {	switch (RunAbbrev)
																							case  "p-N"	:  EvalRulelist( "CARes_ProposedSummary_N" )
																							case  "p-E"	:  EvalRulelist( "CARes_ProposedSummary_E" )
																							case  "p-S"	:  EvalRulelist( "CARes_ProposedSummary_S" )
																							case  "p-W"	:  EvalRulelist( "CARes_ProposedSummary_W" )
																							case  "s"	:  if (AllOrientations < 0.5)
																												then	EvalRulelist( "CARes_StandardSummary" )
																												else	EvalRulelist( "CARes_StandardSummary_NESW" )  endif
																							case  "dr"	:  if (AllOrientations < 0.5)
																												then	EvalRulelist( "CARes_DesignRatingSummary" )
																												else	EvalRulelist( "CARes_DesignRatingSummary_NESW" )  endif
																							default		:  EvalRulelist( "CARes_ProposedSummary" )	; for 'u' or 'p' run
																						endswitch  }
																				;		if (RunNumber == 0) then	EvalRulelist( "CARes_ProposedSummary" )		; run 0 to support Research runs
																				;		else if (AllOrientations < 0.5)
																				;		then	switch (RunNumber)
																				;					case  1 :	EvalRulelist( "CARes_ProposedSummary" )
																				;					case  2 :	EvalRulelist( "CARes_StandardSummary" )
																				;					case  3 :	EvalRulelist( "CARes_DesignRatingSummary" )
																				;					default :	UNCHANGED	endswitch
																				;		else	switch (RunNumber)
																				;					case  1 :	EvalRulelist( "CARes_ProposedSummary_N" )
																				;					case  2 :	EvalRulelist( "CARes_ProposedSummary_E" )
																				;					case  3 :	EvalRulelist( "CARes_ProposedSummary_S" )
																				;					case  4 :	EvalRulelist( "CARes_ProposedSummary_W" )
																				;					case  5 :	EvalRulelist( "CARes_StandardSummary_NESW" )
																				;					case  6 :	EvalRulelist( "CARes_DesignRatingSummary_NESW" )
																				;					default :	UNCHANGED	endswitch  endif endif  }

	"Store final results summary info"				Proj:Action = {	switch (RunAbbrev)
																							case  "s"	:  if (AllOrientations < 0.5)
																												then	EvalRulelist( "CARes_SummaryTab" )
																												else	EvalRulelist( "CARes_SummaryTab_NESW" )  endif
																							default		:  UNCHANGED
																						endswitch  }
																				;		     if (AllOrientations < 0.5 .AND. RunNumber == 2) then  EvalRulelist( "CARes_SummaryTab" )
																				;		else if (AllOrientations > 0.5 .AND. RunNumber == 5) then  EvalRulelist( "CARes_SummaryTab_NESW" )
																				;		else  UNCHANGED  endif endif  }
																						
	"Reset Proj:ResultsCurrentMsg"	Proj:ResultsCurrentMsg	= {	switch (RunAbbrev)
																							case  "s"	:  " "
																							case  "dr"	:  " "
																							default		:  UNCHANGED
																						endswitch  }
																				;		if ( (AllOrientations < 0.5 .AND. RunNumber >= 2) .OR.
																				;			  (AllOrientations > 0.5 .AND. RunNumber >= 5) )
																				;		then  " "  else  UNCHANGED  endif  }		; SAC 4/7/15 - ensure proper reset of ResultsCurrentMsg for Std AND DRtg models

; SAC 5/5/14 - integration of CAHP mods from MM-TRC
	"Retrieve CAHP multipliers"						Proj:Action = {	if (CAHPProgram < 0.5) then  UNCHANGED
																						else if (IsMultiFamily < 0.5)
																						then	EvalRulelist ( "CAHPMultipliersSF" )
																						else	EvalRulelist ( "CAHPMultipliersMF" )    endif endif  }
	"Calculate CAHP results"							Proj:Action = {	if (CAHPProgram < 0.5) then  UNCHANGED
																						else	switch (RunAbbrev)
																									case  "s"	:  if (AllOrientations < 0.5)
																														then	EvalRulelist( "CAHP_Summary" )
																														else	EvalRulelist( "CAHP_Summary_NESW" )  endif
																									default		:  UNCHANGED
																								endswitch  endif  }
																				;		else if (AllOrientations < 0.5 .AND. RunNumber == 2) then  EvalRulelist( "CAHP_Summary" )
																				;		else if (AllOrientations > 0.5 .AND. RunNumber == 5) then  EvalRulelist( "CAHP_Summary_NESW" )
																				;		else  UNCHANGED  endif endif endif  }

  ; SAC 2/4/16 - store model details following results storage for User model (research mode)
	"store research mode details"		Proj:Action = {	if (RunAbbrev == "u") then  StoreBEMProc( "UserModelDetails", 0 )
																		else	UNCHANGED  endif  }
END

;*************************************************************************
RULELIST "CARes_EnergyUse_CopyProposedResults" 1 0 0 1

	"Set EnergyUse:ProposedTDV[2]"			EnergyUse:ProposedTDV[2]			= {	EnergyUse:ProposedTDV[1]  }
	"Set EnergyUse:ProposedTDV[3]"			EnergyUse:ProposedTDV[3]			= {	EnergyUse:ProposedTDV[1]  }
	"Set EnergyUse:PropElecEnergy[2]"		EnergyUse:PropElecEnergy[2]		= {	EnergyUse:PropElecEnergy[1]  }
	"Set EnergyUse:PropNatGasEnergy[2]"		EnergyUse:PropNatGasEnergy[2]		= {	EnergyUse:PropNatGasEnergy[1]  }
	"Set EnergyUse:PropOtherEnergy[2]"		EnergyUse:PropOtherEnergy[2]		= {	EnergyUse:PropOtherEnergy[1]  }
	"Set EnergyUse:PropTotalEnergy[2]"		EnergyUse:PropTotalEnergy[2]		= {	EnergyUse:PropTotalEnergy[1]  }
	"Set EnergyUse:PropElecTDV[2]"			EnergyUse:PropElecTDV[2]			= {	EnergyUse:PropElecTDV[1]  }
	"Set EnergyUse:PropElecDemand[2]"		EnergyUse:PropElecDemand[2]		= {	EnergyUse:PropElecDemand[1]  }

	"Copy Proposed EUesSummary properties"	Proj:Action = {	EvalRulelist( "CARes_EnergyUse_CopyProposedSummaryResults" )  }

END
;*************************************************************************
RULELIST "CARes_EnergyUse_CopyProposedSummaryResults" 1 0 1 1

	"Set EUseSummary:Title1[17]"			EUseSummary:Title1[17]			= {	Title1[2]  }	; Proposed Elec Use -> DRtg Prop Elec Use
	"Set EUseSummary:Title2[17]"			EUseSummary:Title2[17]			= {	Title2[2]  }
	"Set EUseSummary:Title3[17]"			EUseSummary:Title3[17]			= {	Title3[2]  }
	"Set EUseSummary:Enduse1[17]"			EUseSummary:Enduse1[17]			= {	Enduse1[2]  }
	"Set EUseSummary:Enduse2[17]"			EUseSummary:Enduse2[17]			= {	Enduse2[2]  }
	"Set EUseSummary:Enduse3[17]"			EUseSummary:Enduse3[17]			= {	Enduse3[2]  }
	"Set EUseSummary:Enduse4[17]"			EUseSummary:Enduse4[17]			= {	Enduse4[2]  }
	"Set EUseSummary:Enduse5[17]"			EUseSummary:Enduse5[17]			= {	Enduse5[2]  }
	"Set EUseSummary:Enduse6[17]"			EUseSummary:Enduse6[17]			= {	Enduse6[2]  }
	"Set EUseSummary:Enduse7[17]"			EUseSummary:Enduse7[17]			= {	Enduse7[2]  }
	"Set EUseSummary:Enduse8[17]"			EUseSummary:Enduse8[17]			= {	Enduse8[2]  }
	"Set EUseSummary:Enduse9[17]"			EUseSummary:Enduse9[17]			= {	Enduse9[2]  }
	"Set EUseSummary:Enduse10[17]"		EUseSummary:Enduse10[17]		= {	Enduse10[2]  }
	"Set EUseSummary:Enduse11[17]"		EUseSummary:Enduse11[17]		= {	Enduse11[2]  }
	"Set EUseSummary:Enduse12[17]"		EUseSummary:Enduse12[17]		= {	Enduse12[2]  }
	"Set EUseSummary:Enduse13[17]"		EUseSummary:Enduse13[17]		= {	Enduse13[2]  }
	"Set EUseSummary:SummaryCol1[17]"	EUseSummary:SummaryCol1[17]	= {	SummaryCol1[2]  } 
	"Set EUseSummary:SummaryCol2[17]"	EUseSummary:SummaryCol2[17]	= {	SummaryCol2[2]  }
	"Set EUseSummary:SummaryCol3[17]"	EUseSummary:SummaryCol3[17]	= {	SummaryCol3[2]  }

	"Set EUseSummary:Title1[18]"			EUseSummary:Title1[18]			= {	Title1[3]  }	; Proposed NatGas Use -> DRtg Prop NatGas Use
	"Set EUseSummary:Title2[18]"			EUseSummary:Title2[18]			= {	Title2[3]  }
	"Set EUseSummary:Title3[18]"			EUseSummary:Title3[18]			= {	Title3[3]  }
	"Set EUseSummary:Enduse1[18]"			EUseSummary:Enduse1[18]			= {	Enduse1[3]  }
	"Set EUseSummary:Enduse2[18]"			EUseSummary:Enduse2[18]			= {	Enduse2[3]  }
	"Set EUseSummary:Enduse3[18]"			EUseSummary:Enduse3[18]			= {	Enduse3[3]  }
	"Set EUseSummary:Enduse4[18]"			EUseSummary:Enduse4[18]			= {	Enduse4[3]  }
	"Set EUseSummary:Enduse5[18]"			EUseSummary:Enduse5[18]			= {	Enduse5[3]  }
	"Set EUseSummary:Enduse6[18]"			EUseSummary:Enduse6[18]			= {	Enduse6[3]  }
	"Set EUseSummary:Enduse7[18]"			EUseSummary:Enduse7[18]			= {	Enduse7[3]  }
	"Set EUseSummary:Enduse8[18]"			EUseSummary:Enduse8[18]			= {	Enduse8[3]  }
	"Set EUseSummary:Enduse9[18]"			EUseSummary:Enduse9[18]			= {	Enduse9[3]  }
	"Set EUseSummary:Enduse10[18]"		EUseSummary:Enduse10[18]		= {	Enduse10[3]  }
	"Set EUseSummary:Enduse11[18]"		EUseSummary:Enduse11[18]		= {	Enduse11[3]  }
	"Set EUseSummary:Enduse12[18]"		EUseSummary:Enduse12[18]		= {	Enduse12[3]  }
	"Set EUseSummary:Enduse13[18]"		EUseSummary:Enduse13[18]		= {	Enduse13[3]  }
	"Set EUseSummary:SummaryCol1[18]"	EUseSummary:SummaryCol1[18]	= {	SummaryCol1[3]  } 
	"Set EUseSummary:SummaryCol2[18]"	EUseSummary:SummaryCol2[18]	= {	SummaryCol2[3]  }
	"Set EUseSummary:SummaryCol3[18]"	EUseSummary:SummaryCol3[18]	= {	SummaryCol3[3]  }

	"Set EUseSummary:Title1[19]"			EUseSummary:Title1[19]			= {	Title1[4]  }	; Proposed Total TDV -> DRtg Prop Total TDV
	"Set EUseSummary:Title2[19]"			EUseSummary:Title2[19]			= {	Title2[4]  }
	"Set EUseSummary:Title3[19]"			EUseSummary:Title3[19]			= {	Title3[4]  }
	"Set EUseSummary:Enduse1[19]"			EUseSummary:Enduse1[19]			= {	Enduse1[4]  }
	"Set EUseSummary:Enduse2[19]"			EUseSummary:Enduse2[19]			= {	Enduse2[4]  }
	"Set EUseSummary:Enduse3[19]"			EUseSummary:Enduse3[19]			= {	Enduse3[4]  }
	"Set EUseSummary:Enduse4[19]"			EUseSummary:Enduse4[19]			= {	Enduse4[4]  }
	"Set EUseSummary:Enduse5[19]"			EUseSummary:Enduse5[19]			= {	Enduse5[4]  }
	"Set EUseSummary:Enduse6[19]"			EUseSummary:Enduse6[19]			= {	Enduse6[4]  }
	"Set EUseSummary:Enduse7[19]"			EUseSummary:Enduse7[19]			= {	Enduse7[4]  }
	"Set EUseSummary:Enduse8[19]"			EUseSummary:Enduse8[19]			= {	Enduse8[4]  }
	"Set EUseSummary:Enduse9[19]"			EUseSummary:Enduse9[19]			= {	Enduse9[4]  }
	"Set EUseSummary:Enduse10[19]"		EUseSummary:Enduse10[19]		= {	Enduse10[4]  }
	"Set EUseSummary:Enduse11[19]"		EUseSummary:Enduse11[19]		= {	Enduse11[4]  }
	"Set EUseSummary:Enduse12[19]"		EUseSummary:Enduse12[19]		= {	Enduse12[4]  }
	"Set EUseSummary:Enduse13[19]"		EUseSummary:Enduse13[19]		= {	Enduse13[4]  }
	"Set EUseSummary:SummaryCol1[19]"	EUseSummary:SummaryCol1[19]	= {	SummaryCol1[4]  } 
	"Set EUseSummary:SummaryCol2[19]"	EUseSummary:SummaryCol2[19]	= {	SummaryCol2[4]  }
	"Set EUseSummary:SummaryCol3[19]"	EUseSummary:SummaryCol3[19]	= {	SummaryCol3[4]  }
END
;*************************************************************************


; SAC 5/5/14 - integration of CAHP mods from MM-TRC
;*************************************************************************
RULELIST "CAHPMultipliersSF" 1 0 0 1
;mbm - created list 4/15/2014
;*************************************************************************
	"Create heating CAHP multiplier"			Proj:CAHPMultHeat		= { CAHPMultTable:CAHPMultHeatSF( "ClimateZone", Proj:ClimateZone ) }
	"Create cooling CAHP multiplier"			Proj:CAHPMultCool		= { CAHPMultTable:CAHPMultCoolSF( "ClimateZone", Proj:ClimateZone ) }
	"Create ventilation CAHP multiplier"	Proj:CAHPMultVent		= { CAHPMultTable:CAHPMultVentSF( "ClimateZone", Proj:ClimateZone ) }
	"Create other HVAC CAHP multiplier"		Proj:CAHPMultOHVAC	= { CAHPMultTable:CAHPMultOHVACSF( "ClimateZone", Proj:ClimateZone ) }
	"Create DHW CAHP multiplier"				Proj:CAHPMultDhw		= { CAHPMultTable:CAHPMultDhwSF( "ClimateZone", Proj:ClimateZone ) }
	"Create PV Credit CAHP multiplier"		Proj:CAHPMultPVC		= { CAHPMultTable:CAHPMultPVCSF( "ClimateZone", Proj:ClimateZone ) }
	"Create Int Ltg CAHP multiplier"			Proj:CAHPMultIltg		= { CAHPMultTable:CAHPMultIltgSF( "ClimateZone", Proj:ClimateZone ) }
	"Create Appliances CAHP multiplier"		Proj:CAHPMultAppl		= { CAHPMultTable:CAHPMultApplSF( "ClimateZone", Proj:ClimateZone ) }
	"Create Plug Loads CAHP multiplier"		Proj:CAHPMultPlug		= { CAHPMultTable:CAHPMultPlugSF( "ClimateZone", Proj:ClimateZone ) }
	"Create Exterior CAHP multiplier"		Proj:CAHPMultExt		= { CAHPMultTable:CAHPMultExtSF( "ClimateZone", Proj:ClimateZone ) }
END
;*************************************************************************
RULELIST "CAHPMultipliersMF" 1 0 0 1
;mbm - created list 4/15/2014
;*************************************************************************
	"Create heating CAHP multiplier"			Proj:CAHPMultHeat		= { CAHPMultTable:CAHPMultHeatMF( "ClimateZone", Proj:ClimateZone ) }
	"Create cooling CAHP multiplier"			Proj:CAHPMultCool		= { CAHPMultTable:CAHPMultCoolMF( "ClimateZone", Proj:ClimateZone ) }
	"Create ventilation CAHP multiplier"	Proj:CAHPMultVent		= { CAHPMultTable:CAHPMultVentMF( "ClimateZone", Proj:ClimateZone ) }
	"Create other HVAC CAHP multiplier"		Proj:CAHPMultOHVAC	= { CAHPMultTable:CAHPMultOHVACMF( "ClimateZone", Proj:ClimateZone ) }
	"Create DHW CAHP multiplier"				Proj:CAHPMultDhw		= { CAHPMultTable:CAHPMultDhwMF( "ClimateZone", Proj:ClimateZone ) }
	"Create PV Credit CAHP multiplier"		Proj:CAHPMultPVC		= { CAHPMultTable:CAHPMultPVCMF( "ClimateZone", Proj:ClimateZone ) }
	"Create Int Ltg CAHP multiplier"			Proj:CAHPMultIltg		= { CAHPMultTable:CAHPMultIltgMF( "ClimateZone", Proj:ClimateZone ) }
	"Create Appliances CAHP multiplier"		Proj:CAHPMultAppl		= { CAHPMultTable:CAHPMultApplMF( "ClimateZone", Proj:ClimateZone ) }
	"Create Plug Loads CAHP multiplier"		Proj:CAHPMultPlug		= { CAHPMultTable:CAHPMultPlugMF( "ClimateZone", Proj:ClimateZone ) }
	"Create Exterior CAHP multiplier"		Proj:CAHPMultExt		= { CAHPMultTable:CAHPMultExtMF( "ClimateZone", Proj:ClimateZone ) }
END
;*************************************************************************
RULELIST "CAHP_Summary" 1 0 1 1
;*************************************************************************
  ; modified 5/15 MM-TRC updated run results calculations to align with correct array values and modified cahp score calculations.
  ; Standard TDV
	"Set ResultSummary[1]:Title1[9]"			Proj:ResultSummary[1]:Title1[9]		= {	switch (CAHPProgram)
																													case   1 : "CAHP Std"
																													case  11 : "CAHP-MF Std"
																													case  12 : "CMFNH Std"
																													default  : " "					endswitch  }
	"Set ResultSummary[1]:Title2[9]"			Proj:ResultSummary[1]:Title2[9]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[9]"			Proj:ResultSummary[1]:Title3[9]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[1]:Enduse1[9]"		Proj:ResultSummary[1]:Enduse1[9]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResults[1]:StandardTDV * Proj:CAHPMultHeat , 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[9]"		Proj:ResultSummary[1]:Enduse2[9]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResults[2]:StandardTDV * Proj:CAHPMultCool , 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[9]"		Proj:ResultSummary[1]:Enduse3[9]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResults[3]:StandardTDV * Proj:CAHPMultVent , 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[9]"		Proj:ResultSummary[1]:Enduse4[9]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResults[4]:StandardTDV * Proj:CAHPMultOHVAC , 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[9]"		Proj:ResultSummary[1]:Enduse5[9]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResults[5]:StandardTDV * Proj:CAHPMultDhw , 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[9]"		Proj:ResultSummary[1]:Enduse6[9]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResults[6]:StandardTDV * Proj:CAHPMultIltg , 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[9]"		Proj:ResultSummary[1]:Enduse7[9]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResults[7]:StandardTDV * Proj:CAHPMultAppl , 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[9]"		Proj:ResultSummary[1]:Enduse8[9]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResults[8]:StandardTDV * Proj:CAHPMultPlug , 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[9]"		Proj:ResultSummary[1]:Enduse9[9]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResults[9]:StandardTDV * Proj:CAHPMultExt , 2 )  endif  }
	"Set ResultSummary[1]:Enduse10[9]"		Proj:ResultSummary[1]:Enduse10[9]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr(  RunResults[1]:StandardTDV * Proj:CAHPMultHeat + RunResults[2]:StandardTDV * Proj:CAHPMultCool 
																																										+ RunResults[3]:StandardTDV * Proj:CAHPMultVent + RunResults[4]:StandardTDV * Proj:CAHPMultOHVAC
																																										+ RunResults[5]:StandardTDV * Proj:CAHPMultDhw + RunResults[6]:StandardTDV * Proj:CAHPMultIltg 
																																										+ RunResults[7]:StandardTDV * Proj:CAHPMultAppl + RunResults[8]:StandardTDV * Proj:CAHPMultPlug
																																										+ RunResults[9]:StandardTDV * Proj:CAHPMultExt , 2 )  endif  }
	"Set ResultSummary[1]:Enduse11[9]"		Proj:ResultSummary[1]:Enduse11[9]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr(  RunResults[1]:StandardTDV * Proj:CAHPMultHeat + RunResults[2]:StandardTDV * Proj:CAHPMultCool 
																																										+ RunResults[3]:StandardTDV * Proj:CAHPMultVent + RunResults[4]:StandardTDV * Proj:CAHPMultOHVAC
																																										+ RunResults[5]:StandardTDV * Proj:CAHPMultDhw , 2 )  endif  }

	"Set CAHP Score Initial"					Proj:ResultSummary[1]:CAHPScoreInitVal	=	{ 100 * ( RunResults[10]:ProposedTDV ) / ( RunResults[1]:StandardTDV * Proj:CAHPMultHeat + RunResults[2]:StandardTDV * Proj:CAHPMultCool 
																																+ RunResults[3]:StandardTDV * Proj:CAHPMultVent + RunResults[4]:StandardTDV * Proj:CAHPMultOHVAC
																																+ RunResults[5]:StandardTDV * Proj:CAHPMultDhw + RunResults[6]:StandardTDV * Proj:CAHPMultIltg 
																																+ RunResults[7]:StandardTDV * Proj:CAHPMultAppl + RunResults[8]:StandardTDV * Proj:CAHPMultPlug
																																+ RunResults[9]:StandardTDV * Proj:CAHPMultExt ) + 0.5 }
	"Set CAHP Score Initial"					Proj:ResultSummary[1]:CAHPScoreInitial		=	{ FltToStr ( ResultSummary[1]:CAHPScoreInitVal, 0 ) }
	"Set CAHPKickDOE"								Proj:ResultSummary[1]:CAHPKickDOE			=	{ if (CAHPProgram != 1 .OR. Proj:IsCAHPDOEChalHome < 0.5) then  0	else  3  endif  }																			
	"Set CAHPKickFutCode"						Proj:ResultSummary[1]:CAHPKickFutCode		=	{ if (CAHPProgram = 12 .OR. Proj:IsCAHPFutureCode  < 0.5) then  0	else  5  endif  }
	"Set CAHPKickHELtg"							Proj:ResultSummary[1]:CAHPKickHELtg			=	{ if (CAHPProgram != 1 .OR. Proj:IsCAHPHELtg       < 0.5) then  0	else  3  endif  }
	"Set CAHPEnergyTDV"							Proj:ResultSummary[1]:CAHPEnergyTDV			=	{ RunResults[10]:ProposedTDV * Proj:CondFloorArea  }
	"Set CAHP kicker for < 100,000 TDV"		Proj:ResultSummary[1]:CAHPKickTDV100		=	{ if (CAHPProgram == 1 .AND. ResultSummary[1]:CAHPEnergyTDV < 100000) then 5 else 0 endif }
	"Set CAHP kicker for < 60,000 TDV"		Proj:ResultSummary[1]:CAHPKickTDV60			=	{ if (CAHPProgram == 1 .AND. ResultSummary[1]:CAHPEnergyTDV < 60000 ) then 5 else 0 endif }
	"Set CAHP kicker total"						Proj:ResultSummary[1]:CAHPKickTot			= 	{	ValidOr( ResultSummary[1]:CAHPKickDOE,   0 ) + ValidOr( ResultSummary[1]:CAHPKickFutCode, 0 ) + ValidOr( ResultSummary[1]:CAHPKickHELtg, 0 ) +
																														ValidOr( ResultSummary[1]:CAHPKickTDV60, 0 ) + ValidOr( ResultSummary[1]:CAHPKickTDV100, 0 ) }
	"Set CAHP Score Final"						Proj:ResultSummary[1]:CAHPScoreFinal		=	{ ResultSummary[1]:CAHPScoreInitVal - ResultSummary[1]:CAHPKickTot }
	"Set CAHP Score Final"						Proj:ResultSummary[1]:CAHPScoreFinalStr	=	{ FltToStr ( ResultSummary[1]:CAHPScoreFinal, 0 ) }																								
	"Set Initial CAHP Incentive"				Proj:ResultSummary[1]:CAHPIncInit			=	{ switch (CAHPProgram)
																															case   1 : CAHPIncTable:CAHPIncInit(   "CAHPScoreFinal", ResultSummary[1]:CAHPScoreFinal )
																															case  11 : CAHPIncTable:CAHPMFIncInit( "CAHPScoreFinal", ResultSummary[1]:CAHPScoreFinal )
																															case  12 : CAHPIncTable:CMFNHIncInit(  "CAHPScoreFinal", ResultSummary[1]:CAHPScoreFinal )
																															default  : 0		endswitch }
	"Set Final CAHP Incentive"					Proj:ResultSummary[1]:CAHPIncFinal			=	{ ResultSummary[1]:CAHPIncInit * Proj:CAHPIncMod * Proj:NumDwellingUnits }
	"Set T24 CMFNH Incentive"					Proj:ResultSummary[1]:CMFNHIncT24			=	{	if (CAHPProgram != 12) then  0  else  50 * Proj:NumDwellingUnits  endif  }
	"Set HERS CMFNH Incentive"					Proj:ResultSummary[1]:CMFNHIncHERS			=	{	if (CAHPProgram != 12) then  0  else  60 * Proj:NumDwellingUnits  endif  }
	"Set Total CMFNH Incentive"				Proj:ResultSummary[1]:CMFNHIncTotal			=	{	if (CAHPProgram != 12) then  0
																														else	ResultSummary[1]:CMFNHIncHERS + ResultSummary[1]:CMFNHIncT24 + ResultSummary[1]:CAHPIncFinal
																														endif  }
	"Set CAHPScoreLabels[1]"					Proj:ResultSummary[1]:CAHPScoreLabels[1]	=	{ switch (CAHPProgram)
																															case   1 :  "Initial CAHP Score"
																															case  11 :  "Initial CAHP-MF Score"
																															case  12 :  "Initial CMFNH Score"
																															default  :  " "		endswitch }
	"Set CAHPScoreLabels[2]"					Proj:ResultSummary[1]:CAHPScoreLabels[2]	=	{ switch (CAHPProgram)
																															case   1 :  "Final CAHP Score"
																															case  11 :  "Final CAHP-MF Score"
																															case  12 :  "Final CMFNH Score"
																															default  :  " "		endswitch }
	"Set CAHPScoreLabels[3]"					Proj:ResultSummary[1]:CAHPScoreLabels[3]	=	{ switch (CAHPProgram)
																															case   1 :  " "
																															case  11 :  "Initial CAHP-MF Incentive"
																															case  12 :  "Initial CMFNH Incentive"
																															default  :  " "		endswitch }
	"Set CAHPScoreLabels[4]"					Proj:ResultSummary[1]:CAHPScoreLabels[4]	=	{ switch (CAHPProgram)
																															case   1 :  "Total CAHP Incentive"
																															case  11 :  "Total CAHP-MF Incentive"
																															case  12 :  "Total CMFNH Incentive"
																															default  :  " "		endswitch }
	"Set CAHPScoreLabels[5]"					Proj:ResultSummary[1]:CAHPScoreLabels[5]	=	{ switch (CAHPProgram)
																															case   1 :  " "
																															case  11 :  if (NumDwellingUnits <= 200)
																																			then	Format( "  (%.0f units)", NumDwellingUnits )
																																			else			  "  (max 200 units)"		endif
																															case  12 :  if (NumDwellingUnits <= 200)
																																			then	Format( "  (%.0f units)", NumDwellingUnits )
																																			else			  "  (max 200 units)"		endif
																															default  :  " "		endswitch }
END
;*************************************************************************
RULELIST "CAHP_Summary_NESW" 1 0 1 1
;*************************************************************************
	"Calculate CAHP results for Worst Case orientation"	Proj:Action = {	EvalRulelist( "CAHP_Summary" )  }		; SAC 7/9/14 - added

  ; Standard TDV - North
	"Set ResultSummary[2]:Title1[9]"			Proj:ResultSummary[2]:Title1[9]		= {	switch (CAHPProgram)
																													case   1 : "CAHP Std"
																													case  11 : "CAHP-MF Std"
																													case  12 : "CMFNH Std"
																													default  : " "					endswitch  }
	"Set ResultSummary[2]:Title2[9]"			Proj:ResultSummary[2]:Title2[9]		= {	"Design"  }
	"Set ResultSummary[2]:Title3[9]"			Proj:ResultSummary[2]:Title3[9]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[2]:Enduse1[9]"		Proj:ResultSummary[2]:Enduse1[9]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsN[1]:StandardTDV * Proj:CAHPMultHeat , 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[9]"		Proj:ResultSummary[2]:Enduse2[9]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsN[2]:StandardTDV * Proj:CAHPMultCool , 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[9]"		Proj:ResultSummary[2]:Enduse3[9]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsN[3]:StandardTDV * Proj:CAHPMultVent , 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[9]"		Proj:ResultSummary[2]:Enduse4[9]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsN[4]:StandardTDV * Proj:CAHPMultOHVAC , 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[9]"		Proj:ResultSummary[2]:Enduse5[9]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsN[5]:StandardTDV * Proj:CAHPMultDhw , 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[9]"		Proj:ResultSummary[2]:Enduse6[9]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsN[6]:StandardTDV * Proj:CAHPMultIltg , 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[9]"		Proj:ResultSummary[2]:Enduse7[9]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsN[7]:StandardTDV * Proj:CAHPMultAppl , 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[9]"		Proj:ResultSummary[2]:Enduse8[9]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsN[8]:StandardTDV * Proj:CAHPMultPlug , 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[9]"		Proj:ResultSummary[2]:Enduse9[9]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsN[9]:StandardTDV * Proj:CAHPMultExt , 2 )  endif  }
	"Set ResultSummary[2]:Enduse10[9]"		Proj:ResultSummary[2]:Enduse10[9]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsN[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsN[2]:StandardTDV * Proj:CAHPMultCool 
																																										+ RunResultsN[3]:StandardTDV * Proj:CAHPMultVent + RunResultsN[4]:StandardTDV * Proj:CAHPMultOHVAC
																																										+ RunResultsN[5]:StandardTDV * Proj:CAHPMultDhw + RunResultsN[6]:StandardTDV * Proj:CAHPMultIltg 
																																										+ RunResultsN[7]:StandardTDV * Proj:CAHPMultAppl + RunResultsN[8]:StandardTDV * Proj:CAHPMultPlug
																																										+ RunResultsN[9]:StandardTDV * Proj:CAHPMultExt , 2 )  endif  }
	"Set ResultSummary[2]:Enduse11[9]"		Proj:ResultSummary[2]:Enduse11[9]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsN[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsN[2]:StandardTDV * Proj:CAHPMultCool 
																																										+ RunResultsN[3]:StandardTDV * Proj:CAHPMultVent + RunResultsN[4]:StandardTDV * Proj:CAHPMultOHVAC
																																										+ RunResultsN[5]:StandardTDV * Proj:CAHPMultDhw , 2 )  endif  }

	"Set CAHP Score Initial"					Proj:ResultSummary[2]:CAHPScoreInitVal	=	{ 100 * ( RunResultsN[10]:ProposedTDV ) / ( RunResultsN[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsN[2]:StandardTDV * Proj:CAHPMultCool 
																																+ RunResultsN[3]:StandardTDV * Proj:CAHPMultVent + RunResultsN[4]:StandardTDV * Proj:CAHPMultOHVAC
																																+ RunResultsN[5]:StandardTDV * Proj:CAHPMultDhw + RunResultsN[6]:StandardTDV * Proj:CAHPMultIltg 
																																+ RunResultsN[7]:StandardTDV * Proj:CAHPMultAppl + RunResultsN[8]:StandardTDV * Proj:CAHPMultPlug
																																+ RunResultsN[9]:StandardTDV * Proj:CAHPMultExt ) + 0.5 }
	"Set CAHP Score Initial"					Proj:ResultSummary[2]:CAHPScoreInitial		=	{ FltToStr ( ResultSummary[2]:CAHPScoreInitVal, 0 ) }
	"Set CAHPKickDOE"								Proj:ResultSummary[2]:CAHPKickDOE			=	{ if (CAHPProgram != 1 .OR. Proj:IsCAHPDOEChalHome < 0.5) then  0	else  3  endif  }																			
	"Set CAHPKickFutCode"						Proj:ResultSummary[2]:CAHPKickFutCode		=	{ if (CAHPProgram = 12 .OR. Proj:IsCAHPFutureCode  < 0.5) then  0	else  5  endif  }
	"Set CAHPKickHELtg"							Proj:ResultSummary[2]:CAHPKickHELtg			=	{ if (CAHPProgram != 1 .OR. Proj:IsCAHPHELtg       < 0.5) then  0	else  3  endif  }
	"Set CAHPEnergyTDV"							Proj:ResultSummary[2]:CAHPEnergyTDV			=	{ RunResultsN[10]:ProposedTDV * Proj:CondFloorArea  }
	"Set CAHP kicker for < 100,000 TDV"		Proj:ResultSummary[2]:CAHPKickTDV100		=	{ if (CAHPProgram == 1 .AND. ResultSummary[2]:CAHPEnergyTDV < 100000 ) then 5 else 0 endif }
	"Set CAHP kicker for < 60,000 TDV"		Proj:ResultSummary[2]:CAHPKickTDV60			=	{ if (CAHPProgram == 1 .AND. ResultSummary[2]:CAHPEnergyTDV < 60000  ) then 5 else 0 endif }
	"Set CAHP kicker total"						Proj:ResultSummary[2]:CAHPKickTot			= 	{	ValidOr( ResultSummary[2]:CAHPKickDOE,   0 ) + ValidOr( ResultSummary[2]:CAHPKickFutCode, 0 ) + ValidOr( ResultSummary[2]:CAHPKickHELtg, 0 ) +
																														ValidOr( ResultSummary[2]:CAHPKickTDV60, 0 ) + ValidOr( ResultSummary[2]:CAHPKickTDV100,  0 ) }
	"Set CAHP Score Final"						Proj:ResultSummary[2]:CAHPScoreFinal		=	{ ResultSummary[2]:CAHPScoreInitVal - ResultSummary[2]:CAHPKickTot }
	"Set CAHP Score FinalStr"					Proj:ResultSummary[2]:CAHPScoreFinalStr	=	{ FltToStr ( ResultSummary[2]:CAHPScoreFinal, 0 ) }																								
	"Set Inital CAHP Incentive"				Proj:ResultSummary[2]:CAHPIncInit			=	{ switch (CAHPProgram)
																															case   1 : CAHPIncTable:CAHPIncInit(   "CAHPScoreFinal", ResultSummary[2]:CAHPScoreFinal )
																															case  11 : CAHPIncTable:CAHPMFIncInit( "CAHPScoreFinal", ResultSummary[2]:CAHPScoreFinal )
																															case  12 : CAHPIncTable:CMFNHIncInit(  "CAHPScoreFinal", ResultSummary[2]:CAHPScoreFinal )
																															default  : 0		endswitch }
	"Set Final CAHP Incentive"					Proj:ResultSummary[2]:CAHPIncFinal			=	{ ResultSummary[2]:CAHPIncInit * Proj:CAHPIncMod * Proj:NumDwellingUnits }																																										
	"Set T24 CMFNH Incentive"					Proj:ResultSummary[2]:CMFNHIncT24			=	{	if (CAHPProgram != 12) then  0  else  50 * Proj:NumDwellingUnits  endif  }
	"Set HERS CMFNH Incentive"					Proj:ResultSummary[2]:CMFNHIncHERS			=	{	if (CAHPProgram != 12) then  0  else  60 * Proj:NumDwellingUnits  endif  }
	"Set Total CMFNH Incentive"				Proj:ResultSummary[2]:CMFNHIncTotal			=	{	if (CAHPProgram != 12) then  0
																														else	ResultSummary[2]:CMFNHIncHERS + ResultSummary[2]:CMFNHIncT24 + ResultSummary[2]:CAHPIncFinal
																														endif  }
	"Set CAHPScoreLabels[1]"					Proj:ResultSummary[2]:CAHPScoreLabels[1]	=	{ switch (CAHPProgram)
																															case   1 :  "Initial CAHP Score"
																															case  11 :  "Initial CAHP-MF Score"
																															case  12 :  "Initial CMFNH Score"
																															default  :  " "		endswitch }
	"Set CAHPScoreLabels[2]"					Proj:ResultSummary[2]:CAHPScoreLabels[2]	=	{ switch (CAHPProgram)
																															case   1 :  "Final CAHP Score"
																															case  11 :  "Final CAHP-MF Score"
																															case  12 :  "Final CMFNH Score"
																															default  :  " "		endswitch }
	"Set CAHPScoreLabels[3]"					Proj:ResultSummary[2]:CAHPScoreLabels[3]	=	{ switch (CAHPProgram)
																															case   1 :  " "
																															case  11 :  "Initial CAHP-MF Incentive"
																															case  12 :  "Initial CMFNH Incentive"
																															default  :  " "		endswitch }
	"Set CAHPScoreLabels[4]"					Proj:ResultSummary[2]:CAHPScoreLabels[4]	=	{ switch (CAHPProgram)
																															case   1 :  "Total CAHP Incentive"
																															case  11 :  "Total CAHP-MF Incentive"
																															case  12 :  "Total CMFNH Incentive"
																															default  :  " "		endswitch }
	"Set CAHPScoreLabels[5]"					Proj:ResultSummary[2]:CAHPScoreLabels[5]	=	{ switch (CAHPProgram)
																															case   1 :  " "
																															case  11 :  if (NumDwellingUnits <= 200)
																																			then	Format( "  (%.0f units)", NumDwellingUnits )
																																			else			  "  (max 200 units)"		endif
																															case  12 :  if (NumDwellingUnits <= 200)
																																			then	Format( "  (%.0f units)", NumDwellingUnits )
																																			else			  "  (max 200 units)"		endif
																															default  :  " "		endswitch }

; Standard TDV - East
	"Set ResultSummary[3]:Title1[9]"			Proj:ResultSummary[3]:Title1[9]		= {	ResultSummary[2]:Title1[9]  }
	"Set ResultSummary[3]:Title2[9]"			Proj:ResultSummary[3]:Title2[9]		= {	"Design"  }
	"Set ResultSummary[3]:Title3[9]"			Proj:ResultSummary[3]:Title3[9]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[3]:Enduse1[9]"		Proj:ResultSummary[3]:Enduse1[9]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsE[1]:StandardTDV * Proj:CAHPMultHeat , 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[9]"		Proj:ResultSummary[3]:Enduse2[9]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsE[2]:StandardTDV * Proj:CAHPMultCool , 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[9]"		Proj:ResultSummary[3]:Enduse3[9]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsE[3]:StandardTDV * Proj:CAHPMultVent , 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[9]"		Proj:ResultSummary[3]:Enduse4[9]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsE[4]:StandardTDV * Proj:CAHPMultOHVAC , 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[9]"		Proj:ResultSummary[3]:Enduse5[9]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsE[5]:StandardTDV * Proj:CAHPMultDhw , 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[9]"		Proj:ResultSummary[3]:Enduse6[9]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsE[6]:StandardTDV * Proj:CAHPMultIltg , 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[9]"		Proj:ResultSummary[3]:Enduse7[9]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsE[7]:StandardTDV * Proj:CAHPMultAppl , 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[9]"		Proj:ResultSummary[3]:Enduse8[9]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsE[8]:StandardTDV * Proj:CAHPMultPlug , 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[9]"		Proj:ResultSummary[3]:Enduse9[9]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsE[9]:StandardTDV * Proj:CAHPMultExt , 2 )  endif  }
	"Set ResultSummary[3]:Enduse10[9]"		Proj:ResultSummary[3]:Enduse10[9]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsE[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsE[2]:StandardTDV * Proj:CAHPMultCool 
																																										+ RunResultsE[3]:StandardTDV * Proj:CAHPMultVent + RunResultsE[4]:StandardTDV * Proj:CAHPMultOHVAC
																																										+ RunResultsE[5]:StandardTDV * Proj:CAHPMultDhw + RunResultsE[6]:StandardTDV * Proj:CAHPMultIltg 
																																										+ RunResultsE[7]:StandardTDV * Proj:CAHPMultAppl + RunResultsE[8]:StandardTDV * Proj:CAHPMultPlug
																																										+ RunResultsE[9]:StandardTDV * Proj:CAHPMultExt , 2 )  endif  }
	"Set ResultSummary[3]:Enduse11[9]"		Proj:ResultSummary[3]:Enduse11[9]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsE[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsE[2]:StandardTDV * Proj:CAHPMultCool 
																																										+ RunResultsE[3]:StandardTDV * Proj:CAHPMultVent + RunResultsE[4]:StandardTDV * Proj:CAHPMultOHVAC
																																										+ RunResultsE[5]:StandardTDV * Proj:CAHPMultDhw , 2 )  endif  }

	"Set CAHP Score Initial"					Proj:ResultSummary[3]:CAHPScoreInitVal	=	{ 100 * ( RunResultsE[10]:ProposedTDV ) / ( RunResultsE[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsE[2]:StandardTDV * Proj:CAHPMultCool 
																																+ RunResultsE[3]:StandardTDV * Proj:CAHPMultVent + RunResultsE[4]:StandardTDV * Proj:CAHPMultOHVAC
																																+ RunResultsE[5]:StandardTDV * Proj:CAHPMultDhw + RunResultsE[6]:StandardTDV * Proj:CAHPMultIltg 
																																+ RunResultsE[7]:StandardTDV * Proj:CAHPMultAppl + RunResultsE[8]:StandardTDV * Proj:CAHPMultPlug
																																+ RunResultsE[9]:StandardTDV * Proj:CAHPMultExt ) + 0.5 }
	"Set CAHP Score Initial"					Proj:ResultSummary[3]:CAHPScoreInitial		=	{ FltToStr ( ResultSummary[3]:CAHPScoreInitVal, 0 ) }
	"Set CAHPKickDOE"								Proj:ResultSummary[3]:CAHPKickDOE			=	{ if (CAHPProgram != 1 .OR. Proj:IsCAHPDOEChalHome < 0.5) then  0	else  3  endif  }																			
	"Set CAHPKickFutCode"						Proj:ResultSummary[3]:CAHPKickFutCode		=	{ if (CAHPProgram = 12 .OR. Proj:IsCAHPFutureCode  < 0.5) then  0	else  5  endif  }
	"Set CAHPKickHELtg"							Proj:ResultSummary[3]:CAHPKickHELtg			=	{ if (CAHPProgram != 1 .OR. Proj:IsCAHPHELtg       < 0.5) then  0	else  3  endif  }
	"Set CAHPEnergyTDV"							Proj:ResultSummary[3]:CAHPEnergyTDV			=	{ RunResultsE[10]:ProposedTDV * Proj:CondFloorArea  }
	"Set CAHP kicker for < 100,000 TDV"		Proj:ResultSummary[3]:CAHPKickTDV100		=	{ if (CAHPProgram == 1 .AND. ResultSummary[3]:CAHPEnergyTDV < 100000 ) then 5 else 0 endif }
	"Set CAHP kicker for < 60,000 TDV"		Proj:ResultSummary[3]:CAHPKickTDV60			=	{ if (CAHPProgram == 1 .AND. ResultSummary[3]:CAHPEnergyTDV < 60000  ) then 5 else 0 endif }
	"Set CAHP kicker total"						Proj:ResultSummary[3]:CAHPKickTot			= 	{	ValidOr( ResultSummary[3]:CAHPKickDOE,   0 ) + ValidOr( ResultSummary[3]:CAHPKickFutCode, 0 ) + ValidOr( ResultSummary[3]:CAHPKickHELtg, 0 ) +
																														ValidOr( ResultSummary[3]:CAHPKickTDV60, 0 ) + ValidOr( ResultSummary[3]:CAHPKickTDV100, 0 ) }
	"Set CAHP Score Final"						Proj:ResultSummary[3]:CAHPScoreFinal		=	{ ResultSummary[3]:CAHPScoreInitVal - ResultSummary[3]:CAHPKickTot  }
	"Set CAHP Score FinalStr"					Proj:ResultSummary[3]:CAHPScoreFinalStr	=	{ FltToStr ( ResultSummary[3]:CAHPScoreFinal, 0 ) }																								
	"Set Inital CAHP Incentive"				Proj:ResultSummary[3]:CAHPIncInit			=	{ switch (CAHPProgram)
																															case   1 : CAHPIncTable:CAHPIncInit(   "CAHPScoreFinal", ResultSummary[3]:CAHPScoreFinal )
																															case  11 : CAHPIncTable:CAHPMFIncInit( "CAHPScoreFinal", ResultSummary[3]:CAHPScoreFinal )
																															case  12 : CAHPIncTable:CMFNHIncInit(  "CAHPScoreFinal", ResultSummary[3]:CAHPScoreFinal )
																															default  : 0		endswitch }
	"Set Final CAHP Incentive"					Proj:ResultSummary[3]:CAHPIncFinal			=	{ ResultSummary[3]:CAHPIncInit * Proj:CAHPIncMod * Proj:NumDwellingUnits }																																										
	"Set T24 CMFNH Incentive"					Proj:ResultSummary[3]:CMFNHIncT24			=	{	if (CAHPProgram != 12) then  0  else  50 * Proj:NumDwellingUnits  endif  }
	"Set HERS CMFNH Incentive"					Proj:ResultSummary[3]:CMFNHIncHERS			=	{	if (CAHPProgram != 12) then  0  else  60 * Proj:NumDwellingUnits  endif  }
	"Set Total CMFNH Incentive"				Proj:ResultSummary[3]:CMFNHIncTotal			=	{	if (CAHPProgram != 12) then  0
																														else	ResultSummary[3]:CMFNHIncHERS + ResultSummary[3]:CMFNHIncT24 + ResultSummary[3]:CAHPIncFinal
																														endif  }
	"Set CAHPScoreLabels[1]"					Proj:ResultSummary[3]:CAHPScoreLabels[1]	=	{	ResultSummary[2]:CAHPScoreLabels[1]  }
	"Set CAHPScoreLabels[2]"					Proj:ResultSummary[3]:CAHPScoreLabels[2]	=	{	ResultSummary[2]:CAHPScoreLabels[2]  }
	"Set CAHPScoreLabels[3]"					Proj:ResultSummary[3]:CAHPScoreLabels[3]	=	{	ResultSummary[2]:CAHPScoreLabels[3]  }
	"Set CAHPScoreLabels[4]"					Proj:ResultSummary[3]:CAHPScoreLabels[4]	=	{	ResultSummary[2]:CAHPScoreLabels[4]  }
	"Set CAHPScoreLabels[5]"					Proj:ResultSummary[3]:CAHPScoreLabels[5]	=	{	ResultSummary[2]:CAHPScoreLabels[5]  }
	
; Standard TDV - South
	"Set ResultSummary[4]:Title1[9]"			Proj:ResultSummary[4]:Title1[9]		= {	ResultSummary[2]:Title1[9]  }
	"Set ResultSummary[4]:Title2[9]"			Proj:ResultSummary[4]:Title2[9]		= {	"Design"  }
	"Set ResultSummary[4]:Title3[9]"			Proj:ResultSummary[4]:Title3[9]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[4]:Enduse1[9]"		Proj:ResultSummary[4]:Enduse1[9]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsS[1]:StandardTDV * Proj:CAHPMultHeat , 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[9]"		Proj:ResultSummary[4]:Enduse2[9]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsS[2]:StandardTDV * Proj:CAHPMultCool , 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[9]"		Proj:ResultSummary[4]:Enduse3[9]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsS[3]:StandardTDV * Proj:CAHPMultVent , 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[9]"		Proj:ResultSummary[4]:Enduse4[9]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsS[4]:StandardTDV * Proj:CAHPMultOHVAC , 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[9]"		Proj:ResultSummary[4]:Enduse5[9]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsS[5]:StandardTDV * Proj:CAHPMultDhw , 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[9]"		Proj:ResultSummary[4]:Enduse6[9]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsS[6]:StandardTDV * Proj:CAHPMultIltg , 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[9]"		Proj:ResultSummary[4]:Enduse7[9]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsS[7]:StandardTDV * Proj:CAHPMultAppl , 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[9]"		Proj:ResultSummary[4]:Enduse8[9]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsS[8]:StandardTDV * Proj:CAHPMultPlug , 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[9]"		Proj:ResultSummary[4]:Enduse9[9]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsS[9]:StandardTDV * Proj:CAHPMultExt , 2 )  endif  }
	"Set ResultSummary[4]:Enduse10[9]"		Proj:ResultSummary[4]:Enduse10[9]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsS[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsS[2]:StandardTDV * Proj:CAHPMultCool 
																																										+ RunResultsS[3]:StandardTDV * Proj:CAHPMultVent + RunResultsS[4]:StandardTDV * Proj:CAHPMultOHVAC
																																										+ RunResultsS[5]:StandardTDV * Proj:CAHPMultDhw + RunResultsS[6]:StandardTDV * Proj:CAHPMultIltg 
																																										+ RunResultsS[7]:StandardTDV * Proj:CAHPMultAppl + RunResultsS[8]:StandardTDV * Proj:CAHPMultPlug
																																										+ RunResultsS[9]:StandardTDV * Proj:CAHPMultExt , 2 )  endif  }
	"Set ResultSummary[4]:Enduse11[9]"		Proj:ResultSummary[4]:Enduse11[9]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsS[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsS[2]:StandardTDV * Proj:CAHPMultCool 
																																										+ RunResultsS[3]:StandardTDV * Proj:CAHPMultVent + RunResultsS[4]:StandardTDV * Proj:CAHPMultOHVAC
																																										+ RunResultsS[5]:StandardTDV * Proj:CAHPMultDhw , 2 )  endif  }

	"Set CAHP Score Initial"					Proj:ResultSummary[4]:CAHPScoreInitVal	=	{ 100 * ( RunResultsS[10]:ProposedTDV ) / ( RunResultsS[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsS[2]:StandardTDV * Proj:CAHPMultCool 
																																+ RunResultsS[3]:StandardTDV * Proj:CAHPMultVent + RunResultsS[4]:StandardTDV * Proj:CAHPMultOHVAC
																																+ RunResultsS[5]:StandardTDV * Proj:CAHPMultDhw + RunResultsS[6]:StandardTDV * Proj:CAHPMultIltg 
																																+ RunResultsS[7]:StandardTDV * Proj:CAHPMultAppl + RunResultsS[8]:StandardTDV * Proj:CAHPMultPlug
																																+ RunResultsS[9]:StandardTDV * Proj:CAHPMultExt ) + 0.5 }
	"Set CAHP Score Initial"					Proj:ResultSummary[4]:CAHPScoreInitial		=	{ FltToStr ( ResultSummary[4]:CAHPScoreInitVal, 0 ) }
	"Set CAHPKickDOE"								Proj:ResultSummary[4]:CAHPKickDOE			=	{ if (CAHPProgram != 1 .OR. Proj:IsCAHPDOEChalHome < 0.5) then  0	else  3  endif  }																			
	"Set CAHPKickFutCode"						Proj:ResultSummary[4]:CAHPKickFutCode		=	{ if (CAHPProgram = 12 .OR. Proj:IsCAHPFutureCode  < 0.5) then  0	else  5  endif  }
	"Set CAHPKickHELtg"							Proj:ResultSummary[4]:CAHPKickHELtg			=	{ if (CAHPProgram != 1 .OR. Proj:IsCAHPHELtg       < 0.5) then  0	else  3  endif  }
	"Set CAHPEnergyTDV"							Proj:ResultSummary[4]:CAHPEnergyTDV			=	{ RunResultsS[10]:ProposedTDV * Proj:CondFloorArea  }
	"Set CAHP kicker for < 100,000 TDV"		Proj:ResultSummary[4]:CAHPKickTDV100		=	{ if (CAHPProgram == 1 .AND. ResultSummary[4]:CAHPEnergyTDV < 100000 ) then 5 else 0 endif }
	"Set CAHP kicker for < 60,000 TDV"		Proj:ResultSummary[4]:CAHPKickTDV60			=	{ if (CAHPProgram == 1 .AND. ResultSummary[4]:CAHPEnergyTDV < 60000  ) then 5 else 0 endif }
	"Set CAHP kicker total"						Proj:ResultSummary[4]:CAHPKickTot			= 	{	ValidOr( ResultSummary[4]:CAHPKickDOE,   0 ) + ValidOr( ResultSummary[4]:CAHPKickFutCode, 0 ) + ValidOr( ResultSummary[4]:CAHPKickHELtg, 0 ) +
																														ValidOr( ResultSummary[4]:CAHPKickTDV60, 0 ) + ValidOr( ResultSummary[4]:CAHPKickTDV100,  0 ) }
	"Set CAHP Score Final"						Proj:ResultSummary[4]:CAHPScoreFinal		=	{ ResultSummary[4]:CAHPScoreInitVal - ResultSummary[4]:CAHPKickTot  }
	"Set CAHP Score FinalStr"					Proj:ResultSummary[4]:CAHPScoreFinalStr	=	{ FltToStr ( ResultSummary[4]:CAHPScoreFinal, 0 ) }																								
	"Set Inital CAHP Incentive"				Proj:ResultSummary[4]:CAHPIncInit			=	{ switch (CAHPProgram)
																															case   1 : CAHPIncTable:CAHPIncInit(   "CAHPScoreFinal", ResultSummary[4]:CAHPScoreFinal )
																															case  11 : CAHPIncTable:CAHPMFIncInit( "CAHPScoreFinal", ResultSummary[4]:CAHPScoreFinal )
																															case  12 : CAHPIncTable:CMFNHIncInit(  "CAHPScoreFinal", ResultSummary[4]:CAHPScoreFinal )
																															default  : 0		endswitch }
	"Set Final CAHP Incentive"					Proj:ResultSummary[4]:CAHPIncFinal			=	{ ResultSummary[4]:CAHPIncInit * Proj:CAHPIncMod * Proj:NumDwellingUnits }
	"Set T24 CMFNH Incentive"					Proj:ResultSummary[4]:CMFNHIncT24			=	{	if (CAHPProgram != 12) then  0  else  50 * Proj:NumDwellingUnits  endif  }
	"Set HERS CMFNH Incentive"					Proj:ResultSummary[4]:CMFNHIncHERS			=	{	if (CAHPProgram != 12) then  0  else  60 * Proj:NumDwellingUnits  endif  }
	"Set Total CMFNH Incentive"				Proj:ResultSummary[4]:CMFNHIncTotal			=	{	if (CAHPProgram != 12) then  0
																														else	ResultSummary[4]:CMFNHIncHERS + ResultSummary[4]:CMFNHIncT24 + ResultSummary[4]:CAHPIncFinal
																														endif  }
	"Set CAHPScoreLabels[1]"					Proj:ResultSummary[4]:CAHPScoreLabels[1]	=	{	ResultSummary[2]:CAHPScoreLabels[1]  }
	"Set CAHPScoreLabels[2]"					Proj:ResultSummary[4]:CAHPScoreLabels[2]	=	{	ResultSummary[2]:CAHPScoreLabels[2]  }
	"Set CAHPScoreLabels[3]"					Proj:ResultSummary[4]:CAHPScoreLabels[3]	=	{	ResultSummary[2]:CAHPScoreLabels[3]  }
	"Set CAHPScoreLabels[4]"					Proj:ResultSummary[4]:CAHPScoreLabels[4]	=	{	ResultSummary[2]:CAHPScoreLabels[4]  }
	"Set CAHPScoreLabels[5]"					Proj:ResultSummary[4]:CAHPScoreLabels[5]	=	{	ResultSummary[2]:CAHPScoreLabels[5]  }
	
; Standard TDV - West
	"Set ResultSummary[5]:Title1[9]"			Proj:ResultSummary[5]:Title1[9]		= {	ResultSummary[2]:Title1[9]  }
	"Set ResultSummary[5]:Title2[9]"			Proj:ResultSummary[5]:Title2[9]		= {	"Design"  }
	"Set ResultSummary[5]:Title3[9]"			Proj:ResultSummary[5]:Title3[9]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[5]:Enduse1[9]"		Proj:ResultSummary[5]:Enduse1[9]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsW[1]:StandardTDV * Proj:CAHPMultHeat , 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[9]"		Proj:ResultSummary[5]:Enduse2[9]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsW[2]:StandardTDV * Proj:CAHPMultCool , 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[9]"		Proj:ResultSummary[5]:Enduse3[9]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsW[3]:StandardTDV * Proj:CAHPMultVent , 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[9]"		Proj:ResultSummary[5]:Enduse4[9]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsW[4]:StandardTDV * Proj:CAHPMultOHVAC , 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[9]"		Proj:ResultSummary[5]:Enduse5[9]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsW[5]:StandardTDV * Proj:CAHPMultDhw , 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[9]"		Proj:ResultSummary[5]:Enduse6[9]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsW[6]:StandardTDV * Proj:CAHPMultIltg , 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[9]"		Proj:ResultSummary[5]:Enduse7[9]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsW[7]:StandardTDV * Proj:CAHPMultAppl , 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[9]"		Proj:ResultSummary[5]:Enduse8[9]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsW[8]:StandardTDV * Proj:CAHPMultPlug , 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[9]"		Proj:ResultSummary[5]:Enduse9[9]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsW[9]:StandardTDV * Proj:CAHPMultExt , 2 )  endif  }
	"Set ResultSummary[5]:Enduse10[9]"		Proj:ResultSummary[5]:Enduse10[9]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsW[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsW[2]:StandardTDV * Proj:CAHPMultCool 
																																										+ RunResultsW[3]:StandardTDV * Proj:CAHPMultVent + RunResultsW[4]:StandardTDV * Proj:CAHPMultOHVAC
																																										+ RunResultsW[5]:StandardTDV * Proj:CAHPMultDhw + RunResultsW[6]:StandardTDV * Proj:CAHPMultIltg 
																																										+ RunResultsW[7]:StandardTDV * Proj:CAHPMultAppl + RunResultsW[8]:StandardTDV * Proj:CAHPMultPlug
																																										+ RunResultsW[9]:StandardTDV * Proj:CAHPMultExt , 2 )  endif  }
	"Set ResultSummary[5]:Enduse11[9]"		Proj:ResultSummary[5]:Enduse11[9]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr(  RunResultsW[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsW[2]:StandardTDV * Proj:CAHPMultCool 
																																										+ RunResultsW[3]:StandardTDV * Proj:CAHPMultVent + RunResultsW[4]:StandardTDV * Proj:CAHPMultOHVAC
																																										+ RunResultsW[5]:StandardTDV * Proj:CAHPMultDhw , 2 )  endif  }
	"Set CAHP Score Initial"					Proj:ResultSummary[5]:CAHPScoreInitVal	=	{ 100 * ( RunResultsW[10]:ProposedTDV ) / ( RunResultsW[1]:StandardTDV * Proj:CAHPMultHeat + RunResultsW[2]:StandardTDV * Proj:CAHPMultCool 
																																+ RunResultsW[3]:StandardTDV * Proj:CAHPMultVent + RunResultsW[4]:StandardTDV * Proj:CAHPMultOHVAC
																																+ RunResultsW[5]:StandardTDV * Proj:CAHPMultDhw + RunResultsW[6]:StandardTDV * Proj:CAHPMultIltg 
																																+ RunResultsW[7]:StandardTDV * Proj:CAHPMultAppl + RunResultsW[8]:StandardTDV * Proj:CAHPMultPlug
																																+ RunResultsW[9]:StandardTDV * Proj:CAHPMultExt ) + 0.5 }
	"Set CAHP Score Initial"					Proj:ResultSummary[5]:CAHPScoreInitial		=	{ FltToStr ( ResultSummary[5]:CAHPScoreInitVal, 0 ) }
	"Set CAHPKickDOE"								Proj:ResultSummary[5]:CAHPKickDOE			=	{ if (CAHPProgram != 1 .OR. Proj:IsCAHPDOEChalHome < 0.5) then  0	else  3  endif  }																			
	"Set CAHPKickFutCode"						Proj:ResultSummary[5]:CAHPKickFutCode		=	{ if (CAHPProgram = 12 .OR. Proj:IsCAHPFutureCode  < 0.5) then  0	else  5  endif  }
	"Set CAHPKickHELtg"							Proj:ResultSummary[5]:CAHPKickHELtg			=	{ if (CAHPProgram != 1 .OR. Proj:IsCAHPHELtg       < 0.5) then  0	else  3  endif  }
	"Set CAHPEnergyTDV"							Proj:ResultSummary[5]:CAHPEnergyTDV			=	{ RunResultsW[10]:ProposedTDV * Proj:CondFloorArea  }
	"Set CAHP kicker for < 100,000 TDV"		Proj:ResultSummary[5]:CAHPKickTDV100		=	{ if (CAHPProgram == 1 .AND. ResultSummary[5]:CAHPEnergyTDV < 100000 ) then 5 else 0 endif }
	"Set CAHP kicker for < 60,000 TDV"		Proj:ResultSummary[5]:CAHPKickTDV60			=	{ if (CAHPProgram == 1 .AND. ResultSummary[5]:CAHPEnergyTDV < 60000  ) then 5 else 0 endif }
	"Set CAHP kicker total"						Proj:ResultSummary[5]:CAHPKickTot			= 	{	ValidOr( ResultSummary[5]:CAHPKickDOE,   0 ) + ValidOr( ResultSummary[5]:CAHPKickFutCode, 0 ) + ValidOr( ResultSummary[5]:CAHPKickHELtg, 0 ) +
																														ValidOr( ResultSummary[5]:CAHPKickTDV60, 0 ) + ValidOr( ResultSummary[5]:CAHPKickTDV100,  0 )  }
	"Set CAHP Score Final"						Proj:ResultSummary[5]:CAHPScoreFinal		=	{ ResultSummary[5]:CAHPScoreInitVal - ResultSummary[5]:CAHPKickTot  }
	"Set CAHP Score FinalWStr"					Proj:ResultSummary[5]:CAHPScoreFinalStr	=	{ FltToStr ( ResultSummary[5]:CAHPScoreFinal, 0 ) }																								
	"Set Inital CAHP Incentive"				Proj:ResultSummary[5]:CAHPIncInit			=	{ switch (CAHPProgram)
																															case   1 : CAHPIncTable:CAHPIncInit(   "CAHPScoreFinal", ResultSummary[5]:CAHPScoreFinal )
																															case  11 : CAHPIncTable:CAHPMFIncInit( "CAHPScoreFinal", ResultSummary[5]:CAHPScoreFinal )
																															case  12 : CAHPIncTable:CMFNHIncInit(  "CAHPScoreFinal", ResultSummary[5]:CAHPScoreFinal )
																															default  : 0		endswitch }
	"Set Final CAHP Incentive"					Proj:ResultSummary[5]:CAHPIncFinal			=	{ ResultSummary[5]:CAHPIncInit * Proj:CAHPIncMod * Proj:NumDwellingUnits }
	"Set T24 CMFNH Incentive"					Proj:ResultSummary[5]:CMFNHIncT24			=	{	if (CAHPProgram != 12) then  0  else  50 * Proj:NumDwellingUnits  endif  }
	"Set HERS CMFNH Incentive"					Proj:ResultSummary[5]:CMFNHIncHERS			=	{	if (CAHPProgram != 12) then  0  else  60 * Proj:NumDwellingUnits  endif  }
	"Set Total CMFNH Incentive"				Proj:ResultSummary[5]:CMFNHIncTotal			=	{	if (CAHPProgram != 12) then  0
																														else	ResultSummary[5]:CMFNHIncHERS + ResultSummary[5]:CMFNHIncT24 + ResultSummary[5]:CAHPIncFinal
																														endif  }
	"Set CAHPScoreLabels[1]"					Proj:ResultSummary[5]:CAHPScoreLabels[1]	=	{	ResultSummary[2]:CAHPScoreLabels[1]  }
	"Set CAHPScoreLabels[2]"					Proj:ResultSummary[5]:CAHPScoreLabels[2]	=	{	ResultSummary[2]:CAHPScoreLabels[2]  }
	"Set CAHPScoreLabels[3]"					Proj:ResultSummary[5]:CAHPScoreLabels[3]	=	{	ResultSummary[2]:CAHPScoreLabels[3]  }
	"Set CAHPScoreLabels[4]"					Proj:ResultSummary[5]:CAHPScoreLabels[4]	=	{	ResultSummary[2]:CAHPScoreLabels[4]  }
	"Set CAHPScoreLabels[5]"					Proj:ResultSummary[5]:CAHPScoreLabels[5]	=	{	ResultSummary[2]:CAHPScoreLabels[5]  }
END
; SAC 5/5/14 - end of CAHP additions


;*************************************************************************
RULELIST "CARes_ProposedResults" 1 0 0 1
;	mjb-10/16/13	moved "Other HVAC" [4] to "Space Heating" [1]
;*************************************************************************
	"Blast all EnergyUse components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EnergyUse )  }

	"Create result component - SpcHtg"		Proj:RunResults[1]					= {	CreateComp( EnergyUse, "EU-SpcHtg" )  }
	"Set parent for result   - SpcHtg"		Proj:RunResults[1]:Parent			= {	Local( Name )  }
	"Set EU name for result  - SpcHtg"		Proj:RunResults[1]:EnduseName		= {	"Space Heating"  }

	"Create result component - SpcClg"		Proj:RunResults[2]					= {	CreateComp( EnergyUse, "EU-SpcClg" )  }
	"Set parent for result   - SpcClg"		Proj:RunResults[2]:Parent			= {	Local( Name )  }
	"Set EU name for result  - SpcClg"		Proj:RunResults[2]:EnduseName		= {	"Space Cooling"  }

	"Create result component - IAQVent"		Proj:RunResults[3]					= {	CreateComp( EnergyUse, "EU-IAQVent" )  }
	"Set parent for result   - IAQVent"		Proj:RunResults[3]:Parent			= {	Local( Name )  }
	"Set EU name for result  - IAQVent"		Proj:RunResults[3]:EnduseName		= {	"IAQ Ventilation"  }

	"Create result component - Othr HVAC"	Proj:RunResults[4]					= {	CreateComp( EnergyUse, "EU-OthrHVAC" )  }
	"Set parent for result   - Othr HVAC"	Proj:RunResults[4]:Parent			= {	Local( Name )  }
	"Set EU name for result  - Othr HVAC"	Proj:RunResults[4]:EnduseName		= {	"Other HVAC"  }

	"Create result component - WtrHt"		Proj:RunResults[5]					= {	CreateComp( EnergyUse, "EU-WtrHt" )  }
	"Set parent for result   - WtrHt"		Proj:RunResults[5]:Parent			= {	Local( Name )  }
	"Set EU name for result  - WtrHt"		Proj:RunResults[5]:EnduseName		= {	"Water Heating"  }

	"Create result component - InsLtg"		Proj:RunResults[6]					= {	CreateComp( EnergyUse, "EU-InsLtg" )  }
	"Set parent for result   - InsLtg"		Proj:RunResults[6]:Parent			= {	Local( Name )  }
	"Set EU name for result  - InsLtg"		Proj:RunResults[6]:EnduseName		= {	"Inside Lighting"  }

	"Create result component - AppCkg"		Proj:RunResults[7]					= {	CreateComp( EnergyUse, "EU-AppCkg" )  }
	"Set parent for result   - AppCkg"		Proj:RunResults[7]:Parent			= {	Local( Name )  }
	"Set EU name for result  - AppCkg"		Proj:RunResults[7]:EnduseName		= {	"Appl. & Cooking"  }

	"Create result component - Plugs"		Proj:RunResults[8]					= {	CreateComp( EnergyUse, "EU-Plugs" )  }
	"Set parent for result   - Plugs"		Proj:RunResults[8]:Parent			= {	Local( Name )  }
	"Set EU name for result  - Plugs"		Proj:RunResults[8]:EnduseName		= {	"Plug Loads"  }

	"Create result component - Ext"			Proj:RunResults[9]					= {	CreateComp( EnergyUse, "EU-Ext" )  }
	"Set parent for result   - Ext"			Proj:RunResults[9]:Parent			= {	Local( Name )  }
	"Set EU name for result  - Ext"			Proj:RunResults[9]:EnduseName		= {	"Exterior"  }

	"Create result component - Total"		Proj:RunResults[10]					= {	CreateComp( EnergyUse, "EU-Total" )  }
	"Set parent for result   - Total"		Proj:RunResults[10]:Parent			= {	Local( Name )  }
	"Set EU name for result  - Total"		Proj:RunResults[10]:EnduseName	= {	"TOTAL"  }

	"Create result component - Comp Ttl"	Proj:RunResults[11]					= {	CreateComp( EnergyUse, "EU-Compliance" )  }
	"Set parent for result   - Comp Ttl"	Proj:RunResults[11]:Parent			= {	Local( Name )  }
	"Set EU name for result  - Comp Ttl"	Proj:RunResults[11]:EnduseName	= {	"Compliance Total"  }

	"Create result component - PV Ttl"		Proj:RunResults[13]					= {	CreateComp( EnergyUse, "EU-PV" )  }
	"Set parent for result   - PV Ttl"		Proj:RunResults[13]:Parent			= {	Local( Name )  }
	"Set EU name for result  - PV Ttl"		Proj:RunResults[13]:EnduseName	= {	"Photovoltaics"  }

; SAC 8/5/13 - added references to new "SHWPmp" (summed into each occurrence of Elec-SHW)
  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - SpcHt"		Proj:RunResults[1]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - SpcHt"		Proj:RunResults[1]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - SpcHt"		Proj:RunResults[1]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Htg", "HPHtg",  "Aux" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - SpcHt"		Proj:RunResults[1]:PropTotalEnergy[1]		= {	LocalRef( RunResults[1]:PropElecEnergy[1] ) + LocalRef( RunResults[1]:PropNatGasEnergy[1] ) + LocalRef( RunResults[1]:PropOtherEnergy[1] )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - SpcCl"		Proj:RunResults[2]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - SpcCl"		Proj:RunResults[2]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - SpcCl"		Proj:RunResults[2]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - SpcCl"		Proj:RunResults[2]:PropTotalEnergy[1]		= {	LocalRef( RunResults[2]:PropElecEnergy[1] ) + LocalRef( RunResults[2]:PropNatGasEnergy[1] ) + LocalRef( RunResults[2]:PropOtherEnergy[1] )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - IAQVent"	Proj:RunResults[3]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - IAQVent"	Proj:RunResults[3]:PropNatGasEnergy[1]		= {	0  }
	"Store energy use - Other  - IAQVent"	Proj:RunResults[3]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - IAQVent"	Proj:RunResults[3]:PropTotalEnergy[1]		= {	LocalRef( RunResults[3]:PropElecEnergy[1] )   }

  ; Other HVAC (aux & misc fans)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;	"Store energy use - Elec   - OthrHVAC"	Proj:RunResults[4]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - NatGas - OthrHVAC"	Proj:RunResults[4]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - Other  - OthrHVAC"	Proj:RunResults[4]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - TOTAL  - OthrHVAC"	Proj:RunResults[4]:PropTotalEnergy[1]		= {	LocalRef( RunResults[4]:PropElecEnergy[1] ) + LocalRef( RunResults[4]:PropNatGasEnergy[1] ) + LocalRef( RunResults[4]:PropOtherEnergy[1] )   }
;
	"Zero out - Elec   - OthrHVAC"	Proj:RunResults[4]:PropElecEnergy[1]		= {	0  }
	"Zero out - NatGas - OthrHVAC"	Proj:RunResults[4]:PropNatGasEnergy[1]		= {	0  }
	"Zero out - Other  - OthrHVAC"	Proj:RunResults[4]:PropOtherEnergy[1]		= {	0  }
	"Zero out - TOTAL  - OthrHVAC"	Proj:RunResults[4]:PropTotalEnergy[1]		= {	0  }

  ; SAC 3/23/16 - updated references to "DHW" enduse w/ "Dhw" and added "DhwBU" (DHW backup htg)
  ; Water Heating
	"Store energy use - Elec   - WtrHt"		Proj:RunResults[5]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - WtrHt"		Proj:RunResults[5]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - WtrHt"		Proj:RunResults[5]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - WtrHt"		Proj:RunResults[5]:PropTotalEnergy[1]		= {	LocalRef( RunResults[5]:PropElecEnergy[1] ) + LocalRef( RunResults[5]:PropNatGasEnergy[1] ) + LocalRef( RunResults[5]:PropOtherEnergy[1] )   }

  ; Inside Lighting
	"Store energy use - Elec   - InsLtg"	Proj:RunResults[6]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - InsLtg"	Proj:RunResults[6]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - InsLtg"	Proj:RunResults[6]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - InsLtg"	Proj:RunResults[6]:PropTotalEnergy[1]		= {	LocalRef( RunResults[6]:PropElecEnergy[1] ) + LocalRef( RunResults[6]:PropNatGasEnergy[1] ) + LocalRef( RunResults[6]:PropOtherEnergy[1] )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - AppCkg"	Proj:RunResults[7]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - AppCkg"	Proj:RunResults[7]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - AppCkg"	Proj:RunResults[7]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - AppCkg"	Proj:RunResults[7]:PropTotalEnergy[1]		= {	LocalRef( RunResults[7]:PropElecEnergy[1] ) + LocalRef( RunResults[7]:PropNatGasEnergy[1] ) + LocalRef( RunResults[7]:PropOtherEnergy[1] )   }

  ; Plug Loads
	"Store energy use - Elec   - Plugs"		Proj:RunResults[8]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - Plugs"		Proj:RunResults[8]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - Plugs"		Proj:RunResults[8]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - Plugs"		Proj:RunResults[8]:PropTotalEnergy[1]		= {	LocalRef( RunResults[8]:PropElecEnergy[1] ) + LocalRef( RunResults[8]:PropNatGasEnergy[1] ) + LocalRef( RunResults[8]:PropOtherEnergy[1] )   }

  ; Exterior
	"Store energy use - Elec   - Ext"		Proj:RunResults[9]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - Ext"		Proj:RunResults[9]:PropNatGasEnergy[1]		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - Ext"		Proj:RunResults[9]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - Ext"		Proj:RunResults[9]:PropTotalEnergy[1]		= {	LocalRef( RunResults[9]:PropElecEnergy[1] ) + LocalRef( RunResults[9]:PropNatGasEnergy[1] ) + LocalRef( RunResults[9]:PropOtherEnergy[1] )   }

  ; PV
	"Store energy use - Elec   - PV"			Proj:RunResults[13]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - PV"			Proj:RunResults[13]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - PV"			Proj:RunResults[13]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - PV"			Proj:RunResults[13]:PropTotalEnergy[1]		= {	LocalRef( RunResults[13]:PropElecEnergy[1] )   }

  ; Compliance Total
	"Store energy use - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecEnergy[1]		= {	RunResults[1]:PropElecEnergy[1]   + RunResults[2]:PropElecEnergy[1]   + RunResults[3]:PropElecEnergy[1]   + RunResults[4]:PropElecEnergy[1]   + RunResults[5]:PropElecEnergy[1]    }
	"Store energy use - NatGas - Comp Ttl"	Proj:RunResults[11]:PropNatGasEnergy[1]	= {	RunResults[1]:PropNatGasEnergy[1] + RunResults[2]:PropNatGasEnergy[1] + RunResults[3]:PropNatGasEnergy[1] + RunResults[4]:PropNatGasEnergy[1] + RunResults[5]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - Comp Ttl"	Proj:RunResults[11]:PropOtherEnergy[1]		= {	RunResults[1]:PropOtherEnergy[1]  + RunResults[2]:PropOtherEnergy[1]  + RunResults[3]:PropOtherEnergy[1]  + RunResults[4]:PropOtherEnergy[1]  + RunResults[5]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - Comp Ttl"	Proj:RunResults[11]:PropTotalEnergy[1]		= {	RunResults[1]:PropTotalEnergy[1]  + RunResults[2]:PropTotalEnergy[1]  + RunResults[3]:PropTotalEnergy[1]  + RunResults[4]:PropTotalEnergy[1]  + RunResults[5]:PropTotalEnergy[1]   }

  ; Total
	"Store energy use - Elec   - Total"		Proj:RunResults[10]:PropElecEnergy[1]		= {	RunResults[11]:PropElecEnergy[1]   + RunResults[6]:PropElecEnergy[1]   + RunResults[7]:PropElecEnergy[1]   + RunResults[8]:PropElecEnergy[1]   + RunResults[9]:PropElecEnergy[1]    }
	"Store energy use - NatGas - Total"		Proj:RunResults[10]:PropNatGasEnergy[1]	= {	RunResults[11]:PropNatGasEnergy[1] + RunResults[6]:PropNatGasEnergy[1] + RunResults[7]:PropNatGasEnergy[1] + RunResults[8]:PropNatGasEnergy[1] + RunResults[9]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - Total"		Proj:RunResults[10]:PropOtherEnergy[1]		= {	RunResults[11]:PropOtherEnergy[1]  + RunResults[6]:PropOtherEnergy[1]  + RunResults[7]:PropOtherEnergy[1]  + RunResults[8]:PropOtherEnergy[1]  + RunResults[9]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - Total"		Proj:RunResults[10]:PropTotalEnergy[1]		= {	RunResults[11]:PropTotalEnergy[1]  + RunResults[6]:PropTotalEnergy[1]  + RunResults[7]:PropTotalEnergy[1]  + RunResults[8]:PropTotalEnergy[1]  + RunResults[9]:PropTotalEnergy[1]   }
END

;*************************************************************************		- SAC 6/25/13
RULELIST "CARes_ProposedResults_N" 1 0 0 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
	"Blast all EnergyUse components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EnergyUse )  }  ; ONLY for FIRST (North) run

	"Create result component - N-SpcHtg"		Proj:RunResultsN[1]					= {	CreateComp( EnergyUse, "N-EU-SpcHtg" )  }
	"Set parent for result   - N-SpcHtg"		Proj:RunResultsN[1]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-SpcHtg"		Proj:RunResultsN[1]:EnduseName	= {	"Space Heating"  }

	"Create result component - N-SpcClg"		Proj:RunResultsN[2]					= {	CreateComp( EnergyUse, "N-EU-SpcClg" )  }
	"Set parent for result   - N-SpcClg"		Proj:RunResultsN[2]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-SpcClg"		Proj:RunResultsN[2]:EnduseName	= {	"Space Cooling"  }

	"Create result component - N-IAQVent"		Proj:RunResultsN[3]					= {	CreateComp( EnergyUse, "N-EU-IAQVent" )  }
	"Set parent for result   - N-IAQVent"		Proj:RunResultsN[3]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-IAQVent"		Proj:RunResultsN[3]:EnduseName	= {	"IAQ Ventilation"  }

	"Create result component - N-Othr HVAC"	Proj:RunResultsN[4]					= {	CreateComp( EnergyUse, "N-EU-OthrHVAC" )  }
	"Set parent for result   - N-Othr HVAC"	Proj:RunResultsN[4]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-Othr HVAC"	Proj:RunResultsN[4]:EnduseName	= {	"Other HVAC"  }

	"Create result component - N-WtrHt"			Proj:RunResultsN[5]					= {	CreateComp( EnergyUse, "N-EU-WtrHt" )  }
	"Set parent for result   - N-WtrHt"			Proj:RunResultsN[5]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-WtrHt"			Proj:RunResultsN[5]:EnduseName	= {	"Water Heating"  }

	"Create result component - N-InsLtg"		Proj:RunResultsN[6]					= {	CreateComp( EnergyUse, "N-EU-InsLtg" )  }
	"Set parent for result   - N-InsLtg"		Proj:RunResultsN[6]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-InsLtg"		Proj:RunResultsN[6]:EnduseName	= {	"Inside Lighting"  }

	"Create result component - N-AppCkg"		Proj:RunResultsN[7]					= {	CreateComp( EnergyUse, "N-EU-AppCkg" )  }
	"Set parent for result   - N-AppCkg"		Proj:RunResultsN[7]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-AppCkg"		Proj:RunResultsN[7]:EnduseName	= {	"Appl. & Cooking"  }

	"Create result component - N-Plugs"			Proj:RunResultsN[8]					= {	CreateComp( EnergyUse, "N-EU-Plugs" )  }
	"Set parent for result   - N-Plugs"			Proj:RunResultsN[8]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-Plugs"			Proj:RunResultsN[8]:EnduseName	= {	"Plug Loads"  }

	"Create result component - N-Ext"			Proj:RunResultsN[9]					= {	CreateComp( EnergyUse, "N-EU-Ext" )  }
	"Set parent for result   - N-Ext"			Proj:RunResultsN[9]:Parent			= {	Local( Name )  }
	"Set EU name for result  - N-Ext"			Proj:RunResultsN[9]:EnduseName	= {	"Exterior"  }

	"Create result component - N-Total"			Proj:RunResultsN[10]					= {	CreateComp( EnergyUse, "N-EU-Total" )  }
	"Set parent for result   - N-Total"			Proj:RunResultsN[10]:Parent		= {	Local( Name )  }
	"Set EU name for result  - N-Total"			Proj:RunResultsN[10]:EnduseName	= {	"TOTAL"  }

	"Create result component - N-Comp Ttl"		Proj:RunResultsN[11]					= {	CreateComp( EnergyUse, "N-EU-Compliance" )  }
	"Set parent for result   - N-Comp Ttl"		Proj:RunResultsN[11]:Parent		= {	Local( Name )  }
	"Set EU name for result  - N-Comp Ttl"		Proj:RunResultsN[11]:EnduseName	= {	"Compliance Total"  }

	"Create result component - N-PV Ttl"		Proj:RunResultsN[13]					= {	CreateComp( EnergyUse, "N-EU-PV" )  }
	"Set parent for result   - N-PV Ttl"		Proj:RunResultsN[13]:Parent		= {	Local( Name )  }
	"Set EU name for result  - N-PV Ttl"		Proj:RunResultsN[13]:EnduseName	= {	"Photovoltaics"  }

  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - N-SpcHt"		Proj:RunResultsN[1]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH",   "Aux", "Fan"  ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-SpcHt"		Proj:RunResultsN[1]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-SpcHt"		Proj:RunResultsN[1]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Htg", "HPHtg",  "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[1]:PropElecEnergy[1] ) + LocalRef( RunResultsN[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[1]:PropOtherEnergy[1] )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - N-SpcCl"		Proj:RunResultsN[2]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-SpcCl"		Proj:RunResultsN[2]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-SpcCl"		Proj:RunResultsN[2]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[2]:PropElecEnergy[1] ) + LocalRef( RunResultsN[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[2]:PropOtherEnergy[1] )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - N-IAQVent"	Proj:RunResultsN[3]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-IAQVent"	Proj:RunResultsN[3]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - N-IAQVent"	Proj:RunResultsN[3]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[3]:PropElecEnergy[1] )   }

  ; Other HVAC (aux & misc fans)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;	"Store energy use - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[4]:PropElecEnergy[1] ) + LocalRef( RunResultsN[4]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[4]:PropOtherEnergy[1] )   }
;
	"Zero out - Elec   - N-OthrHVAC"		Proj:RunResultsN[4]:PropElecEnergy[1]		= {	0  }
	"Zero out - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:PropNatGasEnergy[1]	= {	0  }
	"Zero out - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:PropOtherEnergy[1]		= {	0  }
	"Zero out - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:PropTotalEnergy[1]		= {	0  }

  ; Water Heating
	"Store energy use - Elec   - N-WtrHt"		Proj:RunResultsN[5]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-WtrHt"		Proj:RunResultsN[5]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-WtrHt"		Proj:RunResultsN[5]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[5]:PropElecEnergy[1] ) + LocalRef( RunResultsN[5]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[5]:PropOtherEnergy[1] )   }

  ; Inside Lighting
	"Store energy use - Elec   - N-InsLtg"		Proj:RunResultsN[6]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-InsLtg"		Proj:RunResultsN[6]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-InsLtg"		Proj:RunResultsN[6]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[6]:PropElecEnergy[1] ) + LocalRef( RunResultsN[6]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[6]:PropOtherEnergy[1] )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - N-AppCkg"		Proj:RunResultsN[7]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-AppCkg"		Proj:RunResultsN[7]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-AppCkg"		Proj:RunResultsN[7]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[7]:PropElecEnergy[1] ) + LocalRef( RunResultsN[7]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[7]:PropOtherEnergy[1] )   }

  ; Plug Loads
	"Store energy use - Elec   - N-Plugs"		Proj:RunResultsN[8]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-Plugs"		Proj:RunResultsN[8]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-Plugs"		Proj:RunResultsN[8]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[8]:PropElecEnergy[1] ) + LocalRef( RunResultsN[8]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[8]:PropOtherEnergy[1] )   }

  ; Exterior
	"Store energy use - Elec   - N-Ext"			Proj:RunResultsN[9]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-Ext"			Proj:RunResultsN[9]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-Ext"			Proj:RunResultsN[9]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-Ext"			Proj:RunResultsN[9]:PropTotalEnergy[1]		= {	LocalRef( RunResultsN[9]:PropElecEnergy[1] ) + LocalRef( RunResultsN[9]:PropNatGasEnergy[1] ) + LocalRef( RunResultsN[9]:PropOtherEnergy[1] )   }

  ; PV
	"Store energy use - Elec   - N-PV"			Proj:RunResultsN[13]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-PV"			Proj:RunResultsN[13]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - N-PV"			Proj:RunResultsN[13]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - N-PV"			Proj:RunResultsN[13]:PropTotalEnergy[1]	= {	LocalRef( RunResultsN[13]:PropElecEnergy[1] )   }

  ; Compliance Total
	"Store energy use - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecEnergy[1]		= {	RunResultsN[1]:PropElecEnergy[1]   + RunResultsN[2]:PropElecEnergy[1]   + RunResultsN[3]:PropElecEnergy[1]   + RunResultsN[4]:PropElecEnergy[1]   + RunResultsN[5]:PropElecEnergy[1]    }
	"Store energy use - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:PropNatGasEnergy[1]	= {	RunResultsN[1]:PropNatGasEnergy[1] + RunResultsN[2]:PropNatGasEnergy[1] + RunResultsN[3]:PropNatGasEnergy[1] + RunResultsN[4]:PropNatGasEnergy[1] + RunResultsN[5]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:PropOtherEnergy[1]	= {	RunResultsN[1]:PropOtherEnergy[1]  + RunResultsN[2]:PropOtherEnergy[1]  + RunResultsN[3]:PropOtherEnergy[1]  + RunResultsN[4]:PropOtherEnergy[1]  + RunResultsN[5]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:PropTotalEnergy[1]	= {	RunResultsN[1]:PropTotalEnergy[1]  + RunResultsN[2]:PropTotalEnergy[1]  + RunResultsN[3]:PropTotalEnergy[1]  + RunResultsN[4]:PropTotalEnergy[1]  + RunResultsN[5]:PropTotalEnergy[1]   }

  ; Total
	"Store energy use - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecEnergy[1]		= {	RunResultsN[11]:PropElecEnergy[1]   + RunResultsN[6]:PropElecEnergy[1]   + RunResultsN[7]:PropElecEnergy[1]   + RunResultsN[8]:PropElecEnergy[1]   + RunResultsN[9]:PropElecEnergy[1]    }
	"Store energy use - NatGas - N-Total"		Proj:RunResultsN[10]:PropNatGasEnergy[1]	= {	RunResultsN[11]:PropNatGasEnergy[1] + RunResultsN[6]:PropNatGasEnergy[1] + RunResultsN[7]:PropNatGasEnergy[1] + RunResultsN[8]:PropNatGasEnergy[1] + RunResultsN[9]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - N-Total"		Proj:RunResultsN[10]:PropOtherEnergy[1]	= {	RunResultsN[11]:PropOtherEnergy[1]  + RunResultsN[6]:PropOtherEnergy[1]  + RunResultsN[7]:PropOtherEnergy[1]  + RunResultsN[8]:PropOtherEnergy[1]  + RunResultsN[9]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - N-Total"		Proj:RunResultsN[10]:PropTotalEnergy[1]	= {	RunResultsN[11]:PropTotalEnergy[1]  + RunResultsN[6]:PropTotalEnergy[1]  + RunResultsN[7]:PropTotalEnergy[1]  + RunResultsN[8]:PropTotalEnergy[1]  + RunResultsN[9]:PropTotalEnergy[1]   }
END

;*************************************************************************		- SAC 6/25/13
RULELIST "CARes_ProposedResults_E" 1 0 0 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
;	"Blast all EnergyUse components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EnergyUse )  }  ; ONLY for FIRST (North) run

	"Create result component - E-SpcHtg"		Proj:RunResultsE[1]					= {	CreateComp( EnergyUse, "E-EU-SpcHtg" )  }
	"Set parent for result   - E-SpcHtg"		Proj:RunResultsE[1]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-SpcHtg"		Proj:RunResultsE[1]:EnduseName	= {	"Space Heating"  }

	"Create result component - E-SpcClg"		Proj:RunResultsE[2]					= {	CreateComp( EnergyUse, "E-EU-SpcClg" )  }
	"Set parent for result   - E-SpcClg"		Proj:RunResultsE[2]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-SpcClg"		Proj:RunResultsE[2]:EnduseName	= {	"Space Cooling"  }

	"Create result component - E-IAQVent"		Proj:RunResultsE[3]					= {	CreateComp( EnergyUse, "E-EU-IAQVent" )  }
	"Set parent for result   - E-IAQVent"		Proj:RunResultsE[3]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-IAQVent"		Proj:RunResultsE[3]:EnduseName	= {	"IAQ Ventilation"  }

	"Create result component - E-Othr HVAC"	Proj:RunResultsE[4]					= {	CreateComp( EnergyUse, "E-EU-OthrHVAC" )  }
	"Set parent for result   - E-Othr HVAC"	Proj:RunResultsE[4]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-Othr HVAC"	Proj:RunResultsE[4]:EnduseName	= {	"Other HVAC"  }

	"Create result component - E-WtrHt"			Proj:RunResultsE[5]					= {	CreateComp( EnergyUse, "E-EU-WtrHt" )  }
	"Set parent for result   - E-WtrHt"			Proj:RunResultsE[5]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-WtrHt"			Proj:RunResultsE[5]:EnduseName	= {	"Water Heating"  }

	"Create result component - E-InsLtg"		Proj:RunResultsE[6]					= {	CreateComp( EnergyUse, "E-EU-InsLtg" )  }
	"Set parent for result   - E-InsLtg"		Proj:RunResultsE[6]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-InsLtg"		Proj:RunResultsE[6]:EnduseName	= {	"Inside Lighting"  }

	"Create result component - E-AppCkg"		Proj:RunResultsE[7]					= {	CreateComp( EnergyUse, "E-EU-AppCkg" )  }
	"Set parent for result   - E-AppCkg"		Proj:RunResultsE[7]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-AppCkg"		Proj:RunResultsE[7]:EnduseName	= {	"Appl. & Cooking"  }

	"Create result component - E-Plugs"			Proj:RunResultsE[8]					= {	CreateComp( EnergyUse, "E-EU-Plugs" )  }
	"Set parent for result   - E-Plugs"			Proj:RunResultsE[8]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-Plugs"			Proj:RunResultsE[8]:EnduseName	= {	"Plug Loads"  }

	"Create result component - E-Ext"			Proj:RunResultsE[9]					= {	CreateComp( EnergyUse, "E-EU-Ext" )  }
	"Set parent for result   - E-Ext"			Proj:RunResultsE[9]:Parent			= {	Local( Name )  }
	"Set EU name for result  - E-Ext"			Proj:RunResultsE[9]:EnduseName	= {	"Exterior"  }

	"Create result component - E-Total"			Proj:RunResultsE[10]					= {	CreateComp( EnergyUse, "E-EU-Total" )  }
	"Set parent for result   - E-Total"			Proj:RunResultsE[10]:Parent		= {	Local( Name )  }
	"Set EU name for result  - E-Total"			Proj:RunResultsE[10]:EnduseName	= {	"TOTAL"  }

	"Create result component - E-Comp Ttl"		Proj:RunResultsE[11]					= {	CreateComp( EnergyUse, "E-EU-Compliance" )  }
	"Set parent for result   - E-Comp Ttl"		Proj:RunResultsE[11]:Parent		= {	Local( Name )  }
	"Set EU name for result  - E-Comp Ttl"		Proj:RunResultsE[11]:EnduseName	= {	"Compliance Total"  }

	"Create result component - E-PV Ttl"		Proj:RunResultsE[13]					= {	CreateComp( EnergyUse, "E-EU-PV" )  }
	"Set parent for result   - E-PV Ttl"		Proj:RunResultsE[13]:Parent		= {	Local( Name )  }
	"Set EU name for result  - E-PV Ttl"		Proj:RunResultsE[13]:EnduseName	= {	"Photovoltaics"  }

  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - E-SpcHt"		Proj:RunResultsE[1]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - E-SpcHt"		Proj:RunResultsE[1]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - E-SpcHt"		Proj:RunResultsE[1]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Htg", "HPHtg",  "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[1]:PropElecEnergy[1] ) + LocalRef( RunResultsE[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[1]:PropOtherEnergy[1] )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - E-SpcCl"		Proj:RunResultsE[2]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - E-SpcCl"		Proj:RunResultsE[2]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - E-SpcCl"		Proj:RunResultsE[2]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[2]:PropElecEnergy[1] ) + LocalRef( RunResultsE[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[2]:PropOtherEnergy[1] )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - E-IAQVent"	Proj:RunResultsE[3]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - E-IAQVent"	Proj:RunResultsE[3]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - E-IAQVent"	Proj:RunResultsE[3]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[3]:PropElecEnergy[1] )   }

  ; Other HVAC (aux & misc fans)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;	"Store energy use - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[4]:PropElecEnergy[1] ) + LocalRef( RunResultsE[4]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[4]:PropOtherEnergy[1] )   }
;
	"Zero out - Elec   - E-OthrHVAC"		Proj:RunResultsE[4]:PropElecEnergy[1]		= {	0  }
	"Zero out - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:PropNatGasEnergy[1]	= {	0  }
	"Zero out - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:PropOtherEnergy[1]		= {	0  }
	"Zero out - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:PropTotalEnergy[1]		= {	0  }
  ; Water Heating
	"Store energy use - Elec   - E-WtrHt"		Proj:RunResultsE[5]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - E-WtrHt"		Proj:RunResultsE[5]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - E-WtrHt"		Proj:RunResultsE[5]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[5]:PropElecEnergy[1] ) + LocalRef( RunResultsE[5]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[5]:PropOtherEnergy[1] )   }

  ; Inside Lighting
	"Store energy use - Elec   - E-InsLtg"		Proj:RunResultsE[6]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - E-InsLtg"		Proj:RunResultsE[6]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - E-InsLtg"		Proj:RunResultsE[6]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[6]:PropElecEnergy[1] ) + LocalRef( RunResultsE[6]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[6]:PropOtherEnergy[1] )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - E-AppCkg"		Proj:RunResultsE[7]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - E-AppCkg"		Proj:RunResultsE[7]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - E-AppCkg"		Proj:RunResultsE[7]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[7]:PropElecEnergy[1] ) + LocalRef( RunResultsE[7]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[7]:PropOtherEnergy[1] )   }

  ; Plug Loads
	"Store energy use - Elec   - E-Plugs"		Proj:RunResultsE[8]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - E-Plugs"		Proj:RunResultsE[8]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - E-Plugs"		Proj:RunResultsE[8]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[8]:PropElecEnergy[1] ) + LocalRef( RunResultsE[8]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[8]:PropOtherEnergy[1] )   }

  ; Exterior
	"Store energy use - Elec   - E-Ext"			Proj:RunResultsE[9]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - E-Ext"			Proj:RunResultsE[9]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - E-Ext"			Proj:RunResultsE[9]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - E-Ext"			Proj:RunResultsE[9]:PropTotalEnergy[1]		= {	LocalRef( RunResultsE[9]:PropElecEnergy[1] ) + LocalRef( RunResultsE[9]:PropNatGasEnergy[1] ) + LocalRef( RunResultsE[9]:PropOtherEnergy[1] )   }

  ; PV
	"Store energy use - Elec   - E-PV"			Proj:RunResultsE[13]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - E-PV"			Proj:RunResultsE[13]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - E-PV"			Proj:RunResultsE[13]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - E-PV"			Proj:RunResultsE[13]:PropTotalEnergy[1]	= {	LocalRef( RunResultsE[13]:PropElecEnergy[1] )   }

  ; Compliance Total
	"Store energy use - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecEnergy[1]		= {	RunResultsE[1]:PropElecEnergy[1]   + RunResultsE[2]:PropElecEnergy[1]   + RunResultsE[3]:PropElecEnergy[1]   + RunResultsE[4]:PropElecEnergy[1]   + RunResultsE[5]:PropElecEnergy[1]    }
	"Store energy use - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:PropNatGasEnergy[1]	= {	RunResultsE[1]:PropNatGasEnergy[1] + RunResultsE[2]:PropNatGasEnergy[1] + RunResultsE[3]:PropNatGasEnergy[1] + RunResultsE[4]:PropNatGasEnergy[1] + RunResultsE[5]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:PropOtherEnergy[1]	= {	RunResultsE[1]:PropOtherEnergy[1]  + RunResultsE[2]:PropOtherEnergy[1]  + RunResultsE[3]:PropOtherEnergy[1]  + RunResultsE[4]:PropOtherEnergy[1]  + RunResultsE[5]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:PropTotalEnergy[1]	= {	RunResultsE[1]:PropTotalEnergy[1]  + RunResultsE[2]:PropTotalEnergy[1]  + RunResultsE[3]:PropTotalEnergy[1]  + RunResultsE[4]:PropTotalEnergy[1]  + RunResultsE[5]:PropTotalEnergy[1]   }

  ; Total
	"Store energy use - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecEnergy[1]		= {	RunResultsE[11]:PropElecEnergy[1]   + RunResultsE[6]:PropElecEnergy[1]   + RunResultsE[7]:PropElecEnergy[1]   + RunResultsE[8]:PropElecEnergy[1]   + RunResultsE[9]:PropElecEnergy[1]    }
	"Store energy use - NatGas - E-Total"		Proj:RunResultsE[10]:PropNatGasEnergy[1]	= {	RunResultsE[11]:PropNatGasEnergy[1] + RunResultsE[6]:PropNatGasEnergy[1] + RunResultsE[7]:PropNatGasEnergy[1] + RunResultsE[8]:PropNatGasEnergy[1] + RunResultsE[9]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - E-Total"		Proj:RunResultsE[10]:PropOtherEnergy[1]	= {	RunResultsE[11]:PropOtherEnergy[1]  + RunResultsE[6]:PropOtherEnergy[1]  + RunResultsE[7]:PropOtherEnergy[1]  + RunResultsE[8]:PropOtherEnergy[1]  + RunResultsE[9]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - E-Total"		Proj:RunResultsE[10]:PropTotalEnergy[1]	= {	RunResultsE[11]:PropTotalEnergy[1]  + RunResultsE[6]:PropTotalEnergy[1]  + RunResultsE[7]:PropTotalEnergy[1]  + RunResultsE[8]:PropTotalEnergy[1]  + RunResultsE[9]:PropTotalEnergy[1]   }
END

;*************************************************************************		- SAC 6/25/13
RULELIST "CARes_ProposedResults_S" 1 0 0 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
;	"Blast all EnergyUse components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EnergyUse )  }  ; ONLY for FIRST (North) run

	"Create result component - S-SpcHtg"		Proj:RunResultsS[1]					= {	CreateComp( EnergyUse, "S-EU-SpcHtg" )  }
	"Set parent for result   - S-SpcHtg"		Proj:RunResultsS[1]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-SpcHtg"		Proj:RunResultsS[1]:EnduseName	= {	"Space Heating"  }

	"Create result component - S-SpcClg"		Proj:RunResultsS[2]					= {	CreateComp( EnergyUse, "S-EU-SpcClg" )  }
	"Set parent for result   - S-SpcClg"		Proj:RunResultsS[2]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-SpcClg"		Proj:RunResultsS[2]:EnduseName	= {	"Space Cooling"  }

	"Create result component - S-IAQVent"		Proj:RunResultsS[3]					= {	CreateComp( EnergyUse, "S-EU-IAQVent" )  }
	"Set parent for result   - S-IAQVent"		Proj:RunResultsS[3]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-IAQVent"		Proj:RunResultsS[3]:EnduseName	= {	"IAQ Ventilation"  }

	"Create result component - S-Othr HVAC"	Proj:RunResultsS[4]					= {	CreateComp( EnergyUse, "S-EU-OthrHVAC" )  }
	"Set parent for result   - S-Othr HVAC"	Proj:RunResultsS[4]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-Othr HVAC"	Proj:RunResultsS[4]:EnduseName	= {	"Other HVAC"  }

	"Create result component - S-WtrHt"			Proj:RunResultsS[5]					= {	CreateComp( EnergyUse, "S-EU-WtrHt" )  }
	"Set parent for result   - S-WtrHt"			Proj:RunResultsS[5]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-WtrHt"			Proj:RunResultsS[5]:EnduseName	= {	"Water Heating"  }

	"Create result component - S-InsLtg"		Proj:RunResultsS[6]					= {	CreateComp( EnergyUse, "S-EU-InsLtg" )  }
	"Set parent for result   - S-InsLtg"		Proj:RunResultsS[6]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-InsLtg"		Proj:RunResultsS[6]:EnduseName	= {	"Inside Lighting"  }

	"Create result component - S-AppCkg"		Proj:RunResultsS[7]					= {	CreateComp( EnergyUse, "S-EU-AppCkg" )  }
	"Set parent for result   - S-AppCkg"		Proj:RunResultsS[7]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-AppCkg"		Proj:RunResultsS[7]:EnduseName	= {	"Appl. & Cooking"  }

	"Create result component - S-Plugs"			Proj:RunResultsS[8]					= {	CreateComp( EnergyUse, "S-EU-Plugs" )  }
	"Set parent for result   - S-Plugs"			Proj:RunResultsS[8]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-Plugs"			Proj:RunResultsS[8]:EnduseName	= {	"Plug Loads"  }

	"Create result component - S-Ext"			Proj:RunResultsS[9]					= {	CreateComp( EnergyUse, "S-EU-Ext" )  }
	"Set parent for result   - S-Ext"			Proj:RunResultsS[9]:Parent			= {	Local( Name )  }
	"Set EU name for result  - S-Ext"			Proj:RunResultsS[9]:EnduseName	= {	"Exterior"  }

	"Create result component - S-Total"			Proj:RunResultsS[10]					= {	CreateComp( EnergyUse, "S-EU-Total" )  }
	"Set parent for result   - S-Total"			Proj:RunResultsS[10]:Parent		= {	Local( Name )  }
	"Set EU name for result  - S-Total"			Proj:RunResultsS[10]:EnduseName	= {	"TOTAL"  }

	"Create result component - S-Comp Ttl"		Proj:RunResultsS[11]					= {	CreateComp( EnergyUse, "S-EU-Compliance" )  }
	"Set parent for result   - S-Comp Ttl"		Proj:RunResultsS[11]:Parent		= {	Local( Name )  }
	"Set EU name for result  - S-Comp Ttl"		Proj:RunResultsS[11]:EnduseName	= {	"Compliance Total"  }

	"Create result component - S-PV Ttl"		Proj:RunResultsS[13]					= {	CreateComp( EnergyUse, "S-EU-PV" )  }
	"Set parent for result   - S-PV Ttl"		Proj:RunResultsS[13]:Parent		= {	Local( Name )  }
	"Set EU name for result  - S-PV Ttl"		Proj:RunResultsS[13]:EnduseName	= {	"Photovoltaics"  }

  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - S-SpcHt"		Proj:RunResultsS[1]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - S-SpcHt"		Proj:RunResultsS[1]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - S-SpcHt"		Proj:RunResultsS[1]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Htg", "HPHtg",  "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[1]:PropElecEnergy[1] ) + LocalRef( RunResultsS[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[1]:PropOtherEnergy[1] )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - S-SpcCl"		Proj:RunResultsS[2]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - S-SpcCl"		Proj:RunResultsS[2]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - S-SpcCl"		Proj:RunResultsS[2]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[2]:PropElecEnergy[1] ) + LocalRef( RunResultsS[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[2]:PropOtherEnergy[1] )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - S-IAQVent"	Proj:RunResultsS[3]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - S-IAQVent"	Proj:RunResultsS[3]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - S-IAQVent"	Proj:RunResultsS[3]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[3]:PropElecEnergy[1] )   }

  ; Other HVAC (aux & misc fans)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;	"Store energy use - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[4]:PropElecEnergy[1] ) + LocalRef( RunResultsS[4]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[4]:PropOtherEnergy[1] )   }
;
	"Zero out - Elec   - S-OthrHVAC"		Proj:RunResultsS[4]:PropElecEnergy[1]		= {	0  }
	"Zero out - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:PropNatGasEnergy[1]	= {	0  }
	"Zero out - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:PropOtherEnergy[1]		= {	0  }
	"Zero out - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:PropTotalEnergy[1]		= {	0  }
  ; Water Heating
	"Store energy use - Elec   - S-WtrHt"		Proj:RunResultsS[5]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - S-WtrHt"		Proj:RunResultsS[5]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - S-WtrHt"		Proj:RunResultsS[5]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[5]:PropElecEnergy[1] ) + LocalRef( RunResultsS[5]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[5]:PropOtherEnergy[1] )   }

  ; Inside Lighting
	"Store energy use - Elec   - S-InsLtg"		Proj:RunResultsS[6]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - S-InsLtg"		Proj:RunResultsS[6]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - S-InsLtg"		Proj:RunResultsS[6]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[6]:PropElecEnergy[1] ) + LocalRef( RunResultsS[6]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[6]:PropOtherEnergy[1] )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - S-AppCkg"		Proj:RunResultsS[7]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - S-AppCkg"		Proj:RunResultsS[7]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - S-AppCkg"		Proj:RunResultsS[7]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[7]:PropElecEnergy[1] ) + LocalRef( RunResultsS[7]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[7]:PropOtherEnergy[1] )   }

  ; Plug Loads
	"Store energy use - Elec   - S-Plugs"		Proj:RunResultsS[8]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - S-Plugs"		Proj:RunResultsS[8]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - S-Plugs"		Proj:RunResultsS[8]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[8]:PropElecEnergy[1] ) + LocalRef( RunResultsS[8]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[8]:PropOtherEnergy[1] )   }

  ; Exterior
	"Store energy use - Elec   - S-Ext"			Proj:RunResultsS[9]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - S-Ext"			Proj:RunResultsS[9]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - S-Ext"			Proj:RunResultsS[9]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - S-Ext"			Proj:RunResultsS[9]:PropTotalEnergy[1]		= {	LocalRef( RunResultsS[9]:PropElecEnergy[1] ) + LocalRef( RunResultsS[9]:PropNatGasEnergy[1] ) + LocalRef( RunResultsS[9]:PropOtherEnergy[1] )   }

  ; PV
	"Store energy use - Elec   - S-PV"			Proj:RunResultsS[13]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - S-PV"			Proj:RunResultsS[13]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - S-PV"			Proj:RunResultsS[13]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - S-PV"			Proj:RunResultsS[13]:PropTotalEnergy[1]	= {	LocalRef( RunResultsS[13]:PropElecEnergy[1] )   }

  ; Compliance Total
	"Store energy use - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecEnergy[1]		= {	RunResultsS[1]:PropElecEnergy[1]   + RunResultsS[2]:PropElecEnergy[1]   + RunResultsS[3]:PropElecEnergy[1]   + RunResultsS[4]:PropElecEnergy[1]   + RunResultsS[5]:PropElecEnergy[1]    }
	"Store energy use - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:PropNatGasEnergy[1]	= {	RunResultsS[1]:PropNatGasEnergy[1] + RunResultsS[2]:PropNatGasEnergy[1] + RunResultsS[3]:PropNatGasEnergy[1] + RunResultsS[4]:PropNatGasEnergy[1] + RunResultsS[5]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:PropOtherEnergy[1]	= {	RunResultsS[1]:PropOtherEnergy[1]  + RunResultsS[2]:PropOtherEnergy[1]  + RunResultsS[3]:PropOtherEnergy[1]  + RunResultsS[4]:PropOtherEnergy[1]  + RunResultsS[5]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:PropTotalEnergy[1]	= {	RunResultsS[1]:PropTotalEnergy[1]  + RunResultsS[2]:PropTotalEnergy[1]  + RunResultsS[3]:PropTotalEnergy[1]  + RunResultsS[4]:PropTotalEnergy[1]  + RunResultsS[5]:PropTotalEnergy[1]   }

  ; Total
	"Store energy use - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecEnergy[1]		= {	RunResultsS[11]:PropElecEnergy[1]   + RunResultsS[6]:PropElecEnergy[1]   + RunResultsS[7]:PropElecEnergy[1]   + RunResultsS[8]:PropElecEnergy[1]   + RunResultsS[9]:PropElecEnergy[1]    }
	"Store energy use - NatGas - S-Total"		Proj:RunResultsS[10]:PropNatGasEnergy[1]	= {	RunResultsS[11]:PropNatGasEnergy[1] + RunResultsS[6]:PropNatGasEnergy[1] + RunResultsS[7]:PropNatGasEnergy[1] + RunResultsS[8]:PropNatGasEnergy[1] + RunResultsS[9]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - S-Total"		Proj:RunResultsS[10]:PropOtherEnergy[1]	= {	RunResultsS[11]:PropOtherEnergy[1]  + RunResultsS[6]:PropOtherEnergy[1]  + RunResultsS[7]:PropOtherEnergy[1]  + RunResultsS[8]:PropOtherEnergy[1]  + RunResultsS[9]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - S-Total"		Proj:RunResultsS[10]:PropTotalEnergy[1]	= {	RunResultsS[11]:PropTotalEnergy[1]  + RunResultsS[6]:PropTotalEnergy[1]  + RunResultsS[7]:PropTotalEnergy[1]  + RunResultsS[8]:PropTotalEnergy[1]  + RunResultsS[9]:PropTotalEnergy[1]   }
END

;*************************************************************************		- SAC 6/25/13
RULELIST "CARes_ProposedResults_W" 1 0 0 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
;	"Blast all EnergyUse components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EnergyUse )  }  ; ONLY for FIRST (North) run

	"Create result component - W-SpcHtg"		Proj:RunResultsW[1]					= {	CreateComp( EnergyUse, "W-EU-SpcHtg" )  }
	"Set parent for result   - W-SpcHtg"		Proj:RunResultsW[1]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-SpcHtg"		Proj:RunResultsW[1]:EnduseName	= {	"Space Heating"  }

	"Create result component - W-SpcClg"		Proj:RunResultsW[2]					= {	CreateComp( EnergyUse, "W-EU-SpcClg" )  }
	"Set parent for result   - W-SpcClg"		Proj:RunResultsW[2]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-SpcClg"		Proj:RunResultsW[2]:EnduseName	= {	"Space Cooling"  }

	"Create result component - W-IAQVent"		Proj:RunResultsW[3]					= {	CreateComp( EnergyUse, "W-EU-IAQVent" )  }
	"Set parent for result   - W-IAQVent"		Proj:RunResultsW[3]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-IAQVent"		Proj:RunResultsW[3]:EnduseName	= {	"IAQ Ventilation"  }

	"Create result component - W-Othr HVAC"	Proj:RunResultsW[4]					= {	CreateComp( EnergyUse, "W-EU-OthrHVAC" )  }
	"Set parent for result   - W-Othr HVAC"	Proj:RunResultsW[4]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-Othr HVAC"	Proj:RunResultsW[4]:EnduseName	= {	"Other HVAC"  }

	"Create result component - W-WtrHt"			Proj:RunResultsW[5]					= {	CreateComp( EnergyUse, "W-EU-WtrHt" )  }
	"Set parent for result   - W-WtrHt"			Proj:RunResultsW[5]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-WtrHt"			Proj:RunResultsW[5]:EnduseName	= {	"Water Heating"  }

	"Create result component - W-InsLtg"		Proj:RunResultsW[6]					= {	CreateComp( EnergyUse, "W-EU-InsLtg" )  }
	"Set parent for result   - W-InsLtg"		Proj:RunResultsW[6]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-InsLtg"		Proj:RunResultsW[6]:EnduseName	= {	"Inside Lighting"  }

	"Create result component - W-AppCkg"		Proj:RunResultsW[7]					= {	CreateComp( EnergyUse, "W-EU-AppCkg" )  }
	"Set parent for result   - W-AppCkg"		Proj:RunResultsW[7]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-AppCkg"		Proj:RunResultsW[7]:EnduseName	= {	"Appl. & Cooking"  }

	"Create result component - W-Plugs"			Proj:RunResultsW[8]					= {	CreateComp( EnergyUse, "W-EU-Plugs" )  }
	"Set parent for result   - W-Plugs"			Proj:RunResultsW[8]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-Plugs"			Proj:RunResultsW[8]:EnduseName	= {	"Plug Loads"  }

	"Create result component - W-Ext"			Proj:RunResultsW[9]					= {	CreateComp( EnergyUse, "W-EU-Ext" )  }
	"Set parent for result   - W-Ext"			Proj:RunResultsW[9]:Parent			= {	Local( Name )  }
	"Set EU name for result  - W-Ext"			Proj:RunResultsW[9]:EnduseName	= {	"Exterior"  }

	"Create result component - W-Total"			Proj:RunResultsW[10]					= {	CreateComp( EnergyUse, "W-EU-Total" )  }
	"Set parent for result   - W-Total"			Proj:RunResultsW[10]:Parent		= {	Local( Name )  }
	"Set EU name for result  - W-Total"			Proj:RunResultsW[10]:EnduseName	= {	"TOTAL"  }

	"Create result component - W-Comp Ttl"		Proj:RunResultsW[11]					= {	CreateComp( EnergyUse, "W-EU-Compliance" )  }
	"Set parent for result   - W-Comp Ttl"		Proj:RunResultsW[11]:Parent		= {	Local( Name )  }
	"Set EU name for result  - W-Comp Ttl"		Proj:RunResultsW[11]:EnduseName	= {	"Compliance Total"  }

	"Create result component - W-PV Ttl"		Proj:RunResultsW[13]					= {	CreateComp( EnergyUse, "W-EU-PV" )  }
	"Set parent for result   - W-PV Ttl"		Proj:RunResultsW[13]:Parent		= {	Local( Name )  }
	"Set EU name for result  - W-PV Ttl"		Proj:RunResultsW[13]:EnduseName	= {	"Photovoltaics"  }

  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - W-SpcHt"		Proj:RunResultsW[1]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - W-SpcHt"		Proj:RunResultsW[1]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - W-SpcHt"		Proj:RunResultsW[1]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[1]:PropElecEnergy[1] ) + LocalRef( RunResultsW[1]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[1]:PropOtherEnergy[1] )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - W-SpcCl"		Proj:RunResultsW[2]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - W-SpcCl"		Proj:RunResultsW[2]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - W-SpcCl"		Proj:RunResultsW[2]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[2]:PropElecEnergy[1] ) + LocalRef( RunResultsW[2]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[2]:PropOtherEnergy[1] )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - W-IAQVent"	Proj:RunResultsW[3]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - W-IAQVent"	Proj:RunResultsW[3]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - W-IAQVent"	Proj:RunResultsW[3]:PropOtherEnergy[1]		= {	0  }
	"Store energy use - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[3]:PropElecEnergy[1] )   }

  ; Other HVAC (aux & misc fans)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;	"Store energy use - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[4]:PropElecEnergy[1] ) + LocalRef( RunResultsW[4]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[4]:PropOtherEnergy[1] )   }
;
	"Zero out - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecEnergy[1]		= {	0  }
	"Zero out - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:PropNatGasEnergy[1]	= {	0  }
	"Zero out - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:PropOtherEnergy[1]	= {	0  }
	"Zero out - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:PropTotalEnergy[1]		= {	0  }
  ; Water Heating
	"Store energy use - Elec   - W-WtrHt"		Proj:RunResultsW[5]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - W-WtrHt"		Proj:RunResultsW[5]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - W-WtrHt"		Proj:RunResultsW[5]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[5]:PropElecEnergy[1] ) + LocalRef( RunResultsW[5]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[5]:PropOtherEnergy[1] )   }

  ; Inside Lighting
	"Store energy use - Elec   - W-InsLtg"		Proj:RunResultsW[6]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - W-InsLtg"		Proj:RunResultsW[6]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - W-InsLtg"		Proj:RunResultsW[6]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[6]:PropElecEnergy[1] ) + LocalRef( RunResultsW[6]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[6]:PropOtherEnergy[1] )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - W-AppCkg"		Proj:RunResultsW[7]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - W-AppCkg"		Proj:RunResultsW[7]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - W-AppCkg"		Proj:RunResultsW[7]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[7]:PropElecEnergy[1] ) + LocalRef( RunResultsW[7]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[7]:PropOtherEnergy[1] )   }

  ; Plug Loads
	"Store energy use - Elec   - W-Plugs"		Proj:RunResultsW[8]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - W-Plugs"		Proj:RunResultsW[8]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - W-Plugs"		Proj:RunResultsW[8]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[8]:PropElecEnergy[1] ) + LocalRef( RunResultsW[8]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[8]:PropOtherEnergy[1] )   }

  ; Exterior
	"Store energy use - Elec   - W-Ext"			Proj:RunResultsW[9]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - W-Ext"			Proj:RunResultsW[9]:PropNatGasEnergy[1]	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - W-Ext"			Proj:RunResultsW[9]:PropOtherEnergy[1]		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - W-Ext"			Proj:RunResultsW[9]:PropTotalEnergy[1]		= {	LocalRef( RunResultsW[9]:PropElecEnergy[1] ) + LocalRef( RunResultsW[9]:PropNatGasEnergy[1] ) + LocalRef( RunResultsW[9]:PropOtherEnergy[1] )   }

  ; PV
	"Store energy use - Elec   - W-PV"			Proj:RunResultsW[13]:PropElecEnergy[1]		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - W-PV"			Proj:RunResultsW[13]:PropNatGasEnergy[1]	= {	0  }
	"Store energy use - Other  - W-PV"			Proj:RunResultsW[13]:PropOtherEnergy[1]	= {	0  }
	"Store energy use - TOTAL  - W-PV"			Proj:RunResultsW[13]:PropTotalEnergy[1]	= {	LocalRef( RunResultsW[13]:PropElecEnergy[1] )   }

  ; Compliance Total
	"Store energy use - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecEnergy[1]		= {	RunResultsW[1]:PropElecEnergy[1]   + RunResultsW[2]:PropElecEnergy[1]   + RunResultsW[3]:PropElecEnergy[1]   + RunResultsW[4]:PropElecEnergy[1]   + RunResultsW[5]:PropElecEnergy[1]    }
	"Store energy use - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:PropNatGasEnergy[1]	= {	RunResultsW[1]:PropNatGasEnergy[1] + RunResultsW[2]:PropNatGasEnergy[1] + RunResultsW[3]:PropNatGasEnergy[1] + RunResultsW[4]:PropNatGasEnergy[1] + RunResultsW[5]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:PropOtherEnergy[1]	= {	RunResultsW[1]:PropOtherEnergy[1]  + RunResultsW[2]:PropOtherEnergy[1]  + RunResultsW[3]:PropOtherEnergy[1]  + RunResultsW[4]:PropOtherEnergy[1]  + RunResultsW[5]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:PropTotalEnergy[1]	= {	RunResultsW[1]:PropTotalEnergy[1]  + RunResultsW[2]:PropTotalEnergy[1]  + RunResultsW[3]:PropTotalEnergy[1]  + RunResultsW[4]:PropTotalEnergy[1]  + RunResultsW[5]:PropTotalEnergy[1]   }

  ; Total
	"Store energy use - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecEnergy[1]		= {	RunResultsW[11]:PropElecEnergy[1]   + RunResultsW[6]:PropElecEnergy[1]   + RunResultsW[7]:PropElecEnergy[1]   + RunResultsW[8]:PropElecEnergy[1]   + RunResultsW[9]:PropElecEnergy[1]    }
	"Store energy use - NatGas - W-Total"		Proj:RunResultsW[10]:PropNatGasEnergy[1]	= {	RunResultsW[11]:PropNatGasEnergy[1] + RunResultsW[6]:PropNatGasEnergy[1] + RunResultsW[7]:PropNatGasEnergy[1] + RunResultsW[8]:PropNatGasEnergy[1] + RunResultsW[9]:PropNatGasEnergy[1]  }
	"Store energy use - Other  - W-Total"		Proj:RunResultsW[10]:PropOtherEnergy[1]	= {	RunResultsW[11]:PropOtherEnergy[1]  + RunResultsW[6]:PropOtherEnergy[1]  + RunResultsW[7]:PropOtherEnergy[1]  + RunResultsW[8]:PropOtherEnergy[1]  + RunResultsW[9]:PropOtherEnergy[1]   }
	"Store energy use - TOTAL  - W-Total"		Proj:RunResultsW[10]:PropTotalEnergy[1]	= {	RunResultsW[11]:PropTotalEnergy[1]  + RunResultsW[6]:PropTotalEnergy[1]  + RunResultsW[7]:PropTotalEnergy[1]  + RunResultsW[8]:PropTotalEnergy[1]  + RunResultsW[9]:PropTotalEnergy[1]   }
END


;*************************************************************************
RULELIST "CARes_StandardResults" 1 0 0 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - SpcHt"		Proj:RunResults[1]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - SpcHt"		Proj:RunResults[1]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - SpcHt"		Proj:RunResults[1]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - SpcHt"		Proj:RunResults[1]:StdTotalEnergy		= {	LocalRef( RunResults[1]:StdElecEnergy ) + LocalRef( RunResults[1]:StdNatGasEnergy ) + LocalRef( RunResults[1]:StdOtherEnergy )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - SpcCl"		Proj:RunResults[2]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - SpcCl"		Proj:RunResults[2]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - SpcCl"		Proj:RunResults[2]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - SpcCl"		Proj:RunResults[2]:StdTotalEnergy		= {	LocalRef( RunResults[2]:StdElecEnergy ) + LocalRef( RunResults[2]:StdNatGasEnergy ) + LocalRef( RunResults[2]:StdOtherEnergy )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - IAQVent"	Proj:RunResults[3]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - IAQVent"	Proj:RunResults[3]:StdNatGasEnergy		= {	0  }
	"Store energy use - Other  - IAQVent"	Proj:RunResults[3]:StdOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - IAQVent"	Proj:RunResults[3]:StdTotalEnergy		= {	LocalRef( RunResults[3]:StdElecEnergy )   }

  ; Other HVAC (aux & misc fans)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;	"Store energy use - Elec   - OthrHVAC"	Proj:RunResults[4]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - NatGas - OthrHVAC"	Proj:RunResults[4]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - Other  - OthrHVAC"	Proj:RunResults[4]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - TOTAL  - OthrHVAC"	Proj:RunResults[4]:StdTotalEnergy		= {	LocalRef( RunResults[4]:StdElecEnergy ) + LocalRef( RunResults[4]:StdNatGasEnergy ) + LocalRef( RunResults[4]:StdOtherEnergy )   }
;
	"Zero out - Elec   - OthrHVAC"	Proj:RunResults[4]:StdElecEnergy		= {	0  }
	"Zero out - NatGas - OthrHVAC"	Proj:RunResults[4]:StdNatGasEnergy		= {	0  }
	"Zero out - Other  - OthrHVAC"	Proj:RunResults[4]:StdOtherEnergy		= {	0  }
	"Zero out - TOTAL  - OthrHVAC"	Proj:RunResults[4]:StdTotalEnergy		= {	0  }
  ; Water Heating
	"Store energy use - Elec   - WtrHt"		Proj:RunResults[5]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - WtrHt"		Proj:RunResults[5]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - WtrHt"		Proj:RunResults[5]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - WtrHt"		Proj:RunResults[5]:StdTotalEnergy		= {	LocalRef( RunResults[5]:StdElecEnergy ) + LocalRef( RunResults[5]:StdNatGasEnergy ) + LocalRef( RunResults[5]:StdOtherEnergy )   }

  ; Inside Lighting
	"Store energy use - Elec   - InsLtg"	Proj:RunResults[6]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - InsLtg"	Proj:RunResults[6]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - InsLtg"	Proj:RunResults[6]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - InsLtg"	Proj:RunResults[6]:StdTotalEnergy		= {	LocalRef( RunResults[6]:StdElecEnergy ) + LocalRef( RunResults[6]:StdNatGasEnergy ) + LocalRef( RunResults[6]:StdOtherEnergy )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - AppCkg"	Proj:RunResults[7]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - AppCkg"	Proj:RunResults[7]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - AppCkg"	Proj:RunResults[7]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - AppCkg"	Proj:RunResults[7]:StdTotalEnergy		= {	LocalRef( RunResults[7]:StdElecEnergy ) + LocalRef( RunResults[7]:StdNatGasEnergy ) + LocalRef( RunResults[7]:StdOtherEnergy )   }

  ; Plug Loads
	"Store energy use - Elec   - Plugs"		Proj:RunResults[8]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - Plugs"		Proj:RunResults[8]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - Plugs"		Proj:RunResults[8]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - Plugs"		Proj:RunResults[8]:StdTotalEnergy		= {	LocalRef( RunResults[8]:StdElecEnergy ) + LocalRef( RunResults[8]:StdNatGasEnergy ) + LocalRef( RunResults[8]:StdOtherEnergy )   }

  ; Exterior
	"Store energy use - Elec   - Ext"		Proj:RunResults[9]:StdElecEnergy			= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - Ext"		Proj:RunResults[9]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - Ext"		Proj:RunResults[9]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - Ext"		Proj:RunResults[9]:StdTotalEnergy		= {	LocalRef( RunResults[9]:StdElecEnergy ) + LocalRef( RunResults[9]:StdNatGasEnergy ) + LocalRef( RunResults[9]:StdOtherEnergy )   }

  ; PV
	"Store energy use - Elec   - PV"			Proj:RunResults[13]:StdElecEnergy		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - PV"			Proj:RunResults[13]:StdNatGasEnergy		= {	0  }
	"Store energy use - Other  - PV"			Proj:RunResults[13]:StdOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - PV"			Proj:RunResults[13]:StdTotalEnergy		= {	LocalRef( RunResults[13]:StdElecEnergy )   }

  ; Compliance Total
	"Store energy use - Elec   - Comp Ttl"	Proj:RunResults[11]:StdElecEnergy		= {	RunResults[1]:StdElecEnergy   + RunResults[2]:StdElecEnergy   + RunResults[3]:StdElecEnergy   + RunResults[4]:StdElecEnergy   + RunResults[5]:StdElecEnergy    }
	"Store energy use - NatGas - Comp Ttl"	Proj:RunResults[11]:StdNatGasEnergy		= {	RunResults[1]:StdNatGasEnergy + RunResults[2]:StdNatGasEnergy + RunResults[3]:StdNatGasEnergy + RunResults[4]:StdNatGasEnergy + RunResults[5]:StdNatGasEnergy  }
	"Store energy use - Other  - Comp Ttl"	Proj:RunResults[11]:StdOtherEnergy		= {	RunResults[1]:StdOtherEnergy  + RunResults[2]:StdOtherEnergy  + RunResults[3]:StdOtherEnergy  + RunResults[4]:StdOtherEnergy  + RunResults[5]:StdOtherEnergy   }
	"Store energy use - TOTAL  - Comp Ttl"	Proj:RunResults[11]:StdTotalEnergy		= {	RunResults[1]:StdTotalEnergy  + RunResults[2]:StdTotalEnergy  + RunResults[3]:StdTotalEnergy  + RunResults[4]:StdTotalEnergy  + RunResults[5]:StdTotalEnergy   }

  ; Total
	"Store energy use - Elec   - Total"		Proj:RunResults[10]:StdElecEnergy		= {	RunResults[11]:StdElecEnergy   + RunResults[6]:StdElecEnergy   + RunResults[7]:StdElecEnergy   + RunResults[8]:StdElecEnergy   + RunResults[9]:StdElecEnergy    }
	"Store energy use - NatGas - Total"		Proj:RunResults[10]:StdNatGasEnergy		= {	RunResults[11]:StdNatGasEnergy + RunResults[6]:StdNatGasEnergy + RunResults[7]:StdNatGasEnergy + RunResults[8]:StdNatGasEnergy + RunResults[9]:StdNatGasEnergy  }
	"Store energy use - Other  - Total"		Proj:RunResults[10]:StdOtherEnergy		= {	RunResults[11]:StdOtherEnergy  + RunResults[6]:StdOtherEnergy  + RunResults[7]:StdOtherEnergy  + RunResults[8]:StdOtherEnergy  + RunResults[9]:StdOtherEnergy   }
	"Store energy use - TOTAL  - Total"		Proj:RunResults[10]:StdTotalEnergy		= {	RunResults[11]:StdTotalEnergy  + RunResults[6]:StdTotalEnergy  + RunResults[7]:StdTotalEnergy  + RunResults[8]:StdTotalEnergy  + RunResults[9]:StdTotalEnergy   }
END

;*************************************************************************
RULELIST "CARes_DesignRatingResults" 1 0 0 1
;*************************************************************************
  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - SpcHt"		Proj:RunResults[1]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - SpcHt"		Proj:RunResults[1]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - SpcHt"		Proj:RunResults[1]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - SpcHt"		Proj:RunResults[1]:DRtgTotalEnergy		= {	LocalRef( RunResults[1]:DRtgElecEnergy ) + LocalRef( RunResults[1]:DRtgNatGasEnergy ) + LocalRef( RunResults[1]:DRtgOtherEnergy )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - SpcCl"		Proj:RunResults[2]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - SpcCl"		Proj:RunResults[2]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - SpcCl"		Proj:RunResults[2]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - SpcCl"		Proj:RunResults[2]:DRtgTotalEnergy		= {	LocalRef( RunResults[2]:DRtgElecEnergy ) + LocalRef( RunResults[2]:DRtgNatGasEnergy ) + LocalRef( RunResults[2]:DRtgOtherEnergy )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - IAQVent"	Proj:RunResults[3]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - IAQVent"	Proj:RunResults[3]:DRtgNatGasEnergy		= {	0  }
	"Store energy use - Other  - IAQVent"	Proj:RunResults[3]:DRtgOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - IAQVent"	Proj:RunResults[3]:DRtgTotalEnergy		= {	LocalRef( RunResults[3]:DRtgElecEnergy )   }

  ; Other HVAC (aux & misc fans)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;	"Store energy use - Elec   - OthrHVAC"	Proj:RunResults[4]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - NatGas - OthrHVAC"	Proj:RunResults[4]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - Other  - OthrHVAC"	Proj:RunResults[4]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DRtgTotalEnergy		= {	LocalRef( RunResults[4]:DRtgElecEnergy ) + LocalRef( RunResults[4]:DRtgNatGasEnergy ) + LocalRef( RunResults[4]:DRtgOtherEnergy )   }
;
	"Zero out - Elec   - OthrHVAC"	Proj:RunResults[4]:DRtgElecEnergy		= {	0  }
	"Zero out - NatGas - OthrHVAC"	Proj:RunResults[4]:DRtgNatGasEnergy		= {	0  }
	"Zero out - Other  - OthrHVAC"	Proj:RunResults[4]:DRtgOtherEnergy		= {	0  }
	"Zero out - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DRtgTotalEnergy		= {	0  }
  ; Water Heating
	"Store energy use - Elec   - WtrHt"		Proj:RunResults[5]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - WtrHt"		Proj:RunResults[5]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - WtrHt"		Proj:RunResults[5]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - WtrHt"		Proj:RunResults[5]:DRtgTotalEnergy		= {	LocalRef( RunResults[5]:DRtgElecEnergy ) + LocalRef( RunResults[5]:DRtgNatGasEnergy ) + LocalRef( RunResults[5]:DRtgOtherEnergy )   }

  ; Inside Lighting
	"Store energy use - Elec   - InsLtg"	Proj:RunResults[6]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - InsLtg"	Proj:RunResults[6]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - InsLtg"	Proj:RunResults[6]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - InsLtg"	Proj:RunResults[6]:DRtgTotalEnergy		= {	LocalRef( RunResults[6]:DRtgElecEnergy ) + LocalRef( RunResults[6]:DRtgNatGasEnergy ) + LocalRef( RunResults[6]:DRtgOtherEnergy )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - AppCkg"	Proj:RunResults[7]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - AppCkg"	Proj:RunResults[7]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - AppCkg"	Proj:RunResults[7]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - AppCkg"	Proj:RunResults[7]:DRtgTotalEnergy		= {	LocalRef( RunResults[7]:DRtgElecEnergy ) + LocalRef( RunResults[7]:DRtgNatGasEnergy ) + LocalRef( RunResults[7]:DRtgOtherEnergy )   }

  ; Plug Loads
	"Store energy use - Elec   - Plugs"		Proj:RunResults[8]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - Plugs"		Proj:RunResults[8]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - Plugs"		Proj:RunResults[8]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - Plugs"		Proj:RunResults[8]:DRtgTotalEnergy		= {	LocalRef( RunResults[8]:DRtgElecEnergy ) + LocalRef( RunResults[8]:DRtgNatGasEnergy ) + LocalRef( RunResults[8]:DRtgOtherEnergy )   }

  ; Exterior
	"Store energy use - Elec   - Ext"		Proj:RunResults[9]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - Ext"		Proj:RunResults[9]:DRtgNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - Ext"		Proj:RunResults[9]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - Ext"		Proj:RunResults[9]:DRtgTotalEnergy		= {	LocalRef( RunResults[9]:DRtgElecEnergy ) + LocalRef( RunResults[9]:DRtgNatGasEnergy ) + LocalRef( RunResults[9]:DRtgOtherEnergy )   }

  ; PV
	"Store energy use - Elec   - PV"			Proj:RunResults[13]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																							else  HourlyResultSum( Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - PV"			Proj:RunResults[13]:DRtgNatGasEnergy	= {	0  }
	"Store energy use - Other  - PV"			Proj:RunResults[13]:DRtgOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - PV"			Proj:RunResults[13]:DRtgTotalEnergy		= {	LocalRef( RunResults[13]:DRtgElecEnergy )   }

  ; Compliance Total
	"Store energy use - Elec   - Comp Ttl"	Proj:RunResults[11]:DRtgElecEnergy		= {	RunResults[1]:DRtgElecEnergy   + RunResults[2]:DRtgElecEnergy   + RunResults[3]:DRtgElecEnergy   + RunResults[4]:DRtgElecEnergy   + RunResults[5]:DRtgElecEnergy    }
	"Store energy use - NatGas - Comp Ttl"	Proj:RunResults[11]:DRtgNatGasEnergy	= {	RunResults[1]:DRtgNatGasEnergy + RunResults[2]:DRtgNatGasEnergy + RunResults[3]:DRtgNatGasEnergy + RunResults[4]:DRtgNatGasEnergy + RunResults[5]:DRtgNatGasEnergy  }
	"Store energy use - Other  - Comp Ttl"	Proj:RunResults[11]:DRtgOtherEnergy		= {	RunResults[1]:DRtgOtherEnergy  + RunResults[2]:DRtgOtherEnergy  + RunResults[3]:DRtgOtherEnergy  + RunResults[4]:DRtgOtherEnergy  + RunResults[5]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - Comp Ttl"	Proj:RunResults[11]:DRtgTotalEnergy		= {	RunResults[1]:DRtgTotalEnergy  + RunResults[2]:DRtgTotalEnergy  + RunResults[3]:DRtgTotalEnergy  + RunResults[4]:DRtgTotalEnergy  + RunResults[5]:DRtgTotalEnergy   }

  ; Total
	"Store energy use - Elec   - Total"		Proj:RunResults[10]:DRtgElecEnergy		= {	RunResults[11]:DRtgElecEnergy   + RunResults[6]:DRtgElecEnergy   + RunResults[7]:DRtgElecEnergy   + RunResults[8]:DRtgElecEnergy   + RunResults[9]:DRtgElecEnergy    }
	"Store energy use - NatGas - Total"		Proj:RunResults[10]:DRtgNatGasEnergy	= {	RunResults[11]:DRtgNatGasEnergy + RunResults[6]:DRtgNatGasEnergy + RunResults[7]:DRtgNatGasEnergy + RunResults[8]:DRtgNatGasEnergy + RunResults[9]:DRtgNatGasEnergy  }
	"Store energy use - Other  - Total"		Proj:RunResults[10]:DRtgOtherEnergy		= {	RunResults[11]:DRtgOtherEnergy  + RunResults[6]:DRtgOtherEnergy  + RunResults[7]:DRtgOtherEnergy  + RunResults[8]:DRtgOtherEnergy  + RunResults[9]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - Total"		Proj:RunResults[10]:DRtgTotalEnergy		= {	RunResults[11]:DRtgTotalEnergy  + RunResults[6]:DRtgTotalEnergy  + RunResults[7]:DRtgTotalEnergy  + RunResults[8]:DRtgTotalEnergy  + RunResults[9]:DRtgTotalEnergy   }
END


;*************************************************************************
RULELIST "CARes_StandardResults_NESW" 1 0 0 1
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;*************************************************************************
  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - N-SpcHt"		Proj:RunResultsN[1]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-SpcHt"		Proj:RunResultsN[1]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-SpcHt"		Proj:RunResultsN[1]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:StdTotalEnergy		= {	LocalRef( RunResultsN[1]:StdElecEnergy ) + LocalRef( RunResultsN[1]:StdNatGasEnergy ) + LocalRef( RunResultsN[1]:StdOtherEnergy )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - N-SpcCl"		Proj:RunResultsN[2]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-SpcCl"		Proj:RunResultsN[2]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-SpcCl"		Proj:RunResultsN[2]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:StdTotalEnergy		= {	LocalRef( RunResultsN[2]:StdElecEnergy ) + LocalRef( RunResultsN[2]:StdNatGasEnergy ) + LocalRef( RunResultsN[2]:StdOtherEnergy )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - N-IAQVent"	Proj:RunResultsN[3]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-IAQVent"	Proj:RunResultsN[3]:StdNatGasEnergy		= {	0  }
	"Store energy use - Other  - N-IAQVent"	Proj:RunResultsN[3]:StdOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:StdTotalEnergy		= {	LocalRef( RunResultsN[3]:StdElecEnergy )   }

  ; Other HVAC (aux & misc fans)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;	"Store energy use - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:StdTotalEnergy		= {	LocalRef( RunResultsN[4]:StdElecEnergy ) + LocalRef( RunResultsN[4]:StdNatGasEnergy ) + LocalRef( RunResultsN[4]:StdOtherEnergy )   }
;
	"Zero out - Elec   - N-OthrHVAC"		Proj:RunResultsN[4]:StdElecEnergy		= {	0  }
	"Zero out - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:StdNatGasEnergy		= {	0  }
	"Zero out - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:StdOtherEnergy		= {	0  }
	"Zero out - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:StdTotalEnergy		= {	0  }
   ; Water Heating
	"Store energy use - Elec   - N-WtrHt"		Proj:RunResultsN[5]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-WtrHt"		Proj:RunResultsN[5]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-WtrHt"		Proj:RunResultsN[5]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:StdTotalEnergy		= {	LocalRef( RunResultsN[5]:StdElecEnergy ) + LocalRef( RunResultsN[5]:StdNatGasEnergy ) + LocalRef( RunResultsN[5]:StdOtherEnergy )   }

  ; Inside Lighting
	"Store energy use - Elec   - N-InsLtg"		Proj:RunResultsN[6]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-InsLtg"		Proj:RunResultsN[6]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-InsLtg"		Proj:RunResultsN[6]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:StdTotalEnergy		= {	LocalRef( RunResultsN[6]:StdElecEnergy ) + LocalRef( RunResultsN[6]:StdNatGasEnergy ) + LocalRef( RunResultsN[6]:StdOtherEnergy )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - N-AppCkg"		Proj:RunResultsN[7]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-AppCkg"		Proj:RunResultsN[7]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-AppCkg"		Proj:RunResultsN[7]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:StdTotalEnergy		= {	LocalRef( RunResultsN[7]:StdElecEnergy ) + LocalRef( RunResultsN[7]:StdNatGasEnergy ) + LocalRef( RunResultsN[7]:StdOtherEnergy )   }

  ; Plug Loads
	"Store energy use - Elec   - N-Plugs"		Proj:RunResultsN[8]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-Plugs"		Proj:RunResultsN[8]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-Plugs"		Proj:RunResultsN[8]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:StdTotalEnergy		= {	LocalRef( RunResultsN[8]:StdElecEnergy ) + LocalRef( RunResultsN[8]:StdNatGasEnergy ) + LocalRef( RunResultsN[8]:StdOtherEnergy )   }

  ; Exterior
	"Store energy use - Elec   - N-Ext"			Proj:RunResultsN[9]:StdElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-Ext"			Proj:RunResultsN[9]:StdNatGasEnergy		= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-Ext"			Proj:RunResultsN[9]:StdOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-Ext"			Proj:RunResultsN[9]:StdTotalEnergy		= {	LocalRef( RunResultsN[9]:StdElecEnergy ) + LocalRef( RunResultsN[9]:StdNatGasEnergy ) + LocalRef( RunResultsN[9]:StdOtherEnergy )   }

  ; PV
	"Store energy use - Elec   - N-PV"			Proj:RunResultsN[13]:StdElecEnergy		= {	if (Local( Fuel_HaveElec ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-PV"			Proj:RunResultsN[13]:StdNatGasEnergy	= {	0  }
	"Store energy use - Other  - N-PV"			Proj:RunResultsN[13]:StdOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - N-PV"			Proj:RunResultsN[13]:StdTotalEnergy		= {	LocalRef( RunResultsN[13]:StdElecEnergy )   }

; SAC 11/20/14 - fixed bug where RunResultsN totals were summing values from RunResults (no trailing 'N'), which are not yet set.
  ; Compliance Total
	"Store energy use - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:StdElecEnergy		= {	RunResultsN[1]:StdElecEnergy   + RunResultsN[2]:StdElecEnergy   + RunResultsN[3]:StdElecEnergy   + RunResultsN[4]:StdElecEnergy   + RunResultsN[5]:StdElecEnergy    }
	"Store energy use - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:StdNatGasEnergy	= {	RunResultsN[1]:StdNatGasEnergy + RunResultsN[2]:StdNatGasEnergy + RunResultsN[3]:StdNatGasEnergy + RunResultsN[4]:StdNatGasEnergy + RunResultsN[5]:StdNatGasEnergy  }
	"Store energy use - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:StdOtherEnergy		= {	RunResultsN[1]:StdOtherEnergy  + RunResultsN[2]:StdOtherEnergy  + RunResultsN[3]:StdOtherEnergy  + RunResultsN[4]:StdOtherEnergy  + RunResultsN[5]:StdOtherEnergy   }
	"Store energy use - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:StdTotalEnergy		= {	RunResultsN[1]:StdTotalEnergy  + RunResultsN[2]:StdTotalEnergy  + RunResultsN[3]:StdTotalEnergy  + RunResultsN[4]:StdTotalEnergy  + RunResultsN[5]:StdTotalEnergy   }

  ; Total
	"Store energy use - Elec   - N-Total"		Proj:RunResultsN[10]:StdElecEnergy		= {	RunResultsN[11]:StdElecEnergy   + RunResultsN[6]:StdElecEnergy   + RunResultsN[7]:StdElecEnergy   + RunResultsN[8]:StdElecEnergy   + RunResultsN[9]:StdElecEnergy    }
	"Store energy use - NatGas - N-Total"		Proj:RunResultsN[10]:StdNatGasEnergy	= {	RunResultsN[11]:StdNatGasEnergy + RunResultsN[6]:StdNatGasEnergy + RunResultsN[7]:StdNatGasEnergy + RunResultsN[8]:StdNatGasEnergy + RunResultsN[9]:StdNatGasEnergy  }
	"Store energy use - Other  - N-Total"		Proj:RunResultsN[10]:StdOtherEnergy		= {	RunResultsN[11]:StdOtherEnergy  + RunResultsN[6]:StdOtherEnergy  + RunResultsN[7]:StdOtherEnergy  + RunResultsN[8]:StdOtherEnergy  + RunResultsN[9]:StdOtherEnergy   }
	"Store energy use - TOTAL  - N-Total"		Proj:RunResultsN[10]:StdTotalEnergy		= {	RunResultsN[11]:StdTotalEnergy  + RunResultsN[6]:StdTotalEnergy  + RunResultsN[7]:StdTotalEnergy  + RunResultsN[8]:StdTotalEnergy  + RunResultsN[9]:StdTotalEnergy   }

; -- COPY N results to E --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - E-SpcHt"		Proj:RunResultsE[1]:StdElecEnergy		= {	RunResultsN[1]:StdElecEnergy     }
	"Store energy use - NatGas - E-SpcHt"		Proj:RunResultsE[1]:StdNatGasEnergy		= {	RunResultsN[1]:StdNatGasEnergy   }
	"Store energy use - Other  - E-SpcHt"		Proj:RunResultsE[1]:StdOtherEnergy		= {	RunResultsN[1]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:StdTotalEnergy		= {	RunResultsN[1]:StdTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - E-SpcCl"		Proj:RunResultsE[2]:StdElecEnergy		= {	RunResultsN[2]:StdElecEnergy     }
	"Store energy use - NatGas - E-SpcCl"		Proj:RunResultsE[2]:StdNatGasEnergy		= {	RunResultsN[2]:StdNatGasEnergy   }
	"Store energy use - Other  - E-SpcCl"		Proj:RunResultsE[2]:StdOtherEnergy		= {	RunResultsN[2]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:StdTotalEnergy		= {	RunResultsN[2]:StdTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - E-IAQVent"	Proj:RunResultsE[3]:StdElecEnergy		= {	RunResultsN[3]:StdElecEnergy     }
	"Store energy use - NatGas - E-IAQVent"	Proj:RunResultsE[3]:StdNatGasEnergy		= {	RunResultsN[3]:StdNatGasEnergy   }
	"Store energy use - Other  - E-IAQVent"	Proj:RunResultsE[3]:StdOtherEnergy		= {	RunResultsN[3]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:StdTotalEnergy		= {	RunResultsN[3]:StdTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:StdElecEnergy		= {	RunResultsN[4]:StdElecEnergy     }
	"Store energy use - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:StdNatGasEnergy		= {	RunResultsN[4]:StdNatGasEnergy   }
	"Store energy use - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:StdOtherEnergy		= {	RunResultsN[4]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:StdTotalEnergy		= {	RunResultsN[4]:StdTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - E-WtrHt"		Proj:RunResultsE[5]:StdElecEnergy		= {	RunResultsN[5]:StdElecEnergy     }
	"Store energy use - NatGas - E-WtrHt"		Proj:RunResultsE[5]:StdNatGasEnergy		= {	RunResultsN[5]:StdNatGasEnergy   }
	"Store energy use - Other  - E-WtrHt"		Proj:RunResultsE[5]:StdOtherEnergy		= {	RunResultsN[5]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:StdTotalEnergy		= {	RunResultsN[5]:StdTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - E-InsLtg"		Proj:RunResultsE[6]:StdElecEnergy		= {	RunResultsN[6]:StdElecEnergy     }
	"Store energy use - NatGas - E-InsLtg"		Proj:RunResultsE[6]:StdNatGasEnergy		= {	RunResultsN[6]:StdNatGasEnergy   }
	"Store energy use - Other  - E-InsLtg"		Proj:RunResultsE[6]:StdOtherEnergy		= {	RunResultsN[6]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:StdTotalEnergy		= {	RunResultsN[6]:StdTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - E-AppCkg"		Proj:RunResultsE[7]:StdElecEnergy		= {	RunResultsN[7]:StdElecEnergy     }
	"Store energy use - NatGas - E-AppCkg"		Proj:RunResultsE[7]:StdNatGasEnergy		= {	RunResultsN[7]:StdNatGasEnergy   }
	"Store energy use - Other  - E-AppCkg"		Proj:RunResultsE[7]:StdOtherEnergy		= {	RunResultsN[7]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:StdTotalEnergy		= {	RunResultsN[7]:StdTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - E-Plugs"		Proj:RunResultsE[8]:StdElecEnergy		= {	RunResultsN[8]:StdElecEnergy     }
	"Store energy use - NatGas - E-Plugs"		Proj:RunResultsE[8]:StdNatGasEnergy		= {	RunResultsN[8]:StdNatGasEnergy   }
	"Store energy use - Other  - E-Plugs"		Proj:RunResultsE[8]:StdOtherEnergy		= {	RunResultsN[8]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:StdTotalEnergy		= {	RunResultsN[8]:StdTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - E-Ext"			Proj:RunResultsE[9]:StdElecEnergy		= {	RunResultsN[9]:StdElecEnergy     }
	"Store energy use - NatGas - E-Ext"			Proj:RunResultsE[9]:StdNatGasEnergy		= {	RunResultsN[9]:StdNatGasEnergy   }
	"Store energy use - Other  - E-Ext"			Proj:RunResultsE[9]:StdOtherEnergy		= {	RunResultsN[9]:StdOtherEnergy    }
	"Store energy use - TOTAL  - E-Ext"			Proj:RunResultsE[9]:StdTotalEnergy		= {	RunResultsN[9]:StdTotalEnergy    }
  ; PV
	"Store energy use - Elec   - E-PV"			Proj:RunResultsE[13]:StdElecEnergy		= {	RunResultsN[13]:StdElecEnergy    }
	"Store energy use - NatGas - E-PV"			Proj:RunResultsE[13]:StdNatGasEnergy	= {	RunResultsN[13]:StdNatGasEnergy  }
	"Store energy use - Other  - E-PV"			Proj:RunResultsE[13]:StdOtherEnergy		= {	RunResultsN[13]:StdOtherEnergy   }
	"Store energy use - TOTAL  - E-PV"			Proj:RunResultsE[13]:StdTotalEnergy		= {	RunResultsN[13]:StdTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:StdElecEnergy		= {	RunResultsN[11]:StdElecEnergy    }
	"Store energy use - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:StdNatGasEnergy	= {	RunResultsN[11]:StdNatGasEnergy  }
	"Store energy use - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:StdOtherEnergy		= {	RunResultsN[11]:StdOtherEnergy   }
	"Store energy use - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:StdTotalEnergy		= {	RunResultsN[11]:StdTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - E-Total"		Proj:RunResultsE[10]:StdElecEnergy		= {	RunResultsN[10]:StdElecEnergy    }
	"Store energy use - NatGas - E-Total"		Proj:RunResultsE[10]:StdNatGasEnergy	= {	RunResultsN[10]:StdNatGasEnergy  }
	"Store energy use - Other  - E-Total"		Proj:RunResultsE[10]:StdOtherEnergy		= {	RunResultsN[10]:StdOtherEnergy   }
	"Store energy use - TOTAL  - E-Total"		Proj:RunResultsE[10]:StdTotalEnergy		= {	RunResultsN[10]:StdTotalEnergy   }

; -- COPY N results to S --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - S-SpcHt"		Proj:RunResultsS[1]:StdElecEnergy		= {	RunResultsN[1]:StdElecEnergy     }
	"Store energy use - NatGas - S-SpcHt"		Proj:RunResultsS[1]:StdNatGasEnergy		= {	RunResultsN[1]:StdNatGasEnergy   }
	"Store energy use - Other  - S-SpcHt"		Proj:RunResultsS[1]:StdOtherEnergy		= {	RunResultsN[1]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:StdTotalEnergy		= {	RunResultsN[1]:StdTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - S-SpcCl"		Proj:RunResultsS[2]:StdElecEnergy		= {	RunResultsN[2]:StdElecEnergy     }
	"Store energy use - NatGas - S-SpcCl"		Proj:RunResultsS[2]:StdNatGasEnergy		= {	RunResultsN[2]:StdNatGasEnergy   }
	"Store energy use - Other  - S-SpcCl"		Proj:RunResultsS[2]:StdOtherEnergy		= {	RunResultsN[2]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:StdTotalEnergy		= {	RunResultsN[2]:StdTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - S-IAQVent"	Proj:RunResultsS[3]:StdElecEnergy		= {	RunResultsN[3]:StdElecEnergy     }
	"Store energy use - NatGas - S-IAQVent"	Proj:RunResultsS[3]:StdNatGasEnergy		= {	RunResultsN[3]:StdNatGasEnergy   }
	"Store energy use - Other  - S-IAQVent"	Proj:RunResultsS[3]:StdOtherEnergy		= {	RunResultsN[3]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:StdTotalEnergy		= {	RunResultsN[3]:StdTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:StdElecEnergy		= {	RunResultsN[4]:StdElecEnergy     }
	"Store energy use - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:StdNatGasEnergy		= {	RunResultsN[4]:StdNatGasEnergy   }
	"Store energy use - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:StdOtherEnergy		= {	RunResultsN[4]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:StdTotalEnergy		= {	RunResultsN[4]:StdTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - S-WtrHt"		Proj:RunResultsS[5]:StdElecEnergy		= {	RunResultsN[5]:StdElecEnergy     }
	"Store energy use - NatGas - S-WtrHt"		Proj:RunResultsS[5]:StdNatGasEnergy		= {	RunResultsN[5]:StdNatGasEnergy   }
	"Store energy use - Other  - S-WtrHt"		Proj:RunResultsS[5]:StdOtherEnergy		= {	RunResultsN[5]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:StdTotalEnergy		= {	RunResultsN[5]:StdTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - S-InsLtg"		Proj:RunResultsS[6]:StdElecEnergy		= {	RunResultsN[6]:StdElecEnergy     }
	"Store energy use - NatGas - S-InsLtg"		Proj:RunResultsS[6]:StdNatGasEnergy		= {	RunResultsN[6]:StdNatGasEnergy   }
	"Store energy use - Other  - S-InsLtg"		Proj:RunResultsS[6]:StdOtherEnergy		= {	RunResultsN[6]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:StdTotalEnergy		= {	RunResultsN[6]:StdTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - S-AppCkg"		Proj:RunResultsS[7]:StdElecEnergy		= {	RunResultsN[7]:StdElecEnergy     }
	"Store energy use - NatGas - S-AppCkg"		Proj:RunResultsS[7]:StdNatGasEnergy		= {	RunResultsN[7]:StdNatGasEnergy   }
	"Store energy use - Other  - S-AppCkg"		Proj:RunResultsS[7]:StdOtherEnergy		= {	RunResultsN[7]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:StdTotalEnergy		= {	RunResultsN[7]:StdTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - S-Plugs"		Proj:RunResultsS[8]:StdElecEnergy		= {	RunResultsN[8]:StdElecEnergy     }
	"Store energy use - NatGas - S-Plugs"		Proj:RunResultsS[8]:StdNatGasEnergy		= {	RunResultsN[8]:StdNatGasEnergy   }
	"Store energy use - Other  - S-Plugs"		Proj:RunResultsS[8]:StdOtherEnergy		= {	RunResultsN[8]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:StdTotalEnergy		= {	RunResultsN[8]:StdTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - S-Ext"			Proj:RunResultsS[9]:StdElecEnergy		= {	RunResultsN[9]:StdElecEnergy     }
	"Store energy use - NatGas - S-Ext"			Proj:RunResultsS[9]:StdNatGasEnergy		= {	RunResultsN[9]:StdNatGasEnergy   }
	"Store energy use - Other  - S-Ext"			Proj:RunResultsS[9]:StdOtherEnergy		= {	RunResultsN[9]:StdOtherEnergy    }
	"Store energy use - TOTAL  - S-Ext"			Proj:RunResultsS[9]:StdTotalEnergy		= {	RunResultsN[9]:StdTotalEnergy    }
  ; PV
	"Store energy use - Elec   - S-PV"			Proj:RunResultsS[13]:StdElecEnergy		= {	RunResultsN[13]:StdElecEnergy    }
	"Store energy use - NatGas - S-PV"			Proj:RunResultsS[13]:StdNatGasEnergy	= {	RunResultsN[13]:StdNatGasEnergy  }
	"Store energy use - Other  - S-PV"			Proj:RunResultsS[13]:StdOtherEnergy		= {	RunResultsN[13]:StdOtherEnergy   }
	"Store energy use - TOTAL  - S-PV"			Proj:RunResultsS[13]:StdTotalEnergy		= {	RunResultsN[13]:StdTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:StdElecEnergy		= {	RunResultsN[11]:StdElecEnergy    }
	"Store energy use - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:StdNatGasEnergy	= {	RunResultsN[11]:StdNatGasEnergy  }
	"Store energy use - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:StdOtherEnergy		= {	RunResultsN[11]:StdOtherEnergy   }
	"Store energy use - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:StdTotalEnergy		= {	RunResultsN[11]:StdTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - S-Total"		Proj:RunResultsS[10]:StdElecEnergy		= {	RunResultsN[10]:StdElecEnergy    }
	"Store energy use - NatGas - S-Total"		Proj:RunResultsS[10]:StdNatGasEnergy	= {	RunResultsN[10]:StdNatGasEnergy  }
	"Store energy use - Other  - S-Total"		Proj:RunResultsS[10]:StdOtherEnergy		= {	RunResultsN[10]:StdOtherEnergy   }
	"Store energy use - TOTAL  - S-Total"		Proj:RunResultsS[10]:StdTotalEnergy		= {	RunResultsN[10]:StdTotalEnergy   }

; -- COPY N results to W --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - W-SpcHt"		Proj:RunResultsW[1]:StdElecEnergy		= {	RunResultsN[1]:StdElecEnergy     }
	"Store energy use - NatGas - W-SpcHt"		Proj:RunResultsW[1]:StdNatGasEnergy		= {	RunResultsN[1]:StdNatGasEnergy   }
	"Store energy use - Other  - W-SpcHt"		Proj:RunResultsW[1]:StdOtherEnergy		= {	RunResultsN[1]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:StdTotalEnergy		= {	RunResultsN[1]:StdTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - W-SpcCl"		Proj:RunResultsW[2]:StdElecEnergy		= {	RunResultsN[2]:StdElecEnergy     }
	"Store energy use - NatGas - W-SpcCl"		Proj:RunResultsW[2]:StdNatGasEnergy		= {	RunResultsN[2]:StdNatGasEnergy   }
	"Store energy use - Other  - W-SpcCl"		Proj:RunResultsW[2]:StdOtherEnergy		= {	RunResultsN[2]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:StdTotalEnergy		= {	RunResultsN[2]:StdTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - W-IAQVent"	Proj:RunResultsW[3]:StdElecEnergy		= {	RunResultsN[3]:StdElecEnergy     }
	"Store energy use - NatGas - W-IAQVent"	Proj:RunResultsW[3]:StdNatGasEnergy		= {	RunResultsN[3]:StdNatGasEnergy   }
	"Store energy use - Other  - W-IAQVent"	Proj:RunResultsW[3]:StdOtherEnergy		= {	RunResultsN[3]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:StdTotalEnergy		= {	RunResultsN[3]:StdTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:StdElecEnergy		= {	RunResultsN[4]:StdElecEnergy     }
	"Store energy use - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:StdNatGasEnergy		= {	RunResultsN[4]:StdNatGasEnergy   }
	"Store energy use - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:StdOtherEnergy		= {	RunResultsN[4]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:StdTotalEnergy		= {	RunResultsN[4]:StdTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - W-WtrHt"		Proj:RunResultsW[5]:StdElecEnergy		= {	RunResultsN[5]:StdElecEnergy     }
	"Store energy use - NatGas - W-WtrHt"		Proj:RunResultsW[5]:StdNatGasEnergy		= {	RunResultsN[5]:StdNatGasEnergy   }
	"Store energy use - Other  - W-WtrHt"		Proj:RunResultsW[5]:StdOtherEnergy		= {	RunResultsN[5]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:StdTotalEnergy		= {	RunResultsN[5]:StdTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - W-InsLtg"		Proj:RunResultsW[6]:StdElecEnergy		= {	RunResultsN[6]:StdElecEnergy     }
	"Store energy use - NatGas - W-InsLtg"		Proj:RunResultsW[6]:StdNatGasEnergy		= {	RunResultsN[6]:StdNatGasEnergy   }
	"Store energy use - Other  - W-InsLtg"		Proj:RunResultsW[6]:StdOtherEnergy		= {	RunResultsN[6]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:StdTotalEnergy		= {	RunResultsN[6]:StdTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - W-AppCkg"		Proj:RunResultsW[7]:StdElecEnergy		= {	RunResultsN[7]:StdElecEnergy     }
	"Store energy use - NatGas - W-AppCkg"		Proj:RunResultsW[7]:StdNatGasEnergy		= {	RunResultsN[7]:StdNatGasEnergy   }
	"Store energy use - Other  - W-AppCkg"		Proj:RunResultsW[7]:StdOtherEnergy		= {	RunResultsN[7]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:StdTotalEnergy		= {	RunResultsN[7]:StdTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - W-Plugs"		Proj:RunResultsW[8]:StdElecEnergy		= {	RunResultsN[8]:StdElecEnergy     }
	"Store energy use - NatGas - W-Plugs"		Proj:RunResultsW[8]:StdNatGasEnergy		= {	RunResultsN[8]:StdNatGasEnergy   }
	"Store energy use - Other  - W-Plugs"		Proj:RunResultsW[8]:StdOtherEnergy		= {	RunResultsN[8]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:StdTotalEnergy		= {	RunResultsN[8]:StdTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - W-Ext"			Proj:RunResultsW[9]:StdElecEnergy		= {	RunResultsN[9]:StdElecEnergy     }
	"Store energy use - NatGas - W-Ext"			Proj:RunResultsW[9]:StdNatGasEnergy		= {	RunResultsN[9]:StdNatGasEnergy   }
	"Store energy use - Other  - W-Ext"			Proj:RunResultsW[9]:StdOtherEnergy		= {	RunResultsN[9]:StdOtherEnergy    }
	"Store energy use - TOTAL  - W-Ext"			Proj:RunResultsW[9]:StdTotalEnergy		= {	RunResultsN[9]:StdTotalEnergy    }
  ; PV
	"Store energy use - Elec   - W-PV"			Proj:RunResultsW[13]:StdElecEnergy		= {	RunResultsN[13]:StdElecEnergy    }
	"Store energy use - NatGas - W-PV"			Proj:RunResultsW[13]:StdNatGasEnergy	= {	RunResultsN[13]:StdNatGasEnergy  }
	"Store energy use - Other  - W-PV"			Proj:RunResultsW[13]:StdOtherEnergy		= {	RunResultsN[13]:StdOtherEnergy   }
	"Store energy use - TOTAL  - W-PV"			Proj:RunResultsW[13]:StdTotalEnergy		= {	RunResultsN[13]:StdTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:StdElecEnergy		= {	RunResultsN[11]:StdElecEnergy    }
	"Store energy use - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:StdNatGasEnergy	= {	RunResultsN[11]:StdNatGasEnergy  }
	"Store energy use - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:StdOtherEnergy		= {	RunResultsN[11]:StdOtherEnergy   }
	"Store energy use - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:StdTotalEnergy		= {	RunResultsN[11]:StdTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - W-Total"		Proj:RunResultsW[10]:StdElecEnergy		= {	RunResultsN[10]:StdElecEnergy    }
	"Store energy use - NatGas - W-Total"		Proj:RunResultsW[10]:StdNatGasEnergy	= {	RunResultsN[10]:StdNatGasEnergy  }
	"Store energy use - Other  - W-Total"		Proj:RunResultsW[10]:StdOtherEnergy		= {	RunResultsN[10]:StdOtherEnergy   }
	"Store energy use - TOTAL  - W-Total"		Proj:RunResultsW[10]:StdTotalEnergy		= {	RunResultsN[10]:StdTotalEnergy   }
END

;*************************************************************************
RULELIST "CARes_DesignRatingResults_NESW" 1 0 0 1
;*************************************************************************
  ; Space Heating (& heating fan)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
	"Store energy use - Elec   - N-SpcHt"		Proj:RunResultsN[1]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-SpcHt"		Proj:RunResultsN[1]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-SpcHt"		Proj:RunResultsN[1]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[1]:DRtgElecEnergy ) + LocalRef( RunResultsN[1]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[1]:DRtgOtherEnergy )   }

  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - N-SpcCl"		Proj:RunResultsN[2]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-SpcCl"		Proj:RunResultsN[2]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-SpcCl"		Proj:RunResultsN[2]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[2]:DRtgElecEnergy ) + LocalRef( RunResultsN[2]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[2]:DRtgOtherEnergy )   }

  ; IAQ Ventilation Fans
	"Store energy use - Elec   - N-IAQVent"	Proj:RunResultsN[3]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-IAQVent"	Proj:RunResultsN[3]:DRtgNatGasEnergy	= {	0  }
	"Store energy use - Other  - N-IAQVent"	Proj:RunResultsN[3]:DRtgOtherEnergy		= {	0  }
	"Store energy use - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[3]:DRtgElecEnergy )   }

  ; Other HVAC (aux & misc fans)
; mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
;	"Store energy use - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
;			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )  endif  }
;	"Store energy use - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[4]:DRtgElecEnergy ) + LocalRef( RunResultsN[4]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[4]:DRtgOtherEnergy )   }
;
	"Zero out - Elec   - N-OthrHVAC"		Proj:RunResultsN[4]:DRtgElecEnergy	= {	0  }
	"Zero out - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgNatGasEnergy	= {	0  }
	"Zero out - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgOtherEnergy		= {	0  }
	"Zero out - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgTotalEnergy		= {	0  }
   ; Water Heating
	"Store energy use - Elec   - N-WtrHt"		Proj:RunResultsN[5]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-WtrHt"		Proj:RunResultsN[5]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-WtrHt"		Proj:RunResultsN[5]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[5]:DRtgElecEnergy ) + LocalRef( RunResultsN[5]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[5]:DRtgOtherEnergy )   }

  ; Inside Lighting
	"Store energy use - Elec   - N-InsLtg"		Proj:RunResultsN[6]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-InsLtg"		Proj:RunResultsN[6]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-InsLtg"		Proj:RunResultsN[6]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[6]:DRtgElecEnergy ) + LocalRef( RunResultsN[6]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[6]:DRtgOtherEnergy )   }

  ; Appliances & Cooking
	"Store energy use - Elec   - N-AppCkg"		Proj:RunResultsN[7]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-AppCkg"		Proj:RunResultsN[7]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-AppCkg"		Proj:RunResultsN[7]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[7]:DRtgElecEnergy ) + LocalRef( RunResultsN[7]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[7]:DRtgOtherEnergy )   }

  ; Plug Loads
	"Store energy use - Elec   - N-Plugs"		Proj:RunResultsN[8]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-Plugs"		Proj:RunResultsN[8]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-Plugs"		Proj:RunResultsN[8]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[8]:DRtgElecEnergy ) + LocalRef( RunResultsN[8]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[8]:DRtgOtherEnergy )   }

  ; Exterior
	"Store energy use - Elec   - N-Ext"			Proj:RunResultsN[9]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-Ext"			Proj:RunResultsN[9]:DRtgNatGasEnergy	= {	if (Local( Fuel_HaveNatGas ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - Other  - N-Ext"			Proj:RunResultsN[9]:DRtgOtherEnergy		= {	if (Local( Fuel_HaveOther  ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )  endif  }
	"Store energy use - TOTAL  - N-Ext"			Proj:RunResultsN[9]:DRtgTotalEnergy		= {	LocalRef( RunResultsN[9]:DRtgElecEnergy ) + LocalRef( RunResultsN[9]:DRtgNatGasEnergy ) + LocalRef( RunResultsN[9]:DRtgOtherEnergy )   }

  ; PV
	"Store energy use - Elec   - N-PV"			Proj:RunResultsN[13]:DRtgElecEnergy		= {	if (Local( Fuel_HaveElec   ) < 0.5 .OR. Local( CondFloorArea ) < 1) then  0
			 			  																								else  HourlyResultSum( Local( RunID ), "MtrElec",   "PV" ) / Local( CondFloorArea )  endif  }
	"Store energy use - NatGas - N-PV"			Proj:RunResultsN[13]:DRtgNatGasEnergy	= {	0  }
	"Store energy use - Other  - N-PV"			Proj:RunResultsN[13]:DRtgOtherEnergy	= {	0  }
	"Store energy use - TOTAL  - N-PV"			Proj:RunResultsN[13]:DRtgTotalEnergy	= {	LocalRef( RunResultsN[13]:DRtgElecEnergy )   }

; SAC 11/20/14 - fixed bug where RunResultsN totals were summing values from RunResults (no trailing 'N'), which are not yet set.
  ; Compliance Total
	"Store energy use - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecEnergy		= {	RunResultsN[1]:DRtgElecEnergy   + RunResultsN[2]:DRtgElecEnergy   + RunResultsN[3]:DRtgElecEnergy   + RunResultsN[4]:DRtgElecEnergy   + RunResultsN[5]:DRtgElecEnergy    }
	"Store energy use - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgNatGasEnergy	= {	RunResultsN[1]:DRtgNatGasEnergy + RunResultsN[2]:DRtgNatGasEnergy + RunResultsN[3]:DRtgNatGasEnergy + RunResultsN[4]:DRtgNatGasEnergy + RunResultsN[5]:DRtgNatGasEnergy  }
	"Store energy use - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgOtherEnergy	= {	RunResultsN[1]:DRtgOtherEnergy  + RunResultsN[2]:DRtgOtherEnergy  + RunResultsN[3]:DRtgOtherEnergy  + RunResultsN[4]:DRtgOtherEnergy  + RunResultsN[5]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgTotalEnergy	= {	RunResultsN[1]:DRtgTotalEnergy  + RunResultsN[2]:DRtgTotalEnergy  + RunResultsN[3]:DRtgTotalEnergy  + RunResultsN[4]:DRtgTotalEnergy  + RunResultsN[5]:DRtgTotalEnergy   }

  ; Total
	"Store energy use - Elec   - N-Total"		Proj:RunResultsN[10]:DRtgElecEnergy		= {	RunResultsN[11]:DRtgElecEnergy   + RunResultsN[6]:DRtgElecEnergy   + RunResultsN[7]:DRtgElecEnergy   + RunResultsN[8]:DRtgElecEnergy   + RunResultsN[9]:DRtgElecEnergy    }
	"Store energy use - NatGas - N-Total"		Proj:RunResultsN[10]:DRtgNatGasEnergy	= {	RunResultsN[11]:DRtgNatGasEnergy + RunResultsN[6]:DRtgNatGasEnergy + RunResultsN[7]:DRtgNatGasEnergy + RunResultsN[8]:DRtgNatGasEnergy + RunResultsN[9]:DRtgNatGasEnergy  }
	"Store energy use - Other  - N-Total"		Proj:RunResultsN[10]:DRtgOtherEnergy	= {	RunResultsN[11]:DRtgOtherEnergy  + RunResultsN[6]:DRtgOtherEnergy  + RunResultsN[7]:DRtgOtherEnergy  + RunResultsN[8]:DRtgOtherEnergy  + RunResultsN[9]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - N-Total"		Proj:RunResultsN[10]:DRtgTotalEnergy	= {	RunResultsN[11]:DRtgTotalEnergy  + RunResultsN[6]:DRtgTotalEnergy  + RunResultsN[7]:DRtgTotalEnergy  + RunResultsN[8]:DRtgTotalEnergy  + RunResultsN[9]:DRtgTotalEnergy   }

; -- COPY N results to E --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - E-SpcHt"		Proj:RunResultsE[1]:DRtgElecEnergy		= {	RunResultsN[1]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-SpcHt"		Proj:RunResultsE[1]:DRtgNatGasEnergy	= {	RunResultsN[1]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-SpcHt"		Proj:RunResultsE[1]:DRtgOtherEnergy		= {	RunResultsN[1]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:DRtgTotalEnergy		= {	RunResultsN[1]:DRtgTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - E-SpcCl"		Proj:RunResultsE[2]:DRtgElecEnergy		= {	RunResultsN[2]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-SpcCl"		Proj:RunResultsE[2]:DRtgNatGasEnergy	= {	RunResultsN[2]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-SpcCl"		Proj:RunResultsE[2]:DRtgOtherEnergy		= {	RunResultsN[2]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:DRtgTotalEnergy		= {	RunResultsN[2]:DRtgTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - E-IAQVent"	Proj:RunResultsE[3]:DRtgElecEnergy		= {	RunResultsN[3]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-IAQVent"	Proj:RunResultsE[3]:DRtgNatGasEnergy	= {	RunResultsN[3]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-IAQVent"	Proj:RunResultsE[3]:DRtgOtherEnergy		= {	RunResultsN[3]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:DRtgTotalEnergy		= {	RunResultsN[3]:DRtgTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgElecEnergy		= {	RunResultsN[4]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgNatGasEnergy	= {	RunResultsN[4]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgOtherEnergy		= {	RunResultsN[4]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgTotalEnergy		= {	RunResultsN[4]:DRtgTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - E-WtrHt"		Proj:RunResultsE[5]:DRtgElecEnergy		= {	RunResultsN[5]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-WtrHt"		Proj:RunResultsE[5]:DRtgNatGasEnergy	= {	RunResultsN[5]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-WtrHt"		Proj:RunResultsE[5]:DRtgOtherEnergy		= {	RunResultsN[5]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:DRtgTotalEnergy		= {	RunResultsN[5]:DRtgTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - E-InsLtg"		Proj:RunResultsE[6]:DRtgElecEnergy		= {	RunResultsN[6]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-InsLtg"		Proj:RunResultsE[6]:DRtgNatGasEnergy	= {	RunResultsN[6]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-InsLtg"		Proj:RunResultsE[6]:DRtgOtherEnergy		= {	RunResultsN[6]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:DRtgTotalEnergy		= {	RunResultsN[6]:DRtgTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - E-AppCkg"		Proj:RunResultsE[7]:DRtgElecEnergy		= {	RunResultsN[7]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-AppCkg"		Proj:RunResultsE[7]:DRtgNatGasEnergy	= {	RunResultsN[7]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-AppCkg"		Proj:RunResultsE[7]:DRtgOtherEnergy		= {	RunResultsN[7]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:DRtgTotalEnergy		= {	RunResultsN[7]:DRtgTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - E-Plugs"		Proj:RunResultsE[8]:DRtgElecEnergy		= {	RunResultsN[8]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-Plugs"		Proj:RunResultsE[8]:DRtgNatGasEnergy	= {	RunResultsN[8]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-Plugs"		Proj:RunResultsE[8]:DRtgOtherEnergy		= {	RunResultsN[8]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:DRtgTotalEnergy		= {	RunResultsN[8]:DRtgTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - E-Ext"			Proj:RunResultsE[9]:DRtgElecEnergy		= {	RunResultsN[9]:DRtgElecEnergy     }
	"Store energy use - NatGas - E-Ext"			Proj:RunResultsE[9]:DRtgNatGasEnergy	= {	RunResultsN[9]:DRtgNatGasEnergy   }
	"Store energy use - Other  - E-Ext"			Proj:RunResultsE[9]:DRtgOtherEnergy		= {	RunResultsN[9]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - E-Ext"			Proj:RunResultsE[9]:DRtgTotalEnergy		= {	RunResultsN[9]:DRtgTotalEnergy    }
  ; PV
	"Store energy use - Elec   - E-PV"			Proj:RunResultsE[13]:DRtgElecEnergy		= {	RunResultsN[13]:DRtgElecEnergy    }
	"Store energy use - NatGas - E-PV"			Proj:RunResultsE[13]:DRtgNatGasEnergy	= {	RunResultsN[13]:DRtgNatGasEnergy  }
	"Store energy use - Other  - E-PV"			Proj:RunResultsE[13]:DRtgOtherEnergy	= {	RunResultsN[13]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - E-PV"			Proj:RunResultsE[13]:DRtgTotalEnergy	= {	RunResultsN[13]:DRtgTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgElecEnergy		= {	RunResultsN[11]:DRtgElecEnergy    }
	"Store energy use - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgNatGasEnergy	= {	RunResultsN[11]:DRtgNatGasEnergy  }
	"Store energy use - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgOtherEnergy	= {	RunResultsN[11]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgTotalEnergy	= {	RunResultsN[11]:DRtgTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - E-Total"		Proj:RunResultsE[10]:DRtgElecEnergy		= {	RunResultsN[10]:DRtgElecEnergy    }
	"Store energy use - NatGas - E-Total"		Proj:RunResultsE[10]:DRtgNatGasEnergy	= {	RunResultsN[10]:DRtgNatGasEnergy  }
	"Store energy use - Other  - E-Total"		Proj:RunResultsE[10]:DRtgOtherEnergy	= {	RunResultsN[10]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - E-Total"		Proj:RunResultsE[10]:DRtgTotalEnergy	= {	RunResultsN[10]:DRtgTotalEnergy   }

; -- COPY N results to S --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - S-SpcHt"		Proj:RunResultsS[1]:DRtgElecEnergy		= {	RunResultsN[1]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-SpcHt"		Proj:RunResultsS[1]:DRtgNatGasEnergy	= {	RunResultsN[1]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-SpcHt"		Proj:RunResultsS[1]:DRtgOtherEnergy		= {	RunResultsN[1]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:DRtgTotalEnergy		= {	RunResultsN[1]:DRtgTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - S-SpcCl"		Proj:RunResultsS[2]:DRtgElecEnergy		= {	RunResultsN[2]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-SpcCl"		Proj:RunResultsS[2]:DRtgNatGasEnergy	= {	RunResultsN[2]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-SpcCl"		Proj:RunResultsS[2]:DRtgOtherEnergy		= {	RunResultsN[2]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:DRtgTotalEnergy		= {	RunResultsN[2]:DRtgTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - S-IAQVent"	Proj:RunResultsS[3]:DRtgElecEnergy		= {	RunResultsN[3]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-IAQVent"	Proj:RunResultsS[3]:DRtgNatGasEnergy	= {	RunResultsN[3]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-IAQVent"	Proj:RunResultsS[3]:DRtgOtherEnergy		= {	RunResultsN[3]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:DRtgTotalEnergy		= {	RunResultsN[3]:DRtgTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgElecEnergy		= {	RunResultsN[4]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgNatGasEnergy	= {	RunResultsN[4]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgOtherEnergy		= {	RunResultsN[4]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgTotalEnergy		= {	RunResultsN[4]:DRtgTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - S-WtrHt"		Proj:RunResultsS[5]:DRtgElecEnergy		= {	RunResultsN[5]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-WtrHt"		Proj:RunResultsS[5]:DRtgNatGasEnergy	= {	RunResultsN[5]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-WtrHt"		Proj:RunResultsS[5]:DRtgOtherEnergy		= {	RunResultsN[5]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:DRtgTotalEnergy		= {	RunResultsN[5]:DRtgTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - S-InsLtg"		Proj:RunResultsS[6]:DRtgElecEnergy		= {	RunResultsN[6]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-InsLtg"		Proj:RunResultsS[6]:DRtgNatGasEnergy	= {	RunResultsN[6]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-InsLtg"		Proj:RunResultsS[6]:DRtgOtherEnergy		= {	RunResultsN[6]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:DRtgTotalEnergy		= {	RunResultsN[6]:DRtgTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - S-AppCkg"		Proj:RunResultsS[7]:DRtgElecEnergy		= {	RunResultsN[7]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-AppCkg"		Proj:RunResultsS[7]:DRtgNatGasEnergy	= {	RunResultsN[7]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-AppCkg"		Proj:RunResultsS[7]:DRtgOtherEnergy		= {	RunResultsN[7]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:DRtgTotalEnergy		= {	RunResultsN[7]:DRtgTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - S-Plugs"		Proj:RunResultsS[8]:DRtgElecEnergy		= {	RunResultsN[8]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-Plugs"		Proj:RunResultsS[8]:DRtgNatGasEnergy	= {	RunResultsN[8]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-Plugs"		Proj:RunResultsS[8]:DRtgOtherEnergy		= {	RunResultsN[8]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:DRtgTotalEnergy		= {	RunResultsN[8]:DRtgTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - S-Ext"			Proj:RunResultsS[9]:DRtgElecEnergy		= {	RunResultsN[9]:DRtgElecEnergy     }
	"Store energy use - NatGas - S-Ext"			Proj:RunResultsS[9]:DRtgNatGasEnergy	= {	RunResultsN[9]:DRtgNatGasEnergy   }
	"Store energy use - Other  - S-Ext"			Proj:RunResultsS[9]:DRtgOtherEnergy		= {	RunResultsN[9]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - S-Ext"			Proj:RunResultsS[9]:DRtgTotalEnergy		= {	RunResultsN[9]:DRtgTotalEnergy    }
  ; PV
	"Store energy use - Elec   - S-PV"			Proj:RunResultsS[13]:DRtgElecEnergy		= {	RunResultsN[13]:DRtgElecEnergy    }
	"Store energy use - NatGas - S-PV"			Proj:RunResultsS[13]:DRtgNatGasEnergy	= {	RunResultsN[13]:DRtgNatGasEnergy  }
	"Store energy use - Other  - S-PV"			Proj:RunResultsS[13]:DRtgOtherEnergy	= {	RunResultsN[13]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - S-PV"			Proj:RunResultsS[13]:DRtgTotalEnergy	= {	RunResultsN[13]:DRtgTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgElecEnergy		= {	RunResultsN[11]:DRtgElecEnergy    }
	"Store energy use - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgNatGasEnergy	= {	RunResultsN[11]:DRtgNatGasEnergy  }
	"Store energy use - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgOtherEnergy	= {	RunResultsN[11]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgTotalEnergy	= {	RunResultsN[11]:DRtgTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - S-Total"		Proj:RunResultsS[10]:DRtgElecEnergy		= {	RunResultsN[10]:DRtgElecEnergy    }
	"Store energy use - NatGas - S-Total"		Proj:RunResultsS[10]:DRtgNatGasEnergy	= {	RunResultsN[10]:DRtgNatGasEnergy  }
	"Store energy use - Other  - S-Total"		Proj:RunResultsS[10]:DRtgOtherEnergy	= {	RunResultsN[10]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - S-Total"		Proj:RunResultsS[10]:DRtgTotalEnergy	= {	RunResultsN[10]:DRtgTotalEnergy   }

; -- COPY N results to W --
  ; Space Heating (& heating fan)
	"Store energy use - Elec   - W-SpcHt"		Proj:RunResultsW[1]:DRtgElecEnergy		= {	RunResultsN[1]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-SpcHt"		Proj:RunResultsW[1]:DRtgNatGasEnergy	= {	RunResultsN[1]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-SpcHt"		Proj:RunResultsW[1]:DRtgOtherEnergy		= {	RunResultsN[1]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:DRtgTotalEnergy		= {	RunResultsN[1]:DRtgTotalEnergy    }
  ; Space Cooling (& cooling fan)
	"Store energy use - Elec   - W-SpcCl"		Proj:RunResultsW[2]:DRtgElecEnergy		= {	RunResultsN[2]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-SpcCl"		Proj:RunResultsW[2]:DRtgNatGasEnergy	= {	RunResultsN[2]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-SpcCl"		Proj:RunResultsW[2]:DRtgOtherEnergy		= {	RunResultsN[2]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:DRtgTotalEnergy		= {	RunResultsN[2]:DRtgTotalEnergy    }
  ; IAQ Ventilation Fans                                                                                                 
	"Store energy use - Elec   - W-IAQVent"	Proj:RunResultsW[3]:DRtgElecEnergy		= {	RunResultsN[3]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-IAQVent"	Proj:RunResultsW[3]:DRtgNatGasEnergy	= {	RunResultsN[3]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-IAQVent"	Proj:RunResultsW[3]:DRtgOtherEnergy		= {	RunResultsN[3]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:DRtgTotalEnergy		= {	RunResultsN[3]:DRtgTotalEnergy    }
  ; Other HVAC (aux & misc fans)                                                                                         
	"Store energy use - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgElecEnergy		= {	RunResultsN[4]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgNatGasEnergy	= {	RunResultsN[4]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgOtherEnergy		= {	RunResultsN[4]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgTotalEnergy		= {	RunResultsN[4]:DRtgTotalEnergy    }
  ; Water Heating                                                                                                        
	"Store energy use - Elec   - W-WtrHt"		Proj:RunResultsW[5]:DRtgElecEnergy		= {	RunResultsN[5]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-WtrHt"		Proj:RunResultsW[5]:DRtgNatGasEnergy	= {	RunResultsN[5]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-WtrHt"		Proj:RunResultsW[5]:DRtgOtherEnergy		= {	RunResultsN[5]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:DRtgTotalEnergy		= {	RunResultsN[5]:DRtgTotalEnergy    }
  ; Inside Lighting                                                                                                      
	"Store energy use - Elec   - W-InsLtg"		Proj:RunResultsW[6]:DRtgElecEnergy		= {	RunResultsN[6]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-InsLtg"		Proj:RunResultsW[6]:DRtgNatGasEnergy	= {	RunResultsN[6]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-InsLtg"		Proj:RunResultsW[6]:DRtgOtherEnergy		= {	RunResultsN[6]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:DRtgTotalEnergy		= {	RunResultsN[6]:DRtgTotalEnergy    }
  ; Appliances & Cooking                                                                                                 
	"Store energy use - Elec   - W-AppCkg"		Proj:RunResultsW[7]:DRtgElecEnergy		= {	RunResultsN[7]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-AppCkg"		Proj:RunResultsW[7]:DRtgNatGasEnergy	= {	RunResultsN[7]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-AppCkg"		Proj:RunResultsW[7]:DRtgOtherEnergy		= {	RunResultsN[7]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:DRtgTotalEnergy		= {	RunResultsN[7]:DRtgTotalEnergy    }
  ; Plug Loads                                                                                                           
	"Store energy use - Elec   - W-Plugs"		Proj:RunResultsW[8]:DRtgElecEnergy		= {	RunResultsN[8]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-Plugs"		Proj:RunResultsW[8]:DRtgNatGasEnergy	= {	RunResultsN[8]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-Plugs"		Proj:RunResultsW[8]:DRtgOtherEnergy		= {	RunResultsN[8]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:DRtgTotalEnergy		= {	RunResultsN[8]:DRtgTotalEnergy    }
  ; Exterior                                                                                                             
	"Store energy use - Elec   - W-Ext"			Proj:RunResultsW[9]:DRtgElecEnergy		= {	RunResultsN[9]:DRtgElecEnergy     }
	"Store energy use - NatGas - W-Ext"			Proj:RunResultsW[9]:DRtgNatGasEnergy	= {	RunResultsN[9]:DRtgNatGasEnergy   }
	"Store energy use - Other  - W-Ext"			Proj:RunResultsW[9]:DRtgOtherEnergy		= {	RunResultsN[9]:DRtgOtherEnergy    }
	"Store energy use - TOTAL  - W-Ext"			Proj:RunResultsW[9]:DRtgTotalEnergy		= {	RunResultsN[9]:DRtgTotalEnergy    }
  ; PV
	"Store energy use - Elec   - W-PV"			Proj:RunResultsW[13]:DRtgElecEnergy		= {	RunResultsN[13]:DRtgElecEnergy    }
	"Store energy use - NatGas - W-PV"			Proj:RunResultsW[13]:DRtgNatGasEnergy	= {	RunResultsN[13]:DRtgNatGasEnergy  }
	"Store energy use - Other  - W-PV"			Proj:RunResultsW[13]:DRtgOtherEnergy	= {	RunResultsN[13]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - W-PV"			Proj:RunResultsW[13]:DRtgTotalEnergy	= {	RunResultsN[13]:DRtgTotalEnergy   }
  ; Compliance Total                                                                                                     
	"Store energy use - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgElecEnergy		= {	RunResultsN[11]:DRtgElecEnergy    }
	"Store energy use - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgNatGasEnergy	= {	RunResultsN[11]:DRtgNatGasEnergy  }
	"Store energy use - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgOtherEnergy	= {	RunResultsN[11]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgTotalEnergy	= {	RunResultsN[11]:DRtgTotalEnergy   }
  ; Total                                                                                                                
	"Store energy use - Elec   - W-Total"		Proj:RunResultsW[10]:DRtgElecEnergy		= {	RunResultsN[10]:DRtgElecEnergy    }
	"Store energy use - NatGas - W-Total"		Proj:RunResultsW[10]:DRtgNatGasEnergy	= {	RunResultsN[10]:DRtgNatGasEnergy  }
	"Store energy use - Other  - W-Total"		Proj:RunResultsW[10]:DRtgOtherEnergy	= {	RunResultsN[10]:DRtgOtherEnergy   }
	"Store energy use - TOTAL  - W-Total"		Proj:RunResultsW[10]:DRtgTotalEnergy	= {	RunResultsN[10]:DRtgTotalEnergy   }
END


;*************************************************************************
RULELIST "CARes_ProposedTDVResults" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - SpcHt"		Proj:RunResults[1]:PropElecTDV[1]			= {	if (LocalRef( RunResults[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcHt"		Proj:RunResults[1]:PropNatGasTDV			= {	if (LocalRef( RunResults[1]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcHt"		Proj:RunResults[1]:PropOtherTDV			= {	if (LocalRef( RunResults[1]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcHt"		Proj:RunResults[1]:ProposedTDV[1]			= {	LocalRef( RunResults[1]:PropElecTDV[1] ) + LocalRef( RunResults[1]:PropNatGasTDV ) + LocalRef( RunResults[1]:PropOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - SpcHt"		Proj:RunResults[1]:PropElecDemand[1]		= {	if (LocalRef( RunResults[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - SpcCl"		Proj:RunResults[2]:PropElecTDV[1]			= {	if (LocalRef( RunResults[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcCl"		Proj:RunResults[2]:PropNatGasTDV			= {	if (LocalRef( RunResults[2]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcCl"		Proj:RunResults[2]:PropOtherTDV			= {	if (LocalRef( RunResults[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcCl"		Proj:RunResults[2]:ProposedTDV[1]			= {	LocalRef( RunResults[2]:PropElecTDV[1] ) + LocalRef( RunResults[2]:PropNatGasTDV ) + LocalRef( RunResults[2]:PropOtherTDV )   }
	"Calculate Elec Demand  - SpcCl"		Proj:RunResults[2]:PropElecDemand[1]		= {	if (LocalRef( RunResults[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - IAQVent"	Proj:RunResults[3]:PropElecTDV[1]			= {	if (LocalRef( RunResults[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - IAQVent"	Proj:RunResults[3]:PropNatGasTDV			= {	0  }
	"Calculate TDV - Other  - IAQVent"	Proj:RunResults[3]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - IAQVent"	Proj:RunResults[3]:ProposedTDV[1]			= {	LocalRef( RunResults[3]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - IAQVent"	Proj:RunResults[3]:PropElecDemand[1]		= {	if (LocalRef( RunResults[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - OthrHVAC"	Proj:RunResults[4]:PropElecTDV[1]		= {	0  }  ; if (LocalRef( RunResults[4]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - OthrHVAC"	Proj:RunResults[4]:PropNatGasTDV			= {	0  }  ; if (LocalRef( RunResults[4]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - OthrHVAC"	Proj:RunResults[4]:PropOtherTDV			= {	0  }  ; if (LocalRef( RunResults[4]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - OthrHVAC"	Proj:RunResults[4]:ProposedTDV[1]		= {	0  }  ; LocalRef( RunResults[4]:PropElecTDV[1] ) + LocalRef( RunResults[4]:PropNatGasTDV ) + LocalRef( RunResults[4]:PropOtherTDV )   }
	"Calculate Elec Demand  - OthrHVAC"	Proj:RunResults[4]:PropElecDemand[1]	= {	0  }  ; if (LocalRef( RunResults[4]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						      ; else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / 3.412  endif  }

  ; Water Heating
	"Calculate TDV - Elec   - WtrHt"		Proj:RunResults[5]:PropElecTDV[1]			= {	if (LocalRef( RunResults[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - WtrHt"		Proj:RunResults[5]:PropNatGasTDV			= {	if (LocalRef( RunResults[5]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - WtrHt"		Proj:RunResults[5]:PropOtherTDV			= {	if (LocalRef( RunResults[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - WtrHt"		Proj:RunResults[5]:ProposedTDV[1]			= {	LocalRef( RunResults[5]:PropElecTDV[1] ) + LocalRef( RunResults[5]:PropNatGasTDV ) + LocalRef( RunResults[5]:PropOtherTDV )   }
	"Calculate Elec Demand  - WtrHt"		Proj:RunResults[5]:PropElecDemand[1]		= {	if (LocalRef( RunResults[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / 3.412  endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - InsLtg"	Proj:RunResults[6]:PropElecTDV[1]			= {	if (LocalRef( RunResults[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - InsLtg"	Proj:RunResults[6]:PropNatGasTDV			= {	if (LocalRef( RunResults[6]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - InsLtg"	Proj:RunResults[6]:PropOtherTDV			= {	if (LocalRef( RunResults[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - InsLtg"	Proj:RunResults[6]:ProposedTDV[1]			= {	LocalRef( RunResults[6]:PropElecTDV[1] ) + LocalRef( RunResults[6]:PropNatGasTDV ) + LocalRef( RunResults[6]:PropOtherTDV )   }
	"Calculate Elec Demand  - InsLtg"	Proj:RunResults[6]:PropElecDemand[1]		= {	if (LocalRef( RunResults[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - AppCkg"	Proj:RunResults[7]:PropElecTDV[1]			= {	if (LocalRef( RunResults[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - AppCkg"	Proj:RunResults[7]:PropNatGasTDV			= {	if (LocalRef( RunResults[7]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - AppCkg"	Proj:RunResults[7]:PropOtherTDV			= {	if (LocalRef( RunResults[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - AppCkg"	Proj:RunResults[7]:ProposedTDV[1]			= {	LocalRef( RunResults[7]:PropElecTDV[1] ) + LocalRef( RunResults[7]:PropNatGasTDV ) + LocalRef( RunResults[7]:PropOtherTDV )   }
	"Calculate Elec Demand  - AppCkg"	Proj:RunResults[7]:PropElecDemand[1]		= {	if (LocalRef( RunResults[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - Plugs"		Proj:RunResults[8]:PropElecTDV[1]			= {	if (LocalRef( RunResults[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Plugs"		Proj:RunResults[8]:PropNatGasTDV			= {	if (LocalRef( RunResults[8]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Plugs"		Proj:RunResults[8]:PropOtherTDV			= {	if (LocalRef( RunResults[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Plugs"		Proj:RunResults[8]:ProposedTDV[1]			= {	LocalRef( RunResults[8]:PropElecTDV[1] ) + LocalRef( RunResults[8]:PropNatGasTDV ) + LocalRef( RunResults[8]:PropOtherTDV )   }
	"Calculate Elec Demand  - Plugs"		Proj:RunResults[8]:PropElecDemand[1]		= {	if (LocalRef( RunResults[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - Ext"		Proj:RunResults[9]:PropElecTDV[1]			= {	if (LocalRef( RunResults[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Ext"		Proj:RunResults[9]:PropNatGasTDV			= {	if (LocalRef( RunResults[9]:PropNatGasEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Ext"		Proj:RunResults[9]:PropOtherTDV			= {	if (LocalRef( RunResults[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Ext"		Proj:RunResults[9]:ProposedTDV[1]			= {	LocalRef( RunResults[9]:PropElecTDV[1] ) + LocalRef( RunResults[9]:PropNatGasTDV ) + LocalRef( RunResults[9]:PropOtherTDV )   }
	"Calculate Elec Demand  - Ext"		Proj:RunResults[9]:PropElecDemand[1]		= {	if (LocalRef( RunResults[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - PV"			Proj:RunResults[13]:PropElecTDV[1]		= {	if (LocalRef( RunResults[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "PVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "PV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - PV"			Proj:RunResults[13]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - PV"			Proj:RunResults[13]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - PV"			Proj:RunResults[13]:ProposedTDV[1]		= {	LocalRef( RunResults[13]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - PV"			Proj:RunResults[13]:PropElecDemand[1]	= {	if (LocalRef( RunResults[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec", "PV" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecTDV[1]			= {	RunResults[1]:PropElecTDV[1]    + RunResults[2]:PropElecTDV[1]    + RunResults[3]:PropElecTDV[1]    + RunResults[4]:PropElecTDV[1]    + RunResults[5]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - Comp Ttl"	Proj:RunResults[11]:PropNatGasTDV		= {	RunResults[1]:PropNatGasTDV  + RunResults[2]:PropNatGasTDV  + RunResults[3]:PropNatGasTDV  + RunResults[4]:PropNatGasTDV  + RunResults[5]:PropNatGasTDV   }
	"Calculate TDV - Other  - Comp Ttl"	Proj:RunResults[11]:PropOtherTDV			= {	RunResults[1]:PropOtherTDV   + RunResults[2]:PropOtherTDV   + RunResults[3]:PropOtherTDV   + RunResults[4]:PropOtherTDV   + RunResults[5]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:ProposedTDV[1]			= {	RunResults[1]:ProposedTDV[1]    + RunResults[2]:ProposedTDV[1]    + RunResults[3]:ProposedTDV[1]    + RunResults[4]:ProposedTDV[1]    + RunResults[5]:ProposedTDV[1]     }
	"Calculate Elec Demand  - Comp Ttl"	Proj:RunResults[11]:PropElecDemand[1]		= {	RunResults[1]:PropElecDemand[1] + RunResults[2]:PropElecDemand[1] + RunResults[3]:PropElecDemand[1] + RunResults[4]:PropElecDemand[1] + RunResults[5]:PropElecDemand[1]  }

  ; Total
	"Calculate TDV - Elec   - Total"		Proj:RunResults[10]:PropElecTDV[1]			= {	RunResults[11]:PropElecTDV[1]    + RunResults[6]:PropElecTDV[1]    + RunResults[7]:PropElecTDV[1]    + RunResults[8]:PropElecTDV[1]    + RunResults[9]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - Total"		Proj:RunResults[10]:PropNatGasTDV		= {	RunResults[11]:PropNatGasTDV  + RunResults[6]:PropNatGasTDV  + RunResults[7]:PropNatGasTDV  + RunResults[8]:PropNatGasTDV  + RunResults[9]:PropNatGasTDV   }
	"Calculate TDV - Other  - Total"		Proj:RunResults[10]:PropOtherTDV			= {	RunResults[11]:PropOtherTDV   + RunResults[6]:PropOtherTDV   + RunResults[7]:PropOtherTDV   + RunResults[8]:PropOtherTDV   + RunResults[9]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:ProposedTDV[1]			= {	RunResults[11]:ProposedTDV[1]    + RunResults[6]:ProposedTDV[1]    + RunResults[7]:ProposedTDV[1]    + RunResults[8]:ProposedTDV[1]    + RunResults[9]:ProposedTDV[1]     }
	"Calculate Elec Demand  - Total"		Proj:RunResults[10]:PropElecDemand[1]		= {	RunResults[11]:PropElecDemand[1] + RunResults[6]:PropElecDemand[1] + RunResults[7]:PropElecDemand[1] + RunResults[8]:PropElecDemand[1] + RunResults[9]:PropElecDemand[1]  }

;;OLD VERSION
;  ; Space Heating
;	"Calculate TDV - Elec   - SpcHt"		Proj:RunResults[1]:PropElecTDV		= {	if (LocalRef( RunResults[1]:PropElecEnergy   ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - NatGas - SpcHt"		Proj:RunResults[1]:PropNatGasTDV		= {	if (LocalRef( RunResults[1]:PropNatGasEnergy ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Htg", "HPHtg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - Other  - SpcHt"		Proj:RunResults[1]:PropOtherTDV		= {	if (LocalRef( RunResults[1]:PropOtherEnergy  ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Htg", "HPHtg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - TOTAL  - SpcHt"		Proj:RunResults[1]:ProposedTDV		= {	LocalRef( RunResults[1]:PropElecTDV ) + LocalRef( RunResults[1]:PropNatGasTDV ) + LocalRef( RunResults[1]:PropOtherTDV )   }
;
;  ; Space Cooling
;	"Calculate TDV - Elec   - SpcCl"		Proj:RunResults[2]:PropElecTDV		= {	if (LocalRef( RunResults[2]:PropElecEnergy   ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Clg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - NatGas - SpcCl"		Proj:RunResults[2]:PropNatGasTDV		= {	if (LocalRef( RunResults[2]:PropNatGasEnergy ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Clg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - Other  - SpcCl"		Proj:RunResults[2]:PropOtherTDV		= {	if (LocalRef( RunResults[2]:PropOtherEnergy  ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Clg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - TOTAL  - SpcCl"		Proj:RunResults[2]:ProposedTDV		= {	LocalRef( RunResults[2]:PropElecTDV ) + LocalRef( RunResults[2]:PropNatGasTDV ) + LocalRef( RunResults[2]:PropOtherTDV )   }
;
;  ; Ventilation Fans
;	"Calculate TDV - Elec   - Vent"		Proj:RunResults[3]:PropElecTDV		= {	if (LocalRef( RunResults[3]:PropElecEnergy   ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "FanTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Fan" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - NatGas - Vent"		Proj:RunResults[3]:PropNatGasTDV		= {	if (LocalRef( RunResults[3]:PropNatGasEnergy ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "FanTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Fan" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - Other  - Vent"		Proj:RunResults[3]:PropOtherTDV		= {	if (LocalRef( RunResults[3]:PropOtherEnergy  ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "FanTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Fan" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - TOTAL  - Vent"		Proj:RunResults[3]:ProposedTDV		= {	LocalRef( RunResults[3]:PropElecTDV ) + LocalRef( RunResults[3]:PropNatGasTDV ) + LocalRef( RunResults[3]:PropOtherTDV )   }
;
;  ; Water Heating
;	"Calculate TDV - Elec   - WtrHt"		Proj:RunResults[4]:PropElecTDV		= {	if (LocalRef( RunResults[4]:PropElecEnergy   ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "SHWTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "SHW", "SHWPmp" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - NatGas - WtrHt"		Proj:RunResults[4]:PropNatGasTDV		= {	if (LocalRef( RunResults[4]:PropNatGasEnergy ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "SHWTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "SHW" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - Other  - WtrHt"		Proj:RunResults[4]:PropOtherTDV		= {	if (LocalRef( RunResults[4]:PropOtherEnergy  ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "SHWTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "SHW" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - TOTAL  - WtrHt"		Proj:RunResults[4]:ProposedTDV		= {	LocalRef( RunResults[4]:PropElecTDV ) + LocalRef( RunResults[4]:PropNatGasTDV ) + LocalRef( RunResults[4]:PropOtherTDV )   }
;
;  ; Total
;	"Calculate TDV - Elec   - Total"		Proj:RunResults[5]:PropElecTDV		= {	LocalRef( RunResults[1]:PropElecTDV   ) + LocalRef( RunResults[2]:PropElecTDV   ) + LocalRef( RunResults[3]:PropElecTDV   ) + LocalRef( RunResults[4]:PropElecTDV   )  }
;	"Calculate TDV - NatGas - Total"		Proj:RunResults[5]:PropNatGasTDV		= {	LocalRef( RunResults[1]:PropNatGasTDV ) + LocalRef( RunResults[2]:PropNatGasTDV ) + LocalRef( RunResults[3]:PropNatGasTDV ) + LocalRef( RunResults[4]:PropNatGasTDV )  }
;	"Calculate TDV - Other  - Total"		Proj:RunResults[5]:PropOtherTDV		= {	LocalRef( RunResults[1]:PropOtherTDV  ) + LocalRef( RunResults[2]:PropOtherTDV  ) + LocalRef( RunResults[3]:PropOtherTDV  ) + LocalRef( RunResults[4]:PropOtherTDV  )  }
;	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[5]:ProposedTDV		= {	LocalRef( RunResults[1]:ProposedTDV   ) + LocalRef( RunResults[2]:ProposedTDV   ) + LocalRef( RunResults[3]:ProposedTDV   ) + LocalRef( RunResults[4]:ProposedTDV   )  }
END

;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedTDVResults_N" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - N-SpcHt"		Proj:RunResultsN[1]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcHt"		Proj:RunResultsN[1]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcHt"		Proj:RunResultsN[1]:PropOtherTDV			= {	if (LocalRef( RunResultsN[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:ProposedTDV[1]			= {	LocalRef( RunResultsN[1]:PropElecTDV[1] ) + LocalRef( RunResultsN[1]:PropNatGasTDV ) + LocalRef( RunResultsN[1]:PropOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - N-SpcHt"		Proj:RunResultsN[1]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - N-SpcCl"		Proj:RunResultsN[2]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcCl"		Proj:RunResultsN[2]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcCl"		Proj:RunResultsN[2]:PropOtherTDV			= {	if (LocalRef( RunResultsN[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:ProposedTDV[1]			= {	LocalRef( RunResultsN[2]:PropElecTDV[1] ) + LocalRef( RunResultsN[2]:PropNatGasTDV ) + LocalRef( RunResultsN[2]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-SpcCl"		Proj:RunResultsN[2]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - N-IAQVent"	Proj:RunResultsN[3]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-IAQVent"	Proj:RunResultsN[3]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-IAQVent"	Proj:RunResultsN[3]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:ProposedTDV[1]			= {	LocalRef( RunResultsN[3]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - N-IAQVent"	Proj:RunResultsN[3]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:PropElecTDV[1]		= {	0  }  ; if (LocalRef( RunResultsN[4]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:PropNatGasTDV		= {	0  }  ; if (LocalRef( RunResultsN[4]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:PropOtherTDV			= {	0  }  ; if (LocalRef( RunResultsN[4]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:ProposedTDV[1]		= {	0  }  ; LocalRef( RunResultsN[4]:PropElecTDV[1] ) + LocalRef( RunResultsN[4]:PropNatGasTDV ) + LocalRef( RunResultsN[4]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-OthrHVAC"	Proj:RunResultsN[4]:PropElecDemand[1]	= {	0  }  ; if (LocalRef( RunResultsN[4]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / 3.412  endif  }

  ; Water Heating
	"Calculate TDV - Elec   - N-WtrHt"		Proj:RunResultsN[5]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-WtrHt"		Proj:RunResultsN[5]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-WtrHt"		Proj:RunResultsN[5]:PropOtherTDV			= {	if (LocalRef( RunResultsN[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:ProposedTDV[1]			= {	LocalRef( RunResultsN[5]:PropElecTDV[1] ) + LocalRef( RunResultsN[5]:PropNatGasTDV ) + LocalRef( RunResultsN[5]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-WtrHt"		Proj:RunResultsN[5]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / 3.412  endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - N-InsLtg"		Proj:RunResultsN[6]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-InsLtg"		Proj:RunResultsN[6]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-InsLtg"		Proj:RunResultsN[6]:PropOtherTDV			= {	if (LocalRef( RunResultsN[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:ProposedTDV[1]			= {	LocalRef( RunResultsN[6]:PropElecTDV[1] ) + LocalRef( RunResultsN[6]:PropNatGasTDV ) + LocalRef( RunResultsN[6]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-InsLtg"		Proj:RunResultsN[6]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - N-AppCkg"		Proj:RunResultsN[7]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-AppCkg"		Proj:RunResultsN[7]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-AppCkg"		Proj:RunResultsN[7]:PropOtherTDV			= {	if (LocalRef( RunResultsN[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:ProposedTDV[1]			= {	LocalRef( RunResultsN[7]:PropElecTDV[1] ) + LocalRef( RunResultsN[7]:PropNatGasTDV ) + LocalRef( RunResultsN[7]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-AppCkg"		Proj:RunResultsN[7]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - N-Plugs"		Proj:RunResultsN[8]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Plugs"		Proj:RunResultsN[8]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Plugs"		Proj:RunResultsN[8]:PropOtherTDV			= {	if (LocalRef( RunResultsN[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:ProposedTDV[1]			= {	LocalRef( RunResultsN[8]:PropElecTDV[1] ) + LocalRef( RunResultsN[8]:PropNatGasTDV ) + LocalRef( RunResultsN[8]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-Plugs"		Proj:RunResultsN[8]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - N-Ext"			Proj:RunResultsN[9]:PropElecTDV[1]			= {	if (LocalRef( RunResultsN[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Ext"			Proj:RunResultsN[9]:PropNatGasTDV		= {	if (LocalRef( RunResultsN[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Ext"			Proj:RunResultsN[9]:PropOtherTDV			= {	if (LocalRef( RunResultsN[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Ext"			Proj:RunResultsN[9]:ProposedTDV[1]			= {	LocalRef( RunResultsN[9]:PropElecTDV[1] ) + LocalRef( RunResultsN[9]:PropNatGasTDV ) + LocalRef( RunResultsN[9]:PropOtherTDV )   }
	"Calculate Elec Demand  - N-Ext"			Proj:RunResultsN[9]:PropElecDemand[1]		= {	if (LocalRef( RunResultsN[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - N-PV"			Proj:RunResultsN[13]:PropElecTDV[1]		= {	if (LocalRef( RunResultsN[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "PVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "PV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-PV"			Proj:RunResultsN[13]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-PV"			Proj:RunResultsN[13]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - N-PV"			Proj:RunResultsN[13]:ProposedTDV[1]		= {	LocalRef( RunResultsN[13]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - N-PV"			Proj:RunResultsN[13]:PropElecDemand[1]	= {	if (LocalRef( RunResultsN[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec", "PV" ) / 3.412  endif  }
; "store BEMProc details"		Proj:Action = {  StoreBEMProc( "DsgnRtg PV TDV", 0 )  }
; "testing"	Proj:Action	= {	MessageBox( "RunResultsN[13]:ProposedTDV[1] = %g  and [2] = %g", ValidOr( RunResultsN[13]:ProposedTDV[1], 0 ), ValidOr( RunResultsN[13]:ProposedTDV[2], 0 ) )  }

  ; Compliance Total
	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecTDV[1]			= {	RunResultsN[1]:PropElecTDV[1]    + RunResultsN[2]:PropElecTDV[1]    + RunResultsN[3]:PropElecTDV[1]    + RunResultsN[4]:PropElecTDV[1]    + RunResultsN[5]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:PropNatGasTDV		= {	RunResultsN[1]:PropNatGasTDV  + RunResultsN[2]:PropNatGasTDV  + RunResultsN[3]:PropNatGasTDV  + RunResultsN[4]:PropNatGasTDV  + RunResultsN[5]:PropNatGasTDV   }
	"Calculate TDV - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:PropOtherTDV		= {	RunResultsN[1]:PropOtherTDV   + RunResultsN[2]:PropOtherTDV   + RunResultsN[3]:PropOtherTDV   + RunResultsN[4]:PropOtherTDV   + RunResultsN[5]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[1]			= {	RunResultsN[1]:ProposedTDV[1]    + RunResultsN[2]:ProposedTDV[1]    + RunResultsN[3]:ProposedTDV[1]    + RunResultsN[4]:ProposedTDV[1]    + RunResultsN[5]:ProposedTDV[1]     }
	"Calculate Elec Demand  - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecDemand[1]		= {	RunResultsN[1]:PropElecDemand[1] + RunResultsN[2]:PropElecDemand[1] + RunResultsN[3]:PropElecDemand[1] + RunResultsN[4]:PropElecDemand[1] + RunResultsN[5]:PropElecDemand[1]  }

  ; Total
	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecTDV[1]			= {	RunResultsN[11]:PropElecTDV[1]    + RunResultsN[6]:PropElecTDV[1]    + RunResultsN[7]:PropElecTDV[1]    + RunResultsN[8]:PropElecTDV[1]    + RunResultsN[9]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - N-Total"		Proj:RunResultsN[10]:PropNatGasTDV		= {	RunResultsN[11]:PropNatGasTDV  + RunResultsN[6]:PropNatGasTDV  + RunResultsN[7]:PropNatGasTDV  + RunResultsN[8]:PropNatGasTDV  + RunResultsN[9]:PropNatGasTDV   }
	"Calculate TDV - Other  - N-Total"		Proj:RunResultsN[10]:PropOtherTDV		= {	RunResultsN[11]:PropOtherTDV   + RunResultsN[6]:PropOtherTDV   + RunResultsN[7]:PropOtherTDV   + RunResultsN[8]:PropOtherTDV   + RunResultsN[9]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedTDV[1]			= {	RunResultsN[11]:ProposedTDV[1]    + RunResultsN[6]:ProposedTDV[1]    + RunResultsN[7]:ProposedTDV[1]    + RunResultsN[8]:ProposedTDV[1]    + RunResultsN[9]:ProposedTDV[1]     }
	"Calculate Elec Demand  - N-Total"		Proj:RunResultsN[10]:PropElecDemand[1]		= {	RunResultsN[11]:PropElecDemand[1] + RunResultsN[6]:PropElecDemand[1] + RunResultsN[7]:PropElecDemand[1] + RunResultsN[8]:PropElecDemand[1] + RunResultsN[9]:PropElecDemand[1]  }
END

;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedTDVResults_E" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - E-SpcHt"		Proj:RunResultsE[1]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-SpcHt"		Proj:RunResultsE[1]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-SpcHt"		Proj:RunResultsE[1]:PropOtherTDV			= {	if (LocalRef( RunResultsE[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:ProposedTDV[1]			= {	LocalRef( RunResultsE[1]:PropElecTDV[1] ) + LocalRef( RunResultsE[1]:PropNatGasTDV ) + LocalRef( RunResultsE[1]:PropOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - E-SpcHt"		Proj:RunResultsE[1]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - E-SpcCl"		Proj:RunResultsE[2]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-SpcCl"		Proj:RunResultsE[2]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-SpcCl"		Proj:RunResultsE[2]:PropOtherTDV			= {	if (LocalRef( RunResultsE[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:ProposedTDV[1]			= {	LocalRef( RunResultsE[2]:PropElecTDV[1] ) + LocalRef( RunResultsE[2]:PropNatGasTDV ) + LocalRef( RunResultsE[2]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-SpcCl"		Proj:RunResultsE[2]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - E-IAQVent"	Proj:RunResultsE[3]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-IAQVent"	Proj:RunResultsE[3]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - E-IAQVent"	Proj:RunResultsE[3]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:ProposedTDV[1]			= {	LocalRef( RunResultsE[3]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - E-IAQVent"	Proj:RunResultsE[3]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:PropElecTDV[1]		= {	0  }  ; if (LocalRef( RunResultsE[4]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:PropNatGasTDV		= {	0  }  ; if (LocalRef( RunResultsE[4]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:PropOtherTDV			= {	0  }  ; if (LocalRef( RunResultsE[4]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:ProposedTDV[1]		= {	0  }  ; LocalRef( RunResultsE[4]:PropElecTDV[1] ) + LocalRef( RunResultsE[4]:PropNatGasTDV ) + LocalRef( RunResultsE[4]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-OthrHVAC"	Proj:RunResultsE[4]:PropElecDemand[1]	= {	0  }  ; if (LocalRef( RunResultsE[4]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / 3.412  endif  }

  ; Water Heating
	"Calculate TDV - Elec   - E-WtrHt"		Proj:RunResultsE[5]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-WtrHt"		Proj:RunResultsE[5]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-WtrHt"		Proj:RunResultsE[5]:PropOtherTDV			= {	if (LocalRef( RunResultsE[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:ProposedTDV[1]			= {	LocalRef( RunResultsE[5]:PropElecTDV[1] ) + LocalRef( RunResultsE[5]:PropNatGasTDV ) + LocalRef( RunResultsE[5]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-WtrHt"		Proj:RunResultsE[5]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / 3.412  endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - E-InsLtg"		Proj:RunResultsE[6]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-InsLtg"		Proj:RunResultsE[6]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-InsLtg"		Proj:RunResultsE[6]:PropOtherTDV			= {	if (LocalRef( RunResultsE[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:ProposedTDV[1]			= {	LocalRef( RunResultsE[6]:PropElecTDV[1] ) + LocalRef( RunResultsE[6]:PropNatGasTDV ) + LocalRef( RunResultsE[6]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-IndLtg"		Proj:RunResultsE[6]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - E-AppCkg"		Proj:RunResultsE[7]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-AppCkg"		Proj:RunResultsE[7]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-AppCkg"		Proj:RunResultsE[7]:PropOtherTDV			= {	if (LocalRef( RunResultsE[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:ProposedTDV[1]			= {	LocalRef( RunResultsE[7]:PropElecTDV[1] ) + LocalRef( RunResultsE[7]:PropNatGasTDV ) + LocalRef( RunResultsE[7]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-AppCkg"		Proj:RunResultsE[7]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - E-Plugs"		Proj:RunResultsE[8]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-Plugs"		Proj:RunResultsE[8]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-Plugs"		Proj:RunResultsE[8]:PropOtherTDV			= {	if (LocalRef( RunResultsE[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:ProposedTDV[1]			= {	LocalRef( RunResultsE[8]:PropElecTDV[1] ) + LocalRef( RunResultsE[8]:PropNatGasTDV ) + LocalRef( RunResultsE[8]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-Plugs"		Proj:RunResultsE[8]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - E-Ext"			Proj:RunResultsE[9]:PropElecTDV[1]			= {	if (LocalRef( RunResultsE[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-Ext"			Proj:RunResultsE[9]:PropNatGasTDV		= {	if (LocalRef( RunResultsE[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - E-Ext"			Proj:RunResultsE[9]:PropOtherTDV			= {	if (LocalRef( RunResultsE[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - E-Ext"			Proj:RunResultsE[9]:ProposedTDV[1]			= {	LocalRef( RunResultsE[9]:PropElecTDV[1] ) + LocalRef( RunResultsE[9]:PropNatGasTDV ) + LocalRef( RunResultsE[9]:PropOtherTDV )   }
	"Calculate Elec Demand  - E-Ext"			Proj:RunResultsE[9]:PropElecDemand[1]		= {	if (LocalRef( RunResultsE[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - E-PV"			Proj:RunResultsE[13]:PropElecTDV[1]		= {	if (LocalRef( RunResultsE[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "PVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "PV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - E-PV"			Proj:RunResultsE[13]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - E-PV"			Proj:RunResultsE[13]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - E-PV"			Proj:RunResultsE[13]:ProposedTDV[1]		= {	LocalRef( RunResultsE[13]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - E-PV"			Proj:RunResultsE[13]:PropElecDemand[1]	= {	if (LocalRef( RunResultsE[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec", "PV" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecTDV[1]			= {	RunResultsE[1]:PropElecTDV[1]    + RunResultsE[2]:PropElecTDV[1]    + RunResultsE[3]:PropElecTDV[1]    + RunResultsE[4]:PropElecTDV[1]    + RunResultsE[5]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:PropNatGasTDV		= {	RunResultsE[1]:PropNatGasTDV  + RunResultsE[2]:PropNatGasTDV  + RunResultsE[3]:PropNatGasTDV  + RunResultsE[4]:PropNatGasTDV  + RunResultsE[5]:PropNatGasTDV   }
	"Calculate TDV - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:PropOtherTDV		= {	RunResultsE[1]:PropOtherTDV   + RunResultsE[2]:PropOtherTDV   + RunResultsE[3]:PropOtherTDV   + RunResultsE[4]:PropOtherTDV   + RunResultsE[5]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[1]			= {	RunResultsE[1]:ProposedTDV[1]    + RunResultsE[2]:ProposedTDV[1]    + RunResultsE[3]:ProposedTDV[1]    + RunResultsE[4]:ProposedTDV[1]    + RunResultsE[5]:ProposedTDV[1]     }
	"Calculate Elec Demand  - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecDemand[1]		= {	RunResultsE[1]:PropElecDemand[1] + RunResultsE[2]:PropElecDemand[1] + RunResultsE[3]:PropElecDemand[1] + RunResultsE[4]:PropElecDemand[1] + RunResultsE[5]:PropElecDemand[1]  }

  ; Total
	"Calculate TDV - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecTDV[1]			= {	RunResultsE[11]:PropElecTDV[1]    + RunResultsE[6]:PropElecTDV[1]    + RunResultsE[7]:PropElecTDV[1]    + RunResultsE[8]:PropElecTDV[1]    + RunResultsE[9]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - E-Total"		Proj:RunResultsE[10]:PropNatGasTDV		= {	RunResultsE[11]:PropNatGasTDV  + RunResultsE[6]:PropNatGasTDV  + RunResultsE[7]:PropNatGasTDV  + RunResultsE[8]:PropNatGasTDV  + RunResultsE[9]:PropNatGasTDV   }
	"Calculate TDV - Other  - E-Total"		Proj:RunResultsE[10]:PropOtherTDV		= {	RunResultsE[11]:PropOtherTDV   + RunResultsE[6]:PropOtherTDV   + RunResultsE[7]:PropOtherTDV   + RunResultsE[8]:PropOtherTDV   + RunResultsE[9]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedTDV[1]			= {	RunResultsE[11]:ProposedTDV[1]    + RunResultsE[6]:ProposedTDV[1]    + RunResultsE[7]:ProposedTDV[1]    + RunResultsE[8]:ProposedTDV[1]    + RunResultsE[9]:ProposedTDV[1]     }
	"Calculate Elec Demand  - E-Total"		Proj:RunResultsE[10]:PropElecDemand[1]		= {	RunResultsE[11]:PropElecDemand[1] + RunResultsE[6]:PropElecDemand[1] + RunResultsE[7]:PropElecDemand[1] + RunResultsE[8]:PropElecDemand[1] + RunResultsE[9]:PropElecDemand[1]  }
END

;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedTDVResults_S" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - S-SpcHt"		Proj:RunResultsS[1]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-SpcHt"		Proj:RunResultsS[1]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-SpcHt"		Proj:RunResultsS[1]:PropOtherTDV			= {	if (LocalRef( RunResultsS[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:ProposedTDV[1]			= {	LocalRef( RunResultsS[1]:PropElecTDV[1] ) + LocalRef( RunResultsS[1]:PropNatGasTDV ) + LocalRef( RunResultsS[1]:PropOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - S-SpcHt"		Proj:RunResultsS[1]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - S-SpcCl"		Proj:RunResultsS[2]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-SpcCl"		Proj:RunResultsS[2]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-SpcCl"		Proj:RunResultsS[2]:PropOtherTDV			= {	if (LocalRef( RunResultsS[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:ProposedTDV[1]			= {	LocalRef( RunResultsS[2]:PropElecTDV[1] ) + LocalRef( RunResultsS[2]:PropNatGasTDV ) + LocalRef( RunResultsS[2]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-SpcCl"		Proj:RunResultsS[2]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - S-IAQVent"	Proj:RunResultsS[3]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-IAQVent"	Proj:RunResultsS[3]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - S-IAQVent"	Proj:RunResultsS[3]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:ProposedTDV[1]			= {	LocalRef( RunResultsS[3]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - S-IAQVent"	Proj:RunResultsS[3]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:PropElecTDV[1]		= {	0  }  ; if (LocalRef( RunResultsS[4]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:PropNatGasTDV		= {	0  }  ; if (LocalRef( RunResultsS[4]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:PropOtherTDV			= {	0  }  ; if (LocalRef( RunResultsS[4]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:ProposedTDV[1]		= {	0  }  ; LocalRef( RunResultsS[4]:PropElecTDV[1] ) + LocalRef( RunResultsS[4]:PropNatGasTDV ) + LocalRef( RunResultsS[4]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-OthrHVAC"	Proj:RunResultsS[4]:PropElecDemand[1]	= {	0  }  ; if (LocalRef( RunResultsS[4]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / 3.412  endif  }

  ; Water Heating
	"Calculate TDV - Elec   - S-WtrHt"		Proj:RunResultsS[5]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-WtrHt"		Proj:RunResultsS[5]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-WtrHt"		Proj:RunResultsS[5]:PropOtherTDV			= {	if (LocalRef( RunResultsS[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:ProposedTDV[1]			= {	LocalRef( RunResultsS[5]:PropElecTDV[1] ) + LocalRef( RunResultsS[5]:PropNatGasTDV ) + LocalRef( RunResultsS[5]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-WtrHt"		Proj:RunResultsS[5]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / 3.412  endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - S-InsLtg"		Proj:RunResultsS[6]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-InsLtg"		Proj:RunResultsS[6]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-InsLtg"		Proj:RunResultsS[6]:PropOtherTDV			= {	if (LocalRef( RunResultsS[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:ProposedTDV[1]			= {	LocalRef( RunResultsS[6]:PropElecTDV[1] ) + LocalRef( RunResultsS[6]:PropNatGasTDV ) + LocalRef( RunResultsS[6]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-IndLtg"		Proj:RunResultsS[6]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - S-AppCkg"		Proj:RunResultsS[7]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-AppCkg"		Proj:RunResultsS[7]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-AppCkg"		Proj:RunResultsS[7]:PropOtherTDV			= {	if (LocalRef( RunResultsS[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:ProposedTDV[1]			= {	LocalRef( RunResultsS[7]:PropElecTDV[1] ) + LocalRef( RunResultsS[7]:PropNatGasTDV ) + LocalRef( RunResultsS[7]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-AppCkg"		Proj:RunResultsS[7]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - S-Plugs"		Proj:RunResultsS[8]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-Plugs"		Proj:RunResultsS[8]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-Plugs"		Proj:RunResultsS[8]:PropOtherTDV			= {	if (LocalRef( RunResultsS[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:ProposedTDV[1]			= {	LocalRef( RunResultsS[8]:PropElecTDV[1] ) + LocalRef( RunResultsS[8]:PropNatGasTDV ) + LocalRef( RunResultsS[8]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-Plugs"		Proj:RunResultsS[8]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - S-Ext"			Proj:RunResultsS[9]:PropElecTDV[1]			= {	if (LocalRef( RunResultsS[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-Ext"			Proj:RunResultsS[9]:PropNatGasTDV		= {	if (LocalRef( RunResultsS[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - S-Ext"			Proj:RunResultsS[9]:PropOtherTDV			= {	if (LocalRef( RunResultsS[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - S-Ext"			Proj:RunResultsS[9]:ProposedTDV[1]			= {	LocalRef( RunResultsS[9]:PropElecTDV[1] ) + LocalRef( RunResultsS[9]:PropNatGasTDV ) + LocalRef( RunResultsS[9]:PropOtherTDV )   }
	"Calculate Elec Demand  - S-Ext"			Proj:RunResultsS[9]:PropElecDemand[1]		= {	if (LocalRef( RunResultsS[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - S-PV"			Proj:RunResultsS[13]:PropElecTDV[1]		= {	if (LocalRef( RunResultsS[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "PVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "PV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - S-PV"			Proj:RunResultsS[13]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - S-PV"			Proj:RunResultsS[13]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - S-PV"			Proj:RunResultsS[13]:ProposedTDV[1]		= {	LocalRef( RunResultsS[13]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - S-PV"			Proj:RunResultsS[13]:PropElecDemand[1]	= {	if (LocalRef( RunResultsS[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec", "PV" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecTDV[1]			= {	RunResultsS[1]:PropElecTDV[1]    + RunResultsS[2]:PropElecTDV[1]    + RunResultsS[3]:PropElecTDV[1]    + RunResultsS[4]:PropElecTDV[1]    + RunResultsS[5]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:PropNatGasTDV		= {	RunResultsS[1]:PropNatGasTDV  + RunResultsS[2]:PropNatGasTDV  + RunResultsS[3]:PropNatGasTDV  + RunResultsS[4]:PropNatGasTDV  + RunResultsS[5]:PropNatGasTDV   }
	"Calculate TDV - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:PropOtherTDV		= {	RunResultsS[1]:PropOtherTDV   + RunResultsS[2]:PropOtherTDV   + RunResultsS[3]:PropOtherTDV   + RunResultsS[4]:PropOtherTDV   + RunResultsS[5]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[1]			= {	RunResultsS[1]:ProposedTDV[1]    + RunResultsS[2]:ProposedTDV[1]    + RunResultsS[3]:ProposedTDV[1]    + RunResultsS[4]:ProposedTDV[1]    + RunResultsS[5]:ProposedTDV[1]     }
	"Calculate Elec Demand  - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecDemand[1]		= {	RunResultsS[1]:PropElecDemand[1] + RunResultsS[2]:PropElecDemand[1] + RunResultsS[3]:PropElecDemand[1] + RunResultsS[4]:PropElecDemand[1] + RunResultsS[5]:PropElecDemand[1]  }

  ; Total
	"Calculate TDV - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecTDV[1]			= {	RunResultsS[11]:PropElecTDV[1]    + RunResultsS[6]:PropElecTDV[1]    + RunResultsS[7]:PropElecTDV[1]    + RunResultsS[8]:PropElecTDV[1]    + RunResultsS[9]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - S-Total"		Proj:RunResultsS[10]:PropNatGasTDV		= {	RunResultsS[11]:PropNatGasTDV  + RunResultsS[6]:PropNatGasTDV  + RunResultsS[7]:PropNatGasTDV  + RunResultsS[8]:PropNatGasTDV  + RunResultsS[9]:PropNatGasTDV   }
	"Calculate TDV - Other  - S-Total"		Proj:RunResultsS[10]:PropOtherTDV		= {	RunResultsS[11]:PropOtherTDV   + RunResultsS[6]:PropOtherTDV   + RunResultsS[7]:PropOtherTDV   + RunResultsS[8]:PropOtherTDV   + RunResultsS[9]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedTDV[1]			= {	RunResultsS[11]:ProposedTDV[1]    + RunResultsS[6]:ProposedTDV[1]    + RunResultsS[7]:ProposedTDV[1]    + RunResultsS[8]:ProposedTDV[1]    + RunResultsS[9]:ProposedTDV[1]     }
	"Calculate Elec Demand  - S-Total"		Proj:RunResultsS[10]:PropElecDemand[1]		= {	RunResultsS[11]:PropElecDemand[1] + RunResultsS[6]:PropElecDemand[1] + RunResultsS[7]:PropElecDemand[1] + RunResultsS[8]:PropElecDemand[1] + RunResultsS[9]:PropElecDemand[1]  }
END

;*************************************************************************  - SAC 6/25/13
RULELIST "CARes_ProposedTDVResults_W" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - W-SpcHt"		Proj:RunResultsW[1]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-SpcHt"		Proj:RunResultsW[1]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[1]:PropNatGasEnergy[1]	) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-SpcHt"		Proj:RunResultsW[1]:PropOtherTDV			= {	if (LocalRef( RunResultsW[1]:PropOtherEnergy[1]		) < 0.0001) then  0                                                                                                     
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:ProposedTDV[1]			= {	LocalRef( RunResultsW[1]:PropElecTDV[1] ) + LocalRef( RunResultsW[1]:PropNatGasTDV ) + LocalRef( RunResultsW[1]:PropOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - W-SpcHt"		Proj:RunResultsW[1]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[1]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - W-SpcCl"		Proj:RunResultsW[2]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-SpcCl"		Proj:RunResultsW[2]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[2]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-SpcCl"		Proj:RunResultsW[2]:PropOtherTDV			= {	if (LocalRef( RunResultsW[2]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:ProposedTDV[1]			= {	LocalRef( RunResultsW[2]:PropElecTDV[1] ) + LocalRef( RunResultsW[2]:PropNatGasTDV ) + LocalRef( RunResultsW[2]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-SpcCl"		Proj:RunResultsW[2]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[2]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - W-IAQVent"	Proj:RunResultsW[3]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-IAQVent"	Proj:RunResultsW[3]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - W-IAQVent"	Proj:RunResultsW[3]:PropOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:ProposedTDV[1]			= {	LocalRef( RunResultsW[3]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - W-IAQVent"	Proj:RunResultsW[3]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[3]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "FanV" ) / 3.412  endif  }		; SAC 7/14/16 - fixed bug here - was same as Htg demand!

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecTDV[1]		= {	0  }  ; if (LocalRef( RunResultsW[4]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:PropNatGasTDV		= {	0  }  ; if (LocalRef( RunResultsW[4]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:PropOtherTDV			= {	0  }  ; if (LocalRef( RunResultsW[4]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:ProposedTDV[1]		= {	0  }  ; LocalRef( RunResultsW[4]:PropElecTDV[1] ) + LocalRef( RunResultsW[4]:PropNatGasTDV ) + LocalRef( RunResultsW[4]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-OthrHVAC"	Proj:RunResultsW[4]:PropElecDemand[1]	= {	0  }  ; if (LocalRef( RunResultsW[4]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							      ; else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / 3.412  endif  }

  ; Water Heating
	"Calculate TDV - Elec   - W-WtrHt"		Proj:RunResultsW[5]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-WtrHt"		Proj:RunResultsW[5]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[5]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-WtrHt"		Proj:RunResultsW[5]:PropOtherTDV			= {	if (LocalRef( RunResultsW[5]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:ProposedTDV[1]			= {	LocalRef( RunResultsW[5]:PropElecTDV[1] ) + LocalRef( RunResultsW[5]:PropNatGasTDV ) + LocalRef( RunResultsW[5]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-WtrHt"		Proj:RunResultsW[5]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[5]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / 3.412  endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - W-InsLtg"		Proj:RunResultsW[6]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-InsLtg"		Proj:RunResultsW[6]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[6]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-InsLtg"		Proj:RunResultsW[6]:PropOtherTDV			= {	if (LocalRef( RunResultsW[6]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:ProposedTDV[1]			= {	LocalRef( RunResultsW[6]:PropElecTDV[1] ) + LocalRef( RunResultsW[6]:PropNatGasTDV ) + LocalRef( RunResultsW[6]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-InsLtg"		Proj:RunResultsW[6]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[6]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - W-AppCkg"		Proj:RunResultsW[7]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-AppCkg"		Proj:RunResultsW[7]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[7]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-AppCkg"		Proj:RunResultsW[7]:PropOtherTDV			= {	if (LocalRef( RunResultsW[7]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:ProposedTDV[1]			= {	LocalRef( RunResultsW[7]:PropElecTDV[1] ) + LocalRef( RunResultsW[7]:PropNatGasTDV ) + LocalRef( RunResultsW[7]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-AppCkg"		Proj:RunResultsW[7]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[7]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - W-Plugs"		Proj:RunResultsW[8]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-Plugs"		Proj:RunResultsW[8]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[8]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-Plugs"		Proj:RunResultsW[8]:PropOtherTDV			= {	if (LocalRef( RunResultsW[8]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:ProposedTDV[1]			= {	LocalRef( RunResultsW[8]:PropElecTDV[1] ) + LocalRef( RunResultsW[8]:PropNatGasTDV ) + LocalRef( RunResultsW[8]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-Plugs"		Proj:RunResultsW[8]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[8]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - W-Ext"			Proj:RunResultsW[9]:PropElecTDV[1]			= {	if (LocalRef( RunResultsW[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-Ext"			Proj:RunResultsW[9]:PropNatGasTDV		= {	if (LocalRef( RunResultsW[9]:PropNatGasEnergy[1]	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - W-Ext"			Proj:RunResultsW[9]:PropOtherTDV			= {	if (LocalRef( RunResultsW[9]:PropOtherEnergy[1]		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - W-Ext"			Proj:RunResultsW[9]:ProposedTDV[1]			= {	LocalRef( RunResultsW[9]:PropElecTDV[1] ) + LocalRef( RunResultsW[9]:PropNatGasTDV ) + LocalRef( RunResultsW[9]:PropOtherTDV )   }
	"Calculate Elec Demand  - W-Ext"			Proj:RunResultsW[9]:PropElecDemand[1]		= {	if (LocalRef( RunResultsW[9]:PropElecEnergy[1]		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - W-PV"			Proj:RunResultsW[13]:PropElecTDV[1]		= {	if (LocalRef( RunResultsW[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "PVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "PV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - W-PV"			Proj:RunResultsW[13]:PropNatGasTDV		= {	0  }
	"Calculate TDV - Other  - W-PV"			Proj:RunResultsW[13]:PropOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - W-PV"			Proj:RunResultsW[13]:ProposedTDV[1]		= {	LocalRef( RunResultsW[13]:PropElecTDV[1] )   }
	"Calculate Elec Demand  - W-PV"			Proj:RunResultsW[13]:PropElecDemand[1]	= {	if (LocalRef( RunResultsW[13]:PropElecEnergy[1]		) > -0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec", "PV" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecTDV[1]			= {	RunResultsW[1]:PropElecTDV[1]    + RunResultsW[2]:PropElecTDV[1]    + RunResultsW[3]:PropElecTDV[1]    + RunResultsW[4]:PropElecTDV[1]    + RunResultsW[5]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:PropNatGasTDV		= {	RunResultsW[1]:PropNatGasTDV  + RunResultsW[2]:PropNatGasTDV  + RunResultsW[3]:PropNatGasTDV  + RunResultsW[4]:PropNatGasTDV  + RunResultsW[5]:PropNatGasTDV   }
	"Calculate TDV - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:PropOtherTDV		= {	RunResultsW[1]:PropOtherTDV   + RunResultsW[2]:PropOtherTDV   + RunResultsW[3]:PropOtherTDV   + RunResultsW[4]:PropOtherTDV   + RunResultsW[5]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[1]			= {	RunResultsW[1]:ProposedTDV[1]    + RunResultsW[2]:ProposedTDV[1]    + RunResultsW[3]:ProposedTDV[1]    + RunResultsW[4]:ProposedTDV[1]    + RunResultsW[5]:ProposedTDV[1]     }
	"Calculate Elec Demand  - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecDemand[1]		= {	RunResultsW[1]:PropElecDemand[1] + RunResultsW[2]:PropElecDemand[1] + RunResultsW[3]:PropElecDemand[1] + RunResultsW[4]:PropElecDemand[1] + RunResultsW[5]:PropElecDemand[1]  }

  ; Total
	"Calculate TDV - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecTDV[1]			= {	RunResultsW[11]:PropElecTDV[1]    + RunResultsW[6]:PropElecTDV[1]    + RunResultsW[7]:PropElecTDV[1]    + RunResultsW[8]:PropElecTDV[1]    + RunResultsW[9]:PropElecTDV[1]     }
	"Calculate TDV - NatGas - W-Total"		Proj:RunResultsW[10]:PropNatGasTDV		= {	RunResultsW[11]:PropNatGasTDV  + RunResultsW[6]:PropNatGasTDV  + RunResultsW[7]:PropNatGasTDV  + RunResultsW[8]:PropNatGasTDV  + RunResultsW[9]:PropNatGasTDV   }
	"Calculate TDV - Other  - W-Total"		Proj:RunResultsW[10]:PropOtherTDV		= {	RunResultsW[11]:PropOtherTDV   + RunResultsW[6]:PropOtherTDV   + RunResultsW[7]:PropOtherTDV   + RunResultsW[8]:PropOtherTDV   + RunResultsW[9]:PropOtherTDV    }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedTDV[1]			= {	RunResultsW[11]:ProposedTDV[1]    + RunResultsW[6]:ProposedTDV[1]    + RunResultsW[7]:ProposedTDV[1]    + RunResultsW[8]:ProposedTDV[1]    + RunResultsW[9]:ProposedTDV[1]     }
	"Calculate Elec Demand  - W-Total"		Proj:RunResultsW[10]:PropElecDemand[1]		= {	RunResultsW[11]:PropElecDemand[1] + RunResultsW[6]:PropElecDemand[1] + RunResultsW[7]:PropElecDemand[1] + RunResultsW[8]:PropElecDemand[1] + RunResultsW[9]:PropElecDemand[1]  }
END


;*************************************************************************
RULELIST "CARes_DRtgPropMultTDVResults" 1 0 0 1
;*************************************************************************
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
	"Calculate TDV - TOTAL  - SpcHt"			Proj:RunResults[1]:ProposedTDV[3]			= {	LocalRef( RunResults[1]:PropElecTDV[1] ) + LocalRef( RunResults[1]:PropNatGasTDV ) + LocalRef( RunResults[1]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - SpcHt"			Proj:RunResults[1]:ProposedTDV[3]			= {	LocalRef( RunResults[1]:PropElecTDV[1] ) + ((LocalRef( RunResults[1]:PropNatGasTDV ) + LocalRef( RunResults[1]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - SpcCl"			Proj:RunResults[2]:ProposedTDV[3]			= {	LocalRef( RunResults[2]:PropElecTDV[1] ) + LocalRef( RunResults[2]:PropNatGasTDV ) + LocalRef( RunResults[2]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - SpcCl"			Proj:RunResults[2]:ProposedTDV[3]			= {	LocalRef( RunResults[2]:PropElecTDV[1] ) + ((LocalRef( RunResults[2]:PropNatGasTDV ) + LocalRef( RunResults[2]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - IAQVent"		Proj:RunResults[3]:ProposedTDV[3]			= {	LocalRef( RunResults[3]:PropElecTDV[1] )   }
	"Calculate TDV - TOTAL  - OthrHVAC"		Proj:RunResults[4]:ProposedTDV[3]			= {	RunResults[4]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - WtrHt"			Proj:RunResults[5]:ProposedTDV[3]			= {	LocalRef( RunResults[5]:PropElecTDV[1] ) + LocalRef( RunResults[5]:PropNatGasTDV ) + LocalRef( RunResults[5]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - WtrHt"			Proj:RunResults[5]:ProposedTDV[3]			= {	LocalRef( RunResults[5]:PropElecTDV[1] ) + ((LocalRef( RunResults[5]:PropNatGasTDV ) + LocalRef( RunResults[5]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  }
	"Calculate TDV - TOTAL  - InsLtg"		Proj:RunResults[6]:ProposedTDV[3]			= {	RunResults[6]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - AppCkg"		Proj:RunResults[7]:ProposedTDV[3]			= {	LocalRef( RunResults[7]:PropElecTDV[1] ) + LocalRef( RunResults[7]:PropNatGasTDV ) + LocalRef( RunResults[7]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - AppCkg"		Proj:RunResults[7]:ProposedTDV[3]			= {	LocalRef( RunResults[7]:PropElecTDV[1] ) + ((LocalRef( RunResults[7]:PropNatGasTDV ) + LocalRef( RunResults[7]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - Plugs"			Proj:RunResults[8]:ProposedTDV[3]			= {	RunResults[8]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - Ext"			Proj:RunResults[9]:ProposedTDV[3]			= {	RunResults[9]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - PV"				Proj:RunResults[13]:ProposedTDV[3]			= {	RunResults[13]:ProposedTDV[1]   }

	"Calculate TDV - TOTAL  - Comp Ttl"		Proj:RunResults[11]:ProposedTDV[3]			= {	RunResults[1]:ProposedTDV[3]    + RunResults[2]:ProposedTDV[3]    + RunResults[3]:ProposedTDV[3]    + RunResults[4]:ProposedTDV[3]    + RunResults[5]:ProposedTDV[3]     }
	"Calculate TDV - TOTAL  - Total"			Proj:RunResults[10]:ProposedTDV[3]			= {	RunResults[11]:ProposedTDV[3]   + RunResults[6]:ProposedTDV[3]    + RunResults[7]:ProposedTDV[3]    + RunResults[8]:ProposedTDV[3]    + RunResults[9]:ProposedTDV[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultTDVResults_N" 1 0 0 1
;*************************************************************************
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:ProposedTDV[3]			= {	LocalRef( RunResultsN[1]:PropElecTDV[1] ) + LocalRef( RunResultsN[1]:PropNatGasTDV ) + LocalRef( RunResultsN[1]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:ProposedTDV[3]			= {	LocalRef( RunResultsN[1]:PropElecTDV[1] ) + ((LocalRef( RunResultsN[1]:PropNatGasTDV ) + LocalRef( RunResultsN[1]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:ProposedTDV[3]			= {	LocalRef( RunResultsN[2]:PropElecTDV[1] ) + LocalRef( RunResultsN[2]:PropNatGasTDV ) + LocalRef( RunResultsN[2]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:ProposedTDV[3]			= {	LocalRef( RunResultsN[2]:PropElecTDV[1] ) + ((LocalRef( RunResultsN[2]:PropNatGasTDV ) + LocalRef( RunResultsN[2]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:ProposedTDV[3]			= {	LocalRef( RunResultsN[3]:PropElecTDV[1] )   }
	"Calculate TDV - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:ProposedTDV[3]			= {	RunResultsN[4]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:ProposedTDV[3]			= {	LocalRef( RunResultsN[5]:PropElecTDV[1] ) + LocalRef( RunResultsN[5]:PropNatGasTDV ) + LocalRef( RunResultsN[5]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:ProposedTDV[3]			= {	LocalRef( RunResultsN[5]:PropElecTDV[1] ) + ((LocalRef( RunResultsN[5]:PropNatGasTDV ) + LocalRef( RunResultsN[5]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  }
	"Calculate TDV - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:ProposedTDV[3]			= {	RunResultsN[6]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:ProposedTDV[3]			= {	LocalRef( RunResultsN[7]:PropElecTDV[1] ) + LocalRef( RunResultsN[7]:PropNatGasTDV ) + LocalRef( RunResultsN[7]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:ProposedTDV[3]			= {	LocalRef( RunResultsN[7]:PropElecTDV[1] ) + ((LocalRef( RunResultsN[7]:PropNatGasTDV ) + LocalRef( RunResultsN[7]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:ProposedTDV[3]			= {	RunResultsN[8]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - N-Ext"			Proj:RunResultsN[9]:ProposedTDV[3]			= {	RunResultsN[9]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - N-PV"			Proj:RunResultsN[13]:ProposedTDV[3]			= {	RunResultsN[13]:ProposedTDV[1]   }

	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[3]			= {	RunResultsN[1]:ProposedTDV[3]    + RunResultsN[2]:ProposedTDV[3]    + RunResultsN[3]:ProposedTDV[3]    + RunResultsN[4]:ProposedTDV[3]    + RunResultsN[5]:ProposedTDV[3]     }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedTDV[3]			= {	RunResultsN[11]:ProposedTDV[3]    + RunResultsN[6]:ProposedTDV[3]    + RunResultsN[7]:ProposedTDV[3]    + RunResultsN[8]:ProposedTDV[3]    + RunResultsN[9]:ProposedTDV[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultTDVResults_E" 1 0 0 1
;*************************************************************************
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:ProposedTDV[3]			= {	LocalRef( RunResultsE[1]:PropElecTDV[1] ) + LocalRef( RunResultsE[1]:PropNatGasTDV ) + LocalRef( RunResultsE[1]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:ProposedTDV[3]			= {	LocalRef( RunResultsE[1]:PropElecTDV[1] ) + ((LocalRef( RunResultsE[1]:PropNatGasTDV ) + LocalRef( RunResultsE[1]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:ProposedTDV[3]			= {	LocalRef( RunResultsE[2]:PropElecTDV[1] ) + LocalRef( RunResultsE[2]:PropNatGasTDV ) + LocalRef( RunResultsE[2]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:ProposedTDV[3]			= {	LocalRef( RunResultsE[2]:PropElecTDV[1] ) + ((LocalRef( RunResultsE[2]:PropNatGasTDV ) + LocalRef( RunResultsE[2]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:ProposedTDV[3]			= {	LocalRef( RunResultsE[3]:PropElecTDV[1] )   }
	"Calculate TDV - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:ProposedTDV[3]			= {	RunResultsE[4]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:ProposedTDV[3]			= {	LocalRef( RunResultsE[5]:PropElecTDV[1] ) + LocalRef( RunResultsE[5]:PropNatGasTDV ) + LocalRef( RunResultsE[5]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:ProposedTDV[3]			= {	LocalRef( RunResultsE[5]:PropElecTDV[1] ) + ((LocalRef( RunResultsE[5]:PropNatGasTDV ) + LocalRef( RunResultsE[5]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  }
	"Calculate TDV - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:ProposedTDV[3]			= {	RunResultsE[6]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:ProposedTDV[3]			= {	LocalRef( RunResultsE[7]:PropElecTDV[1] ) + LocalRef( RunResultsE[7]:PropNatGasTDV ) + LocalRef( RunResultsE[7]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:ProposedTDV[3]			= {	LocalRef( RunResultsE[7]:PropElecTDV[1] ) + ((LocalRef( RunResultsE[7]:PropNatGasTDV ) + LocalRef( RunResultsE[7]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:ProposedTDV[3]			= {	RunResultsE[8]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - E-Ext"			Proj:RunResultsE[9]:ProposedTDV[3]			= {	RunResultsE[9]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - E-PV"			Proj:RunResultsE[13]:ProposedTDV[3]			= {	RunResultsE[13]:ProposedTDV[1]   }

	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[3]			= {	RunResultsE[1]:ProposedTDV[3]    + RunResultsE[2]:ProposedTDV[3]    + RunResultsE[3]:ProposedTDV[3]    + RunResultsE[4]:ProposedTDV[3]    + RunResultsE[5]:ProposedTDV[3]     }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedTDV[3]			= {	RunResultsE[11]:ProposedTDV[3]    + RunResultsE[6]:ProposedTDV[3]    + RunResultsE[7]:ProposedTDV[3]    + RunResultsE[8]:ProposedTDV[3]    + RunResultsE[9]:ProposedTDV[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultTDVResults_S" 1 0 0 1
;*************************************************************************
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:ProposedTDV[3]			= {	LocalRef( RunResultsS[1]:PropElecTDV[1] ) + LocalRef( RunResultsS[1]:PropNatGasTDV ) + LocalRef( RunResultsS[1]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:ProposedTDV[3]			= {	LocalRef( RunResultsS[1]:PropElecTDV[1] ) + ((LocalRef( RunResultsS[1]:PropNatGasTDV ) + LocalRef( RunResultsS[1]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:ProposedTDV[3]			= {	LocalRef( RunResultsS[2]:PropElecTDV[1] ) + LocalRef( RunResultsS[2]:PropNatGasTDV ) + LocalRef( RunResultsS[2]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:ProposedTDV[3]			= {	LocalRef( RunResultsS[2]:PropElecTDV[1] ) + ((LocalRef( RunResultsS[2]:PropNatGasTDV ) + LocalRef( RunResultsS[2]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:ProposedTDV[3]			= {	LocalRef( RunResultsS[3]:PropElecTDV[1] )   }
	"Calculate TDV - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:ProposedTDV[3]			= {	RunResultsS[4]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:ProposedTDV[3]			= {	LocalRef( RunResultsS[5]:PropElecTDV[1] ) + LocalRef( RunResultsS[5]:PropNatGasTDV ) + LocalRef( RunResultsS[5]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:ProposedTDV[3]			= {	LocalRef( RunResultsS[5]:PropElecTDV[1] ) + ((LocalRef( RunResultsS[5]:PropNatGasTDV ) + LocalRef( RunResultsS[5]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  }
	"Calculate TDV - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:ProposedTDV[3]			= {	RunResultsS[6]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:ProposedTDV[3]			= {	LocalRef( RunResultsS[7]:PropElecTDV[1] ) + LocalRef( RunResultsS[7]:PropNatGasTDV ) + LocalRef( RunResultsS[7]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:ProposedTDV[3]			= {	LocalRef( RunResultsS[7]:PropElecTDV[1] ) + ((LocalRef( RunResultsS[7]:PropNatGasTDV ) + LocalRef( RunResultsS[7]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:ProposedTDV[3]			= {	RunResultsS[8]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - S-Ext"			Proj:RunResultsS[9]:ProposedTDV[3]			= {	RunResultsS[9]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - S-PV"			Proj:RunResultsS[13]:ProposedTDV[3]			= {	RunResultsS[13]:ProposedTDV[1]   }

	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[3]			= {	RunResultsS[1]:ProposedTDV[3]    + RunResultsS[2]:ProposedTDV[3]    + RunResultsS[3]:ProposedTDV[3]    + RunResultsS[4]:ProposedTDV[3]    + RunResultsS[5]:ProposedTDV[3]     }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedTDV[3]			= {	RunResultsS[11]:ProposedTDV[3]    + RunResultsS[6]:ProposedTDV[3]    + RunResultsS[7]:ProposedTDV[3]    + RunResultsS[8]:ProposedTDV[3]    + RunResultsS[9]:ProposedTDV[3]     }
END

;*************************************************************************  - SAC 3/14/16
RULELIST "CARes_DRtgPropMultTDVResults_W" 1 0 0 1
;*************************************************************************
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:ProposedTDV[3]			= {	LocalRef( RunResultsW[1]:PropElecTDV[1] ) + LocalRef( RunResultsW[1]:PropNatGasTDV ) + LocalRef( RunResultsW[1]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:ProposedTDV[3]			= {	LocalRef( RunResultsW[1]:PropElecTDV[1] ) + ((LocalRef( RunResultsW[1]:PropNatGasTDV ) + LocalRef( RunResultsW[1]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:ProposedTDV[3]			= {	LocalRef( RunResultsW[2]:PropElecTDV[1] ) + LocalRef( RunResultsW[2]:PropNatGasTDV ) + LocalRef( RunResultsW[2]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:ProposedTDV[3]			= {	LocalRef( RunResultsW[2]:PropElecTDV[1] ) + ((LocalRef( RunResultsW[2]:PropNatGasTDV ) + LocalRef( RunResultsW[2]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:ProposedTDV[3]			= {	LocalRef( RunResultsW[3]:PropElecTDV[1] )   }
	"Calculate TDV - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:ProposedTDV[3]			= {	RunResultsW[4]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:ProposedTDV[3]			= {	LocalRef( RunResultsW[5]:PropElecTDV[1] ) + LocalRef( RunResultsW[5]:PropNatGasTDV ) + LocalRef( RunResultsW[5]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:ProposedTDV[3]			= {	LocalRef( RunResultsW[5]:PropElecTDV[1] ) + ((LocalRef( RunResultsW[5]:PropNatGasTDV ) + LocalRef( RunResultsW[5]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  }
	"Calculate TDV - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:ProposedTDV[3]			= {	RunResultsW[6]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:ProposedTDV[3]			= {	LocalRef( RunResultsW[7]:PropElecTDV[1] ) + LocalRef( RunResultsW[7]:PropNatGasTDV ) + LocalRef( RunResultsW[7]:PropOtherTDV )  }
;	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:ProposedTDV[3]			= {	LocalRef( RunResultsW[7]:PropElecTDV[1] ) + ((LocalRef( RunResultsW[7]:PropNatGasTDV ) + LocalRef( RunResultsW[7]:PropOtherTDV )) *
;																																													CAClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))   }
	"Calculate TDV - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:ProposedTDV[3]			= {	RunResultsW[8]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - W-Ext"			Proj:RunResultsW[9]:ProposedTDV[3]			= {	RunResultsW[9]:ProposedTDV[1]  }
	"Calculate TDV - TOTAL  - W-PV"			Proj:RunResultsW[13]:ProposedTDV[3]			= {	RunResultsW[13]:ProposedTDV[1]   }

	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[3]			= {	RunResultsW[1]:ProposedTDV[3]    + RunResultsW[2]:ProposedTDV[3]    + RunResultsW[3]:ProposedTDV[3]    + RunResultsW[4]:ProposedTDV[3]    + RunResultsW[5]:ProposedTDV[3]     }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedTDV[3]			= {	RunResultsW[11]:ProposedTDV[3]    + RunResultsW[6]:ProposedTDV[3]    + RunResultsW[7]:ProposedTDV[3]    + RunResultsW[8]:ProposedTDV[3]    + RunResultsW[9]:ProposedTDV[3]     }
END


;*************************************************************************
RULELIST "CARes_CalculatePVCredit_2013Compliance" 1 0 0 1
;*************************************************************************
;	mjb	added check on StandardsVersion for finalizing PV credit	9/23/13
	"Set Proj:PVPrelimCredit based on Std design Cool TDV * MaxPVPrelimCredit"
			Proj:PVPrelimCredit	= {	ApplyHourlyResultMultipliers( "ClgPVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec", "Clg", "FanC") * (MaxPVPrelimCredit / 100)  }

;  "debug PV credit"		Proj:Action = { PostWarning( "debug PV credit  MaxPVPrelimCredit: %g  PVPrelimCredit: %g",  MaxPVPrelimCredit, PVPrelimCredit )  }
	"Set Proj:PVCredit[1] (min of PVGenCredit & PVPrelimCredit) - Comp analysis"	Proj:PVCredit[1]	= {	int( (100 * min( PVGenCredit, PVPrelimCredit ) / CondFloorArea) + 0.5) / 100  }
;  "debug PV credit 2"		Proj:Action = { PostWarning( "debug 2013 PV credit 2  PVGenCredit: %g  PVCredit: %g  --  in rulelist: CARes_CalculatePVCredit_2013Compliance",  PVGenCredit, PVCredit )  }
END

;*************************************************************************
RULELIST "CARes_CalculatePVCredit_2016Compliance" 1 0 0 1
;*************************************************************************
;	mjb	added check on StandardsVersion for finalizing PV credit	9/23/13
	"Set Proj:PVPrelimCredit based on Std design Cool TDV * MaxPVPrelimCredit"
			Proj:PVPrelimCredit	= {	PVBaseTDV * (MaxPVPrelimCredit / 100)  }

;  "debug PV credit"		Proj:Action = { PostWarning( "debug PV credit  MaxPVPrelimCredit: %g  PVPrelimCredit: %g",  MaxPVPrelimCredit, PVPrelimCredit )  }
	"Set Proj:PVCredit[1] (min of PVGenCredit & PVPrelimCredit) - Comp analysis"	Proj:PVCredit[1]	= {	int( (100 * PVPrelimCredit / CondFloorArea) + 0.5) / 100  }
;  "debug PV credit 2"		Proj:Action = { PostWarning( "debug 2016 PV credit 2  PVGenCredit: %g  PVCredit: %g  --  in rulelist: CARes_CalculatePVCredit_2016Compliance",  PVGenCredit, PVCredit )  }

	; SAC 4/2/15 - adjust Proj:PVMinRatedPower based in part on final PVCredit for T-24 2016 - and if entered PVRatedPower insufficient, then zero out PVCredit
	"Set Proj:PVMinRatedPower[2]"		Proj:PVMinRatedPower[2]	= {	if (IfValidAnd( PVDwellUnitSize > PVDUSizeThreshold ))
																						then  PVMinRatedPower[1] + (PVCredit[1] * ValidOr( NumDwellingUnits, 1 ) * (PVDwellUnitSize - PVDUSizeThreshold) / ValidOr( PVGenerationRate, 1 ))
																						else	0  endif  }
	"Round Proj:PVMinRatedPower[2]"	Proj:PVMinRatedPower[2]	= {	if (PVMinRatedPower[2] > 0) then  int( (PVMinRatedPower[2] * 10) + 0.5 ) / 10    else  UNCHANGED  endif  }
	"Zero out PVCredit if PVRatedPower too low - Comp analysis"		Proj:Action	= {	if (PVCredit[1] > 0 .AND. PVMinRatedPower[2] > 0 .AND. IfValidAnd(PVRatedPower < PVMinRatedPower[2]))
																												then	EvalRulelist( "CARes_ZeroOutCompPVCredit_InsufficientPVRatedPower" )
																												else  UNCHANGED  endif  }
  ; SAC 3/3/16 - add new PV message when PVCompCredit selected but no PVRatedPower input (tic #609)
	"Store message to document minimum PV system power to qualify for PV compliance credit"
		Proj:CompResultsMsg	= {	if (PVCompCredit > 0 .AND. PVCredit[1] > 0)
											then	if (IfValidAnd( ResultSummary[1]:PVMinRatedPower > 0 ))
													then	Format( "Required minimum PV system size is %.1f kWdc.", ResultSummary[1]:PVMinRatedPower )
													else if (IfValidAnd( PVMinRatedPower[2] > 0 ))
													then	Format( "Required minimum PV system size is %.1f kWdc.", PVMinRatedPower[2] )
													else	UNCHANGED  endif endif
											else	UNCHANGED  endif  }

	; SAC 3/24/16 - REWRITE SpeclFeatrs:PVSysCreditMsg based on the final PV minimum or installed size (requested by KN 3/22/16)
	"Write PV Capacity Msg" 	Proj:SpeclFeatrs:PVSysCreditMsg = {
											if (PVCompCredit > 0 .AND. PVCredit[1] > 0)
											then	if (IfValidAnd( AllowDesignRating > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs > 0.5 ) .AND. IfValidAnd( PVWDCSysTotal >= PVMinRatedPower[2] ))
													then	"PV System: " + FltToStr( PVWDCSysTotal, 1, 0, 3 ) + " kWdc"
													else if (IfValidAnd( ResultSummary[1]:PVMinRatedPower > 0 ))
													then	Format( "PV System: %.1f kWdc", ResultSummary[1]:PVMinRatedPower )
													else if (IfValidAnd( PVMinRatedPower[2] > 0 ))
													then	Format( "PV System: %.1f kWdc", PVMinRatedPower[2] )
													else	UNCHANGED  endif endif endif
											else	UNCHANGED  endif  }
END

;*************************************************************************
RULELIST "CARes_CalculatePVCredit_2016DesignRating" 1 0 0 1
;*************************************************************************
	"Disable Proj:MaxPVPrelimCredit for DesignRating calc"		Proj:MaxPVPrelimCredit	= {	UNDEFINED  }
	"Disable Proj:PVPrelimCredit for DesignRating calc"			Proj:PVPrelimCredit		= {	UNDEFINED  }

		;  "debug PV credit"		Proj:Action = { PostWarning( "debug PV credit  MaxPVPrelimCredit: %g  PVPrelimCredit: %g",  MaxPVPrelimCredit, PVPrelimCredit )  }
;	"Set Proj:PVCredit[2] (min of PVGenCredit & PVPrelimCredit) - DRtg analysis"	Proj:PVCredit[2]	= {	int( (100 * PVGenCredit / CondFloorArea) + 0.5) / 100  }
		;  "debug PV credit 2"		Proj:Action = { PostWarning( "debug PV credit 2  PVGenCredit: %g  PVCredit: %g",  PVGenCredit, PVCredit[2] )  }
  ; SAC 1/28/16 - new DRtg PVCredit based on PVWatts results...
;"store BEMProc details"		Proj:Action = {  StoreBEMProc( "DsgnRtg PV", 0 )  }
;"testing"	Proj:Action	= {	if (IfValidAnd( AllOrientations > 0.5 ))
;										then	MessageBox( "RunResultsN[13]:ProposedTDV[1] = %g  and [2] = %g", ValidOr( RunResultsN[13]:ProposedTDV[1], 0 ), ValidOr( RunResultsN[13]:ProposedTDV[2], 0 ) )
;										else	MessageBox( "RunResults[13]:ProposedTDV[1] = %g  and [2] = %g", ValidOr(  RunResults[13]:ProposedTDV[1], 0 ), ValidOr(  RunResults[13]:ProposedTDV[2], 0 ) )  endif  }
	"Set Proj:PVCredit[2] (based on PVWatts) - DRtg analysis"
			Proj:PVCredit[2]	= {	if (IfValidAnd( AllOrientations > 0.5 ))
											then	-1 * ValidOr( RunResultsN[13]:ProposedTDV[2], 0 )
											else	-1 * ValidOr(  RunResults[13]:ProposedTDV[2], 0 )
											endif  }
END

;*************************************************************************
RULELIST "CARes_ZeroOutCompPVCredit_InsufficientPVRatedPower" 1 0 0 1
	"Zero-out Proj:PVCredit[1] - Comp analysis"	Proj:PVCredit[1]	= {	0  }
; PROMPT USER for insufficient PVRatedPower
	"Prompt user for insufficent PVRatedPower due to PVMinRatedPower increased by PVCredit adjustment - Comp analysis"
		Proj:Action	= {	PostWarning( "Minimum PV rated power increased due to dwelling unit size and calculated PV credit, rated power must be >= %.1f kWdc (compliance analysis).", PVMinRatedPower[2] )  }
	"Store message to field displayed in results summary describing insufficient PVRatedPower issue"
		Proj:CompResultsMsg	= {	Format( "PV credit unavailable for this model unless PV Rated Power increased to >= %.1f kWdc.", PVMinRatedPower[2] )  }
  ; SAC 4/17/15 - ALSO reset special features flag & message to prevent improper
	"Reset SpeclFeatrs:PVSysCredit flag"	Proj:SpeclFeatrs:PVSysCredit		= {	0  }
	"Reset SpeclFeatrs:PVSysCreditMsg"		Proj:SpeclFeatrs:PVSysCreditMsg	= {	" "  }
END
; ;*************************************************************************
; RULELIST "CARes_ZeroOutDRtgPVCredit_InsufficientPVRatedPower" 1 0 0 1
; 	"Zero-out Proj:PVCredit[2] - DRtg analysis"	Proj:PVCredit[2]	= {	0  }
; ; PROMPT USER for insufficient PVRatedPower
; 	"Prompt user for insufficent PVRatedPower due to PVMinRatedPower increased by PVCredit adjustment - DRtg analysis"
; 		Proj:Action	= {	PostWarning( "Minimum PV rated power increased due to dwelling unit size and calculated PV credit, rated power must be >= %g kWdc (design rating analysis).", PVMinRatedPower[2] )  }
; END
;*************************************************************************


;*************************************************************************
RULELIST "CARes_StandardTDVResults" 1 0 0 1
;*************************************************************************
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - SpcHt"		Proj:RunResults[1]:StdElecTDV				= {	if (LocalRef( RunResults[1]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcHt"		Proj:RunResults[1]:StdNatGasTDV			= {	if (LocalRef( RunResults[1]:StdNatGasEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcHt"		Proj:RunResults[1]:StdOtherTDV			= {	if (LocalRef( RunResults[1]:StdOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcHt"		Proj:RunResults[1]:StandardTDV			= {	LocalRef( RunResults[1]:StdElecTDV ) + LocalRef( RunResults[1]:StdNatGasTDV ) + LocalRef( RunResults[1]:StdOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - SpcHt"		Proj:RunResults[1]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - SpcCl"		Proj:RunResults[2]:StdElecTDV				= {	if (LocalRef( RunResults[2]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcCl"		Proj:RunResults[2]:StdNatGasTDV			= {	if (LocalRef( RunResults[2]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcCl"		Proj:RunResults[2]:StdOtherTDV			= {	if (LocalRef( RunResults[2]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcCl"		Proj:RunResults[2]:StandardTDV			= {	LocalRef( RunResults[2]:StdElecTDV ) + LocalRef( RunResults[2]:StdNatGasTDV ) + LocalRef( RunResults[2]:StdOtherTDV )   }
	"Calculate Elec Demand  - SpcCl"		Proj:RunResults[2]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - IAQVent"	Proj:RunResults[3]:StdElecTDV				= {	if (LocalRef( RunResults[3]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - IAQVent"	Proj:RunResults[3]:StdNatGasTDV			= {	0  }
	"Calculate TDV - Other  - IAQVent"	Proj:RunResults[3]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - IAQVent"	Proj:RunResults[3]:StandardTDV			= {	LocalRef( RunResults[3]:StdElecTDV )   }
	"Calculate Elec Demand  - IAQVent"	Proj:RunResults[3]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - OthrHVAC"	Proj:RunResults[4]:StdElecTDV				= {	0  }  ; if (LocalRef( RunResults[4]:StdElecEnergy		) < 0.0001) then  0
			 			  																						      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - OthrHVAC"	Proj:RunResults[4]:StdNatGasTDV			= {	0  }  ; if (LocalRef( RunResults[4]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - OthrHVAC"	Proj:RunResults[4]:StdOtherTDV			= {	0  }  ; if (LocalRef( RunResults[4]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - OthrHVAC"	Proj:RunResults[4]:StandardTDV			= {	0  }  ; LocalRef( RunResults[4]:StdElecTDV ) + LocalRef( RunResults[4]:StdNatGasTDV ) + LocalRef( RunResults[4]:StdOtherTDV )   }
	"Calculate Elec Demand  - OthrHVAC"	Proj:RunResults[4]:StdElecDemand			= {	0  }  ; if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						      ; else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / 3.412  endif  }

  ; Water Heating
	"Calculate TDV - Elec   - WtrHt"		Proj:RunResults[5]:StdElecTDV				= {	if (LocalRef( RunResults[5]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - WtrHt"		Proj:RunResults[5]:StdNatGasTDV			= {	if (LocalRef( RunResults[5]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - WtrHt"		Proj:RunResults[5]:StdOtherTDV			= {	if (LocalRef( RunResults[5]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - WtrHt"		Proj:RunResults[5]:StandardTDV			= {	LocalRef( RunResults[5]:StdElecTDV ) + LocalRef( RunResults[5]:StdNatGasTDV ) + LocalRef( RunResults[5]:StdOtherTDV )   }
	"Calculate Elec Demand  - WtrHt"		Proj:RunResults[5]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / 3.412  endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - InsLtg"	Proj:RunResults[6]:StdElecTDV				= {	if (LocalRef( RunResults[6]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - InsLtg"	Proj:RunResults[6]:StdNatGasTDV			= {	if (LocalRef( RunResults[6]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - InsLtg"	Proj:RunResults[6]:StdOtherTDV			= {	if (LocalRef( RunResults[6]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - InsLtg"	Proj:RunResults[6]:StandardTDV			= {	LocalRef( RunResults[6]:StdElecTDV ) + LocalRef( RunResults[6]:StdNatGasTDV ) + LocalRef( RunResults[6]:StdOtherTDV )   }
	"Calculate Elec Demand  - InsLtg"	Proj:RunResults[6]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - AppCkg"	Proj:RunResults[7]:StdElecTDV				= {	if (LocalRef( RunResults[7]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - AppCkg"	Proj:RunResults[7]:StdNatGasTDV			= {	if (LocalRef( RunResults[7]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - AppCkg"	Proj:RunResults[7]:StdOtherTDV			= {	if (LocalRef( RunResults[7]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - AppCkg"	Proj:RunResults[7]:StandardTDV			= {	LocalRef( RunResults[7]:StdElecTDV ) + LocalRef( RunResults[7]:StdNatGasTDV ) + LocalRef( RunResults[7]:StdOtherTDV )   }
	"Calculate Elec Demand  - AppCkg"	Proj:RunResults[7]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - Plugs"		Proj:RunResults[8]:StdElecTDV				= {	if (LocalRef( RunResults[8]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Plugs"		Proj:RunResults[8]:StdNatGasTDV			= {	if (LocalRef( RunResults[8]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Plugs"		Proj:RunResults[8]:StdOtherTDV			= {	if (LocalRef( RunResults[8]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Plugs"		Proj:RunResults[8]:StandardTDV			= {	LocalRef( RunResults[8]:StdElecTDV ) + LocalRef( RunResults[8]:StdNatGasTDV ) + LocalRef( RunResults[8]:StdOtherTDV )   }
	"Calculate Elec Demand  - Plugs"		Proj:RunResults[8]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - Ext"		Proj:RunResults[9]:StdElecTDV				= {	if (LocalRef( RunResults[9]:StdElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Ext"		Proj:RunResults[9]:StdNatGasTDV			= {	if (LocalRef( RunResults[9]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Ext"		Proj:RunResults[9]:StdOtherTDV			= {	if (LocalRef( RunResults[9]:StdOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Ext"		Proj:RunResults[9]:StandardTDV			= {	LocalRef( RunResults[9]:StdElecTDV ) + LocalRef( RunResults[9]:StdNatGasTDV ) + LocalRef( RunResults[9]:StdOtherTDV )   }
	"Calculate Elec Demand  - Ext"		Proj:RunResults[9]:StdElecDemand			= {	if (LocalRef( RunResults[1]:StdElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - PV"			Proj:RunResults[13]:StdElecTDV			= {	if (LocalRef( RunResults[13]:StdElecEnergy		) > -0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "PVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - PV"			Proj:RunResults[13]:StdNatGasTDV			= {	0  }
	"Calculate TDV - Other  - PV"			Proj:RunResults[13]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - PV"			Proj:RunResults[13]:StandardTDV			= {	LocalRef( RunResults[13]:StdElecTDV )   }
	"Calculate Elec Demand  - PV"			Proj:RunResults[13]:StdElecDemand		= {	0  }		; zero out demand for PV enduse ??

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) TDV
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:StdElecTDV			= {	RunResults[1]:StdElecTDV    + RunResults[2]:StdElecTDV    + RunResults[3]:StdElecTDV    + RunResults[4]:StdElecTDV    + RunResults[5]:StdElecTDV     }
	"Calculate TDV - NatGas - Comp Ttl"	Proj:RunResults[11]:StdNatGasTDV			= {	RunResults[1]:StdNatGasTDV  + RunResults[2]:StdNatGasTDV  + RunResults[3]:StdNatGasTDV  + RunResults[4]:StdNatGasTDV  + RunResults[5]:StdNatGasTDV   }
	"Calculate TDV - Other  - Comp Ttl"	Proj:RunResults[11]:StdOtherTDV			= {	RunResults[1]:StdOtherTDV   + RunResults[2]:StdOtherTDV   + RunResults[3]:StdOtherTDV   + RunResults[4]:StdOtherTDV   + RunResults[5]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:StandardTDV			= {	RunResults[1]:StandardTDV   + RunResults[2]:StandardTDV   + RunResults[3]:StandardTDV   + RunResults[4]:StandardTDV   + RunResults[5]:StandardTDV    }
	"Calculate Elec Demand  - Comp Ttl"	Proj:RunResults[11]:StdElecDemand		= {	RunResults[1]:StdElecDemand + RunResults[2]:StdElecDemand + RunResults[3]:StdElecDemand + RunResults[4]:StdElecDemand + RunResults[5]:StdElecDemand  }

  ; Total
	"Calculate TDV - Elec   - Total"		Proj:RunResults[10]:StdElecTDV			= {	RunResults[11]:StdElecTDV    + RunResults[6]:StdElecTDV    + RunResults[7]:StdElecTDV    + RunResults[8]:StdElecTDV    + RunResults[9]:StdElecTDV     }
	"Calculate TDV - NatGas - Total"		Proj:RunResults[10]:StdNatGasTDV			= {	RunResults[11]:StdNatGasTDV  + RunResults[6]:StdNatGasTDV  + RunResults[7]:StdNatGasTDV  + RunResults[8]:StdNatGasTDV  + RunResults[9]:StdNatGasTDV   }
	"Calculate TDV - Other  - Total"		Proj:RunResults[10]:StdOtherTDV			= {	RunResults[11]:StdOtherTDV   + RunResults[6]:StdOtherTDV   + RunResults[7]:StdOtherTDV   + RunResults[8]:StdOtherTDV   + RunResults[9]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:StandardTDV			= {	RunResults[11]:StandardTDV   + RunResults[6]:StandardTDV   + RunResults[7]:StandardTDV   + RunResults[8]:StandardTDV   + RunResults[9]:StandardTDV    }
	"Calculate Elec Demand  - Total"		Proj:RunResults[10]:StdElecDemand		= {	RunResults[11]:StdElecDemand + RunResults[6]:StdElecDemand + RunResults[7]:StdElecDemand + RunResults[8]:StdElecDemand + RunResults[9]:StdElecDemand  }


	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	RunResults[11]:StandardTDV * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResults[10]:StdElecTDV
	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
																				else	switch ( CompCodeBase )
																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
																							default    :	UNCHANGED
																						endswitch  endif  }
	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
	"Store PropPVCreditTDV[1]"				Proj:RunResults[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
; ADJUST certain Proposed results that now are to have PVCredit applied to them
; mjb-10/16/13	subtracted PVCredit from Proposed Design Elec and TOTAL 
	"Calculate TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecTDV[1]			= {	RunResults[11]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:ProposedTDV[1]			= {	RunResults[11]:ProposedTDV[1]  - PVCredit[1]  }
	"Calculate TDV - Elec   - Total"		Proj:RunResults[10]:PropElecTDV[1]			= {	RunResults[10]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:ProposedTDV[1]			= {	RunResults[10]:ProposedTDV[1]  - PVCredit[1]  }


;;OLD VERSION
;  ; Space Heating
;	"Calculate TDV - Elec   - SpcHt"		Proj:RunResults[1]:StdElecTDV			= {	if (LocalRef( RunResults[1]:StdElecEnergy   ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - NatGas - SpcHt"		Proj:RunResults[1]:StdNatGasTDV		= {	if (LocalRef( RunResults[1]:StdNatGasEnergy ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Htg", "HPHtg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - Other  - SpcHt"		Proj:RunResults[1]:StdOtherTDV		= {	if (LocalRef( RunResults[1]:StdOtherEnergy  ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Htg", "HPHtg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - TOTAL  - SpcHt"		Proj:RunResults[1]:StandardTDV		= {	LocalRef( RunResults[1]:StdElecTDV ) + LocalRef( RunResults[1]:StdNatGasTDV ) + LocalRef( RunResults[1]:StdOtherTDV )   }
;
;  ; Space Cooling
;	"Calculate TDV - Elec   - SpcCl"		Proj:RunResults[2]:StdElecTDV			= {	if (LocalRef( RunResults[2]:StdElecEnergy   ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Clg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - NatGas - SpcCl"		Proj:RunResults[2]:StdNatGasTDV		= {	if (LocalRef( RunResults[2]:StdNatGasEnergy ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Clg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - Other  - SpcCl"		Proj:RunResults[2]:StdOtherTDV		= {	if (LocalRef( RunResults[2]:StdOtherEnergy  ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Clg" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - TOTAL  - SpcCl"		Proj:RunResults[2]:StandardTDV		= {	LocalRef( RunResults[2]:StdElecTDV ) + LocalRef( RunResults[2]:StdNatGasTDV ) + LocalRef( RunResults[2]:StdOtherTDV )   }
;
;  ; Ventilation Fans
;	"Calculate TDV - Elec   - Vent"		Proj:RunResults[3]:StdElecTDV			= {	if (LocalRef( RunResults[3]:StdElecEnergy   ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "FanTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Fan" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - NatGas - Vent"		Proj:RunResults[3]:StdNatGasTDV		= {	if (LocalRef( RunResults[3]:StdNatGasEnergy ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "FanTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Fan" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - Other  - Vent"		Proj:RunResults[3]:StdOtherTDV		= {	if (LocalRef( RunResults[3]:StdOtherEnergy  ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "FanTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Fan" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - TOTAL  - Vent"		Proj:RunResults[3]:StandardTDV		= {	LocalRef( RunResults[3]:StdElecTDV ) + LocalRef( RunResults[3]:StdNatGasTDV ) + LocalRef( RunResults[3]:StdOtherTDV )   }
;
;  ; Water Heating
;	"Calculate TDV - Elec   - WtrHt"		Proj:RunResults[4]:StdElecTDV			= {	if (LocalRef( RunResults[4]:StdElecEnergy   ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "SHWTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "SHW", "SHWPmp" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - NatGas - WtrHt"		Proj:RunResults[4]:StdNatGasTDV		= {	if (LocalRef( RunResults[4]:StdNatGasEnergy ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "SHWTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "SHW" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - Other  - WtrHt"		Proj:RunResults[4]:StdOtherTDV		= {	if (LocalRef( RunResults[4]:StdOtherEnergy  ) < 0.0001) then  0
;			 			  																					else  ApplyHourlyResultMultipliers( "SHWTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "SHW" ) / Local( CondFloorArea )  endif  }
;	"Calculate TDV - TOTAL  - WtrHt"		Proj:RunResults[4]:StandardTDV		= {	LocalRef( RunResults[4]:StdElecTDV ) + LocalRef( RunResults[4]:StdNatGasTDV ) + LocalRef( RunResults[4]:StdOtherTDV )   }
;
;  ; Total
;	"Calculate TDV - Elec   - Total"		Proj:RunResults[5]:StdElecTDV			= {	LocalRef( RunResults[1]:StdElecTDV   ) + LocalRef( RunResults[2]:StdElecTDV   ) + LocalRef( RunResults[3]:StdElecTDV   ) + LocalRef( RunResults[4]:StdElecTDV   )  }
;	"Calculate TDV - NatGas - Total"		Proj:RunResults[5]:StdNatGasTDV		= {	LocalRef( RunResults[1]:StdNatGasTDV ) + LocalRef( RunResults[2]:StdNatGasTDV ) + LocalRef( RunResults[3]:StdNatGasTDV ) + LocalRef( RunResults[4]:StdNatGasTDV )  }
;	"Calculate TDV - Other  - Total"		Proj:RunResults[5]:StdOtherTDV		= {	LocalRef( RunResults[1]:StdOtherTDV  ) + LocalRef( RunResults[2]:StdOtherTDV  ) + LocalRef( RunResults[3]:StdOtherTDV  ) + LocalRef( RunResults[4]:StdOtherTDV  )  }
;	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[5]:StandardTDV		= {	LocalRef( RunResults[1]:StandardTDV   ) + LocalRef( RunResults[2]:StandardTDV   ) + LocalRef( RunResults[3]:StandardTDV   ) + LocalRef( RunResults[4]:StandardTDV   )  }

  ; Compliance Margins
	"Calc TDV Comp Margin - SpcHt"    	Proj:RunResults[1]:CompMarginTDV		= {	LocalRef( RunResults[1]:StandardTDV  ) - LocalRef( RunResults[1]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - SpcCl"    	Proj:RunResults[2]:CompMarginTDV		= {	LocalRef( RunResults[2]:StandardTDV  ) - LocalRef( RunResults[2]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - IAQVent"  	Proj:RunResults[3]:CompMarginTDV		= {	LocalRef( RunResults[3]:StandardTDV  ) - LocalRef( RunResults[3]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - OthrHVAC" 	Proj:RunResults[4]:CompMarginTDV		= {	LocalRef( RunResults[4]:StandardTDV  ) - LocalRef( RunResults[4]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - WtrHt"    	Proj:RunResults[5]:CompMarginTDV		= {	LocalRef( RunResults[5]:StandardTDV  ) - LocalRef( RunResults[5]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - InsLtg"   	Proj:RunResults[6]:CompMarginTDV		= {	LocalRef( RunResults[6]:StandardTDV  ) - LocalRef( RunResults[6]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - AppCkg"   	Proj:RunResults[7]:CompMarginTDV		= {	LocalRef( RunResults[7]:StandardTDV  ) - LocalRef( RunResults[7]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - Plugs"    	Proj:RunResults[8]:CompMarginTDV		= {	LocalRef( RunResults[8]:StandardTDV  ) - LocalRef( RunResults[8]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - Ext"      	Proj:RunResults[9]:CompMarginTDV		= {	LocalRef( RunResults[9]:StandardTDV  ) - LocalRef( RunResults[9]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - PV"      	Proj:RunResults[13]:CompMarginTDV	= {	LocalRef( RunResults[13]:StandardTDV ) - LocalRef( RunResults[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - Total"    	Proj:RunResults[10]:CompMarginTDV	= {	LocalRef( RunResults[10]:StandardTDV ) - LocalRef( RunResults[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - Comp Ttl" 	Proj:RunResults[11]:CompMarginTDV	= {	LocalRef( RunResults[11]:StandardTDV ) - LocalRef( RunResults[11]:ProposedTDV[1] )   }

  ; Percent Improvement
	"Calc TDV Pct Improve - SpcHt"    	Proj:RunResults[1]:PctImproveTDV		= {	if (LocalRef( RunResults[1]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[1]:CompMarginTDV  ) * 100 / LocalRef( RunResults[1]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - SpcCl"    	Proj:RunResults[2]:PctImproveTDV		= {	if (LocalRef( RunResults[2]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[2]:CompMarginTDV  ) * 100 / LocalRef( RunResults[2]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - IAQVent"  	Proj:RunResults[3]:PctImproveTDV		= {	if (LocalRef( RunResults[3]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[3]:CompMarginTDV  ) * 100 / LocalRef( RunResults[3]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - OthrHVAC" 	Proj:RunResults[4]:PctImproveTDV		= {	if (LocalRef( RunResults[4]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[4]:CompMarginTDV  ) * 100 / LocalRef( RunResults[4]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - WtrHt"    	Proj:RunResults[5]:PctImproveTDV		= {	if (LocalRef( RunResults[5]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[5]:CompMarginTDV  ) * 100 / LocalRef( RunResults[5]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - InsLtg"   	Proj:RunResults[6]:PctImproveTDV		= {	if (LocalRef( RunResults[6]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[6]:CompMarginTDV  ) * 100 / LocalRef( RunResults[6]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - AppCkg"   	Proj:RunResults[7]:PctImproveTDV		= {	if (LocalRef( RunResults[7]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[7]:CompMarginTDV  ) * 100 / LocalRef( RunResults[7]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - Plugs"    	Proj:RunResults[8]:PctImproveTDV		= {	if (LocalRef( RunResults[8]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[8]:CompMarginTDV  ) * 100 / LocalRef( RunResults[8]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - Ext"      	Proj:RunResults[9]:PctImproveTDV		= {	if (LocalRef( RunResults[9]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResults[9]:CompMarginTDV  ) * 100 / LocalRef( RunResults[9]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - PV"      	Proj:RunResults[13]:PctImproveTDV	= {	if (LocalRef( RunResults[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResults[13]:CompMarginTDV ) * 100 / LocalRef( RunResults[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - Total"    	Proj:RunResults[10]:PctImproveTDV	= {	if (LocalRef( RunResults[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResults[10]:CompMarginTDV ) * 100 / LocalRef( RunResults[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - Comp Ttl"  	Proj:RunResults[11]:PctImproveTDV	= {	if (LocalRef( RunResults[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResults[11]:CompMarginTDV ) * 100 / LocalRef( RunResults[11]:StandardTDV )  endif  }

  ; Delta Demand   - SAC 8/23/14
	"Calc Delta El Demand - SpcHt"    	Proj:RunResults[1]:DeltaDemand		= {	LocalRef( RunResults[1]:StdElecDemand  ) - LocalRef( RunResults[1]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - SpcCl"    	Proj:RunResults[2]:DeltaDemand		= {	LocalRef( RunResults[2]:StdElecDemand  ) - LocalRef( RunResults[2]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - IAQVent"  	Proj:RunResults[3]:DeltaDemand		= {	LocalRef( RunResults[3]:StdElecDemand  ) - LocalRef( RunResults[3]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - OthrHVAC" 	Proj:RunResults[4]:DeltaDemand		= {	LocalRef( RunResults[4]:StdElecDemand  ) - LocalRef( RunResults[4]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - WtrHt"    	Proj:RunResults[5]:DeltaDemand		= {	LocalRef( RunResults[5]:StdElecDemand  ) - LocalRef( RunResults[5]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - InsLtg"   	Proj:RunResults[6]:DeltaDemand		= {	LocalRef( RunResults[6]:StdElecDemand  ) - LocalRef( RunResults[6]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - AppCkg"   	Proj:RunResults[7]:DeltaDemand		= {	LocalRef( RunResults[7]:StdElecDemand  ) - LocalRef( RunResults[7]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - Plugs"    	Proj:RunResults[8]:DeltaDemand		= {	LocalRef( RunResults[8]:StdElecDemand  ) - LocalRef( RunResults[8]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - Ext"      	Proj:RunResults[9]:DeltaDemand		= {	LocalRef( RunResults[9]:StdElecDemand  ) - LocalRef( RunResults[9]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - PV"      	Proj:RunResults[13]:DeltaDemand		= {	LocalRef( RunResults[13]:StdElecDemand ) - LocalRef( RunResults[13]:PropElecDemand[1] )   }
	"Calc Delta El Demand - Total"    	Proj:RunResults[10]:DeltaDemand		= {	LocalRef( RunResults[10]:StdElecDemand ) - LocalRef( RunResults[10]:PropElecDemand[1] )   }
	"Calc Delta El Demand - Comp Ttl" 	Proj:RunResults[11]:DeltaDemand		= {	LocalRef( RunResults[11]:StdElecDemand ) - LocalRef( RunResults[11]:PropElecDemand[1] )   }

END

;*************************************************************************
RULELIST "CARes_DesignRatingTDVResults" 1 0 0 1
;*************************************************************************

	"Store DRtg Proposed TDV-multiplied results"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultTDVResults" )  }		; SAC 3/14/16

; 1,           "DesignRatingTDV",   BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating TDV run result for this enduse" 
; 1,           "DRtgPctSavTDV",     BEMP_Flt,  1,  0,  0, "%",                0,  0,             39110, "Percent improvement (DesignRtg -> Prop TDV) for this enduse" 
; 1,           "DRtgDeltaDemand",   BEMP_Flt,  1,  0,  0, "kW",               0,  0,             39110, "Difference (DRtg-Prop elec demand) for this enduse" 

; 1,           "DRtgElecEnergy",    BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Eletric energy use for this enduse" 
; 1,           "DRtgNatGasEnergy",  BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Natural Gas energy use for this enduse" 
; 1,           "DRtgOtherEnergy",   BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Other Fuel energy use for this enduse" 
; 1,           "DRtgTotalEnergy",   BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run TOTAL energy use for this enduse" 
; 
; 1,           "DRtgElecTDV",       BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Eletric TDV for this enduse" 
; 1,           "DRtgNatGasTDV",     BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Natural Gas TDV for this enduse" 
; 1,           "DRtgOtherTDV",      BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Other Fuel TDV for this enduse" 
; 
; 1,           "DRtgElecDemand",    BEMP_Flt,  1,  0,  0, "kW",               0,  0,             39110, "Design Rating run Eletric TDV for this enduse" 

; SAC 3/31/16 - added rules to set RunResults[*]:DesignRatingTDV[2] to set fuel-adjusted design rating TDV for use in setting design rating score
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - SpcHt"		Proj:RunResults[1]:DRtgElecTDV			= {	if (LocalRef( RunResults[1]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcHt"		Proj:RunResults[1]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[1]:DRtgNatGasEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcHt"		Proj:RunResults[1]:DRtgOtherTDV			= {	if (LocalRef( RunResults[1]:DRtgOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcHt"		Proj:RunResults[1]:DesignRatingTDV[1]	= {	LocalRef( RunResults[1]:DRtgElecTDV ) + LocalRef( RunResults[1]:DRtgNatGasTDV ) + LocalRef( RunResults[1]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - SpcHt"		Proj:RunResults[1]:DesignRatingTDV[2]	= {	if (Proj:IsMultiFamily > 0.5)
																												then	if (CAClimateZoneCodeBase:mfHtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																														then	LocalRef( RunResults[1]:DRtgElecTDV ) + ((LocalRef( RunResults[1]:DRtgNatGasTDV ) + LocalRef( RunResults[1]:DRtgOtherTDV )) /
																																														CAClimateZoneCodeBase:mfHtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																														else	RunResults[1]:DesignRatingTDV[1]  endif
																												else	if (CAClimateZoneCodeBase:sfHtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																														then	LocalRef( RunResults[1]:DRtgElecTDV ) + ((LocalRef( RunResults[1]:DRtgNatGasTDV ) + LocalRef( RunResults[1]:DRtgOtherTDV )) /
																																														CAClimateZoneCodeBase:sfHtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																														else	RunResults[1]:DesignRatingTDV[1]  endif
																												endif   }
	"Calculate Elec Demand  - SpcHt"		Proj:RunResults[1]:DRtgElecDemand		= {	if (LocalRef( RunResults[1]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - SpcCl"		Proj:RunResults[2]:DRtgElecTDV			= {	if (LocalRef( RunResults[2]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - SpcCl"		Proj:RunResults[2]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[2]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - SpcCl"		Proj:RunResults[2]:DRtgOtherTDV			= {	if (LocalRef( RunResults[2]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - SpcCl"		Proj:RunResults[2]:DesignRatingTDV[1]	= {	LocalRef( RunResults[2]:DRtgElecTDV ) + LocalRef( RunResults[2]:DRtgNatGasTDV ) + LocalRef( RunResults[2]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - SpcCl"		Proj:RunResults[2]:DesignRatingTDV[2]	= {	if (Proj:IsMultiFamily > 0.5)
																												then	if (CAClimateZoneCodeBase:mfClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																														then	LocalRef( RunResults[2]:DRtgElecTDV ) + ((LocalRef( RunResults[2]:DRtgNatGasTDV ) + LocalRef( RunResults[2]:DRtgOtherTDV )) /
																																														CAClimateZoneCodeBase:mfClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																														else	RunResults[2]:DesignRatingTDV[1]  endif
																												else	if (CAClimateZoneCodeBase:sfClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																														then	LocalRef( RunResults[2]:DRtgElecTDV ) + ((LocalRef( RunResults[2]:DRtgNatGasTDV ) + LocalRef( RunResults[2]:DRtgOtherTDV )) /
																																														CAClimateZoneCodeBase:sfClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																														else	RunResults[2]:DesignRatingTDV[1]  endif
																												endif   }
	"Calculate Elec Demand  - SpcCl"		Proj:RunResults[2]:DRtgElecDemand		= {	if (LocalRef( RunResults[2]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - IAQVent"	Proj:RunResults[3]:DRtgElecTDV			= {	if (LocalRef( RunResults[3]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - IAQVent"	Proj:RunResults[3]:DRtgNatGasTDV			= {	0  }
	"Calculate TDV - Other  - IAQVent"	Proj:RunResults[3]:DRtgOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - IAQVent"	Proj:RunResults[3]:DesignRatingTDV[1]	= {	LocalRef( RunResults[3]:DRtgElecTDV )   }
	"Calculate TDV - TOTAL  - IAQVent"	Proj:RunResults[3]:DesignRatingTDV[2]	= {	LocalRef( RunResults[3]:DRtgElecTDV )   }
	"Calculate Elec Demand  - IAQVent"	Proj:RunResults[3]:DRtgElecDemand		= {	if (LocalRef( RunResults[3]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - OthrHVAC"	Proj:RunResults[4]:DRtgElecTDV			= {	0  }  ; if (LocalRef( RunResults[4]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - OthrHVAC"	Proj:RunResults[4]:DRtgNatGasTDV			= {	0  }  ; if (LocalRef( RunResults[4]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - OthrHVAC"	Proj:RunResults[4]:DRtgOtherTDV			= {	0  }  ; if (LocalRef( RunResults[4]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DesignRatingTDV[1]	= {	0  }  ; LocalRef( RunResults[4]:DRtgElecTDV ) + LocalRef( RunResults[4]:DRtgNatGasTDV ) + LocalRef( RunResults[4]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - OthrHVAC"	Proj:RunResults[4]:DesignRatingTDV[2]	= {	RunResults[4]:DesignRatingTDV[1]  }
	"Calculate Elec Demand  - OthrHVAC"	Proj:RunResults[4]:DRtgElecDemand		= {	0  }  ; if (LocalRef( RunResults[4]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						      ; else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / 3.412  endif  }

  ; Water Heating
	"Calculate TDV - Elec   - WtrHt"		Proj:RunResults[5]:DRtgElecTDV			= {	if (LocalRef( RunResults[5]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - WtrHt"		Proj:RunResults[5]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[5]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - WtrHt"		Proj:RunResults[5]:DRtgOtherTDV			= {	if (LocalRef( RunResults[5]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - WtrHt"		Proj:RunResults[5]:DesignRatingTDV[1]	= {	LocalRef( RunResults[5]:DRtgElecTDV ) + LocalRef( RunResults[5]:DRtgNatGasTDV ) + LocalRef( RunResults[5]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - WtrHt"		Proj:RunResults[5]:DesignRatingTDV[2]	= {	if (Proj:IsMultiFamily > 0.5)
																												then	if (CAClimateZoneCodeBase:mfDHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																														then	LocalRef( RunResults[5]:DRtgElecTDV ) + ((LocalRef( RunResults[5]:DRtgNatGasTDV ) + LocalRef( RunResults[5]:DRtgOtherTDV )) / 
																																														CAClimateZoneCodeBase:mfDHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																														else	RunResults[5]:DesignRatingTDV[1]  endif
																												else	if (CAClimateZoneCodeBase:sfDHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																														then	LocalRef( RunResults[5]:DRtgElecTDV ) + ((LocalRef( RunResults[5]:DRtgNatGasTDV ) + LocalRef( RunResults[5]:DRtgOtherTDV )) / 
																																														CAClimateZoneCodeBase:sfDHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																														else	RunResults[5]:DesignRatingTDV[1]  endif
																												endif   }
	"Calculate Elec Demand  - WtrHt"		Proj:RunResults[5]:DRtgElecDemand		= {	if (LocalRef( RunResults[5]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / 3.412  endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - InsLtg"	Proj:RunResults[6]:DRtgElecTDV			= {	if (LocalRef( RunResults[6]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - InsLtg"	Proj:RunResults[6]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[6]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - InsLtg"	Proj:RunResults[6]:DRtgOtherTDV			= {	if (LocalRef( RunResults[6]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - InsLtg"	Proj:RunResults[6]:DesignRatingTDV[1]	= {	LocalRef( RunResults[6]:DRtgElecTDV ) + LocalRef( RunResults[6]:DRtgNatGasTDV ) + LocalRef( RunResults[6]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - InsLtg"	Proj:RunResults[6]:DesignRatingTDV[2]	= {	RunResults[6]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - InsLtg"	Proj:RunResults[6]:DRtgElecDemand		= {	if (LocalRef( RunResults[6]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - AppCkg"	Proj:RunResults[7]:DRtgElecTDV			= {	if (LocalRef( RunResults[7]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - AppCkg"	Proj:RunResults[7]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[7]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - AppCkg"	Proj:RunResults[7]:DRtgOtherTDV			= {	if (LocalRef( RunResults[7]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - AppCkg"	Proj:RunResults[7]:DesignRatingTDV[1]	= {	LocalRef( RunResults[7]:DRtgElecTDV ) + LocalRef( RunResults[7]:DRtgNatGasTDV ) + LocalRef( RunResults[7]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - AppCkg"	Proj:RunResults[7]:DesignRatingTDV[2]	= {	if (Proj:IsMultiFamily > 0.5)
																												then	if (CAClimateZoneCodeBase:mfAppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																														then	LocalRef( RunResults[7]:DRtgElecTDV ) + ((LocalRef( RunResults[7]:DRtgNatGasTDV ) + LocalRef( RunResults[7]:DRtgOtherTDV )) /
																																														CAClimateZoneCodeBase:mfAppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																														else	RunResults[5]:DesignRatingTDV[1]  endif
																												else	if (CAClimateZoneCodeBase:sfAppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																														then	LocalRef( RunResults[7]:DRtgElecTDV ) + ((LocalRef( RunResults[7]:DRtgNatGasTDV ) + LocalRef( RunResults[7]:DRtgOtherTDV )) /
																																														CAClimateZoneCodeBase:sfAppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																														else	RunResults[5]:DesignRatingTDV[1]  endif
																												endif   }
	"Calculate Elec Demand  - AppCkg"	Proj:RunResults[7]:DRtgElecDemand		= {	if (LocalRef( RunResults[7]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - Plugs"		Proj:RunResults[8]:DRtgElecTDV			= {	if (LocalRef( RunResults[8]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Plugs"		Proj:RunResults[8]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[8]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Plugs"		Proj:RunResults[8]:DRtgOtherTDV			= {	if (LocalRef( RunResults[8]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Plugs"		Proj:RunResults[8]:DesignRatingTDV[1]	= {	LocalRef( RunResults[8]:DRtgElecTDV ) + LocalRef( RunResults[8]:DRtgNatGasTDV ) + LocalRef( RunResults[8]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - Plugs"		Proj:RunResults[8]:DesignRatingTDV[2]	= {	RunResults[8]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - Plugs"		Proj:RunResults[8]:DRtgElecDemand		= {	if (LocalRef( RunResults[8]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - Ext"		Proj:RunResults[9]:DRtgElecTDV			= {	if (LocalRef( RunResults[9]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - Ext"		Proj:RunResults[9]:DRtgNatGasTDV			= {	if (LocalRef( RunResults[9]:DRtgNatGasEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - Ext"		Proj:RunResults[9]:DRtgOtherTDV			= {	if (LocalRef( RunResults[9]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - Ext"		Proj:RunResults[9]:DesignRatingTDV[1]	= {	LocalRef( RunResults[9]:DRtgElecTDV ) + LocalRef( RunResults[9]:DRtgNatGasTDV ) + LocalRef( RunResults[9]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - Ext"		Proj:RunResults[9]:DesignRatingTDV[2]	= {	RunResults[9]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - Ext"		Proj:RunResults[9]:DRtgElecDemand		= {	if (LocalRef( RunResults[9]:DRtgElecEnergy	) < 0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - PV"			Proj:RunResults[13]:DRtgElecTDV			= {	if (LocalRef( RunResults[13]:DRtgElecEnergy		) > -0.0001) then  0
			 			  																						else  int( (100 * ApplyHourlyResultMultipliers( "PVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - PV"			Proj:RunResults[13]:DRtgNatGasTDV		= {	0  }
	"Calculate TDV - Other  - PV"			Proj:RunResults[13]:DRtgOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - PV"			Proj:RunResults[13]:DesignRatingTDV[1]	= {	LocalRef( RunResults[13]:DRtgElecTDV )   }
	"Calculate TDV - TOTAL  - PV"			Proj:RunResults[13]:DesignRatingTDV[2]	= {	RunResults[13]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - PV"			Proj:RunResults[13]:DRtgElecDemand		= {	if (LocalRef( RunResults[13]:DRtgElecEnergy	) > -0.0001) then  0
			 			  																						else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "PV" ) / 3.412  endif  }

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) TDV
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate TDV - Elec   - Comp Ttl"	Proj:RunResults[11]:DRtgElecTDV			= {	RunResults[1]:DRtgElecTDV    + RunResults[2]:DRtgElecTDV    + RunResults[3]:DRtgElecTDV    + RunResults[4]:DRtgElecTDV    + RunResults[5]:DRtgElecTDV     }
	"Calculate TDV - NatGas - Comp Ttl"	Proj:RunResults[11]:DRtgNatGasTDV		= {	RunResults[1]:DRtgNatGasTDV  + RunResults[2]:DRtgNatGasTDV  + RunResults[3]:DRtgNatGasTDV  + RunResults[4]:DRtgNatGasTDV  + RunResults[5]:DRtgNatGasTDV   }
	"Calculate TDV - Other  - Comp Ttl"	Proj:RunResults[11]:DRtgOtherTDV			= {	RunResults[1]:DRtgOtherTDV   + RunResults[2]:DRtgOtherTDV   + RunResults[3]:DRtgOtherTDV   + RunResults[4]:DRtgOtherTDV   + RunResults[5]:DRtgOtherTDV    }
	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:DesignRatingTDV[1]	= {	RunResults[1]:DesignRatingTDV[1]   + RunResults[2]:DesignRatingTDV[1]   + RunResults[3]:DesignRatingTDV[1]   + RunResults[4]:DesignRatingTDV[1]   + RunResults[5]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - Comp Ttl"	Proj:RunResults[11]:DesignRatingTDV[2]	= {	RunResults[1]:DesignRatingTDV[2]   + RunResults[2]:DesignRatingTDV[2]   + RunResults[3]:DesignRatingTDV[2]   + RunResults[4]:DesignRatingTDV[2]   + RunResults[5]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - Comp Ttl"	Proj:RunResults[11]:DRtgElecDemand		= {	RunResults[1]:DRtgElecDemand + RunResults[2]:DRtgElecDemand + RunResults[3]:DRtgElecDemand + RunResults[4]:DRtgElecDemand + RunResults[5]:DRtgElecDemand  }

  ; Total
	"Calculate TDV - Elec   - Total"		Proj:RunResults[10]:DRtgElecTDV			= {	RunResults[11]:DRtgElecTDV    + RunResults[6]:DRtgElecTDV    + RunResults[7]:DRtgElecTDV    + RunResults[8]:DRtgElecTDV    + RunResults[9]:DRtgElecTDV     }
	"Calculate TDV - NatGas - Total"		Proj:RunResults[10]:DRtgNatGasTDV		= {	RunResults[11]:DRtgNatGasTDV  + RunResults[6]:DRtgNatGasTDV  + RunResults[7]:DRtgNatGasTDV  + RunResults[8]:DRtgNatGasTDV  + RunResults[9]:DRtgNatGasTDV   }
	"Calculate TDV - Other  - Total"		Proj:RunResults[10]:DRtgOtherTDV			= {	RunResults[11]:DRtgOtherTDV   + RunResults[6]:DRtgOtherTDV   + RunResults[7]:DRtgOtherTDV   + RunResults[8]:DRtgOtherTDV   + RunResults[9]:DRtgOtherTDV    }
	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:DesignRatingTDV[1]	= {	RunResults[11]:DesignRatingTDV[1]   + RunResults[6]:DesignRatingTDV[1]   + RunResults[7]:DesignRatingTDV[1]   + RunResults[8]:DesignRatingTDV[1]   + RunResults[9]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - Total"		Proj:RunResults[10]:DesignRatingTDV[2]	= {	RunResults[11]:DesignRatingTDV[2]   + RunResults[6]:DesignRatingTDV[2]   + RunResults[7]:DesignRatingTDV[2]   + RunResults[8]:DesignRatingTDV[2]   + RunResults[9]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - Total"		Proj:RunResults[10]:DRtgElecDemand		= {	RunResults[11]:DRtgElecDemand + RunResults[6]:DRtgElecDemand + RunResults[7]:DRtgElecDemand + RunResults[8]:DRtgElecDemand + RunResults[9]:DRtgElecDemand  }

  ; SAC 2/1/16 - inserted RE-calc of Standard model PVCredit (so that it is available for analysis results reporting following design rating run)
	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	ValidOr( RunResults[11]:StandardTDV, 0 ) * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResults[10]:StdElecTDV
	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
																				else	switch ( CompCodeBase )
																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
																							default    :	UNCHANGED
																						endswitch  endif  }

	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
	"Set Proj:PVBaseTDV - DRtg"						Proj:PVBaseTDV	= {	ValidOr( RunResults[10]:DesignRatingTDV[1], 0 ) * CondFloorArea  }		; SAC 4/14/15 - switched from elecTDV to totalTDV - was: RunResults[10]:DRtgElecTDV
		; SAC 3/24/16 - removed logic 'PVGenCredit < 1 .OR.' preventing call to CARes_CalculatePVCredit_2016DesignRating when compliance PV credit toggled off
	"Perform PV calcs if applicable - DRtg"		Proj:Action		= {	if ((StdDesignBase == 2013 .AND. StandardsVersion == 2014) .OR. CondFloorArea < 0.01) then  UNCHANGED
																							else	switch ( CompCodeBase )
																										case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )
																										default    :	UNCHANGED
																									endswitch  endif  }
	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
	"Store PropPVCreditTDV[2]"				Proj:RunResults[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }			; SAC 1/28/16 - still track this under InsLtg enduse ??
	; SAC SAC 4/8/15 - adjust RunResults[6]:Prop*[2] properties for DRtgLtgReduction
	"Adjust - Elec   - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropElecEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropElecEnergy[2]   <= 0) then  UNCHANGED
			 			  																										else               RunResults[6]:PropElecEnergy[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - NatGas - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropNatGasEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasEnergy[2] <= 0) then  UNCHANGED
			 			  																										else               RunResults[6]:PropNatGasEnergy[2] * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Other  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropOtherEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherEnergy[2]  <= 0) then  UNCHANGED
			 			  																										else               RunResults[6]:PropOtherEnergy[2]  * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Elec   - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropElecTDV[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropElecTDV[2]      <= 0) then  UNCHANGED
			 			  																										else  int( (100 * (RunResults[6]:PropElecTDV[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropNatGasTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasTDV[2]    <= 0) then  UNCHANGED
;			 			  																										else  int( (100 * (RunResults[6]:PropNatGasTDV[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropOtherTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherTDV[2]     <= 0) then  UNCHANGED
;																																else  int( (100 * (RunResults[6]:PropOtherTDV[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Adjust E Demand - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropElecDemand[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropElecDemand[2]   <= 0) then  UNCHANGED
			 			  																										else               RunResults[6]:PropElecDemand[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Recalc - TOTAL  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:PropTotalEnergy[2]	= {	RunResults[6]:PropElecEnergy[2] + RunResults[6]:PropNatGasEnergy[2] + RunResults[6]:PropOtherEnergy[2]   }
	"Recalc - TOTAL  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:ProposedTDV[2]		= {	RunResults[6]:PropElecTDV[2]    + RunResults[6]:PropNatGasTDV       + RunResults[6]:PropOtherTDV         }
	"Recalc - TOTAL  - InsLtg for DRtgLtgReduction"	Proj:RunResults[6]:ProposedTDV[3]		= {	RunResults[6]:ProposedTDV[2]  }
; ADJUST certain Proposed results that now are to have PVCredit applied to them
; mjb-10/16/13	subtracted PVCredit from Proposed Design Elec and TOTAL 
; SAC 4/9/15 - updated to also recalc energy use sums (to catch mods for design rating lighting credit)
	"Recalc total - Elec   - Comp Ttl"	Proj:RunResults[11]:PropElecEnergy[2]		= {	RunResults[1]:PropElecEnergy[2]    + RunResults[2]:PropElecEnergy[2]   + RunResults[3]:PropElecEnergy[2]   + RunResults[4]:PropElecEnergy[2]   + RunResults[5]:PropElecEnergy[2]   + RunResults[13]:PropElecEnergy[2]    }	; SAC 2/1/16 - PV
	"Recalc total - NatGas - Comp Ttl"	Proj:RunResults[11]:PropNatGasEnergy[2]	= {	RunResults[1]:PropNatGasEnergy[2]  + RunResults[2]:PropNatGasEnergy[2] + RunResults[3]:PropNatGasEnergy[2] + RunResults[4]:PropNatGasEnergy[2] + RunResults[5]:PropNatGasEnergy[2] + RunResults[13]:PropNatGasEnergy[2]  }
	"Recalc total - Other  - Comp Ttl"	Proj:RunResults[11]:PropOtherEnergy[2]		= {	RunResults[1]:PropOtherEnergy[2]   + RunResults[2]:PropOtherEnergy[2]  + RunResults[3]:PropOtherEnergy[2]  + RunResults[4]:PropOtherEnergy[2]  + RunResults[5]:PropOtherEnergy[2]  + RunResults[13]:PropOtherEnergy[2]   }
	"Recalc total - TOTAL  - Comp Ttl"	Proj:RunResults[11]:PropTotalEnergy[2]		= {	RunResults[1]:PropTotalEnergy[2]   + RunResults[2]:PropTotalEnergy[2]  + RunResults[3]:PropTotalEnergy[2]  + RunResults[4]:PropTotalEnergy[2]  + RunResults[5]:PropTotalEnergy[2]  + RunResults[13]:PropTotalEnergy[2]   }
	"Recalc TDV - Elec   - Comp Ttl"		Proj:RunResults[11]:PropElecTDV[2]			= {	RunResults[1]:PropElecTDV[2]       + RunResults[2]:PropElecTDV[2]      + RunResults[3]:PropElecTDV[2]      + RunResults[4]:PropElecTDV[2]      + RunResults[5]:PropElecTDV[2]      + RunResults[13]:PropElecTDV[2]       } ; - PVCredit[2]  }
	"Recalc TDV - TOTAL  - Comp Ttl"		Proj:RunResults[11]:ProposedTDV[2]			= {	RunResults[1]:ProposedTDV[2]       + RunResults[2]:ProposedTDV[2]      + RunResults[3]:ProposedTDV[2]      + RunResults[4]:ProposedTDV[2]      + RunResults[5]:ProposedTDV[2]      + RunResults[13]:ProposedTDV[2]       } ; - PVCredit[2]  }
	"Recalc TDV - TOTAL  - Comp Ttl"		Proj:RunResults[11]:ProposedTDV[3]			= {	RunResults[1]:ProposedTDV[3]       + RunResults[2]:ProposedTDV[3]      + RunResults[3]:ProposedTDV[3]      + RunResults[4]:ProposedTDV[3]      + RunResults[5]:ProposedTDV[3]      + RunResults[13]:ProposedTDV[3]       } ; - PVCredit[2]  }
	"Recalc total - ElDem - Comp Ttl"	Proj:RunResults[11]:PropElecDemand[2]		= {	RunResults[1]:PropElecDemand[2]    + RunResults[2]:PropElecDemand[2]   + RunResults[3]:PropElecDemand[2]   + RunResults[4]:PropElecDemand[2]   + RunResults[5]:PropElecDemand[2]   + RunResults[13]:PropElecDemand[2]    }	; SAC 5/1/15
	"Recalc total - Elec   - Total"		Proj:RunResults[10]:PropElecEnergy[2]		= {	RunResults[11]:PropElecEnergy[2]   + RunResults[6]:PropElecEnergy[2]   + RunResults[7]:PropElecEnergy[2]   + RunResults[8]:PropElecEnergy[2]   + RunResults[9]:PropElecEnergy[2]    }
	"Recalc total - NatGas - Total"		Proj:RunResults[10]:PropNatGasEnergy[2]	= {	RunResults[11]:PropNatGasEnergy[2] + RunResults[6]:PropNatGasEnergy[2] + RunResults[7]:PropNatGasEnergy[2] + RunResults[8]:PropNatGasEnergy[2] + RunResults[9]:PropNatGasEnergy[2]  }
	"Recalc total - Other  - Total"		Proj:RunResults[10]:PropOtherEnergy[2]		= {	RunResults[11]:PropOtherEnergy[2]  + RunResults[6]:PropOtherEnergy[2]  + RunResults[7]:PropOtherEnergy[2]  + RunResults[8]:PropOtherEnergy[2]  + RunResults[9]:PropOtherEnergy[2]   }
	"Recalc total - TOTAL  - Total"		Proj:RunResults[10]:PropTotalEnergy[2]		= {	RunResults[11]:PropTotalEnergy[2]  + RunResults[6]:PropTotalEnergy[2]  + RunResults[7]:PropTotalEnergy[2]  + RunResults[8]:PropTotalEnergy[2]  + RunResults[9]:PropTotalEnergy[2]   }
	"Recalc TDV - Elec   - Total"			Proj:RunResults[10]:PropElecTDV[2]			= {	RunResults[11]:PropElecTDV[2]      + RunResults[6]:PropElecTDV[2]      + RunResults[7]:PropElecTDV[2]      + RunResults[8]:PropElecTDV[2]      + RunResults[9]:PropElecTDV[2]       }
	"Recalc TDV - TOTAL  - Total"			Proj:RunResults[10]:ProposedTDV[2]			= {	RunResults[11]:ProposedTDV[2]      + RunResults[6]:ProposedTDV[2]      + RunResults[7]:ProposedTDV[2]      + RunResults[8]:ProposedTDV[2]      + RunResults[9]:ProposedTDV[2]       }
	"Recalc TDV - TOTAL  - Total"			Proj:RunResults[10]:ProposedTDV[3]			= {	RunResults[11]:ProposedTDV[3]      + RunResults[6]:ProposedTDV[3]      + RunResults[7]:ProposedTDV[3]      + RunResults[8]:ProposedTDV[3]      + RunResults[9]:ProposedTDV[3]       }
	"Recalc total - ElDem - Total"		Proj:RunResults[10]:PropElecDemand[2]		= {	RunResults[11]:PropElecDemand[2]   + RunResults[6]:PropElecDemand[2]   + RunResults[7]:PropElecDemand[2]   + RunResults[8]:PropElecDemand[2]   + RunResults[9]:PropElecDemand[2]    }	; SAC 5/1/15

  ; Percent Improvement
	"Calc TDV Pct Improve - SpcHt"    	Proj:RunResults[1]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[1]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResults[1]:DesignRatingTDV[1]  ) - LocalRef( RunResults[1]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[1]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - SpcCl"    	Proj:RunResults[2]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[2]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResults[2]:DesignRatingTDV[1]  ) - LocalRef( RunResults[2]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[2]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - IAQVent"  	Proj:RunResults[3]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[3]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResults[3]:DesignRatingTDV[1]  ) - LocalRef( RunResults[3]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[3]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - OthrHVAC" 	Proj:RunResults[4]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[4]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResults[4]:DesignRatingTDV[1]  ) - LocalRef( RunResults[4]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[4]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - WtrHt"    	Proj:RunResults[5]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[5]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResults[5]:DesignRatingTDV[1]  ) - LocalRef( RunResults[5]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[5]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - InsLtg"   	Proj:RunResults[6]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[6]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResults[6]:DesignRatingTDV[1]  ) - LocalRef( RunResults[6]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[6]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - AppCkg"   	Proj:RunResults[7]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[7]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResults[7]:DesignRatingTDV[1]  ) - LocalRef( RunResults[7]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[7]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - Plugs"    	Proj:RunResults[8]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[8]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResults[8]:DesignRatingTDV[1]  ) - LocalRef( RunResults[8]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[8]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - Ext"      	Proj:RunResults[9]:DRtgPctSavTDV		= {	if (LocalRef( RunResults[9]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResults[9]:DesignRatingTDV[1]  ) - LocalRef( RunResults[9]:ProposedTDV[2]  )) * 100 / LocalRef( RunResults[9]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - PV"      	Proj:RunResults[13]:DRtgPctSavTDV	= {	if (LocalRef( RunResults[13]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResults[13]:DesignRatingTDV[1] ) - LocalRef( RunResults[13]:ProposedTDV[2] )) * 100 / LocalRef( RunResults[13]:DesignRatingTDV[1] )  endif  }
	"Calc TDV Pct Improve - Total"    	Proj:RunResults[10]:DRtgPctSavTDV	= {	if (LocalRef( RunResults[10]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResults[10]:DesignRatingTDV[1] ) - LocalRef( RunResults[10]:ProposedTDV[2] )) * 100 / LocalRef( RunResults[10]:DesignRatingTDV[1] )  endif  }
	"Calc TDV Pct Improve - Comp Ttl"  	Proj:RunResults[11]:DRtgPctSavTDV	= {	if (LocalRef( RunResults[11]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResults[11]:DesignRatingTDV[1] ) - LocalRef( RunResults[11]:ProposedTDV[2] )) * 100 / LocalRef( RunResults[11]:DesignRatingTDV[1] )  endif  }

  ; Delta Demand
	"Calc Delta El Demand - SpcHt"    	Proj:RunResults[1]:DRtgDeltaDemand	= {	LocalRef( RunResults[1]:DRtgElecDemand  ) - LocalRef( RunResults[1]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - SpcCl"    	Proj:RunResults[2]:DRtgDeltaDemand	= {	LocalRef( RunResults[2]:DRtgElecDemand  ) - LocalRef( RunResults[2]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - IAQVent"  	Proj:RunResults[3]:DRtgDeltaDemand	= {	LocalRef( RunResults[3]:DRtgElecDemand  ) - LocalRef( RunResults[3]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - OthrHVAC" 	Proj:RunResults[4]:DRtgDeltaDemand	= {	LocalRef( RunResults[4]:DRtgElecDemand  ) - LocalRef( RunResults[4]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - WtrHt"    	Proj:RunResults[5]:DRtgDeltaDemand	= {	LocalRef( RunResults[5]:DRtgElecDemand  ) - LocalRef( RunResults[5]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - InsLtg"   	Proj:RunResults[6]:DRtgDeltaDemand	= {	LocalRef( RunResults[6]:DRtgElecDemand  ) - LocalRef( RunResults[6]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - AppCkg"   	Proj:RunResults[7]:DRtgDeltaDemand	= {	LocalRef( RunResults[7]:DRtgElecDemand  ) - LocalRef( RunResults[7]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - Plugs"    	Proj:RunResults[8]:DRtgDeltaDemand	= {	LocalRef( RunResults[8]:DRtgElecDemand  ) - LocalRef( RunResults[8]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - Ext"      	Proj:RunResults[9]:DRtgDeltaDemand	= {	LocalRef( RunResults[9]:DRtgElecDemand  ) - LocalRef( RunResults[9]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - PV"      	Proj:RunResults[13]:DRtgDeltaDemand	= {	LocalRef( RunResults[13]:DRtgElecDemand ) - LocalRef( RunResults[13]:PropElecDemand[2] )   }
	"Calc Delta El Demand - Total"    	Proj:RunResults[10]:DRtgDeltaDemand	= {	LocalRef( RunResults[10]:DRtgElecDemand ) - LocalRef( RunResults[10]:PropElecDemand[2] )   }
	"Calc Delta El Demand - Comp Ttl" 	Proj:RunResults[11]:DRtgDeltaDemand	= {	LocalRef( RunResults[11]:DRtgElecDemand ) - LocalRef( RunResults[11]:PropElecDemand[2] )   }

END


;*************************************************************************
RULELIST "CARes_StandardTDVResults_NESW" 1 0 0 1
;*************************************************************************

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - N-SpcHt"		Proj:RunResultsN[1]:StdElecTDV			= {	if (LocalRef( RunResultsN[1]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcHt"		Proj:RunResultsN[1]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[1]:StdNatGasEnergy		) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcHt"		Proj:RunResultsN[1]:StdOtherTDV			= {	if (LocalRef( RunResultsN[1]:StdOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:StandardTDV			= {	LocalRef( RunResultsN[1]:StdElecTDV ) + LocalRef( RunResultsN[1]:StdNatGasTDV ) + LocalRef( RunResultsN[1]:StdOtherTDV )   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - N-SpcHt"		Proj:RunResultsN[1]:StdElecDemand		= {	if (LocalRef( RunResultsN[1]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - N-SpcCl"		Proj:RunResultsN[2]:StdElecTDV			= {	if (LocalRef( RunResultsN[2]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcCl"		Proj:RunResultsN[2]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[2]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcCl"		Proj:RunResultsN[2]:StdOtherTDV			= {	if (LocalRef( RunResultsN[2]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:StandardTDV			= {	LocalRef( RunResultsN[2]:StdElecTDV ) + LocalRef( RunResultsN[2]:StdNatGasTDV ) + LocalRef( RunResultsN[2]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-SpcCl"		Proj:RunResultsN[2]:StdElecDemand		= {	if (LocalRef( RunResultsN[2]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - N-IAQVent"	Proj:RunResultsN[3]:StdElecTDV			= {	if (LocalRef( RunResultsN[3]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-IAQVent"	Proj:RunResultsN[3]:StdNatGasTDV			= {	0  }
	"Calculate TDV - Other  - N-IAQVent"	Proj:RunResultsN[3]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:StandardTDV			= {	LocalRef( RunResultsN[3]:StdElecTDV )   }
	"Calculate Elec Demand  - N-IAQVent"	Proj:RunResultsN[3]:StdElecDemand		= {	if (LocalRef( RunResultsN[3]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:StdElecTDV			= {	0  }  ; if (LocalRef( RunResultsN[4]:StdElecEnergy		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:StdNatGasTDV			= {	0  }  ; if (LocalRef( RunResultsN[4]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:StdOtherTDV			= {	0  }  ; if (LocalRef( RunResultsN[4]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:StandardTDV			= {	0  }  ; LocalRef( RunResultsN[4]:StdElecTDV ) + LocalRef( RunResultsN[4]:StdNatGasTDV ) + LocalRef( RunResultsN[4]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-OthrHVAC"	Proj:RunResultsN[4]:StdElecDemand		= {	0  }  ; if (LocalRef( RunResultsN[4]:StdElecEnergy		) < 0.0001) then  0
			 			  																							      ; else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / 3.412  endif  }

  ; Water Heating
	"Calculate TDV - Elec   - N-WtrHt"		Proj:RunResultsN[5]:StdElecTDV			= {	if (LocalRef( RunResultsN[5]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-WtrHt"		Proj:RunResultsN[5]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[5]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-WtrHt"		Proj:RunResultsN[5]:StdOtherTDV			= {	if (LocalRef( RunResultsN[5]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:StandardTDV			= {	LocalRef( RunResultsN[5]:StdElecTDV ) + LocalRef( RunResultsN[5]:StdNatGasTDV ) + LocalRef( RunResultsN[5]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-WtrHt"		Proj:RunResultsN[5]:StdElecDemand		= {	if (LocalRef( RunResultsN[5]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / 3.412  endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - N-InsLtg"		Proj:RunResultsN[6]:StdElecTDV			= {	if (LocalRef( RunResultsN[6]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-InsLtg"		Proj:RunResultsN[6]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[6]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-InsLtg"		Proj:RunResultsN[6]:StdOtherTDV			= {	if (LocalRef( RunResultsN[6]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:StandardTDV			= {	LocalRef( RunResultsN[6]:StdElecTDV ) + LocalRef( RunResultsN[6]:StdNatGasTDV ) + LocalRef( RunResultsN[6]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-InsLtg"		Proj:RunResultsN[6]:StdElecDemand		= {	if (LocalRef( RunResultsN[6]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - N-AppCkg"		Proj:RunResultsN[7]:StdElecTDV			= {	if (LocalRef( RunResultsN[7]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-AppCkg"		Proj:RunResultsN[7]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[7]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-AppCkg"		Proj:RunResultsN[7]:StdOtherTDV			= {	if (LocalRef( RunResultsN[7]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:StandardTDV			= {	LocalRef( RunResultsN[7]:StdElecTDV ) + LocalRef( RunResultsN[7]:StdNatGasTDV ) + LocalRef( RunResultsN[7]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-AppCkg"		Proj:RunResultsN[7]:StdElecDemand		= {	if (LocalRef( RunResultsN[7]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - N-Plugs"		Proj:RunResultsN[8]:StdElecTDV			= {	if (LocalRef( RunResultsN[8]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Plugs"		Proj:RunResultsN[8]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[8]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Plugs"		Proj:RunResultsN[8]:StdOtherTDV			= {	if (LocalRef( RunResultsN[8]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:StandardTDV			= {	LocalRef( RunResultsN[8]:StdElecTDV ) + LocalRef( RunResultsN[8]:StdNatGasTDV ) + LocalRef( RunResultsN[8]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-Plugs"		Proj:RunResultsN[8]:StdElecDemand		= {	if (LocalRef( RunResultsN[8]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - N-Ext"			Proj:RunResultsN[9]:StdElecTDV			= {	if (LocalRef( RunResultsN[9]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Ext"			Proj:RunResultsN[9]:StdNatGasTDV			= {	if (LocalRef( RunResultsN[9]:StdNatGasEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Ext"			Proj:RunResultsN[9]:StdOtherTDV			= {	if (LocalRef( RunResultsN[9]:StdOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Ext"			Proj:RunResultsN[9]:StandardTDV			= {	LocalRef( RunResultsN[9]:StdElecTDV ) + LocalRef( RunResultsN[9]:StdNatGasTDV ) + LocalRef( RunResultsN[9]:StdOtherTDV )   }
	"Calculate Elec Demand  - N-Ext"			Proj:RunResultsN[9]:StdElecDemand		= {	if (LocalRef( RunResultsN[9]:StdElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Ext" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - N-PV"			Proj:RunResultsN[13]:StdElecTDV			= {	if (LocalRef( RunResultsN[13]:StdElecEnergy		) > -0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "PVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-PV"			Proj:RunResultsN[13]:StdNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-PV"			Proj:RunResultsN[13]:StdOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-PV"			Proj:RunResultsN[13]:StandardTDV			= {	LocalRef( RunResultsN[13]:StdElecTDV )   }
	"Calculate Elec Demand  - N-PV"			Proj:RunResultsN[13]:StdElecDemand		= {	0  }		; zero-out PV elec demand?

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) TDV
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:StdElecTDV			= {	RunResultsN[1]:StdElecTDV    + RunResultsN[2]:StdElecTDV    + RunResultsN[3]:StdElecTDV    + RunResultsN[4]:StdElecTDV    + RunResultsN[5]:StdElecTDV     }
	"Calculate TDV - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:StdNatGasTDV		= {	RunResultsN[1]:StdNatGasTDV  + RunResultsN[2]:StdNatGasTDV  + RunResultsN[3]:StdNatGasTDV  + RunResultsN[4]:StdNatGasTDV  + RunResultsN[5]:StdNatGasTDV   }
	"Calculate TDV - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:StdOtherTDV			= {	RunResultsN[1]:StdOtherTDV   + RunResultsN[2]:StdOtherTDV   + RunResultsN[3]:StdOtherTDV   + RunResultsN[4]:StdOtherTDV   + RunResultsN[5]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:StandardTDV			= {	RunResultsN[1]:StandardTDV   + RunResultsN[2]:StandardTDV   + RunResultsN[3]:StandardTDV   + RunResultsN[4]:StandardTDV   + RunResultsN[5]:StandardTDV    }
	"Calculate Elec Demand  - N-Comp Ttl"	Proj:RunResultsN[11]:StdElecDemand		= {	RunResultsN[1]:StdElecDemand + RunResultsN[2]:StdElecDemand + RunResultsN[3]:StdElecDemand + RunResultsN[4]:StdElecDemand + RunResultsN[5]:StdElecDemand  }

  ; Total
	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV    + RunResultsN[6]:StdElecTDV    + RunResultsN[7]:StdElecTDV    + RunResultsN[8]:StdElecTDV    + RunResultsN[9]:StdElecTDV     }
	"Calculate TDV - NatGas - N-Total"		Proj:RunResultsN[10]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV  + RunResultsN[6]:StdNatGasTDV  + RunResultsN[7]:StdNatGasTDV  + RunResultsN[8]:StdNatGasTDV  + RunResultsN[9]:StdNatGasTDV   }
	"Calculate TDV - Other  - N-Total"		Proj:RunResultsN[10]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV   + RunResultsN[6]:StdOtherTDV   + RunResultsN[7]:StdOtherTDV   + RunResultsN[8]:StdOtherTDV   + RunResultsN[9]:StdOtherTDV    }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:StandardTDV			= {	RunResultsN[11]:StandardTDV   + RunResultsN[6]:StandardTDV   + RunResultsN[7]:StandardTDV   + RunResultsN[8]:StandardTDV   + RunResultsN[9]:StandardTDV    }
	"Calculate Elec Demand  - N-Total"		Proj:RunResultsN[10]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand + RunResultsN[6]:StdElecDemand + RunResultsN[7]:StdElecDemand + RunResultsN[8]:StdElecDemand + RunResultsN[9]:StdElecDemand  }


	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	RunResultsN[11]:StandardTDV * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResultsN[10]:StdElecTDV
	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
																				else	switch ( CompCodeBase )
																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
																							default    :	UNCHANGED
																						endswitch  endif  }
	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
	"Store PropPVCreditTDV[1] - N"			Proj:RunResultsN[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
	"Store PropPVCreditTDV[1] - E"			Proj:RunResultsE[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
	"Store PropPVCreditTDV[1] - S"			Proj:RunResultsS[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
	"Store PropPVCreditTDV[1] - W"			Proj:RunResultsW[6]:PropPVCreditTDV[1]		= {	PVCredit[1]  }
; ADJUST certain Proposed results that now are to have PVCredit applied to them
; mjb-10/16/13	subtracted PVCredit from Elec and TOTAL
	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecTDV[1]			= {	RunResultsN[11]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[1]			= {	RunResultsN[11]:ProposedTDV[1]  - PVCredit[1]  }
	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecTDV[1]			= {	RunResultsN[10]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedTDV[1]			= {	RunResultsN[10]:ProposedTDV[1]  - PVCredit[1]  }

	"Calculate TDV - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecTDV[1]			= {	RunResultsE[11]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[1]			= {	RunResultsE[11]:ProposedTDV[1]  - PVCredit[1]  }
	"Calculate TDV - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecTDV[1]			= {	RunResultsE[10]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedTDV[1]			= {	RunResultsE[10]:ProposedTDV[1]  - PVCredit[1]  }

	"Calculate TDV - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecTDV[1]			= {	RunResultsS[11]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[1]			= {	RunResultsS[11]:ProposedTDV[1]  - PVCredit[1]  }
	"Calculate TDV - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecTDV[1]			= {	RunResultsS[10]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedTDV[1]			= {	RunResultsS[10]:ProposedTDV[1]  - PVCredit[1]  }

	"Calculate TDV - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecTDV[1]			= {	RunResultsW[11]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[1]			= {	RunResultsW[11]:ProposedTDV[1]  - PVCredit[1]  }
	"Calculate TDV - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecTDV[1]			= {	RunResultsW[10]:PropElecTDV[1]  - PVCredit[1]  }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedTDV[1]			= {	RunResultsW[10]:ProposedTDV[1]  - PVCredit[1]  }


; -- COPY N results to E --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - E-SpcHt"		Proj:RunResultsE[1]:StdElecTDV			= {	RunResultsN[1]:StdElecTDV        }
	"Calculate TDV - NatGas - E-SpcHt"		Proj:RunResultsE[1]:StdNatGasTDV			= {	RunResultsN[1]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-SpcHt"		Proj:RunResultsE[1]:StdOtherTDV			= {	RunResultsN[1]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:StandardTDV			= {	RunResultsN[1]:StandardTDV       }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - E-SpcHt"		Proj:RunResultsE[1]:StdElecDemand		= {	RunResultsN[1]:StdElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - E-SpcCl"		Proj:RunResultsE[2]:StdElecTDV			= {	RunResultsN[2]:StdElecTDV        }
	"Calculate TDV - NatGas - E-SpcCl"		Proj:RunResultsE[2]:StdNatGasTDV			= {	RunResultsN[2]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-SpcCl"		Proj:RunResultsE[2]:StdOtherTDV			= {	RunResultsN[2]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:StandardTDV			= {	RunResultsN[2]:StandardTDV       }
	"Calculate Elec Demand  - E-SpcCl"		Proj:RunResultsE[2]:StdElecDemand		= {	RunResultsN[2]:StdElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - E-IAQVent"	Proj:RunResultsE[3]:StdElecTDV			= {	RunResultsN[3]:StdElecTDV        }
	"Calculate TDV - NatGas - E-IAQVent"	Proj:RunResultsE[3]:StdNatGasTDV			= {	RunResultsN[3]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-IAQVent"	Proj:RunResultsE[3]:StdOtherTDV			= {	RunResultsN[3]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:StandardTDV			= {	RunResultsN[3]:StandardTDV       }
	"Calculate Elec Demand  - E-IAQVent"	Proj:RunResultsE[3]:StdElecDemand		= {	RunResultsN[3]:StdElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:StdElecTDV			= {	RunResultsN[4]:StdElecTDV        }
	"Calculate TDV - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:StdNatGasTDV			= {	RunResultsN[4]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:StdOtherTDV			= {	RunResultsN[4]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:StandardTDV			= {	RunResultsN[4]:StandardTDV       }
	"Calculate Elec Demand  - E-OthrHVAC"	Proj:RunResultsE[4]:StdElecDemand		= {	RunResultsN[4]:StdElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - E-WtrHt"		Proj:RunResultsE[5]:StdElecTDV			= {	RunResultsN[5]:StdElecTDV        }
	"Calculate TDV - NatGas - E-WtrHt"		Proj:RunResultsE[5]:StdNatGasTDV			= {	RunResultsN[5]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-WtrHt"		Proj:RunResultsE[5]:StdOtherTDV			= {	RunResultsN[5]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:StandardTDV			= {	RunResultsN[5]:StandardTDV       }
	"Calculate Elec Demand  - E-WtrHt"		Proj:RunResultsE[5]:StdElecDemand		= {	RunResultsN[5]:StdElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - E-InsLtg"		Proj:RunResultsE[6]:StdElecTDV			= {	RunResultsN[6]:StdElecTDV        }
	"Calculate TDV - NatGas - E-InsLtg"		Proj:RunResultsE[6]:StdNatGasTDV			= {	RunResultsN[6]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-InsLtg"		Proj:RunResultsE[6]:StdOtherTDV			= {	RunResultsN[6]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:StandardTDV			= {	RunResultsN[6]:StandardTDV       }
	"Calculate Elec Demand  - E-InsLtg"		Proj:RunResultsE[6]:StdElecDemand		= {	RunResultsN[6]:StdElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - E-AppCkg"		Proj:RunResultsE[7]:StdElecTDV			= {	RunResultsN[7]:StdElecTDV        }
	"Calculate TDV - NatGas - E-AppCkg"		Proj:RunResultsE[7]:StdNatGasTDV			= {	RunResultsN[7]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-AppCkg"		Proj:RunResultsE[7]:StdOtherTDV			= {	RunResultsN[7]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:StandardTDV			= {	RunResultsN[7]:StandardTDV       }
	"Calculate Elec Demand  - E-AppCkg"		Proj:RunResultsE[7]:StdElecDemand		= {	RunResultsN[7]:StdElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - E-Plugs"		Proj:RunResultsE[8]:StdElecTDV			= {	RunResultsN[8]:StdElecTDV        }
	"Calculate TDV - NatGas - E-Plugs"		Proj:RunResultsE[8]:StdNatGasTDV			= {	RunResultsN[8]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-Plugs"		Proj:RunResultsE[8]:StdOtherTDV			= {	RunResultsN[8]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:StandardTDV			= {	RunResultsN[8]:StandardTDV       }
	"Calculate Elec Demand  - E-Plugs"		Proj:RunResultsE[8]:StdElecDemand		= {	RunResultsN[8]:StdElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - E-Ext"			Proj:RunResultsE[9]:StdElecTDV			= {	RunResultsN[9]:StdElecTDV        }
	"Calculate TDV - NatGas - E-Ext"			Proj:RunResultsE[9]:StdNatGasTDV			= {	RunResultsN[9]:StdNatGasTDV      }
	"Calculate TDV - Other  - E-Ext"			Proj:RunResultsE[9]:StdOtherTDV			= {	RunResultsN[9]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - E-Ext"			Proj:RunResultsE[9]:StandardTDV			= {	RunResultsN[9]:StandardTDV       }
	"Calculate Elec Demand  - E-Ext"			Proj:RunResultsE[9]:StdElecDemand		= {	RunResultsN[9]:StdElecDemand     }
  ; PV
	"Calculate TDV - Elec   - E-PV"			Proj:RunResultsE[13]:StdElecTDV			= {	RunResultsN[13]:StdElecTDV       }
	"Calculate TDV - NatGas - E-PV"			Proj:RunResultsE[13]:StdNatGasTDV		= {	RunResultsN[13]:StdNatGasTDV     }
	"Calculate TDV - Other  - E-PV"			Proj:RunResultsE[13]:StdOtherTDV			= {	RunResultsN[13]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - E-PV"			Proj:RunResultsE[13]:StandardTDV			= {	RunResultsN[13]:StandardTDV      }
	"Calculate Elec Demand  - E-PV"			Proj:RunResultsE[13]:StdElecDemand		= {	RunResultsN[13]:StdElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV       }
	"Calculate TDV - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV     }
	"Calculate TDV - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:StandardTDV			= {	RunResultsN[11]:StandardTDV      }
	"Calculate Elec Demand  - E-Comp Ttl"	Proj:RunResultsE[11]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - E-Total"		Proj:RunResultsE[10]:StdElecTDV			= {	RunResultsN[10]:StdElecTDV       }
	"Calculate TDV - NatGas - E-Total"		Proj:RunResultsE[10]:StdNatGasTDV		= {	RunResultsN[10]:StdNatGasTDV     }
	"Calculate TDV - Other  - E-Total"		Proj:RunResultsE[10]:StdOtherTDV			= {	RunResultsN[10]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:StandardTDV			= {	RunResultsN[10]:StandardTDV      }
	"Calculate Elec Demand  - E-Total"		Proj:RunResultsE[10]:StdElecDemand		= {	RunResultsN[10]:StdElecDemand    }

; -- COPY N results to S --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - S-SpcHt"		Proj:RunResultsS[1]:StdElecTDV			= {	RunResultsN[1]:StdElecTDV        }
	"Calculate TDV - NatGas - S-SpcHt"		Proj:RunResultsS[1]:StdNatGasTDV			= {	RunResultsN[1]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-SpcHt"		Proj:RunResultsS[1]:StdOtherTDV			= {	RunResultsN[1]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:StandardTDV			= {	RunResultsN[1]:StandardTDV       }
	"Calculate Elec Demand  - S-SpcHt"		Proj:RunResultsS[1]:StdElecDemand		= {	RunResultsN[1]:StdElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - S-SpcCl"		Proj:RunResultsS[2]:StdElecTDV			= {	RunResultsN[2]:StdElecTDV        }
	"Calculate TDV - NatGas - S-SpcCl"		Proj:RunResultsS[2]:StdNatGasTDV			= {	RunResultsN[2]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-SpcCl"		Proj:RunResultsS[2]:StdOtherTDV			= {	RunResultsN[2]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:StandardTDV			= {	RunResultsN[2]:StandardTDV       }
	"Calculate Elec Demand  - S-SpcCl"     Proj:RunResultsS[2]:StdElecDemand		= {	RunResultsN[2]:StdElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - S-IAQVent"	Proj:RunResultsS[3]:StdElecTDV			= {	RunResultsN[3]:StdElecTDV        }
	"Calculate TDV - NatGas - S-IAQVent"	Proj:RunResultsS[3]:StdNatGasTDV			= {	RunResultsN[3]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-IAQVent"	Proj:RunResultsS[3]:StdOtherTDV			= {	RunResultsN[3]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:StandardTDV			= {	RunResultsN[3]:StandardTDV       }
	"Calculate Elec Demand  - S-IAQVent"   Proj:RunResultsS[3]:StdElecDemand		= {	RunResultsN[3]:StdElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:StdElecTDV			= {	RunResultsN[4]:StdElecTDV        }
	"Calculate TDV - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:StdNatGasTDV			= {	RunResultsN[4]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:StdOtherTDV			= {	RunResultsN[4]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:StandardTDV			= {	RunResultsN[4]:StandardTDV       }
	"Calculate Elec Demand  - S-OthrHVAC"  Proj:RunResultsS[4]:StdElecDemand		= {	RunResultsN[4]:StdElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - S-WtrHt"		Proj:RunResultsS[5]:StdElecTDV			= {	RunResultsN[5]:StdElecTDV        }
	"Calculate TDV - NatGas - S-WtrHt"		Proj:RunResultsS[5]:StdNatGasTDV			= {	RunResultsN[5]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-WtrHt"		Proj:RunResultsS[5]:StdOtherTDV			= {	RunResultsN[5]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:StandardTDV			= {	RunResultsN[5]:StandardTDV       }
	"Calculate Elec Demand  - S-WtrHt"     Proj:RunResultsS[5]:StdElecDemand		= {	RunResultsN[5]:StdElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - S-InsLtg"		Proj:RunResultsS[6]:StdElecTDV			= {	RunResultsN[6]:StdElecTDV        }
	"Calculate TDV - NatGas - S-InsLtg"		Proj:RunResultsS[6]:StdNatGasTDV			= {	RunResultsN[6]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-InsLtg"		Proj:RunResultsS[6]:StdOtherTDV			= {	RunResultsN[6]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:StandardTDV			= {	RunResultsN[6]:StandardTDV       }
	"Calculate Elec Demand  - S-InsLtg"    Proj:RunResultsS[6]:StdElecDemand		= {	RunResultsN[6]:StdElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - S-AppCkg"		Proj:RunResultsS[7]:StdElecTDV			= {	RunResultsN[7]:StdElecTDV        }
	"Calculate TDV - NatGas - S-AppCkg"		Proj:RunResultsS[7]:StdNatGasTDV			= {	RunResultsN[7]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-AppCkg"		Proj:RunResultsS[7]:StdOtherTDV			= {	RunResultsN[7]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:StandardTDV			= {	RunResultsN[7]:StandardTDV       }
	"Calculate Elec Demand  - S-AppCkg"    Proj:RunResultsS[7]:StdElecDemand		= {	RunResultsN[7]:StdElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - S-Plugs"		Proj:RunResultsS[8]:StdElecTDV			= {	RunResultsN[8]:StdElecTDV        }
	"Calculate TDV - NatGas - S-Plugs"		Proj:RunResultsS[8]:StdNatGasTDV			= {	RunResultsN[8]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-Plugs"		Proj:RunResultsS[8]:StdOtherTDV			= {	RunResultsN[8]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:StandardTDV			= {	RunResultsN[8]:StandardTDV       }
	"Calculate Elec Demand  - S-Plugs"     Proj:RunResultsS[8]:StdElecDemand		= {	RunResultsN[8]:StdElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - S-Ext"			Proj:RunResultsS[9]:StdElecTDV			= {	RunResultsN[9]:StdElecTDV        }
	"Calculate TDV - NatGas - S-Ext"			Proj:RunResultsS[9]:StdNatGasTDV			= {	RunResultsN[9]:StdNatGasTDV      }
	"Calculate TDV - Other  - S-Ext"			Proj:RunResultsS[9]:StdOtherTDV			= {	RunResultsN[9]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - S-Ext"			Proj:RunResultsS[9]:StandardTDV			= {	RunResultsN[9]:StandardTDV       }
	"Calculate Elec Demand  - S-Ext"       Proj:RunResultsS[9]:StdElecDemand		= {	RunResultsN[9]:StdElecDemand     }
  ; PV
	"Calculate TDV - Elec   - S-PV"			Proj:RunResultsS[13]:StdElecTDV			= {	RunResultsN[13]:StdElecTDV       }
	"Calculate TDV - NatGas - S-PV"			Proj:RunResultsS[13]:StdNatGasTDV		= {	RunResultsN[13]:StdNatGasTDV     }
	"Calculate TDV - Other  - S-PV"			Proj:RunResultsS[13]:StdOtherTDV			= {	RunResultsN[13]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - S-PV"			Proj:RunResultsS[13]:StandardTDV			= {	RunResultsN[13]:StandardTDV      }
	"Calculate Elec Demand  - S-PV"			Proj:RunResultsS[13]:StdElecDemand		= {	RunResultsN[13]:StdElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV       }
	"Calculate TDV - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV     }
	"Calculate TDV - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:StandardTDV			= {	RunResultsN[11]:StandardTDV      }
	"Calculate Elec Demand  - S-Comp Ttl"  Proj:RunResultsS[11]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - S-Total"		Proj:RunResultsS[10]:StdElecTDV			= {	RunResultsN[10]:StdElecTDV       }
	"Calculate TDV - NatGas - S-Total"		Proj:RunResultsS[10]:StdNatGasTDV		= {	RunResultsN[10]:StdNatGasTDV     }
	"Calculate TDV - Other  - S-Total"		Proj:RunResultsS[10]:StdOtherTDV			= {	RunResultsN[10]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:StandardTDV			= {	RunResultsN[10]:StandardTDV      }
	"Calculate Elec Demand  - S-Total"     Proj:RunResultsS[10]:StdElecDemand		= {	RunResultsN[10]:StdElecDemand    }

; -- COPY N results to W --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - W-SpcHt"		Proj:RunResultsW[1]:StdElecTDV			= {	RunResultsN[1]:StdElecTDV        }
	"Calculate TDV - NatGas - W-SpcHt"		Proj:RunResultsW[1]:StdNatGasTDV			= {	RunResultsN[1]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-SpcHt"		Proj:RunResultsW[1]:StdOtherTDV			= {	RunResultsN[1]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:StandardTDV			= {	RunResultsN[1]:StandardTDV       }
	"Calculate Elec Demand  - W-SpcHt"		Proj:RunResultsW[1]:StdElecDemand		= {	RunResultsN[1]:StdElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - W-SpcCl"		Proj:RunResultsW[2]:StdElecTDV			= {	RunResultsN[2]:StdElecTDV        }
	"Calculate TDV - NatGas - W-SpcCl"		Proj:RunResultsW[2]:StdNatGasTDV			= {	RunResultsN[2]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-SpcCl"		Proj:RunResultsW[2]:StdOtherTDV			= {	RunResultsN[2]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:StandardTDV			= {	RunResultsN[2]:StandardTDV       }
	"Calculate Elec Demand  - W-SpcCl"     Proj:RunResultsW[2]:StdElecDemand		= {	RunResultsN[2]:StdElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - W-IAQVent"	Proj:RunResultsW[3]:StdElecTDV			= {	RunResultsN[3]:StdElecTDV        }
	"Calculate TDV - NatGas - W-IAQVent"	Proj:RunResultsW[3]:StdNatGasTDV			= {	RunResultsN[3]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-IAQVent"	Proj:RunResultsW[3]:StdOtherTDV			= {	RunResultsN[3]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:StandardTDV			= {	RunResultsN[3]:StandardTDV       }
	"Calculate Elec Demand  - W-IAQVent"   Proj:RunResultsW[3]:StdElecDemand		= {	RunResultsN[3]:StdElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:StdElecTDV			= {	RunResultsN[4]:StdElecTDV        }
	"Calculate TDV - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:StdNatGasTDV			= {	RunResultsN[4]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:StdOtherTDV			= {	RunResultsN[4]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:StandardTDV			= {	RunResultsN[4]:StandardTDV       }
	"Calculate Elec Demand  - W-OthrHVAC"  Proj:RunResultsW[4]:StdElecDemand		= {	RunResultsN[4]:StdElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - W-WtrHt"		Proj:RunResultsW[5]:StdElecTDV			= {	RunResultsN[5]:StdElecTDV        }
	"Calculate TDV - NatGas - W-WtrHt"		Proj:RunResultsW[5]:StdNatGasTDV			= {	RunResultsN[5]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-WtrHt"		Proj:RunResultsW[5]:StdOtherTDV			= {	RunResultsN[5]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:StandardTDV			= {	RunResultsN[5]:StandardTDV       }
	"Calculate Elec Demand  - W-WtrHt"     Proj:RunResultsW[5]:StdElecDemand		= {	RunResultsN[5]:StdElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - W-InsLtg"		Proj:RunResultsW[6]:StdElecTDV			= {	RunResultsN[6]:StdElecTDV        }
	"Calculate TDV - NatGas - W-InsLtg"		Proj:RunResultsW[6]:StdNatGasTDV			= {	RunResultsN[6]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-InsLtg"		Proj:RunResultsW[6]:StdOtherTDV			= {	RunResultsN[6]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:StandardTDV			= {	RunResultsN[6]:StandardTDV       }
	"Calculate Elec Demand  - W-InsLtg"    Proj:RunResultsW[6]:StdElecDemand		= {	RunResultsN[6]:StdElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - W-AppCkg"		Proj:RunResultsW[7]:StdElecTDV			= {	RunResultsN[7]:StdElecTDV        }
	"Calculate TDV - NatGas - W-AppCkg"		Proj:RunResultsW[7]:StdNatGasTDV			= {	RunResultsN[7]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-AppCkg"		Proj:RunResultsW[7]:StdOtherTDV			= {	RunResultsN[7]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:StandardTDV			= {	RunResultsN[7]:StandardTDV       }
	"Calculate Elec Demand  - W-AppCkg"    Proj:RunResultsW[7]:StdElecDemand		= {	RunResultsN[7]:StdElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - W-Plugs"		Proj:RunResultsW[8]:StdElecTDV			= {	RunResultsN[8]:StdElecTDV        }
	"Calculate TDV - NatGas - W-Plugs"		Proj:RunResultsW[8]:StdNatGasTDV			= {	RunResultsN[8]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-Plugs"		Proj:RunResultsW[8]:StdOtherTDV			= {	RunResultsN[8]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:StandardTDV			= {	RunResultsN[8]:StandardTDV       }
	"Calculate Elec Demand  - W-Plugs"     Proj:RunResultsW[8]:StdElecDemand		= {	RunResultsN[8]:StdElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - W-Ext"			Proj:RunResultsW[9]:StdElecTDV			= {	RunResultsN[9]:StdElecTDV        }
	"Calculate TDV - NatGas - W-Ext"			Proj:RunResultsW[9]:StdNatGasTDV			= {	RunResultsN[9]:StdNatGasTDV      }
	"Calculate TDV - Other  - W-Ext"			Proj:RunResultsW[9]:StdOtherTDV			= {	RunResultsN[9]:StdOtherTDV       }
	"Calculate TDV - TOTAL  - W-Ext"			Proj:RunResultsW[9]:StandardTDV			= {	RunResultsN[9]:StandardTDV       }
	"Calculate Elec Demand  - W-Ext"       Proj:RunResultsW[9]:StdElecDemand		= {	RunResultsN[9]:StdElecDemand     }
  ; PV
	"Calculate TDV - Elec   - W-PV"			Proj:RunResultsW[13]:StdElecTDV			= {	RunResultsN[13]:StdElecTDV       }
	"Calculate TDV - NatGas - W-PV"			Proj:RunResultsW[13]:StdNatGasTDV		= {	RunResultsN[13]:StdNatGasTDV     }
	"Calculate TDV - Other  - W-PV"			Proj:RunResultsW[13]:StdOtherTDV			= {	RunResultsN[13]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - W-PV"			Proj:RunResultsW[13]:StandardTDV			= {	RunResultsN[13]:StandardTDV      }
	"Calculate Elec Demand  - W-PV"			Proj:RunResultsW[13]:StdElecDemand		= {	RunResultsN[13]:StdElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:StdElecTDV			= {	RunResultsN[11]:StdElecTDV       }
	"Calculate TDV - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:StdNatGasTDV		= {	RunResultsN[11]:StdNatGasTDV     }
	"Calculate TDV - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:StdOtherTDV			= {	RunResultsN[11]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:StandardTDV			= {	RunResultsN[11]:StandardTDV      }
	"Calculate Elec Demand  - W-Comp Ttl"	Proj:RunResultsW[11]:StdElecDemand		= {	RunResultsN[11]:StdElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - W-Total"		Proj:RunResultsW[10]:StdElecTDV			= {	RunResultsN[10]:StdElecTDV       }
	"Calculate TDV - NatGas - W-Total"		Proj:RunResultsW[10]:StdNatGasTDV		= {	RunResultsN[10]:StdNatGasTDV     }
	"Calculate TDV - Other  - W-Total"		Proj:RunResultsW[10]:StdOtherTDV			= {	RunResultsN[10]:StdOtherTDV      }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:StandardTDV			= {	RunResultsN[10]:StandardTDV      }
	"Calculate Elec Demand  - W-Total"     Proj:RunResultsW[10]:StdElecDemand		= {	RunResultsN[10]:StdElecDemand    }


  ; Compliance Margins - NORTH
	"Calc TDV Comp Margin - N-SpcHt"    	Proj:RunResultsN[1]:CompMarginTDV	= {	LocalRef( RunResultsN[1]:StandardTDV  ) - LocalRef( RunResultsN[1]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-SpcCl"    	Proj:RunResultsN[2]:CompMarginTDV	= {	LocalRef( RunResultsN[2]:StandardTDV  ) - LocalRef( RunResultsN[2]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-IAQVent"  	Proj:RunResultsN[3]:CompMarginTDV	= {	LocalRef( RunResultsN[3]:StandardTDV  ) - LocalRef( RunResultsN[3]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-OthrHVAC" 	Proj:RunResultsN[4]:CompMarginTDV	= {	LocalRef( RunResultsN[4]:StandardTDV  ) - LocalRef( RunResultsN[4]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-WtrHt"    	Proj:RunResultsN[5]:CompMarginTDV	= {	LocalRef( RunResultsN[5]:StandardTDV  ) - LocalRef( RunResultsN[5]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-InsLtg"   	Proj:RunResultsN[6]:CompMarginTDV	= {	LocalRef( RunResultsN[6]:StandardTDV  ) - LocalRef( RunResultsN[6]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-AppCkg"   	Proj:RunResultsN[7]:CompMarginTDV	= {	LocalRef( RunResultsN[7]:StandardTDV  ) - LocalRef( RunResultsN[7]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-Plugs"    	Proj:RunResultsN[8]:CompMarginTDV	= {	LocalRef( RunResultsN[8]:StandardTDV  ) - LocalRef( RunResultsN[8]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-Ext"      	Proj:RunResultsN[9]:CompMarginTDV	= {	LocalRef( RunResultsN[9]:StandardTDV  ) - LocalRef( RunResultsN[9]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - N-PV"     	 	Proj:RunResultsN[13]:CompMarginTDV	= {	LocalRef( RunResultsN[13]:StandardTDV ) - LocalRef( RunResultsN[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - N-Total"    	Proj:RunResultsN[10]:CompMarginTDV	= {	LocalRef( RunResultsN[10]:StandardTDV ) - LocalRef( RunResultsN[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - N-Comp Ttl" 	Proj:RunResultsN[11]:CompMarginTDV	= {	LocalRef( RunResultsN[11]:StandardTDV ) - LocalRef( RunResultsN[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - N-SpcHt"    	Proj:RunResultsN[1]:PctImproveTDV	= {	if (LocalRef( RunResultsN[1]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[1]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[1]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-SpcCl"    	Proj:RunResultsN[2]:PctImproveTDV	= {	if (LocalRef( RunResultsN[2]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[2]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[2]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-IAQVent"  	Proj:RunResultsN[3]:PctImproveTDV	= {	if (LocalRef( RunResultsN[3]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[3]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[3]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-OthrHVAC" 	Proj:RunResultsN[4]:PctImproveTDV	= {	if (LocalRef( RunResultsN[4]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[4]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[4]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-WtrHt"    	Proj:RunResultsN[5]:PctImproveTDV	= {	if (LocalRef( RunResultsN[5]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[5]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[5]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-InsLtg"   	Proj:RunResultsN[6]:PctImproveTDV	= {	if (LocalRef( RunResultsN[6]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[6]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[6]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-AppCkg"   	Proj:RunResultsN[7]:PctImproveTDV	= {	if (LocalRef( RunResultsN[7]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[7]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[7]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-Plugs"    	Proj:RunResultsN[8]:PctImproveTDV	= {	if (LocalRef( RunResultsN[8]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[8]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[8]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-Ext"      	Proj:RunResultsN[9]:PctImproveTDV	= {	if (LocalRef( RunResultsN[9]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsN[9]:CompMarginTDV  ) * 100 / LocalRef( RunResultsN[9]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - N-PV"     	 	Proj:RunResultsN[13]:PctImproveTDV	= {	if (LocalRef( RunResultsN[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsN[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsN[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - N-Total"    	Proj:RunResultsN[10]:PctImproveTDV	= {	if (LocalRef( RunResultsN[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsN[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsN[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - N-Comp Ttl"  	Proj:RunResultsN[11]:PctImproveTDV	= {	if (LocalRef( RunResultsN[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsN[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsN[11]:StandardTDV )  endif  }
  ; Delta Demand   - SAC 8/23/14
	"Calc Delta El Demand - N-SpcHt"    	Proj:RunResultsN[1]:DeltaDemand		= {	LocalRef( RunResultsN[1]:StdElecDemand  ) - LocalRef( RunResultsN[1]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-SpcCl"    	Proj:RunResultsN[2]:DeltaDemand		= {	LocalRef( RunResultsN[2]:StdElecDemand  ) - LocalRef( RunResultsN[2]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-IAQVent"  	Proj:RunResultsN[3]:DeltaDemand		= {	LocalRef( RunResultsN[3]:StdElecDemand  ) - LocalRef( RunResultsN[3]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-OthrHVAC" 	Proj:RunResultsN[4]:DeltaDemand		= {	LocalRef( RunResultsN[4]:StdElecDemand  ) - LocalRef( RunResultsN[4]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-WtrHt"    	Proj:RunResultsN[5]:DeltaDemand		= {	LocalRef( RunResultsN[5]:StdElecDemand  ) - LocalRef( RunResultsN[5]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-InsLtg"   	Proj:RunResultsN[6]:DeltaDemand		= {	LocalRef( RunResultsN[6]:StdElecDemand  ) - LocalRef( RunResultsN[6]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-AppCkg"   	Proj:RunResultsN[7]:DeltaDemand		= {	LocalRef( RunResultsN[7]:StdElecDemand  ) - LocalRef( RunResultsN[7]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-Plugs"    	Proj:RunResultsN[8]:DeltaDemand		= {	LocalRef( RunResultsN[8]:StdElecDemand  ) - LocalRef( RunResultsN[8]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-Ext"      	Proj:RunResultsN[9]:DeltaDemand		= {	LocalRef( RunResultsN[9]:StdElecDemand  ) - LocalRef( RunResultsN[9]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - N-PV"      		Proj:RunResultsN[13]:DeltaDemand		= {	LocalRef( RunResultsN[13]:StdElecDemand ) - LocalRef( RunResultsN[13]:PropElecDemand[1] )   }
	"Calc Delta El Demand - N-Total"    	Proj:RunResultsN[10]:DeltaDemand		= {	LocalRef( RunResultsN[10]:StdElecDemand ) - LocalRef( RunResultsN[10]:PropElecDemand[1] )   }
	"Calc Delta El Demand - N-Comp Ttl" 	Proj:RunResultsN[11]:DeltaDemand		= {	LocalRef( RunResultsN[11]:StdElecDemand ) - LocalRef( RunResultsN[11]:PropElecDemand[1] )   }

  ; Compliance Margins - EAST
	"Calc TDV Comp Margin - E-SpcHt"    	Proj:RunResultsE[1]:CompMarginTDV	= {	LocalRef( RunResultsE[1]:StandardTDV  ) - LocalRef( RunResultsE[1]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-SpcCl"    	Proj:RunResultsE[2]:CompMarginTDV	= {	LocalRef( RunResultsE[2]:StandardTDV  ) - LocalRef( RunResultsE[2]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-IAQVent"  	Proj:RunResultsE[3]:CompMarginTDV	= {	LocalRef( RunResultsE[3]:StandardTDV  ) - LocalRef( RunResultsE[3]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-OthrHVAC" 	Proj:RunResultsE[4]:CompMarginTDV	= {	LocalRef( RunResultsE[4]:StandardTDV  ) - LocalRef( RunResultsE[4]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-WtrHt"    	Proj:RunResultsE[5]:CompMarginTDV	= {	LocalRef( RunResultsE[5]:StandardTDV  ) - LocalRef( RunResultsE[5]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-InsLtg"   	Proj:RunResultsE[6]:CompMarginTDV	= {	LocalRef( RunResultsE[6]:StandardTDV  ) - LocalRef( RunResultsE[6]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-AppCkg"   	Proj:RunResultsE[7]:CompMarginTDV	= {	LocalRef( RunResultsE[7]:StandardTDV  ) - LocalRef( RunResultsE[7]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-Plugs"    	Proj:RunResultsE[8]:CompMarginTDV	= {	LocalRef( RunResultsE[8]:StandardTDV  ) - LocalRef( RunResultsE[8]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-Ext"      	Proj:RunResultsE[9]:CompMarginTDV	= {	LocalRef( RunResultsE[9]:StandardTDV  ) - LocalRef( RunResultsE[9]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - E-PV"     	 	Proj:RunResultsE[13]:CompMarginTDV	= {	LocalRef( RunResultsE[13]:StandardTDV ) - LocalRef( RunResultsE[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - E-Total"    	Proj:RunResultsE[10]:CompMarginTDV	= {	LocalRef( RunResultsE[10]:StandardTDV ) - LocalRef( RunResultsE[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - E-Comp Ttl" 	Proj:RunResultsE[11]:CompMarginTDV	= {	LocalRef( RunResultsE[11]:StandardTDV ) - LocalRef( RunResultsE[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - E-SpcHt"    	Proj:RunResultsE[1]:PctImproveTDV	= {	if (LocalRef( RunResultsE[1]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[1]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[1]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-SpcCl"    	Proj:RunResultsE[2]:PctImproveTDV	= {	if (LocalRef( RunResultsE[2]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[2]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[2]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-IAQVent"  	Proj:RunResultsE[3]:PctImproveTDV	= {	if (LocalRef( RunResultsE[3]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[3]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[3]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-OthrHVAC" 	Proj:RunResultsE[4]:PctImproveTDV	= {	if (LocalRef( RunResultsE[4]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[4]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[4]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-WtrHt"    	Proj:RunResultsE[5]:PctImproveTDV	= {	if (LocalRef( RunResultsE[5]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[5]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[5]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-InsLtg"   	Proj:RunResultsE[6]:PctImproveTDV	= {	if (LocalRef( RunResultsE[6]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[6]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[6]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-AppCkg"   	Proj:RunResultsE[7]:PctImproveTDV	= {	if (LocalRef( RunResultsE[7]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[7]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[7]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-Plugs"    	Proj:RunResultsE[8]:PctImproveTDV	= {	if (LocalRef( RunResultsE[8]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[8]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[8]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-Ext"      	Proj:RunResultsE[9]:PctImproveTDV	= {	if (LocalRef( RunResultsE[9]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsE[9]:CompMarginTDV  ) * 100 / LocalRef( RunResultsE[9]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - E-PV"     	 	Proj:RunResultsE[13]:PctImproveTDV	= {	if (LocalRef( RunResultsE[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsE[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsE[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - E-Total"    	Proj:RunResultsE[10]:PctImproveTDV	= {	if (LocalRef( RunResultsE[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsE[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsE[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - E-Comp Ttl"  	Proj:RunResultsE[11]:PctImproveTDV	= {	if (LocalRef( RunResultsE[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsE[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsE[11]:StandardTDV )  endif  }
  ; Delta Demand   - SAC 8/23/14
	"Calc Delta El Demand - E-SpcHt"    	Proj:RunResultsE[1]:DeltaDemand		= {	LocalRef( RunResultsE[1]:StdElecDemand  ) - LocalRef( RunResultsE[1]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-SpcCl"    	Proj:RunResultsE[2]:DeltaDemand		= {	LocalRef( RunResultsE[2]:StdElecDemand  ) - LocalRef( RunResultsE[2]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-IAQVent"  	Proj:RunResultsE[3]:DeltaDemand		= {	LocalRef( RunResultsE[3]:StdElecDemand  ) - LocalRef( RunResultsE[3]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-OthrHVAC" 	Proj:RunResultsE[4]:DeltaDemand		= {	LocalRef( RunResultsE[4]:StdElecDemand  ) - LocalRef( RunResultsE[4]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-WtrHt"    	Proj:RunResultsE[5]:DeltaDemand		= {	LocalRef( RunResultsE[5]:StdElecDemand  ) - LocalRef( RunResultsE[5]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-InsLtg"   	Proj:RunResultsE[6]:DeltaDemand		= {	LocalRef( RunResultsE[6]:StdElecDemand  ) - LocalRef( RunResultsE[6]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-AppCkg"   	Proj:RunResultsE[7]:DeltaDemand		= {	LocalRef( RunResultsE[7]:StdElecDemand  ) - LocalRef( RunResultsE[7]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-Plugs"    	Proj:RunResultsE[8]:DeltaDemand		= {	LocalRef( RunResultsE[8]:StdElecDemand  ) - LocalRef( RunResultsE[8]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-Ext"      	Proj:RunResultsE[9]:DeltaDemand		= {	LocalRef( RunResultsE[9]:StdElecDemand  ) - LocalRef( RunResultsE[9]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - E-PV"     	 	Proj:RunResultsE[13]:DeltaDemand		= {	LocalRef( RunResultsE[13]:StdElecDemand ) - LocalRef( RunResultsE[13]:PropElecDemand[1] )   }
	"Calc Delta El Demand - E-Total"    	Proj:RunResultsE[10]:DeltaDemand		= {	LocalRef( RunResultsE[10]:StdElecDemand ) - LocalRef( RunResultsE[10]:PropElecDemand[1] )   }
	"Calc Delta El Demand - E-Comp Ttl" 	Proj:RunResultsE[11]:DeltaDemand		= {	LocalRef( RunResultsE[11]:StdElecDemand ) - LocalRef( RunResultsE[11]:PropElecDemand[1] )   }

  ; Compliance Margins - SOUTH
	"Calc TDV Comp Margin - S-SpcHt"    	Proj:RunResultsS[1]:CompMarginTDV	= {	LocalRef( RunResultsS[1]:StandardTDV  ) - LocalRef( RunResultsS[1]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-SpcCl"    	Proj:RunResultsS[2]:CompMarginTDV	= {	LocalRef( RunResultsS[2]:StandardTDV  ) - LocalRef( RunResultsS[2]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-IAQVent"  	Proj:RunResultsS[3]:CompMarginTDV	= {	LocalRef( RunResultsS[3]:StandardTDV  ) - LocalRef( RunResultsS[3]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-OthrHVAC" 	Proj:RunResultsS[4]:CompMarginTDV	= {	LocalRef( RunResultsS[4]:StandardTDV  ) - LocalRef( RunResultsS[4]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-WtrHt"    	Proj:RunResultsS[5]:CompMarginTDV	= {	LocalRef( RunResultsS[5]:StandardTDV  ) - LocalRef( RunResultsS[5]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-InsLtg"   	Proj:RunResultsS[6]:CompMarginTDV	= {	LocalRef( RunResultsS[6]:StandardTDV  ) - LocalRef( RunResultsS[6]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-AppCkg"   	Proj:RunResultsS[7]:CompMarginTDV	= {	LocalRef( RunResultsS[7]:StandardTDV  ) - LocalRef( RunResultsS[7]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-Plugs"    	Proj:RunResultsS[8]:CompMarginTDV	= {	LocalRef( RunResultsS[8]:StandardTDV  ) - LocalRef( RunResultsS[8]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-Ext"      	Proj:RunResultsS[9]:CompMarginTDV	= {	LocalRef( RunResultsS[9]:StandardTDV  ) - LocalRef( RunResultsS[9]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - S-PV"     	 	Proj:RunResultsS[13]:CompMarginTDV	= {	LocalRef( RunResultsS[13]:StandardTDV ) - LocalRef( RunResultsS[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - S-Total"    	Proj:RunResultsS[10]:CompMarginTDV	= {	LocalRef( RunResultsS[10]:StandardTDV ) - LocalRef( RunResultsS[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - S-Comp Ttl" 	Proj:RunResultsS[11]:CompMarginTDV	= {	LocalRef( RunResultsS[11]:StandardTDV ) - LocalRef( RunResultsS[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - S-SpcHt"    	Proj:RunResultsS[1]:PctImproveTDV	= {	if (LocalRef( RunResultsS[1]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[1]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[1]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-SpcCl"    	Proj:RunResultsS[2]:PctImproveTDV	= {	if (LocalRef( RunResultsS[2]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[2]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[2]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-IAQVent"  	Proj:RunResultsS[3]:PctImproveTDV	= {	if (LocalRef( RunResultsS[3]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[3]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[3]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-OthrHVAC" 	Proj:RunResultsS[4]:PctImproveTDV	= {	if (LocalRef( RunResultsS[4]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[4]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[4]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-WtrHt"    	Proj:RunResultsS[5]:PctImproveTDV	= {	if (LocalRef( RunResultsS[5]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[5]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[5]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-InsLtg"   	Proj:RunResultsS[6]:PctImproveTDV	= {	if (LocalRef( RunResultsS[6]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[6]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[6]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-AppCkg"   	Proj:RunResultsS[7]:PctImproveTDV	= {	if (LocalRef( RunResultsS[7]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[7]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[7]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-Plugs"    	Proj:RunResultsS[8]:PctImproveTDV	= {	if (LocalRef( RunResultsS[8]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[8]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[8]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-Ext"      	Proj:RunResultsS[9]:PctImproveTDV	= {	if (LocalRef( RunResultsS[9]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsS[9]:CompMarginTDV  ) * 100 / LocalRef( RunResultsS[9]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - S-PV"  	    	Proj:RunResultsS[13]:PctImproveTDV	= {	if (LocalRef( RunResultsS[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsS[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsS[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - S-Total"    	Proj:RunResultsS[10]:PctImproveTDV	= {	if (LocalRef( RunResultsS[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsS[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsS[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - S-Comp Ttl"  	Proj:RunResultsS[11]:PctImproveTDV	= {	if (LocalRef( RunResultsS[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsS[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsS[11]:StandardTDV )  endif  }
  ; Delta Demand   - SAC 8/23/14
	"Calc Delta El Demand - S-SpcHt"    	Proj:RunResultsS[1]:DeltaDemand		= {	LocalRef( RunResultsS[1]:StdElecDemand  ) - LocalRef( RunResultsS[1]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-SpcCl"    	Proj:RunResultsS[2]:DeltaDemand		= {	LocalRef( RunResultsS[2]:StdElecDemand  ) - LocalRef( RunResultsS[2]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-IAQVent"  	Proj:RunResultsS[3]:DeltaDemand		= {	LocalRef( RunResultsS[3]:StdElecDemand  ) - LocalRef( RunResultsS[3]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-OthrHVAC" 	Proj:RunResultsS[4]:DeltaDemand		= {	LocalRef( RunResultsS[4]:StdElecDemand  ) - LocalRef( RunResultsS[4]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-WtrHt"    	Proj:RunResultsS[5]:DeltaDemand		= {	LocalRef( RunResultsS[5]:StdElecDemand  ) - LocalRef( RunResultsS[5]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-InsLtg"   	Proj:RunResultsS[6]:DeltaDemand		= {	LocalRef( RunResultsS[6]:StdElecDemand  ) - LocalRef( RunResultsS[6]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-AppCkg"   	Proj:RunResultsS[7]:DeltaDemand		= {	LocalRef( RunResultsS[7]:StdElecDemand  ) - LocalRef( RunResultsS[7]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-Plugs"    	Proj:RunResultsS[8]:DeltaDemand		= {	LocalRef( RunResultsS[8]:StdElecDemand  ) - LocalRef( RunResultsS[8]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-Ext"      	Proj:RunResultsS[9]:DeltaDemand		= {	LocalRef( RunResultsS[9]:StdElecDemand  ) - LocalRef( RunResultsS[9]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - S-PV"     	 	Proj:RunResultsS[13]:DeltaDemand		= {	LocalRef( RunResultsS[13]:StdElecDemand ) - LocalRef( RunResultsS[13]:PropElecDemand[1] )   }
	"Calc Delta El Demand - S-Total"    	Proj:RunResultsS[10]:DeltaDemand		= {	LocalRef( RunResultsS[10]:StdElecDemand ) - LocalRef( RunResultsS[10]:PropElecDemand[1] )   }
	"Calc Delta El Demand - S-Comp Ttl" 	Proj:RunResultsS[11]:DeltaDemand		= {	LocalRef( RunResultsS[11]:StdElecDemand ) - LocalRef( RunResultsS[11]:PropElecDemand[1] )   }

  ; Compliance Margins - WEST
	"Calc TDV Comp Margin - W-SpcHt"    	Proj:RunResultsW[1]:CompMarginTDV	= {	LocalRef( RunResultsW[1]:StandardTDV  ) - LocalRef( RunResultsW[1]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-SpcCl"    	Proj:RunResultsW[2]:CompMarginTDV	= {	LocalRef( RunResultsW[2]:StandardTDV  ) - LocalRef( RunResultsW[2]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-IAQVent"  	Proj:RunResultsW[3]:CompMarginTDV	= {	LocalRef( RunResultsW[3]:StandardTDV  ) - LocalRef( RunResultsW[3]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-OthrHVAC" 	Proj:RunResultsW[4]:CompMarginTDV	= {	LocalRef( RunResultsW[4]:StandardTDV  ) - LocalRef( RunResultsW[4]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-WtrHt"    	Proj:RunResultsW[5]:CompMarginTDV	= {	LocalRef( RunResultsW[5]:StandardTDV  ) - LocalRef( RunResultsW[5]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-InsLtg"   	Proj:RunResultsW[6]:CompMarginTDV	= {	LocalRef( RunResultsW[6]:StandardTDV  ) - LocalRef( RunResultsW[6]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-AppCkg"   	Proj:RunResultsW[7]:CompMarginTDV	= {	LocalRef( RunResultsW[7]:StandardTDV  ) - LocalRef( RunResultsW[7]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-Plugs"    	Proj:RunResultsW[8]:CompMarginTDV	= {	LocalRef( RunResultsW[8]:StandardTDV  ) - LocalRef( RunResultsW[8]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-Ext"      	Proj:RunResultsW[9]:CompMarginTDV	= {	LocalRef( RunResultsW[9]:StandardTDV  ) - LocalRef( RunResultsW[9]:ProposedTDV[1]  )   }
	"Calc TDV Comp Margin - W-PV"      		Proj:RunResultsW[13]:CompMarginTDV	= {	LocalRef( RunResultsW[13]:StandardTDV ) - LocalRef( RunResultsW[13]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - W-Total"    	Proj:RunResultsW[10]:CompMarginTDV	= {	LocalRef( RunResultsW[10]:StandardTDV ) - LocalRef( RunResultsW[10]:ProposedTDV[1] )   }
	"Calc TDV Comp Margin - W-Comp Ttl" 	Proj:RunResultsW[11]:CompMarginTDV	= {	LocalRef( RunResultsW[11]:StandardTDV ) - LocalRef( RunResultsW[11]:ProposedTDV[1] )   }
  ; Percent Improvement
	"Calc TDV Pct Improve - W-SpcHt"    	Proj:RunResultsW[1]:PctImproveTDV	= {	if (LocalRef( RunResultsW[1]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[1]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[1]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-SpcCl"    	Proj:RunResultsW[2]:PctImproveTDV	= {	if (LocalRef( RunResultsW[2]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[2]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[2]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-IAQVent"  	Proj:RunResultsW[3]:PctImproveTDV	= {	if (LocalRef( RunResultsW[3]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[3]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[3]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-OthrHVAC" 	Proj:RunResultsW[4]:PctImproveTDV	= {	if (LocalRef( RunResultsW[4]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[4]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[4]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-WtrHt"    	Proj:RunResultsW[5]:PctImproveTDV	= {	if (LocalRef( RunResultsW[5]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[5]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[5]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-InsLtg"   	Proj:RunResultsW[6]:PctImproveTDV	= {	if (LocalRef( RunResultsW[6]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[6]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[6]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-AppCkg"   	Proj:RunResultsW[7]:PctImproveTDV	= {	if (LocalRef( RunResultsW[7]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[7]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[7]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-Plugs"    	Proj:RunResultsW[8]:PctImproveTDV	= {	if (LocalRef( RunResultsW[8]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[8]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[8]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-Ext"      	Proj:RunResultsW[9]:PctImproveTDV	= {	if (LocalRef( RunResultsW[9]:StandardTDV  ) == 0) then  0  else  LocalRef( RunResultsW[9]:CompMarginTDV  ) * 100 / LocalRef( RunResultsW[9]:StandardTDV  )  endif  }
	"Calc TDV Pct Improve - W-PV"      		Proj:RunResultsW[13]:PctImproveTDV	= {	if (LocalRef( RunResultsW[13]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsW[13]:CompMarginTDV ) * 100 / LocalRef( RunResultsW[13]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - W-Total"    	Proj:RunResultsW[10]:PctImproveTDV	= {	if (LocalRef( RunResultsW[10]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsW[10]:CompMarginTDV ) * 100 / LocalRef( RunResultsW[10]:StandardTDV )  endif  }
	"Calc TDV Pct Improve - W-Comp Ttl"  	Proj:RunResultsW[11]:PctImproveTDV	= {	if (LocalRef( RunResultsW[11]:StandardTDV ) == 0) then  0  else  LocalRef( RunResultsW[11]:CompMarginTDV ) * 100 / LocalRef( RunResultsW[11]:StandardTDV )  endif  }
  ; Delta Demand   - SAC 8/23/14
	"Calc Delta El Demand - W-SpcHt"    	Proj:RunResultsW[1]:DeltaDemand		= {	LocalRef( RunResultsW[1]:StdElecDemand  ) - LocalRef( RunResultsW[1]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-SpcCl"    	Proj:RunResultsW[2]:DeltaDemand		= {	LocalRef( RunResultsW[2]:StdElecDemand  ) - LocalRef( RunResultsW[2]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-IAQVent"  	Proj:RunResultsW[3]:DeltaDemand		= {	LocalRef( RunResultsW[3]:StdElecDemand  ) - LocalRef( RunResultsW[3]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-OthrHVAC" 	Proj:RunResultsW[4]:DeltaDemand		= {	LocalRef( RunResultsW[4]:StdElecDemand  ) - LocalRef( RunResultsW[4]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-WtrHt"    	Proj:RunResultsW[5]:DeltaDemand		= {	LocalRef( RunResultsW[5]:StdElecDemand  ) - LocalRef( RunResultsW[5]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-InsLtg"   	Proj:RunResultsW[6]:DeltaDemand		= {	LocalRef( RunResultsW[6]:StdElecDemand  ) - LocalRef( RunResultsW[6]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-AppCkg"   	Proj:RunResultsW[7]:DeltaDemand		= {	LocalRef( RunResultsW[7]:StdElecDemand  ) - LocalRef( RunResultsW[7]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-Plugs"    	Proj:RunResultsW[8]:DeltaDemand		= {	LocalRef( RunResultsW[8]:StdElecDemand  ) - LocalRef( RunResultsW[8]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-Ext"      	Proj:RunResultsW[9]:DeltaDemand		= {	LocalRef( RunResultsW[9]:StdElecDemand  ) - LocalRef( RunResultsW[9]:PropElecDemand[1]  )   }
	"Calc Delta El Demand - W-PV"    	  	Proj:RunResultsW[13]:DeltaDemand		= {	LocalRef( RunResultsW[13]:StdElecDemand ) - LocalRef( RunResultsW[13]:PropElecDemand[1] )   }
	"Calc Delta El Demand - W-Total"    	Proj:RunResultsW[10]:DeltaDemand		= {	LocalRef( RunResultsW[10]:StdElecDemand ) - LocalRef( RunResultsW[10]:PropElecDemand[1] )   }
	"Calc Delta El Demand - W-Comp Ttl" 	Proj:RunResultsW[11]:DeltaDemand		= {	LocalRef( RunResultsW[11]:StdElecDemand ) - LocalRef( RunResultsW[11]:PropElecDemand[1] )   }

; -- NOW -- Calculate WORST case scenario and reference THOSE RunResults objects in the main RunResults[] elements
	"Determine which RunResults is Worst case"	Proj:WorstOrientation	= {	if (		RunResultsN[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
																													RunResultsN[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
																													RunResultsN[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	1
																										else if (RunResultsE[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
																													RunResultsE[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
																													RunResultsE[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	2
																										else if (RunResultsS[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
																													RunResultsS[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
																													RunResultsS[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	3	else	4	endif endif endif  }
	"Call rules to set Worst case RunResults"		Proj:Action		= {	switch (WorstOrientation)
																								case  2 :  EvalRulelist( "CARes_RunResults_SetWorst_E" )
																								case  3 :  EvalRulelist( "CARes_RunResults_SetWorst_S" )
																								case  4 :  EvalRulelist( "CARes_RunResults_SetWorst_W" )
																								default :  EvalRulelist( "CARes_RunResults_SetWorst_N" )
																							endswitch  }
END

;*************************************************************************
RULELIST "CARes_DesignRatingTDVResults_NESW" 1 0 0 1
;*************************************************************************

	"Store DRtg Proposed TDV-multiplied results (N)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultTDVResults_N" )  }		; SAC 3/14/16
	"Store DRtg Proposed TDV-multiplied results (E)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultTDVResults_E" )  }
	"Store DRtg Proposed TDV-multiplied results (S)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultTDVResults_S" )  }
	"Store DRtg Proposed TDV-multiplied results (W)"		Proj:Action = {	EvalRulelist( "CARes_DRtgPropMultTDVResults_W" )  }

; 1,           "DesignRatingTDV",   BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating TDV run result for this enduse" 
; 1,           "DRtgPctSavTDV",     BEMP_Flt,  1,  0,  0, "%",                0,  0,             39110, "Percent improvement (DesignRtg -> Prop TDV) for this enduse" 
; 1,           "DRtgDeltaDemand",   BEMP_Flt,  1,  0,  0, "kW",               0,  0,             39110, "Difference (DRtg-Prop elec demand) for this enduse" 

; 1,           "DRtgElecEnergy",    BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Eletric energy use for this enduse" 
; 1,           "DRtgNatGasEnergy",  BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Natural Gas energy use for this enduse" 
; 1,           "DRtgOtherEnergy",   BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run Other Fuel energy use for this enduse" 
; 1,           "DRtgTotalEnergy",   BEMP_Flt,  1,  0,  0, "kBTU/ft2-yr",      0,  0,             39110, "Design Rating run TOTAL energy use for this enduse" 
; 
; 1,           "DRtgElecTDV",       BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Eletric TDV for this enduse" 
; 1,           "DRtgNatGasTDV",     BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Natural Gas TDV for this enduse" 
; 1,           "DRtgOtherTDV",      BEMP_Flt,  1,  0,  0, "kTDV/ft2-yr",      0,  0,             39110, "Design Rating run Other Fuel TDV for this enduse" 
; 
; 1,           "DRtgElecDemand",    BEMP_Flt,  1,  0,  0, "kW",               0,  0,             39110, "Design Rating run Eletric TDV for this enduse" 

; SAC 3/31/16 - added rules to set RunResultsN[*]:DesignRatingTDV[2] to set fuel-adjusted design rating TDV for use in setting design rating score
; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - N-SpcHt"		Proj:RunResultsN[1]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[1]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcHt"		Proj:RunResultsN[1]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[1]:DRtgNatGasEnergy	) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcHt"		Proj:RunResultsN[1]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[1]:DRtgOtherEnergy		) < 0.0001) then  0                                                                                                        
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "HtgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Htg", "HPHtg", "Aux"                ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[1]:DRtgElecTDV ) + LocalRef( RunResultsN[1]:DRtgNatGasTDV ) + LocalRef( RunResultsN[1]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-SpcHt"		Proj:RunResultsN[1]:DesignRatingTDV[2]	= {	if (Proj:IsMultiFamily > 0.5)
																													then	if (CAClimateZoneCodeBase:mfHtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																															then	LocalRef( RunResultsN[1]:DRtgElecTDV ) + ((LocalRef( RunResultsN[1]:DRtgNatGasTDV ) + LocalRef( RunResultsN[1]:DRtgOtherTDV )) /
																																															CAClimateZoneCodeBase:mfHtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																															else	RunResultsN[1]:DesignRatingTDV[1]  endif
																													else	if (CAClimateZoneCodeBase:sfHtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																															then	LocalRef( RunResultsN[1]:DRtgElecTDV ) + ((LocalRef( RunResultsN[1]:DRtgNatGasTDV ) + LocalRef( RunResultsN[1]:DRtgOtherTDV )) /
																																															CAClimateZoneCodeBase:sfHtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																															else	RunResultsN[1]:DesignRatingTDV[1]  endif
																													endif   }
  ; SAC 8/23/14 - added rules to set elec demand
	"Calculate Elec Demand  - N-SpcHt"		Proj:RunResultsN[1]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[1]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Htg", "HPHtg", "FanH", "Aux", "Fan" ) / 3.412  endif  }

  ; Space Cooling (& cooling fan)
	"Calculate TDV - Elec   - N-SpcCl"		Proj:RunResultsN[2]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[2]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-SpcCl"		Proj:RunResultsN[2]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[2]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-SpcCl"		Proj:RunResultsN[2]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[2]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ClgTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Clg"         ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[2]:DRtgElecTDV ) + LocalRef( RunResultsN[2]:DRtgNatGasTDV ) + LocalRef( RunResultsN[2]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-SpcCl"		Proj:RunResultsN[2]:DesignRatingTDV[2]	= {	if (Proj:IsMultiFamily > 0.5)
																													then	if (CAClimateZoneCodeBase:mfClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																															then	LocalRef( RunResultsN[2]:DRtgElecTDV ) + ((LocalRef( RunResultsN[2]:DRtgNatGasTDV ) + LocalRef( RunResultsN[2]:DRtgOtherTDV )) /
																																															CAClimateZoneCodeBase:mfClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																															else	RunResultsN[2]:DesignRatingTDV[1]  endif
																													else	if (CAClimateZoneCodeBase:sfClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																															then	LocalRef( RunResultsN[2]:DRtgElecTDV ) + ((LocalRef( RunResultsN[2]:DRtgNatGasTDV ) + LocalRef( RunResultsN[2]:DRtgOtherTDV )) /
																																															CAClimateZoneCodeBase:sfClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																															else	RunResultsN[2]:DesignRatingTDV[1]  endif
																													endif   }
	"Calculate Elec Demand  - N-SpcCl"		Proj:RunResultsN[2]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[2]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Clg", "FanC" ) / 3.412  endif  }

  ; IAQ Ventilation Fans
	"Calculate TDV - Elec   - N-IAQVent"	Proj:RunResultsN[3]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[3]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "IAQVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "FanV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-IAQVent"	Proj:RunResultsN[3]:DRtgNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-IAQVent"	Proj:RunResultsN[3]:DRtgOtherTDV			= {	0  }
	"Calculate TDV - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[3]:DRtgElecTDV )   }
	"Calculate TDV - TOTAL  - N-IAQVent"	Proj:RunResultsN[3]:DesignRatingTDV[2]	= {	RunResultsN[3]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-IAQVent"	Proj:RunResultsN[3]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[3]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "FanV" ) / 3.412  endif  }

; SAC 7/14/16 - moved Aux & Fan energy into Heating enduse for consistency w/ related mods by MJB:   mjb-10/16/13	moved "Other HVAC" [4] into "Space Heating" [1]
  ; Other HVAC (aux & misc fans)
	"Calculate TDV - Elec   - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgElecTDV			= {	0  }  ; if (LocalRef( RunResultsN[4]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgNatGasTDV		= {	0  }  ; if (LocalRef( RunResultsN[4]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgOtherTDV			= {	0  }  ; if (LocalRef( RunResultsN[4]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							      ; else  int( (100 * ApplyHourlyResultMultipliers( "OthHVACTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Aux" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DesignRatingTDV[1]	= {	0  }  ; LocalRef( RunResultsN[4]:DRtgElecTDV ) + LocalRef( RunResultsN[4]:DRtgNatGasTDV ) + LocalRef( RunResultsN[4]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-OthrHVAC"	Proj:RunResultsN[4]:DesignRatingTDV[2]	= {	RunResultsN[4]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-OthrHVAC"	Proj:RunResultsN[4]:DRtgElecDemand		= {	0  }  ; if (LocalRef( RunResultsN[4]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							      ; else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Aux", "Fan" ) / 3.412  endif  }

  ; Water Heating
	"Calculate TDV - Elec   - N-WtrHt"		Proj:RunResultsN[5]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[5]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-WtrHt"		Proj:RunResultsN[5]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[5]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-WtrHt"		Proj:RunResultsN[5]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[5]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "WHtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Dhw", "DhwBU" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[5]:DRtgElecTDV ) + LocalRef( RunResultsN[5]:DRtgNatGasTDV ) + LocalRef( RunResultsN[5]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-WtrHt"		Proj:RunResultsN[5]:DesignRatingTDV[2]	= {	if (Proj:IsMultiFamily > 0.5)
																													then	if (CAClimateZoneCodeBase:mfDHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																															then	LocalRef( RunResultsN[5]:DRtgElecTDV ) + ((LocalRef( RunResultsN[5]:DRtgNatGasTDV ) + LocalRef( RunResultsN[5]:DRtgOtherTDV )) /
																																															CAClimateZoneCodeBase:mfDHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																															else	RunResultsN[5]:DesignRatingTDV[1]  endif
																													else	if (CAClimateZoneCodeBase:sfDHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																															then	LocalRef( RunResultsN[5]:DRtgElecTDV ) + ((LocalRef( RunResultsN[5]:DRtgNatGasTDV ) + LocalRef( RunResultsN[5]:DRtgOtherTDV )) /
																																															CAClimateZoneCodeBase:sfDHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																															else	RunResultsN[5]:DesignRatingTDV[1]  endif
																													endif   }
	"Calculate Elec Demand  - N-WtrHt"		Proj:RunResultsN[5]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[5]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Dhw", "DhwBU", "DHWPmp" ) / 3.412  endif  }

  ; Inside Lighting
	"Calculate TDV - Elec   - N-InsLtg"		Proj:RunResultsN[6]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[6]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-InsLtg"		Proj:RunResultsN[6]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[6]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-InsLtg"		Proj:RunResultsN[6]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[6]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ILtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Lit" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[6]:DRtgElecTDV ) + LocalRef( RunResultsN[6]:DRtgNatGasTDV ) + LocalRef( RunResultsN[6]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-InsLtg"		Proj:RunResultsN[6]:DesignRatingTDV[2]	= {	RunResultsN[6]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-InsLtg"		Proj:RunResultsN[6]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[6]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Lit" ) / 3.412  endif  }

  ; Appliances & Cooking
	"Calculate TDV - Elec   - N-AppCkg"		Proj:RunResultsN[7]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[7]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-AppCkg"		Proj:RunResultsN[7]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[7]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-AppCkg"		Proj:RunResultsN[7]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[7]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "AppTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Refr", "Dish", "Dry", "Wash", "Cook" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[7]:DRtgElecTDV ) + LocalRef( RunResultsN[7]:DRtgNatGasTDV ) + LocalRef( RunResultsN[7]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-AppCkg"		Proj:RunResultsN[7]:DesignRatingTDV[2]	= {	if (Proj:IsMultiFamily > 0.5)
																													then	if (CAClimateZoneCodeBase:mfAppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																															then	LocalRef( RunResultsN[7]:DRtgElecTDV ) + ((LocalRef( RunResultsN[7]:DRtgNatGasTDV ) + LocalRef( RunResultsN[7]:DRtgOtherTDV )) /
																																													CAClimateZoneCodeBase:mfAppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																															else	RunResultsN[7]:DesignRatingTDV[1]  endif
																													else	if (CAClimateZoneCodeBase:sfAppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) > 0)
																															then	LocalRef( RunResultsN[7]:DRtgElecTDV ) + ((LocalRef( RunResultsN[7]:DRtgNatGasTDV ) + LocalRef( RunResultsN[7]:DRtgOtherTDV )) /
																																													CAClimateZoneCodeBase:sfAppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))
																															else	RunResultsN[7]:DesignRatingTDV[1]  endif
																													endif   }
	"Calculate Elec Demand  - N-AppCkg"		Proj:RunResultsN[7]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[7]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Refr", "Dish", "Dry", "Wash", "Cook" ) / 3.412  endif  }

  ; Plug Loads
	"Calculate TDV - Elec   - N-Plugs"		Proj:RunResultsN[8]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[8]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Plugs"		Proj:RunResultsN[8]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[8]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Plugs"		Proj:RunResultsN[8]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[8]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "RcpTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Rcp" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[8]:DRtgElecTDV ) + LocalRef( RunResultsN[8]:DRtgNatGasTDV ) + LocalRef( RunResultsN[8]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-Plugs"		Proj:RunResultsN[8]:DesignRatingTDV[2]	= {	RunResultsN[8]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-Plugs"		Proj:RunResultsN[8]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[8]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Rcp" ) / 3.412  endif  }

  ; Exterior
	"Calculate TDV - Elec   - N-Ext"			Proj:RunResultsN[9]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[9]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec",   "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-Ext"			Proj:RunResultsN[9]:DRtgNatGasTDV		= {	if (LocalRef( RunResultsN[9]:DRtgNatGasEnergy	) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 2, Local( RunID ), "MtrNatGas", "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - Other  - N-Ext"			Proj:RunResultsN[9]:DRtgOtherTDV			= {	if (LocalRef( RunResultsN[9]:DRtgOtherEnergy		) < 0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "ExtTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 3, Local( RunID ), "MtrOther",  "Ext" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - TOTAL  - N-Ext"			Proj:RunResultsN[9]:DesignRatingTDV[1]	= {	LocalRef( RunResultsN[9]:DRtgElecTDV ) + LocalRef( RunResultsN[9]:DRtgNatGasTDV ) + LocalRef( RunResultsN[9]:DRtgOtherTDV )   }
	"Calculate TDV - TOTAL  - N-Ext"			Proj:RunResultsN[9]:DesignRatingTDV[2]	= {	RunResultsN[9]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-Ext"			Proj:RunResultsN[9]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[9]:DRtgElecEnergy		) < 0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "Ext" ) / 3.412  endif  }

  ; PV
	"Calculate TDV - Elec   - N-PV"			Proj:RunResultsN[13]:DRtgElecTDV			= {	if (LocalRef( RunResultsN[13]:DRtgElecEnergy		) > -0.0001) then  0
			 			  																							else  int( (100 * ApplyHourlyResultMultipliers( "PVTDV", "TDVTable", ((Local( ClimateZone )-1) * 3) + 1, Local( RunID ), "MtrElec", "PV" ) / Local( CondFloorArea )) + 0.5) / 100  endif  }
	"Calculate TDV - NatGas - N-PV"			Proj:RunResultsN[13]:DRtgNatGasTDV		= {	0  }
	"Calculate TDV - Other  - N-PV"			Proj:RunResultsN[13]:DRtgOtherTDV		= {	0  }
	"Calculate TDV - TOTAL  - N-PV"			Proj:RunResultsN[13]:DesignRatingTDV[1] = {	LocalRef( RunResultsN[13]:DRtgElecTDV )   }
	"Calculate TDV - TOTAL  - N-PV"			Proj:RunResultsN[13]:DesignRatingTDV[2] = {	RunResultsN[13]:DesignRatingTDV[1]   }
	"Calculate Elec Demand  - N-PV"			Proj:RunResultsN[13]:DRtgElecDemand		= {	if (LocalRef( RunResultsN[13]:DRtgElecEnergy		) > -0.0001) then  0
			 			  																							else  ApplyHourlyResultMultipliers( "none", "PeakDemandTable", 1, Local( RunID ), "MtrElec",   "PV" ) / 3.412  endif  }

  ; Compliance Total
	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecTDV			= {	RunResultsN[1]:DRtgElecTDV     + RunResultsN[2]:DRtgElecTDV     + RunResultsN[3]:DRtgElecTDV     + RunResultsN[4]:DRtgElecTDV     + RunResultsN[5]:DRtgElecTDV      }
	"Calculate TDV - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgNatGasTDV		= {	RunResultsN[1]:DRtgNatGasTDV   + RunResultsN[2]:DRtgNatGasTDV   + RunResultsN[3]:DRtgNatGasTDV   + RunResultsN[4]:DRtgNatGasTDV   + RunResultsN[5]:DRtgNatGasTDV    }
	"Calculate TDV - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgOtherTDV		= {	RunResultsN[1]:DRtgOtherTDV    + RunResultsN[2]:DRtgOtherTDV    + RunResultsN[3]:DRtgOtherTDV    + RunResultsN[4]:DRtgOtherTDV    + RunResultsN[5]:DRtgOtherTDV     }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingTDV[1] = {	RunResultsN[1]:DesignRatingTDV[1] + RunResultsN[2]:DesignRatingTDV[1] + RunResultsN[3]:DesignRatingTDV[1] + RunResultsN[4]:DesignRatingTDV[1] + RunResultsN[5]:DesignRatingTDV[1]  }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingTDV[2] = {	RunResultsN[1]:DesignRatingTDV[2] + RunResultsN[2]:DesignRatingTDV[2] + RunResultsN[3]:DesignRatingTDV[2] + RunResultsN[4]:DesignRatingTDV[2] + RunResultsN[5]:DesignRatingTDV[2]  }
	"Calculate Elec Demand  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecDemand		= {	RunResultsN[1]:DRtgElecDemand  + RunResultsN[2]:DRtgElecDemand  + RunResultsN[3]:DRtgElecDemand  + RunResultsN[4]:DRtgElecDemand  + RunResultsN[5]:DRtgElecDemand   }

  ; Total
	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:DRtgElecTDV			= {	RunResultsN[11]:DRtgElecTDV     + RunResultsN[6]:DRtgElecTDV     + RunResultsN[7]:DRtgElecTDV     + RunResultsN[8]:DRtgElecTDV     + RunResultsN[9]:DRtgElecTDV      }
	"Calculate TDV - NatGas - N-Total"		Proj:RunResultsN[10]:DRtgNatGasTDV		= {	RunResultsN[11]:DRtgNatGasTDV   + RunResultsN[6]:DRtgNatGasTDV   + RunResultsN[7]:DRtgNatGasTDV   + RunResultsN[8]:DRtgNatGasTDV   + RunResultsN[9]:DRtgNatGasTDV    }
	"Calculate TDV - Other  - N-Total"		Proj:RunResultsN[10]:DRtgOtherTDV		= {	RunResultsN[11]:DRtgOtherTDV    + RunResultsN[6]:DRtgOtherTDV    + RunResultsN[7]:DRtgOtherTDV    + RunResultsN[8]:DRtgOtherTDV    + RunResultsN[9]:DRtgOtherTDV     }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingTDV[1] = {	RunResultsN[11]:DesignRatingTDV[1] + RunResultsN[6]:DesignRatingTDV[1] + RunResultsN[7]:DesignRatingTDV[1] + RunResultsN[8]:DesignRatingTDV[1] + RunResultsN[9]:DesignRatingTDV[1]  }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingTDV[2] = {	RunResultsN[11]:DesignRatingTDV[2] + RunResultsN[6]:DesignRatingTDV[2] + RunResultsN[7]:DesignRatingTDV[2] + RunResultsN[8]:DesignRatingTDV[2] + RunResultsN[9]:DesignRatingTDV[2]  }
	"Calculate Elec Demand  - N-Total"		Proj:RunResultsN[10]:DRtgElecDemand		= {	RunResultsN[11]:DRtgElecDemand  + RunResultsN[6]:DRtgElecDemand  + RunResultsN[7]:DRtgElecDemand  + RunResultsN[8]:DRtgElecDemand  + RunResultsN[9]:DRtgElecDemand   }


  ; SAC 2/1/16 - inserted RE-calc of Standard model PVCredit (so that it is available for analysis results reporting following design rating run)
	"Set Proj:PVBaseTDV"						Proj:PVBaseTDV	= {	RunResultsN[11]:StandardTDV * CondFloorArea  }		; SAC 4/14/15 - switched from elecTotalTDV to totalCompTDV - was: RunResultsN[10]:StdElecTDV
	"Perform PV calcs if applicable"		Proj:Action		= {	if (PVGenCredit < 1 .OR. StandardsVersion == 2014 .OR. CondFloorArea < 0.01) then  UNCHANGED
																				else	switch ( CompCodeBase )
																							case  2013 :	EvalRulelist( "CARes_CalculatePVCredit_2013Compliance" )
																							case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016Compliance" )
																							default    :	UNCHANGED
																						endswitch  endif  }

	; SAC 4/2/14 - moved PV credit calcs into subordinate rulelist
	"Set Proj:PVBaseTDV - DRtg"						Proj:PVBaseTDV	= {	RunResultsN[10]:DesignRatingTDV[1] * CondFloorArea  }		; SAC 4/14/15 - switched from elecTDV to totalTDV - was: RunResultsN[10]:DRtgElecTDV
	"Perform PV calcs if applicable - DRtg"		Proj:Action		= {	if (PVGenCredit < 1 .OR. (StdDesignBase == 2013 .AND. StandardsVersion == 2014) .OR. CondFloorArea < 0.01) then  UNCHANGED
																							else	switch ( CompCodeBase )
																										case  2016 :	EvalRulelist( "CARes_CalculatePVCredit_2016DesignRating" )
																										default    :	UNCHANGED
																									endswitch  endif  }
	; SAC 4/3/15 - set new EnergyUse:PropPVCreditTDV property (needed to track & pass PVCredit from first to second Proposed EnergyUse data)
	"Store PropPVCreditTDV[2] - N"			Proj:RunResultsN[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }
	"Store PropPVCreditTDV[2] - E"			Proj:RunResultsE[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }
	"Store PropPVCreditTDV[2] - S"			Proj:RunResultsS[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }
	"Store PropPVCreditTDV[2] - W"			Proj:RunResultsW[6]:PropPVCreditTDV[2]		= {	PVCredit[2]  }

	; SAC 4/9/15 - adjust RunResults[6]:Prop*[2] properties for DRtgLtgReduction
	"Adjust - Elec   - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropElecEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsN[6]:PropElecEnergy[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsN[6]:PropElecEnergy[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - NatGas - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropNatGasEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResultsN[6]:PropNatGasEnergy[2] <= 0) then  UNCHANGED
			 			  																												else                           RunResultsN[6]:PropNatGasEnergy[2] * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Other  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropOtherEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsN[6]:PropOtherEnergy[2]  <= 0) then  UNCHANGED
			 			  																												else                           RunResultsN[6]:PropOtherEnergy[2]  * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Elec   - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropElecTDV[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsN[6]:PropElecTDV[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsN[6]:PropElecTDV[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropNatGasTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasTDV[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasTDV[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropOtherTDV				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherTDV[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherTDV[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Adjust E Demand - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropElecDemand[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsN[6]:PropElecDemand[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsN[6]:PropElecDemand[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Recalc - TOTAL  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:PropTotalEnergy[2]		= {	RunResultsN[6]:PropElecEnergy[2] + RunResultsN[6]:PropNatGasEnergy[2] + RunResultsN[6]:PropOtherEnergy[2]   }
	"Recalc - TOTAL  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:ProposedTDV[2]			= {	RunResultsN[6]:PropElecTDV[2]    + RunResultsN[6]:PropNatGasTDV       + RunResultsN[6]:PropOtherTDV         }
	"Recalc - TOTAL  - N-InsLtg for DRtgLtgReduction"	Proj:RunResultsN[6]:ProposedTDV[3]			= {	RunResultsN[6]:ProposedTDV[2]  }

	"Adjust - Elec   - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropElecEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsE[6]:PropElecEnergy[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsE[6]:PropElecEnergy[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - NatGas - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropNatGasEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResultsE[6]:PropNatGasEnergy[2] <= 0) then  UNCHANGED
			 			  																												else                           RunResultsE[6]:PropNatGasEnergy[2] * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Other  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropOtherEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsE[6]:PropOtherEnergy[2]  <= 0) then  UNCHANGED
			 			  																												else                           RunResultsE[6]:PropOtherEnergy[2]  * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Elec   - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropElecTDV[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsE[6]:PropElecTDV[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsE[6]:PropElecTDV[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropNatGasTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasTDV[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasTDV[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropOtherTDV				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherTDV[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherTDV[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Adjust E Demand - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropElecDemand[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsE[6]:PropElecDemand[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsE[6]:PropElecDemand[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Recalc - TOTAL  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:PropTotalEnergy[2]		= {	RunResultsE[6]:PropElecEnergy[2] + RunResultsE[6]:PropNatGasEnergy[2] + RunResultsE[6]:PropOtherEnergy[2]   }
	"Recalc - TOTAL  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:ProposedTDV[2]			= {	RunResultsE[6]:PropElecTDV[2]    + RunResultsE[6]:PropNatGasTDV       + RunResultsE[6]:PropOtherTDV         }
	"Recalc - TOTAL  - E-InsLtg for DRtgLtgReduction"	Proj:RunResultsE[6]:ProposedTDV[3]			= {	RunResultsE[6]:ProposedTDV[2]  }

	"Adjust - Elec   - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropElecEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsS[6]:PropElecEnergy[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsS[6]:PropElecEnergy[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - NatGas - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropNatGasEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResultsS[6]:PropNatGasEnergy[2] <= 0) then  UNCHANGED
			 			  																												else                           RunResultsS[6]:PropNatGasEnergy[2] * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Other  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropOtherEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsS[6]:PropOtherEnergy[2]  <= 0) then  UNCHANGED
			 			  																												else                           RunResultsS[6]:PropOtherEnergy[2]  * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Elec   - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropElecTDV[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsS[6]:PropElecTDV[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsS[6]:PropElecTDV[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropNatGasTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasTDV[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasTDV[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropOtherTDV				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherTDV[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherTDV[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Adjust E Demand - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropElecDemand[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsS[6]:PropElecDemand[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsS[6]:PropElecDemand[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Recalc - TOTAL  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:PropTotalEnergy[2]		= {	RunResultsS[6]:PropElecEnergy[2] + RunResultsS[6]:PropNatGasEnergy[2] + RunResultsS[6]:PropOtherEnergy[2]   }
	"Recalc - TOTAL  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:ProposedTDV[2]			= {	RunResultsS[6]:PropElecTDV[2]    + RunResultsS[6]:PropNatGasTDV       + RunResultsS[6]:PropOtherTDV         }
	"Recalc - TOTAL  - S-InsLtg for DRtgLtgReduction"	Proj:RunResultsS[6]:ProposedTDV[3]			= {	RunResultsS[6]:ProposedTDV[2]  }

	"Adjust - Elec   - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropElecEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsW[6]:PropElecEnergy[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsW[6]:PropElecEnergy[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - NatGas - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropNatGasEnergy[2]	= {	if (DRtgLtgReduction <= 0 .OR. RunResultsW[6]:PropNatGasEnergy[2] <= 0) then  UNCHANGED
			 			  																												else                           RunResultsW[6]:PropNatGasEnergy[2] * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Other  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropOtherEnergy[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsW[6]:PropOtherEnergy[2]  <= 0) then  UNCHANGED
			 			  																												else                           RunResultsW[6]:PropOtherEnergy[2]  * (100 - DRtgLtgReduction) / 100  endif  }
	"Adjust - Elec   - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropElecTDV[2]			= {	if (DRtgLtgReduction <= 0 .OR. RunResultsW[6]:PropElecTDV[2]      <= 0) then  UNCHANGED
			 			  																												else              int( (100 * (RunResultsW[6]:PropElecTDV[2]      * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - NatGas - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropNatGasTDV			= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropNatGasTDV[2]    <= 0) then  UNCHANGED
;			 			  																												else              int( (100 * (RunResults[6]:PropNatGasTDV[2]    * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
;	"Adjust - Other  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropOtherTDV				= {	if (DRtgLtgReduction <= 0 .OR. RunResults[6]:PropOtherTDV[2]     <= 0) then  UNCHANGED
;																																		else              int( (100 * (RunResults[6]:PropOtherTDV[2]     * (100 - DRtgLtgReduction) / 100) + 0.5) ) / 100  endif  }
	"Adjust E Demand - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropElecDemand[2]		= {	if (DRtgLtgReduction <= 0 .OR. RunResultsW[6]:PropElecDemand[2]   <= 0) then  UNCHANGED
			 			  																												else                           RunResultsW[6]:PropElecDemand[2]   * (100 - DRtgLtgReduction) / 100  endif  }
	"Recalc - TOTAL  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:PropTotalEnergy[2]		= {	RunResultsW[6]:PropElecEnergy[2] + RunResultsW[6]:PropNatGasEnergy[2] + RunResultsW[6]:PropOtherEnergy[2]   }
	"Recalc - TOTAL  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:ProposedTDV[2]			= {	RunResultsW[6]:PropElecTDV[2]    + RunResultsW[6]:PropNatGasTDV       + RunResultsW[6]:PropOtherTDV         }
	"Recalc - TOTAL  - W-InsLtg for DRtgLtgReduction"	Proj:RunResultsW[6]:ProposedTDV[3]			= {	RunResultsW[6]:ProposedTDV[2]  }

; ADJUST certain Proposed results that now are to have PVCredit applied to them
; mjb-10/16/13	subtracted PVCredit from Proposed Design Elec and TOTAL 
; SAC 4/9/15 - updated to also recalc energy use sums (to catch mods for design rating lighting credit)
	"Recalc total - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecEnergy[2]		= {	RunResultsN[1]:PropElecEnergy[2]    + RunResultsN[2]:PropElecEnergy[2]   + RunResultsN[3]:PropElecEnergy[2]   + RunResultsN[4]:PropElecEnergy[2]   + RunResultsN[5]:PropElecEnergy[2]   + RunResultsN[13]:PropElecEnergy[2]    }
	"Recalc total - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:PropNatGasEnergy[2]	= {	RunResultsN[1]:PropNatGasEnergy[2]  + RunResultsN[2]:PropNatGasEnergy[2] + RunResultsN[3]:PropNatGasEnergy[2] + RunResultsN[4]:PropNatGasEnergy[2] + RunResultsN[5]:PropNatGasEnergy[2] + RunResultsN[13]:PropNatGasEnergy[2]  }
	"Recalc total - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:PropOtherEnergy[2]	= {	RunResultsN[1]:PropOtherEnergy[2]   + RunResultsN[2]:PropOtherEnergy[2]  + RunResultsN[3]:PropOtherEnergy[2]  + RunResultsN[4]:PropOtherEnergy[2]  + RunResultsN[5]:PropOtherEnergy[2]  + RunResultsN[13]:PropOtherEnergy[2]   }
	"Recalc total - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:PropTotalEnergy[2]	= {	RunResultsN[1]:PropTotalEnergy[2]   + RunResultsN[2]:PropTotalEnergy[2]  + RunResultsN[3]:PropTotalEnergy[2]  + RunResultsN[4]:PropTotalEnergy[2]  + RunResultsN[5]:PropTotalEnergy[2]  + RunResultsN[13]:PropTotalEnergy[2]   }
	"Recalc TDV   - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:PropElecTDV[2]			= {	RunResultsN[1]:PropElecTDV[2]       + RunResultsN[2]:PropElecTDV[2]      + RunResultsN[3]:PropElecTDV[2]      + RunResultsN[4]:PropElecTDV[2]      + RunResultsN[5]:PropElecTDV[2]      + RunResultsN[13]:PropElecTDV[2]       } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[2]			= {	RunResultsN[1]:ProposedTDV[2]       + RunResultsN[2]:ProposedTDV[2]      + RunResultsN[3]:ProposedTDV[2]      + RunResultsN[4]:ProposedTDV[2]      + RunResultsN[5]:ProposedTDV[2]      + RunResultsN[13]:ProposedTDV[2]       } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:ProposedTDV[3]			= {	RunResultsN[1]:ProposedTDV[3]       + RunResultsN[2]:ProposedTDV[3]      + RunResultsN[3]:ProposedTDV[3]      + RunResultsN[4]:ProposedTDV[3]      + RunResultsN[5]:ProposedTDV[3]      + RunResultsN[13]:ProposedTDV[3]       } ; - PVCredit[2]  }
	"Recalc total - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecEnergy[2]		= {	RunResultsN[11]:PropElecEnergy[2]   + RunResultsN[6]:PropElecEnergy[2]   + RunResultsN[7]:PropElecEnergy[2]   + RunResultsN[8]:PropElecEnergy[2]   + RunResultsN[9]:PropElecEnergy[2]    }
	"Recalc total - NatGas - N-Total"		Proj:RunResultsN[10]:PropNatGasEnergy[2]	= {	RunResultsN[11]:PropNatGasEnergy[2] + RunResultsN[6]:PropNatGasEnergy[2] + RunResultsN[7]:PropNatGasEnergy[2] + RunResultsN[8]:PropNatGasEnergy[2] + RunResultsN[9]:PropNatGasEnergy[2]  }
	"Recalc total - Other  - N-Total"		Proj:RunResultsN[10]:PropOtherEnergy[2]	= {	RunResultsN[11]:PropOtherEnergy[2]  + RunResultsN[6]:PropOtherEnergy[2]  + RunResultsN[7]:PropOtherEnergy[2]  + RunResultsN[8]:PropOtherEnergy[2]  + RunResultsN[9]:PropOtherEnergy[2]   }
	"Recalc total - TOTAL  - N-Total"		Proj:RunResultsN[10]:PropTotalEnergy[2]	= {	RunResultsN[11]:PropTotalEnergy[2]  + RunResultsN[6]:PropTotalEnergy[2]  + RunResultsN[7]:PropTotalEnergy[2]  + RunResultsN[8]:PropTotalEnergy[2]  + RunResultsN[9]:PropTotalEnergy[2]   }
	"Recalc TDV   - Elec   - N-Total"		Proj:RunResultsN[10]:PropElecTDV[2]			= {	RunResultsN[11]:PropElecTDV[2]      + RunResultsN[6]:PropElecTDV[2]      + RunResultsN[7]:PropElecTDV[2]      + RunResultsN[8]:PropElecTDV[2]      + RunResultsN[9]:PropElecTDV[2]       }
	"Recalc TDV   - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedTDV[2]			= {	RunResultsN[11]:ProposedTDV[2]      + RunResultsN[6]:ProposedTDV[2]      + RunResultsN[7]:ProposedTDV[2]      + RunResultsN[8]:ProposedTDV[2]      + RunResultsN[9]:ProposedTDV[2]       }
	"Recalc TDV   - TOTAL  - N-Total"		Proj:RunResultsN[10]:ProposedTDV[3]			= {	RunResultsN[11]:ProposedTDV[3]      + RunResultsN[6]:ProposedTDV[3]      + RunResultsN[7]:ProposedTDV[3]      + RunResultsN[8]:ProposedTDV[3]      + RunResultsN[9]:ProposedTDV[3]       }

	"Recalc total - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecEnergy[2]		= {	RunResultsE[1]:PropElecEnergy[2]    + RunResultsE[2]:PropElecEnergy[2]   + RunResultsE[3]:PropElecEnergy[2]   + RunResultsE[4]:PropElecEnergy[2]   + RunResultsE[5]:PropElecEnergy[2]   + RunResultsE[13]:PropElecEnergy[2]    }
	"Recalc total - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:PropNatGasEnergy[2]	= {	RunResultsE[1]:PropNatGasEnergy[2]  + RunResultsE[2]:PropNatGasEnergy[2] + RunResultsE[3]:PropNatGasEnergy[2] + RunResultsE[4]:PropNatGasEnergy[2] + RunResultsE[5]:PropNatGasEnergy[2] + RunResultsE[13]:PropNatGasEnergy[2]  }
	"Recalc total - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:PropOtherEnergy[2]	= {	RunResultsE[1]:PropOtherEnergy[2]   + RunResultsE[2]:PropOtherEnergy[2]  + RunResultsE[3]:PropOtherEnergy[2]  + RunResultsE[4]:PropOtherEnergy[2]  + RunResultsE[5]:PropOtherEnergy[2]  + RunResultsE[13]:PropOtherEnergy[2]   }
	"Recalc total - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:PropTotalEnergy[2]	= {	RunResultsE[1]:PropTotalEnergy[2]   + RunResultsE[2]:PropTotalEnergy[2]  + RunResultsE[3]:PropTotalEnergy[2]  + RunResultsE[4]:PropTotalEnergy[2]  + RunResultsE[5]:PropTotalEnergy[2]  + RunResultsE[13]:PropTotalEnergy[2]   }
	"Recalc TDV   - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:PropElecTDV[2]			= {	RunResultsE[1]:PropElecTDV[2]       + RunResultsE[2]:PropElecTDV[2]      + RunResultsE[3]:PropElecTDV[2]      + RunResultsE[4]:PropElecTDV[2]      + RunResultsE[5]:PropElecTDV[2]      + RunResultsE[13]:PropElecTDV[2]       } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[2]			= {	RunResultsE[1]:ProposedTDV[2]       + RunResultsE[2]:ProposedTDV[2]      + RunResultsE[3]:ProposedTDV[2]      + RunResultsE[4]:ProposedTDV[2]      + RunResultsE[5]:ProposedTDV[2]      + RunResultsE[13]:ProposedTDV[2]       } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:ProposedTDV[3]			= {	RunResultsE[1]:ProposedTDV[3]       + RunResultsE[2]:ProposedTDV[3]      + RunResultsE[3]:ProposedTDV[3]      + RunResultsE[4]:ProposedTDV[3]      + RunResultsE[5]:ProposedTDV[3]      + RunResultsE[13]:ProposedTDV[3]       } ; - PVCredit[2]  }
	"Recalc total - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecEnergy[2]		= {	RunResultsE[11]:PropElecEnergy[2]   + RunResultsE[6]:PropElecEnergy[2]   + RunResultsE[7]:PropElecEnergy[2]   + RunResultsE[8]:PropElecEnergy[2]   + RunResultsE[9]:PropElecEnergy[2]    }
	"Recalc total - NatGas - E-Total"		Proj:RunResultsE[10]:PropNatGasEnergy[2]	= {	RunResultsE[11]:PropNatGasEnergy[2] + RunResultsE[6]:PropNatGasEnergy[2] + RunResultsE[7]:PropNatGasEnergy[2] + RunResultsE[8]:PropNatGasEnergy[2] + RunResultsE[9]:PropNatGasEnergy[2]  }
	"Recalc total - Other  - E-Total"		Proj:RunResultsE[10]:PropOtherEnergy[2]	= {	RunResultsE[11]:PropOtherEnergy[2]  + RunResultsE[6]:PropOtherEnergy[2]  + RunResultsE[7]:PropOtherEnergy[2]  + RunResultsE[8]:PropOtherEnergy[2]  + RunResultsE[9]:PropOtherEnergy[2]   }
	"Recalc total - TOTAL  - E-Total"		Proj:RunResultsE[10]:PropTotalEnergy[2]	= {	RunResultsE[11]:PropTotalEnergy[2]  + RunResultsE[6]:PropTotalEnergy[2]  + RunResultsE[7]:PropTotalEnergy[2]  + RunResultsE[8]:PropTotalEnergy[2]  + RunResultsE[9]:PropTotalEnergy[2]   }
	"Recalc TDV   - Elec   - E-Total"		Proj:RunResultsE[10]:PropElecTDV[2]			= {	RunResultsE[11]:PropElecTDV[2]      + RunResultsE[6]:PropElecTDV[2]      + RunResultsE[7]:PropElecTDV[2]      + RunResultsE[8]:PropElecTDV[2]      + RunResultsE[9]:PropElecTDV[2]       }
	"Recalc TDV   - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedTDV[2]			= {	RunResultsE[11]:ProposedTDV[2]      + RunResultsE[6]:ProposedTDV[2]      + RunResultsE[7]:ProposedTDV[2]      + RunResultsE[8]:ProposedTDV[2]      + RunResultsE[9]:ProposedTDV[2]       }
	"Recalc TDV   - TOTAL  - E-Total"		Proj:RunResultsE[10]:ProposedTDV[3]			= {	RunResultsE[11]:ProposedTDV[3]      + RunResultsE[6]:ProposedTDV[3]      + RunResultsE[7]:ProposedTDV[3]      + RunResultsE[8]:ProposedTDV[3]      + RunResultsE[9]:ProposedTDV[3]       }
                                                                                                                                                                                                                                                          
	"Recalc total - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecEnergy[2]		= {	RunResultsS[1]:PropElecEnergy[2]    + RunResultsS[2]:PropElecEnergy[2]   + RunResultsS[3]:PropElecEnergy[2]   + RunResultsS[4]:PropElecEnergy[2]   + RunResultsS[5]:PropElecEnergy[2]   + RunResultsS[13]:PropElecEnergy[2]    }
	"Recalc total - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:PropNatGasEnergy[2]	= {	RunResultsS[1]:PropNatGasEnergy[2]  + RunResultsS[2]:PropNatGasEnergy[2] + RunResultsS[3]:PropNatGasEnergy[2] + RunResultsS[4]:PropNatGasEnergy[2] + RunResultsS[5]:PropNatGasEnergy[2] + RunResultsS[13]:PropNatGasEnergy[2]  }
	"Recalc total - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:PropOtherEnergy[2]	= {	RunResultsS[1]:PropOtherEnergy[2]   + RunResultsS[2]:PropOtherEnergy[2]  + RunResultsS[3]:PropOtherEnergy[2]  + RunResultsS[4]:PropOtherEnergy[2]  + RunResultsS[5]:PropOtherEnergy[2]  + RunResultsS[13]:PropOtherEnergy[2]   }
	"Recalc total - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:PropTotalEnergy[2]	= {	RunResultsS[1]:PropTotalEnergy[2]   + RunResultsS[2]:PropTotalEnergy[2]  + RunResultsS[3]:PropTotalEnergy[2]  + RunResultsS[4]:PropTotalEnergy[2]  + RunResultsS[5]:PropTotalEnergy[2]  + RunResultsS[13]:PropTotalEnergy[2]   }
	"Recalc TDV   - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:PropElecTDV[2]			= {	RunResultsS[1]:PropElecTDV[2]       + RunResultsS[2]:PropElecTDV[2]      + RunResultsS[3]:PropElecTDV[2]      + RunResultsS[4]:PropElecTDV[2]      + RunResultsS[5]:PropElecTDV[2]      + RunResultsS[13]:PropElecTDV[2]       } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[2]			= {	RunResultsS[1]:ProposedTDV[2]       + RunResultsS[2]:ProposedTDV[2]      + RunResultsS[3]:ProposedTDV[2]      + RunResultsS[4]:ProposedTDV[2]      + RunResultsS[5]:ProposedTDV[2]      + RunResultsS[13]:ProposedTDV[2]       } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:ProposedTDV[3]			= {	RunResultsS[1]:ProposedTDV[3]       + RunResultsS[2]:ProposedTDV[3]      + RunResultsS[3]:ProposedTDV[3]      + RunResultsS[4]:ProposedTDV[3]      + RunResultsS[5]:ProposedTDV[3]      + RunResultsS[13]:ProposedTDV[3]       } ; - PVCredit[2]  }
	"Recalc total - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecEnergy[2]		= {	RunResultsS[11]:PropElecEnergy[2]   + RunResultsS[6]:PropElecEnergy[2]   + RunResultsS[7]:PropElecEnergy[2]   + RunResultsS[8]:PropElecEnergy[2]   + RunResultsS[9]:PropElecEnergy[2]    }
	"Recalc total - NatGas - S-Total"		Proj:RunResultsS[10]:PropNatGasEnergy[2]	= {	RunResultsS[11]:PropNatGasEnergy[2] + RunResultsS[6]:PropNatGasEnergy[2] + RunResultsS[7]:PropNatGasEnergy[2] + RunResultsS[8]:PropNatGasEnergy[2] + RunResultsS[9]:PropNatGasEnergy[2]  }
	"Recalc total - Other  - S-Total"		Proj:RunResultsS[10]:PropOtherEnergy[2]	= {	RunResultsS[11]:PropOtherEnergy[2]  + RunResultsS[6]:PropOtherEnergy[2]  + RunResultsS[7]:PropOtherEnergy[2]  + RunResultsS[8]:PropOtherEnergy[2]  + RunResultsS[9]:PropOtherEnergy[2]   }
	"Recalc total - TOTAL  - S-Total"		Proj:RunResultsS[10]:PropTotalEnergy[2]	= {	RunResultsS[11]:PropTotalEnergy[2]  + RunResultsS[6]:PropTotalEnergy[2]  + RunResultsS[7]:PropTotalEnergy[2]  + RunResultsS[8]:PropTotalEnergy[2]  + RunResultsS[9]:PropTotalEnergy[2]   }
	"Recalc TDV   - Elec   - S-Total"		Proj:RunResultsS[10]:PropElecTDV[2]			= {	RunResultsS[11]:PropElecTDV[2]      + RunResultsS[6]:PropElecTDV[2]      + RunResultsS[7]:PropElecTDV[2]      + RunResultsS[8]:PropElecTDV[2]      + RunResultsS[9]:PropElecTDV[2]       }
	"Recalc TDV   - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedTDV[2]			= {	RunResultsS[11]:ProposedTDV[2]      + RunResultsS[6]:ProposedTDV[2]      + RunResultsS[7]:ProposedTDV[2]      + RunResultsS[8]:ProposedTDV[2]      + RunResultsS[9]:ProposedTDV[2]       }
	"Recalc TDV   - TOTAL  - S-Total"		Proj:RunResultsS[10]:ProposedTDV[3]			= {	RunResultsS[11]:ProposedTDV[3]      + RunResultsS[6]:ProposedTDV[3]      + RunResultsS[7]:ProposedTDV[3]      + RunResultsS[8]:ProposedTDV[3]      + RunResultsS[9]:ProposedTDV[3]       }
                                                                                                                                                                                                                                                          
	"Recalc total - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecEnergy[2]		= {	RunResultsW[1]:PropElecEnergy[2]    + RunResultsW[2]:PropElecEnergy[2]   + RunResultsW[3]:PropElecEnergy[2]   + RunResultsW[4]:PropElecEnergy[2]   + RunResultsW[5]:PropElecEnergy[2]   + RunResultsW[13]:PropElecEnergy[2]    }
	"Recalc total - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:PropNatGasEnergy[2]	= {	RunResultsW[1]:PropNatGasEnergy[2]  + RunResultsW[2]:PropNatGasEnergy[2] + RunResultsW[3]:PropNatGasEnergy[2] + RunResultsW[4]:PropNatGasEnergy[2] + RunResultsW[5]:PropNatGasEnergy[2] + RunResultsW[13]:PropNatGasEnergy[2]  }
	"Recalc total - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:PropOtherEnergy[2]	= {	RunResultsW[1]:PropOtherEnergy[2]   + RunResultsW[2]:PropOtherEnergy[2]  + RunResultsW[3]:PropOtherEnergy[2]  + RunResultsW[4]:PropOtherEnergy[2]  + RunResultsW[5]:PropOtherEnergy[2]  + RunResultsW[13]:PropOtherEnergy[2]   }
	"Recalc total - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:PropTotalEnergy[2]	= {	RunResultsW[1]:PropTotalEnergy[2]   + RunResultsW[2]:PropTotalEnergy[2]  + RunResultsW[3]:PropTotalEnergy[2]  + RunResultsW[4]:PropTotalEnergy[2]  + RunResultsW[5]:PropTotalEnergy[2]  + RunResultsW[13]:PropTotalEnergy[2]   }
	"Recalc TDV   - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:PropElecTDV[2]			= {	RunResultsW[1]:PropElecTDV[2]       + RunResultsW[2]:PropElecTDV[2]      + RunResultsW[3]:PropElecTDV[2]      + RunResultsW[4]:PropElecTDV[2]      + RunResultsW[5]:PropElecTDV[2]      + RunResultsW[13]:PropElecTDV[2]       } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[2]			= {	RunResultsW[1]:ProposedTDV[2]       + RunResultsW[2]:ProposedTDV[2]      + RunResultsW[3]:ProposedTDV[2]      + RunResultsW[4]:ProposedTDV[2]      + RunResultsW[5]:ProposedTDV[2]      + RunResultsW[13]:ProposedTDV[2]       } ; - PVCredit[2]  }
	"Recalc TDV   - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:ProposedTDV[3]			= {	RunResultsW[1]:ProposedTDV[3]       + RunResultsW[2]:ProposedTDV[3]      + RunResultsW[3]:ProposedTDV[3]      + RunResultsW[4]:ProposedTDV[3]      + RunResultsW[5]:ProposedTDV[3]      + RunResultsW[13]:ProposedTDV[3]       } ; - PVCredit[2]  }
	"Recalc total - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecEnergy[2]		= {	RunResultsW[11]:PropElecEnergy[2]   + RunResultsW[6]:PropElecEnergy[2]   + RunResultsW[7]:PropElecEnergy[2]   + RunResultsW[8]:PropElecEnergy[2]   + RunResultsW[9]:PropElecEnergy[2]    }
	"Recalc total - NatGas - W-Total"		Proj:RunResultsW[10]:PropNatGasEnergy[2]	= {	RunResultsW[11]:PropNatGasEnergy[2] + RunResultsW[6]:PropNatGasEnergy[2] + RunResultsW[7]:PropNatGasEnergy[2] + RunResultsW[8]:PropNatGasEnergy[2] + RunResultsW[9]:PropNatGasEnergy[2]  }
	"Recalc total - Other  - W-Total"		Proj:RunResultsW[10]:PropOtherEnergy[2]	= {	RunResultsW[11]:PropOtherEnergy[2]  + RunResultsW[6]:PropOtherEnergy[2]  + RunResultsW[7]:PropOtherEnergy[2]  + RunResultsW[8]:PropOtherEnergy[2]  + RunResultsW[9]:PropOtherEnergy[2]   }
	"Recalc total - TOTAL  - W-Total"		Proj:RunResultsW[10]:PropTotalEnergy[2]	= {	RunResultsW[11]:PropTotalEnergy[2]  + RunResultsW[6]:PropTotalEnergy[2]  + RunResultsW[7]:PropTotalEnergy[2]  + RunResultsW[8]:PropTotalEnergy[2]  + RunResultsW[9]:PropTotalEnergy[2]   }
	"Recalc TDV   - Elec   - W-Total"		Proj:RunResultsW[10]:PropElecTDV[2]			= {	RunResultsW[11]:PropElecTDV[2]      + RunResultsW[6]:PropElecTDV[2]      + RunResultsW[7]:PropElecTDV[2]      + RunResultsW[8]:PropElecTDV[2]      + RunResultsW[9]:PropElecTDV[2]       }
	"Recalc TDV   - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedTDV[2]			= {	RunResultsW[11]:ProposedTDV[2]      + RunResultsW[6]:ProposedTDV[2]      + RunResultsW[7]:ProposedTDV[2]      + RunResultsW[8]:ProposedTDV[2]      + RunResultsW[9]:ProposedTDV[2]       }
	"Recalc TDV   - TOTAL  - W-Total"		Proj:RunResultsW[10]:ProposedTDV[3]			= {	RunResultsW[11]:ProposedTDV[3]      + RunResultsW[6]:ProposedTDV[3]      + RunResultsW[7]:ProposedTDV[3]      + RunResultsW[8]:ProposedTDV[3]      + RunResultsW[9]:ProposedTDV[3]       }

  ; Compliance Total
  ; SAC 1/14/13 - added in PVCredit to Std (elec) TDV
; mjb-10/16/13	remove PVCredit from Std Design
	"Calculate TDV - Elec   - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecTDV			= {	RunResultsN[1]:DRtgElecTDV     + RunResultsN[2]:DRtgElecTDV     + RunResultsN[3]:DRtgElecTDV     + RunResultsN[4]:DRtgElecTDV     + RunResultsN[5]:DRtgElecTDV     + RunResultsN[13]:DRtgElecTDV      }
	"Calculate TDV - NatGas - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgNatGasTDV		= {	RunResultsN[1]:DRtgNatGasTDV   + RunResultsN[2]:DRtgNatGasTDV   + RunResultsN[3]:DRtgNatGasTDV   + RunResultsN[4]:DRtgNatGasTDV   + RunResultsN[5]:DRtgNatGasTDV   + RunResultsN[13]:DRtgNatGasTDV    }
	"Calculate TDV - Other  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgOtherTDV		= {	RunResultsN[1]:DRtgOtherTDV    + RunResultsN[2]:DRtgOtherTDV    + RunResultsN[3]:DRtgOtherTDV    + RunResultsN[4]:DRtgOtherTDV    + RunResultsN[5]:DRtgOtherTDV    + RunResultsN[13]:DRtgOtherTDV     }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingTDV[1] = {	RunResultsN[1]:DesignRatingTDV[1] + RunResultsN[2]:DesignRatingTDV[1] + RunResultsN[3]:DesignRatingTDV[1] + RunResultsN[4]:DesignRatingTDV[1] + RunResultsN[5]:DesignRatingTDV[1] + RunResultsN[13]:DesignRatingTDV[1]  }
	"Calculate TDV - TOTAL  - N-Comp Ttl"	Proj:RunResultsN[11]:DesignRatingTDV[2] = {	RunResultsN[1]:DesignRatingTDV[2] + RunResultsN[2]:DesignRatingTDV[2] + RunResultsN[3]:DesignRatingTDV[2] + RunResultsN[4]:DesignRatingTDV[2] + RunResultsN[5]:DesignRatingTDV[2] + RunResultsN[13]:DesignRatingTDV[2]  }
	"Calculate Elec Demand  - N-Comp Ttl"	Proj:RunResultsN[11]:DRtgElecDemand		= {	RunResultsN[1]:DRtgElecDemand  + RunResultsN[2]:DRtgElecDemand  + RunResultsN[3]:DRtgElecDemand  + RunResultsN[4]:DRtgElecDemand  + RunResultsN[5]:DRtgElecDemand  + RunResultsN[13]:DRtgElecDemand   }

  ; Total
	"Calculate TDV - Elec   - N-Total"		Proj:RunResultsN[10]:DRtgElecTDV			= {	RunResultsN[11]:DRtgElecTDV     + RunResultsN[6]:DRtgElecTDV     + RunResultsN[7]:DRtgElecTDV     + RunResultsN[8]:DRtgElecTDV     + RunResultsN[9]:DRtgElecTDV      }
	"Calculate TDV - NatGas - N-Total"		Proj:RunResultsN[10]:DRtgNatGasTDV		= {	RunResultsN[11]:DRtgNatGasTDV   + RunResultsN[6]:DRtgNatGasTDV   + RunResultsN[7]:DRtgNatGasTDV   + RunResultsN[8]:DRtgNatGasTDV   + RunResultsN[9]:DRtgNatGasTDV    }
	"Calculate TDV - Other  - N-Total"		Proj:RunResultsN[10]:DRtgOtherTDV		= {	RunResultsN[11]:DRtgOtherTDV    + RunResultsN[6]:DRtgOtherTDV    + RunResultsN[7]:DRtgOtherTDV    + RunResultsN[8]:DRtgOtherTDV    + RunResultsN[9]:DRtgOtherTDV     }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingTDV[1] = {	RunResultsN[11]:DesignRatingTDV[1] + RunResultsN[6]:DesignRatingTDV[1] + RunResultsN[7]:DesignRatingTDV[1] + RunResultsN[8]:DesignRatingTDV[1] + RunResultsN[9]:DesignRatingTDV[1]  }
	"Calculate TDV - TOTAL  - N-Total"		Proj:RunResultsN[10]:DesignRatingTDV[2] = {	RunResultsN[11]:DesignRatingTDV[2] + RunResultsN[6]:DesignRatingTDV[2] + RunResultsN[7]:DesignRatingTDV[2] + RunResultsN[8]:DesignRatingTDV[2] + RunResultsN[9]:DesignRatingTDV[2]  }
	"Calculate Elec Demand  - N-Total"		Proj:RunResultsN[10]:DRtgElecDemand		= {	RunResultsN[11]:DRtgElecDemand  + RunResultsN[6]:DRtgElecDemand  + RunResultsN[7]:DRtgElecDemand  + RunResultsN[8]:DRtgElecDemand  + RunResultsN[9]:DRtgElecDemand   }

; -- COPY N results to E --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - E-SpcHt"		Proj:RunResultsE[1]:DRtgElecTDV			= {	RunResultsN[1]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-SpcHt"		Proj:RunResultsE[1]:DRtgNatGasTDV		= {	RunResultsN[1]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-SpcHt"		Proj:RunResultsE[1]:DRtgOtherTDV			= {	RunResultsN[1]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:DesignRatingTDV[1]	= {	RunResultsN[1]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-SpcHt"		Proj:RunResultsE[1]:DesignRatingTDV[2]	= {	RunResultsN[1]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-SpcHt"		Proj:RunResultsE[1]:DRtgElecDemand		= {	RunResultsN[1]:DRtgElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - E-SpcCl"		Proj:RunResultsE[2]:DRtgElecTDV			= {	RunResultsN[2]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-SpcCl"		Proj:RunResultsE[2]:DRtgNatGasTDV		= {	RunResultsN[2]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-SpcCl"		Proj:RunResultsE[2]:DRtgOtherTDV			= {	RunResultsN[2]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:DesignRatingTDV[1]	= {	RunResultsN[2]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-SpcCl"		Proj:RunResultsE[2]:DesignRatingTDV[2]	= {	RunResultsN[2]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-SpcCl"		Proj:RunResultsE[2]:DRtgElecDemand		= {	RunResultsN[2]:DRtgElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - E-IAQVent"	Proj:RunResultsE[3]:DRtgElecTDV			= {	RunResultsN[3]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-IAQVent"	Proj:RunResultsE[3]:DRtgNatGasTDV		= {	RunResultsN[3]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-IAQVent"	Proj:RunResultsE[3]:DRtgOtherTDV			= {	RunResultsN[3]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:DesignRatingTDV[1]	= {	RunResultsN[3]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-IAQVent"	Proj:RunResultsE[3]:DesignRatingTDV[2]	= {	RunResultsN[3]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-IAQVent"	Proj:RunResultsE[3]:DRtgElecDemand		= {	RunResultsN[3]:DRtgElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgElecTDV			= {	RunResultsN[4]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgNatGasTDV		= {	RunResultsN[4]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgOtherTDV			= {	RunResultsN[4]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:DesignRatingTDV[1]	= {	RunResultsN[4]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-OthrHVAC"	Proj:RunResultsE[4]:DesignRatingTDV[2]	= {	RunResultsN[4]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-OthrHVAC"	Proj:RunResultsE[4]:DRtgElecDemand		= {	RunResultsN[4]:DRtgElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - E-WtrHt"		Proj:RunResultsE[5]:DRtgElecTDV			= {	RunResultsN[5]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-WtrHt"		Proj:RunResultsE[5]:DRtgNatGasTDV		= {	RunResultsN[5]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-WtrHt"		Proj:RunResultsE[5]:DRtgOtherTDV			= {	RunResultsN[5]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:DesignRatingTDV[1]	= {	RunResultsN[5]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-WtrHt"		Proj:RunResultsE[5]:DesignRatingTDV[2]	= {	RunResultsN[5]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-WtrHt"		Proj:RunResultsE[5]:DRtgElecDemand		= {	RunResultsN[5]:DRtgElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - E-InsLtg"		Proj:RunResultsE[6]:DRtgElecTDV			= {	RunResultsN[6]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-InsLtg"		Proj:RunResultsE[6]:DRtgNatGasTDV		= {	RunResultsN[6]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-InsLtg"		Proj:RunResultsE[6]:DRtgOtherTDV			= {	RunResultsN[6]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:DesignRatingTDV[1]	= {	RunResultsN[6]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-InsLtg"		Proj:RunResultsE[6]:DesignRatingTDV[2]	= {	RunResultsN[6]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-InsLtg"		Proj:RunResultsE[6]:DRtgElecDemand		= {	RunResultsN[6]:DRtgElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - E-AppCkg"		Proj:RunResultsE[7]:DRtgElecTDV			= {	RunResultsN[7]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-AppCkg"		Proj:RunResultsE[7]:DRtgNatGasTDV		= {	RunResultsN[7]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-AppCkg"		Proj:RunResultsE[7]:DRtgOtherTDV			= {	RunResultsN[7]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:DesignRatingTDV[1]	= {	RunResultsN[7]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-AppCkg"		Proj:RunResultsE[7]:DesignRatingTDV[2]	= {	RunResultsN[7]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-AppCkg"		Proj:RunResultsE[7]:DRtgElecDemand		= {	RunResultsN[7]:DRtgElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - E-Plugs"		Proj:RunResultsE[8]:DRtgElecTDV			= {	RunResultsN[8]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-Plugs"		Proj:RunResultsE[8]:DRtgNatGasTDV		= {	RunResultsN[8]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-Plugs"		Proj:RunResultsE[8]:DRtgOtherTDV			= {	RunResultsN[8]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:DesignRatingTDV[1]	= {	RunResultsN[8]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-Plugs"		Proj:RunResultsE[8]:DesignRatingTDV[2]	= {	RunResultsN[8]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-Plugs"		Proj:RunResultsE[8]:DRtgElecDemand		= {	RunResultsN[8]:DRtgElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - E-Ext"			Proj:RunResultsE[9]:DRtgElecTDV			= {	RunResultsN[9]:DRtgElecTDV        }
	"Calculate TDV - NatGas - E-Ext"			Proj:RunResultsE[9]:DRtgNatGasTDV		= {	RunResultsN[9]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - E-Ext"			Proj:RunResultsE[9]:DRtgOtherTDV			= {	RunResultsN[9]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - E-Ext"			Proj:RunResultsE[9]:DesignRatingTDV[1]	= {	RunResultsN[9]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - E-Ext"			Proj:RunResultsE[9]:DesignRatingTDV[2]	= {	RunResultsN[9]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - E-Ext"			Proj:RunResultsE[9]:DRtgElecDemand		= {	RunResultsN[9]:DRtgElecDemand     }
  ; PV
	"Calculate TDV - Elec   - E-PV"			Proj:RunResultsE[13]:DRtgElecTDV			= {	RunResultsN[13]:DRtgElecTDV       }
	"Calculate TDV - NatGas - E-PV"			Proj:RunResultsE[13]:DRtgNatGasTDV		= {	RunResultsN[13]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - E-PV"			Proj:RunResultsE[13]:DRtgOtherTDV		= {	RunResultsN[13]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - E-PV"			Proj:RunResultsE[13]:DesignRatingTDV[1] = {	RunResultsN[13]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - E-PV"			Proj:RunResultsE[13]:DesignRatingTDV[2] = {	RunResultsN[13]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - E-PV"			Proj:RunResultsE[13]:DRtgElecDemand		= {	RunResultsN[13]:DRtgElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgElecTDV			= {	RunResultsN[11]:DRtgElecTDV       }
	"Calculate TDV - NatGas - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgNatGasTDV		= {	RunResultsN[11]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgOtherTDV		= {	RunResultsN[11]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:DesignRatingTDV[1] = {	RunResultsN[11]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - E-Comp Ttl"	Proj:RunResultsE[11]:DesignRatingTDV[2] = {	RunResultsN[11]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - E-Comp Ttl"	Proj:RunResultsE[11]:DRtgElecDemand		= {	RunResultsN[11]:DRtgElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - E-Total"		Proj:RunResultsE[10]:DRtgElecTDV			= {	RunResultsN[10]:DRtgElecTDV       }
	"Calculate TDV - NatGas - E-Total"		Proj:RunResultsE[10]:DRtgNatGasTDV		= {	RunResultsN[10]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - E-Total"		Proj:RunResultsE[10]:DRtgOtherTDV		= {	RunResultsN[10]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:DesignRatingTDV[1] = {	RunResultsN[10]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - E-Total"		Proj:RunResultsE[10]:DesignRatingTDV[2] = {	RunResultsN[10]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - E-Total"		Proj:RunResultsE[10]:DRtgElecDemand		= {	RunResultsN[10]:DRtgElecDemand    }

; -- COPY N results to S --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - S-SpcHt"		Proj:RunResultsS[1]:DRtgElecTDV			= {	RunResultsN[1]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-SpcHt"		Proj:RunResultsS[1]:DRtgNatGasTDV		= {	RunResultsN[1]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-SpcHt"		Proj:RunResultsS[1]:DRtgOtherTDV			= {	RunResultsN[1]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:DesignRatingTDV[1]	= {	RunResultsN[1]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-SpcHt"		Proj:RunResultsS[1]:DesignRatingTDV[2]	= {	RunResultsN[1]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-SpcHt"		Proj:RunResultsS[1]:DRtgElecDemand		= {	RunResultsN[1]:DRtgElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - S-SpcCl"		Proj:RunResultsS[2]:DRtgElecTDV			= {	RunResultsN[2]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-SpcCl"		Proj:RunResultsS[2]:DRtgNatGasTDV		= {	RunResultsN[2]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-SpcCl"		Proj:RunResultsS[2]:DRtgOtherTDV			= {	RunResultsN[2]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:DesignRatingTDV[1]	= {	RunResultsN[2]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-SpcCl"		Proj:RunResultsS[2]:DesignRatingTDV[2]	= {	RunResultsN[2]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-SpcCl"     Proj:RunResultsS[2]:DRtgElecDemand		= {	RunResultsN[2]:DRtgElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - S-IAQVent"	Proj:RunResultsS[3]:DRtgElecTDV			= {	RunResultsN[3]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-IAQVent"	Proj:RunResultsS[3]:DRtgNatGasTDV		= {	RunResultsN[3]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-IAQVent"	Proj:RunResultsS[3]:DRtgOtherTDV			= {	RunResultsN[3]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:DesignRatingTDV[1]	= {	RunResultsN[3]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-IAQVent"	Proj:RunResultsS[3]:DesignRatingTDV[2]	= {	RunResultsN[3]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-IAQVent"   Proj:RunResultsS[3]:DRtgElecDemand		= {	RunResultsN[3]:DRtgElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgElecTDV			= {	RunResultsN[4]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgNatGasTDV		= {	RunResultsN[4]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-OthrHVAC"	Proj:RunResultsS[4]:DRtgOtherTDV			= {	RunResultsN[4]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:DesignRatingTDV[1]	= {	RunResultsN[4]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-OthrHVAC"	Proj:RunResultsS[4]:DesignRatingTDV[2]	= {	RunResultsN[4]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-OthrHVAC"  Proj:RunResultsS[4]:DRtgElecDemand		= {	RunResultsN[4]:DRtgElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - S-WtrHt"		Proj:RunResultsS[5]:DRtgElecTDV			= {	RunResultsN[5]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-WtrHt"		Proj:RunResultsS[5]:DRtgNatGasTDV		= {	RunResultsN[5]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-WtrHt"		Proj:RunResultsS[5]:DRtgOtherTDV			= {	RunResultsN[5]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:DesignRatingTDV[1]	= {	RunResultsN[5]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-WtrHt"		Proj:RunResultsS[5]:DesignRatingTDV[2]	= {	RunResultsN[5]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-WtrHt"     Proj:RunResultsS[5]:DRtgElecDemand		= {	RunResultsN[5]:DRtgElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - S-InsLtg"		Proj:RunResultsS[6]:DRtgElecTDV			= {	RunResultsN[6]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-InsLtg"		Proj:RunResultsS[6]:DRtgNatGasTDV		= {	RunResultsN[6]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-InsLtg"		Proj:RunResultsS[6]:DRtgOtherTDV			= {	RunResultsN[6]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:DesignRatingTDV[1]	= {	RunResultsN[6]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-InsLtg"		Proj:RunResultsS[6]:DesignRatingTDV[2]	= {	RunResultsN[6]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-InsLtg"    Proj:RunResultsS[6]:DRtgElecDemand		= {	RunResultsN[6]:DRtgElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - S-AppCkg"		Proj:RunResultsS[7]:DRtgElecTDV			= {	RunResultsN[7]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-AppCkg"		Proj:RunResultsS[7]:DRtgNatGasTDV		= {	RunResultsN[7]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-AppCkg"		Proj:RunResultsS[7]:DRtgOtherTDV			= {	RunResultsN[7]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:DesignRatingTDV[1]	= {	RunResultsN[7]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-AppCkg"		Proj:RunResultsS[7]:DesignRatingTDV[2]	= {	RunResultsN[7]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-AppCkg"    Proj:RunResultsS[7]:DRtgElecDemand		= {	RunResultsN[7]:DRtgElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - S-Plugs"		Proj:RunResultsS[8]:DRtgElecTDV			= {	RunResultsN[8]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-Plugs"		Proj:RunResultsS[8]:DRtgNatGasTDV		= {	RunResultsN[8]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-Plugs"		Proj:RunResultsS[8]:DRtgOtherTDV			= {	RunResultsN[8]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:DesignRatingTDV[1]	= {	RunResultsN[8]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-Plugs"		Proj:RunResultsS[8]:DesignRatingTDV[2]	= {	RunResultsN[8]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-Plugs"     Proj:RunResultsS[8]:DRtgElecDemand		= {	RunResultsN[8]:DRtgElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - S-Ext"			Proj:RunResultsS[9]:DRtgElecTDV			= {	RunResultsN[9]:DRtgElecTDV        }
	"Calculate TDV - NatGas - S-Ext"			Proj:RunResultsS[9]:DRtgNatGasTDV		= {	RunResultsN[9]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - S-Ext"			Proj:RunResultsS[9]:DRtgOtherTDV			= {	RunResultsN[9]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - S-Ext"			Proj:RunResultsS[9]:DesignRatingTDV[1]	= {	RunResultsN[9]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - S-Ext"			Proj:RunResultsS[9]:DesignRatingTDV[2]	= {	RunResultsN[9]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - S-Ext"       Proj:RunResultsS[9]:DRtgElecDemand		= {	RunResultsN[9]:DRtgElecDemand     }
  ; PV
	"Calculate TDV - Elec   - S-PV"			Proj:RunResultsS[13]:DRtgElecTDV			= {	RunResultsN[13]:DRtgElecTDV       }
	"Calculate TDV - NatGas - S-PV"			Proj:RunResultsS[13]:DRtgNatGasTDV		= {	RunResultsN[13]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - S-PV"			Proj:RunResultsS[13]:DRtgOtherTDV		= {	RunResultsN[13]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - S-PV"			Proj:RunResultsS[13]:DesignRatingTDV[1] = {	RunResultsN[13]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - S-PV"			Proj:RunResultsS[13]:DesignRatingTDV[2] = {	RunResultsN[13]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - S-PV"			Proj:RunResultsS[13]:DRtgElecDemand		= {	RunResultsN[13]:DRtgElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgElecTDV			= {	RunResultsN[11]:DRtgElecTDV       }
	"Calculate TDV - NatGas - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgNatGasTDV		= {	RunResultsN[11]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - S-Comp Ttl"	Proj:RunResultsS[11]:DRtgOtherTDV		= {	RunResultsN[11]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:DesignRatingTDV[1] = {	RunResultsN[11]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - S-Comp Ttl"	Proj:RunResultsS[11]:DesignRatingTDV[2] = {	RunResultsN[11]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - S-Comp Ttl"  Proj:RunResultsS[11]:DRtgElecDemand		= {	RunResultsN[11]:DRtgElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - S-Total"		Proj:RunResultsS[10]:DRtgElecTDV			= {	RunResultsN[10]:DRtgElecTDV       }
	"Calculate TDV - NatGas - S-Total"		Proj:RunResultsS[10]:DRtgNatGasTDV		= {	RunResultsN[10]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - S-Total"		Proj:RunResultsS[10]:DRtgOtherTDV		= {	RunResultsN[10]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:DesignRatingTDV[1] = {	RunResultsN[10]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - S-Total"		Proj:RunResultsS[10]:DesignRatingTDV[2] = {	RunResultsN[10]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - S-Total"     Proj:RunResultsS[10]:DRtgElecDemand		= {	RunResultsN[10]:DRtgElecDemand    }

; -- COPY N results to W --
  ; Space Heating (& heating fan)
	"Calculate TDV - Elec   - W-SpcHt"		Proj:RunResultsW[1]:DRtgElecTDV			= {	RunResultsN[1]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-SpcHt"		Proj:RunResultsW[1]:DRtgNatGasTDV		= {	RunResultsN[1]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-SpcHt"		Proj:RunResultsW[1]:DRtgOtherTDV			= {	RunResultsN[1]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:DesignRatingTDV[1]	= {	RunResultsN[1]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-SpcHt"		Proj:RunResultsW[1]:DesignRatingTDV[2]	= {	RunResultsN[1]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-SpcHt"		Proj:RunResultsW[1]:DRtgElecDemand		= {	RunResultsN[1]:DRtgElecDemand     }
  ; Space Cooling (& cooling fan)                                                                                     
	"Calculate TDV - Elec   - W-SpcCl"		Proj:RunResultsW[2]:DRtgElecTDV			= {	RunResultsN[2]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-SpcCl"		Proj:RunResultsW[2]:DRtgNatGasTDV		= {	RunResultsN[2]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-SpcCl"		Proj:RunResultsW[2]:DRtgOtherTDV			= {	RunResultsN[2]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:DesignRatingTDV[1]	= {	RunResultsN[2]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-SpcCl"		Proj:RunResultsW[2]:DesignRatingTDV[2]	= {	RunResultsN[2]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-SpcCl"     Proj:RunResultsW[2]:DRtgElecDemand		= {	RunResultsN[2]:DRtgElecDemand     }
  ; IAQ Ventilation Fans                                                                                              
	"Calculate TDV - Elec   - W-IAQVent"	Proj:RunResultsW[3]:DRtgElecTDV			= {	RunResultsN[3]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-IAQVent"	Proj:RunResultsW[3]:DRtgNatGasTDV		= {	RunResultsN[3]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-IAQVent"	Proj:RunResultsW[3]:DRtgOtherTDV			= {	RunResultsN[3]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:DesignRatingTDV[1]	= {	RunResultsN[3]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-IAQVent"	Proj:RunResultsW[3]:DesignRatingTDV[2]	= {	RunResultsN[3]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-IAQVent"   Proj:RunResultsW[3]:DRtgElecDemand		= {	RunResultsN[3]:DRtgElecDemand     }
  ; Other HVAC (aux & misc fans)                                                                                      
	"Calculate TDV - Elec   - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgElecTDV			= {	RunResultsN[4]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgNatGasTDV		= {	RunResultsN[4]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-OthrHVAC"	Proj:RunResultsW[4]:DRtgOtherTDV			= {	RunResultsN[4]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:DesignRatingTDV[1]	= {	RunResultsN[4]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-OthrHVAC"	Proj:RunResultsW[4]:DesignRatingTDV[2]	= {	RunResultsN[4]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-OthrHVAC"  Proj:RunResultsW[4]:DRtgElecDemand		= {	RunResultsN[4]:DRtgElecDemand     }
  ; Water Heating                                                                                                     
	"Calculate TDV - Elec   - W-WtrHt"		Proj:RunResultsW[5]:DRtgElecTDV			= {	RunResultsN[5]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-WtrHt"		Proj:RunResultsW[5]:DRtgNatGasTDV		= {	RunResultsN[5]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-WtrHt"		Proj:RunResultsW[5]:DRtgOtherTDV			= {	RunResultsN[5]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:DesignRatingTDV[1]	= {	RunResultsN[5]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-WtrHt"		Proj:RunResultsW[5]:DesignRatingTDV[2]	= {	RunResultsN[5]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-WtrHt"     Proj:RunResultsW[5]:DRtgElecDemand		= {	RunResultsN[5]:DRtgElecDemand     }
  ; Inside Lighting                                                                                                   
	"Calculate TDV - Elec   - W-InsLtg"		Proj:RunResultsW[6]:DRtgElecTDV			= {	RunResultsN[6]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-InsLtg"		Proj:RunResultsW[6]:DRtgNatGasTDV		= {	RunResultsN[6]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-InsLtg"		Proj:RunResultsW[6]:DRtgOtherTDV			= {	RunResultsN[6]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:DesignRatingTDV[1]	= {	RunResultsN[6]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-InsLtg"		Proj:RunResultsW[6]:DesignRatingTDV[2]	= {	RunResultsN[6]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-InsLtg"    Proj:RunResultsW[6]:DRtgElecDemand		= {	RunResultsN[6]:DRtgElecDemand     }
  ; Appliances & Cooking                                                                                              
	"Calculate TDV - Elec   - W-AppCkg"		Proj:RunResultsW[7]:DRtgElecTDV			= {	RunResultsN[7]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-AppCkg"		Proj:RunResultsW[7]:DRtgNatGasTDV		= {	RunResultsN[7]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-AppCkg"		Proj:RunResultsW[7]:DRtgOtherTDV			= {	RunResultsN[7]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:DesignRatingTDV[1]	= {	RunResultsN[7]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-AppCkg"		Proj:RunResultsW[7]:DesignRatingTDV[2]	= {	RunResultsN[7]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-AppCkg"    Proj:RunResultsW[7]:DRtgElecDemand		= {	RunResultsN[7]:DRtgElecDemand     }
  ; Plug Loads                                                                                                        
	"Calculate TDV - Elec   - W-Plugs"		Proj:RunResultsW[8]:DRtgElecTDV			= {	RunResultsN[8]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-Plugs"		Proj:RunResultsW[8]:DRtgNatGasTDV		= {	RunResultsN[8]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-Plugs"		Proj:RunResultsW[8]:DRtgOtherTDV			= {	RunResultsN[8]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:DesignRatingTDV[1]	= {	RunResultsN[8]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-Plugs"		Proj:RunResultsW[8]:DesignRatingTDV[2]	= {	RunResultsN[8]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-Plugs"     Proj:RunResultsW[8]:DRtgElecDemand		= {	RunResultsN[8]:DRtgElecDemand     }
  ; Exterior                                                                                                          
	"Calculate TDV - Elec   - W-Ext"			Proj:RunResultsW[9]:DRtgElecTDV			= {	RunResultsN[9]:DRtgElecTDV        }
	"Calculate TDV - NatGas - W-Ext"			Proj:RunResultsW[9]:DRtgNatGasTDV		= {	RunResultsN[9]:DRtgNatGasTDV      }
	"Calculate TDV - Other  - W-Ext"			Proj:RunResultsW[9]:DRtgOtherTDV			= {	RunResultsN[9]:DRtgOtherTDV       }
	"Calculate TDV - TOTAL  - W-Ext"			Proj:RunResultsW[9]:DesignRatingTDV[1]	= {	RunResultsN[9]:DesignRatingTDV[1]    }
	"Calculate TDV - TOTAL  - W-Ext"			Proj:RunResultsW[9]:DesignRatingTDV[2]	= {	RunResultsN[9]:DesignRatingTDV[2]    }
	"Calculate Elec Demand  - W-Ext"       Proj:RunResultsW[9]:DRtgElecDemand		= {	RunResultsN[9]:DRtgElecDemand     }
  ; PV
	"Calculate TDV - Elec   - W-PV"			Proj:RunResultsW[13]:DRtgElecTDV			= {	RunResultsN[13]:DRtgElecTDV       }
	"Calculate TDV - NatGas - W-PV"			Proj:RunResultsW[13]:DRtgNatGasTDV		= {	RunResultsN[13]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - W-PV"			Proj:RunResultsW[13]:DRtgOtherTDV		= {	RunResultsN[13]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - W-PV"			Proj:RunResultsW[13]:DesignRatingTDV[1] = {	RunResultsN[13]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - W-PV"			Proj:RunResultsW[13]:DesignRatingTDV[2] = {	RunResultsN[13]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - W-PV"			Proj:RunResultsW[13]:DRtgElecDemand		= {	RunResultsN[13]:DRtgElecDemand    }
  ; Compliance Total                                                                                                  
	"Calculate TDV - Elec   - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgElecTDV			= {	RunResultsN[11]:DRtgElecTDV       }
	"Calculate TDV - NatGas - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgNatGasTDV		= {	RunResultsN[11]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgOtherTDV		= {	RunResultsN[11]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:DesignRatingTDV[1] = {	RunResultsN[11]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - W-Comp Ttl"	Proj:RunResultsW[11]:DesignRatingTDV[2] = {	RunResultsN[11]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - W-Comp Ttl"	Proj:RunResultsW[11]:DRtgElecDemand		= {	RunResultsN[11]:DRtgElecDemand    }
  ; Total                                                                                                             
	"Calculate TDV - Elec   - W-Total"		Proj:RunResultsW[10]:DRtgElecTDV			= {	RunResultsN[10]:DRtgElecTDV       }
	"Calculate TDV - NatGas - W-Total"		Proj:RunResultsW[10]:DRtgNatGasTDV		= {	RunResultsN[10]:DRtgNatGasTDV     }
	"Calculate TDV - Other  - W-Total"		Proj:RunResultsW[10]:DRtgOtherTDV		= {	RunResultsN[10]:DRtgOtherTDV      }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:DesignRatingTDV[1] = {	RunResultsN[10]:DesignRatingTDV[1]   }
	"Calculate TDV - TOTAL  - W-Total"		Proj:RunResultsW[10]:DesignRatingTDV[2] = {	RunResultsN[10]:DesignRatingTDV[2]   }
	"Calculate Elec Demand  - W-Total"     Proj:RunResultsW[10]:DRtgElecDemand		= {	RunResultsN[10]:DRtgElecDemand    }


  ; Percent Improvement - NORTH
	"Calc TDV Pct Improve - N-SpcHt"    	Proj:RunResultsN[1]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[1]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsN[1]:DesignRatingTDV[1]  ) - LocalRef( RunResultsN[1]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[1]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - N-SpcCl"    	Proj:RunResultsN[2]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[2]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsN[2]:DesignRatingTDV[1]  ) - LocalRef( RunResultsN[2]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[2]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - N-IAQVent"  	Proj:RunResultsN[3]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[3]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsN[3]:DesignRatingTDV[1]  ) - LocalRef( RunResultsN[3]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[3]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - N-OthrHVAC" 	Proj:RunResultsN[4]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[4]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsN[4]:DesignRatingTDV[1]  ) - LocalRef( RunResultsN[4]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[4]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - N-WtrHt"    	Proj:RunResultsN[5]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[5]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsN[5]:DesignRatingTDV[1]  ) - LocalRef( RunResultsN[5]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[5]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - N-InsLtg"   	Proj:RunResultsN[6]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[6]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsN[6]:DesignRatingTDV[1]  ) - LocalRef( RunResultsN[6]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[6]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - N-AppCkg"   	Proj:RunResultsN[7]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[7]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsN[7]:DesignRatingTDV[1]  ) - LocalRef( RunResultsN[7]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[7]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - N-Plugs"    	Proj:RunResultsN[8]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[8]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsN[8]:DesignRatingTDV[1]  ) - LocalRef( RunResultsN[8]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[8]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - N-Ext"      	Proj:RunResultsN[9]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[9]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsN[9]:DesignRatingTDV[1]  ) - LocalRef( RunResultsN[9]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsN[9]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - N-PV"     	 	Proj:RunResultsN[13]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[13]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsN[13]:DesignRatingTDV[1] ) - LocalRef( RunResultsN[13]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsN[13]:DesignRatingTDV[1] )  endif  }
	"Calc TDV Pct Improve - N-Total"    	Proj:RunResultsN[10]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[10]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsN[10]:DesignRatingTDV[1] ) - LocalRef( RunResultsN[10]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsN[10]:DesignRatingTDV[1] )  endif  }
	"Calc TDV Pct Improve - N-Comp Ttl"  	Proj:RunResultsN[11]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsN[11]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsN[11]:DesignRatingTDV[1] ) - LocalRef( RunResultsN[11]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsN[11]:DesignRatingTDV[1] )  endif  }
  ; Delta Demand
	"Calc Delta El Demand - N-SpcHt"    	Proj:RunResultsN[1]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[1]:DRtgElecDemand  ) - LocalRef( RunResultsN[1]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-SpcCl"    	Proj:RunResultsN[2]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[2]:DRtgElecDemand  ) - LocalRef( RunResultsN[2]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-IAQVent"  	Proj:RunResultsN[3]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[3]:DRtgElecDemand  ) - LocalRef( RunResultsN[3]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-OthrHVAC" 	Proj:RunResultsN[4]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[4]:DRtgElecDemand  ) - LocalRef( RunResultsN[4]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-WtrHt"    	Proj:RunResultsN[5]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[5]:DRtgElecDemand  ) - LocalRef( RunResultsN[5]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-InsLtg"   	Proj:RunResultsN[6]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[6]:DRtgElecDemand  ) - LocalRef( RunResultsN[6]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-AppCkg"   	Proj:RunResultsN[7]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[7]:DRtgElecDemand  ) - LocalRef( RunResultsN[7]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-Plugs"    	Proj:RunResultsN[8]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[8]:DRtgElecDemand  ) - LocalRef( RunResultsN[8]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-Ext"      	Proj:RunResultsN[9]:DRtgDeltaDemand		= {	LocalRef( RunResultsN[9]:DRtgElecDemand  ) - LocalRef( RunResultsN[9]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - N-PV"     	 	Proj:RunResultsN[13]:DRtgDeltaDemand	= {	LocalRef( RunResultsN[13]:DRtgElecDemand ) - LocalRef( RunResultsN[13]:PropElecDemand[2] )   }
	"Calc Delta El Demand - N-Total"    	Proj:RunResultsN[10]:DRtgDeltaDemand	= {	LocalRef( RunResultsN[10]:DRtgElecDemand ) - LocalRef( RunResultsN[10]:PropElecDemand[2] )   }
	"Calc Delta El Demand - N-Comp Ttl" 	Proj:RunResultsN[11]:DRtgDeltaDemand	= {	LocalRef( RunResultsN[11]:DRtgElecDemand ) - LocalRef( RunResultsN[11]:PropElecDemand[2] )   }

  ; Percent Improvement - EAST
	"Calc TDV Pct Improve - E-SpcHt"    	Proj:RunResultsE[1]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[1]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsE[1]:DesignRatingTDV[1]  ) - LocalRef( RunResultsE[1]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[1]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - E-SpcCl"    	Proj:RunResultsE[2]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[2]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsE[2]:DesignRatingTDV[1]  ) - LocalRef( RunResultsE[2]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[2]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - E-IAQVent"  	Proj:RunResultsE[3]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[3]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsE[3]:DesignRatingTDV[1]  ) - LocalRef( RunResultsE[3]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[3]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - E-OthrHVAC" 	Proj:RunResultsE[4]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[4]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsE[4]:DesignRatingTDV[1]  ) - LocalRef( RunResultsE[4]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[4]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - E-WtrHt"    	Proj:RunResultsE[5]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[5]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsE[5]:DesignRatingTDV[1]  ) - LocalRef( RunResultsE[5]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[5]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - E-InsLtg"   	Proj:RunResultsE[6]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[6]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsE[6]:DesignRatingTDV[1]  ) - LocalRef( RunResultsE[6]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[6]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - E-AppCkg"   	Proj:RunResultsE[7]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[7]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsE[7]:DesignRatingTDV[1]  ) - LocalRef( RunResultsE[7]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[7]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - E-Plugs"    	Proj:RunResultsE[8]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[8]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsE[8]:DesignRatingTDV[1]  ) - LocalRef( RunResultsE[8]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[8]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - E-Ext"      	Proj:RunResultsE[9]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[9]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsE[9]:DesignRatingTDV[1]  ) - LocalRef( RunResultsE[9]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsE[9]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - E-PV"     	 	Proj:RunResultsE[13]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[13]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsE[13]:DesignRatingTDV[1] ) - LocalRef( RunResultsE[13]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsE[13]:DesignRatingTDV[1] )  endif  }
	"Calc TDV Pct Improve - E-Total"    	Proj:RunResultsE[10]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[10]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsE[10]:DesignRatingTDV[1] ) - LocalRef( RunResultsE[10]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsE[10]:DesignRatingTDV[1] )  endif  }
	"Calc TDV Pct Improve - E-Comp Ttl"  	Proj:RunResultsE[11]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsE[11]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsE[11]:DesignRatingTDV[1] ) - LocalRef( RunResultsE[11]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsE[11]:DesignRatingTDV[1] )  endif  }
  ; Delta Demand
	"Calc Delta El Demand - E-SpcHt"    	Proj:RunResultsE[1]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[1]:DRtgElecDemand  ) - LocalRef( RunResultsE[1]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-SpcCl"    	Proj:RunResultsE[2]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[2]:DRtgElecDemand  ) - LocalRef( RunResultsE[2]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-IAQVent"  	Proj:RunResultsE[3]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[3]:DRtgElecDemand  ) - LocalRef( RunResultsE[3]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-OthrHVAC" 	Proj:RunResultsE[4]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[4]:DRtgElecDemand  ) - LocalRef( RunResultsE[4]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-WtrHt"    	Proj:RunResultsE[5]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[5]:DRtgElecDemand  ) - LocalRef( RunResultsE[5]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-InsLtg"   	Proj:RunResultsE[6]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[6]:DRtgElecDemand  ) - LocalRef( RunResultsE[6]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-AppCkg"   	Proj:RunResultsE[7]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[7]:DRtgElecDemand  ) - LocalRef( RunResultsE[7]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-Plugs"    	Proj:RunResultsE[8]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[8]:DRtgElecDemand  ) - LocalRef( RunResultsE[8]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-Ext"      	Proj:RunResultsE[9]:DRtgDeltaDemand		= {	LocalRef( RunResultsE[9]:DRtgElecDemand  ) - LocalRef( RunResultsE[9]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - E-PV"     	 	Proj:RunResultsE[13]:DRtgDeltaDemand	= {	LocalRef( RunResultsE[13]:DRtgElecDemand ) - LocalRef( RunResultsE[13]:PropElecDemand[2] )   }
	"Calc Delta El Demand - E-Total"    	Proj:RunResultsE[10]:DRtgDeltaDemand	= {	LocalRef( RunResultsE[10]:DRtgElecDemand ) - LocalRef( RunResultsE[10]:PropElecDemand[2] )   }
	"Calc Delta El Demand - E-Comp Ttl" 	Proj:RunResultsE[11]:DRtgDeltaDemand	= {	LocalRef( RunResultsE[11]:DRtgElecDemand ) - LocalRef( RunResultsE[11]:PropElecDemand[2] )   }

  ; Percent Improvement - SOUTH
	"Calc TDV Pct Improve - S-SpcHt"    	Proj:RunResultsS[1]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[1]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsS[1]:DesignRatingTDV[1]  ) - LocalRef( RunResultsS[1]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[1]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - S-SpcCl"    	Proj:RunResultsS[2]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[2]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsS[2]:DesignRatingTDV[1]  ) - LocalRef( RunResultsS[2]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[2]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - S-IAQVent"  	Proj:RunResultsS[3]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[3]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsS[3]:DesignRatingTDV[1]  ) - LocalRef( RunResultsS[3]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[3]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - S-OthrHVAC" 	Proj:RunResultsS[4]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[4]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsS[4]:DesignRatingTDV[1]  ) - LocalRef( RunResultsS[4]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[4]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - S-WtrHt"    	Proj:RunResultsS[5]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[5]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsS[5]:DesignRatingTDV[1]  ) - LocalRef( RunResultsS[5]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[5]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - S-InsLtg"   	Proj:RunResultsS[6]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[6]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsS[6]:DesignRatingTDV[1]  ) - LocalRef( RunResultsS[6]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[6]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - S-AppCkg"   	Proj:RunResultsS[7]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[7]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsS[7]:DesignRatingTDV[1]  ) - LocalRef( RunResultsS[7]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[7]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - S-Plugs"    	Proj:RunResultsS[8]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[8]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsS[8]:DesignRatingTDV[1]  ) - LocalRef( RunResultsS[8]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[8]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - S-Ext"      	Proj:RunResultsS[9]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[9]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsS[9]:DesignRatingTDV[1]  ) - LocalRef( RunResultsS[9]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsS[9]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - S-PV"    	  	Proj:RunResultsS[13]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[13]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsS[13]:DesignRatingTDV[1] ) - LocalRef( RunResultsS[13]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsS[13]:DesignRatingTDV[1] )  endif  }
	"Calc TDV Pct Improve - S-Total"    	Proj:RunResultsS[10]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[10]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsS[10]:DesignRatingTDV[1] ) - LocalRef( RunResultsS[10]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsS[10]:DesignRatingTDV[1] )  endif  }
	"Calc TDV Pct Improve - S-Comp Ttl"  	Proj:RunResultsS[11]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsS[11]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsS[11]:DesignRatingTDV[1] ) - LocalRef( RunResultsS[11]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsS[11]:DesignRatingTDV[1] )  endif  }
  ; Delta Demand
	"Calc Delta El Demand - S-SpcHt"    	Proj:RunResultsS[1]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[1]:DRtgElecDemand  ) - LocalRef( RunResultsS[1]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-SpcCl"    	Proj:RunResultsS[2]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[2]:DRtgElecDemand  ) - LocalRef( RunResultsS[2]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-IAQVent"  	Proj:RunResultsS[3]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[3]:DRtgElecDemand  ) - LocalRef( RunResultsS[3]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-OthrHVAC" 	Proj:RunResultsS[4]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[4]:DRtgElecDemand  ) - LocalRef( RunResultsS[4]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-WtrHt"    	Proj:RunResultsS[5]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[5]:DRtgElecDemand  ) - LocalRef( RunResultsS[5]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-InsLtg"   	Proj:RunResultsS[6]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[6]:DRtgElecDemand  ) - LocalRef( RunResultsS[6]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-AppCkg"   	Proj:RunResultsS[7]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[7]:DRtgElecDemand  ) - LocalRef( RunResultsS[7]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-Plugs"    	Proj:RunResultsS[8]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[8]:DRtgElecDemand  ) - LocalRef( RunResultsS[8]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-Ext"      	Proj:RunResultsS[9]:DRtgDeltaDemand		= {	LocalRef( RunResultsS[9]:DRtgElecDemand  ) - LocalRef( RunResultsS[9]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - S-PV"   	   	Proj:RunResultsS[13]:DRtgDeltaDemand	= {	LocalRef( RunResultsS[13]:DRtgElecDemand ) - LocalRef( RunResultsS[13]:PropElecDemand[2] )   }
	"Calc Delta El Demand - S-Total"    	Proj:RunResultsS[10]:DRtgDeltaDemand	= {	LocalRef( RunResultsS[10]:DRtgElecDemand ) - LocalRef( RunResultsS[10]:PropElecDemand[2] )   }
	"Calc Delta El Demand - S-Comp Ttl" 	Proj:RunResultsS[11]:DRtgDeltaDemand	= {	LocalRef( RunResultsS[11]:DRtgElecDemand ) - LocalRef( RunResultsS[11]:PropElecDemand[2] )   }

  ; Percent Improvement - WEST
	"Calc TDV Pct Improve - W-SpcHt"    	Proj:RunResultsW[1]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[1]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsW[1]:DesignRatingTDV[1]  ) - LocalRef( RunResultsW[1]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[1]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - W-SpcCl"    	Proj:RunResultsW[2]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[2]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsW[2]:DesignRatingTDV[1]  ) - LocalRef( RunResultsW[2]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[2]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - W-IAQVent"  	Proj:RunResultsW[3]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[3]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsW[3]:DesignRatingTDV[1]  ) - LocalRef( RunResultsW[3]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[3]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - W-OthrHVAC" 	Proj:RunResultsW[4]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[4]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsW[4]:DesignRatingTDV[1]  ) - LocalRef( RunResultsW[4]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[4]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - W-WtrHt"    	Proj:RunResultsW[5]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[5]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsW[5]:DesignRatingTDV[1]  ) - LocalRef( RunResultsW[5]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[5]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - W-InsLtg"   	Proj:RunResultsW[6]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[6]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsW[6]:DesignRatingTDV[1]  ) - LocalRef( RunResultsW[6]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[6]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - W-AppCkg"   	Proj:RunResultsW[7]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[7]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsW[7]:DesignRatingTDV[1]  ) - LocalRef( RunResultsW[7]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[7]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - W-Plugs"    	Proj:RunResultsW[8]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[8]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsW[8]:DesignRatingTDV[1]  ) - LocalRef( RunResultsW[8]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[8]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - W-Ext"      	Proj:RunResultsW[9]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[9]:DesignRatingTDV[1]  ) == 0) then  0  else  (LocalRef( RunResultsW[9]:DesignRatingTDV[1]  ) - LocalRef( RunResultsW[9]:ProposedTDV[2]  )) * 100 / LocalRef( RunResultsW[9]:DesignRatingTDV[1]  )  endif  }
	"Calc TDV Pct Improve - W-PV"     	 	Proj:RunResultsW[13]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[13]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsW[13]:DesignRatingTDV[1] ) - LocalRef( RunResultsW[13]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsW[13]:DesignRatingTDV[1] )  endif  }
	"Calc TDV Pct Improve - W-Total"    	Proj:RunResultsW[10]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[10]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsW[10]:DesignRatingTDV[1] ) - LocalRef( RunResultsW[10]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsW[10]:DesignRatingTDV[1] )  endif  }
	"Calc TDV Pct Improve - W-Comp Ttl"  	Proj:RunResultsW[11]:DRtgPctSavTDV	= {	if (LocalRef( RunResultsW[11]:DesignRatingTDV[1] ) == 0) then  0  else  (LocalRef( RunResultsW[11]:DesignRatingTDV[1] ) - LocalRef( RunResultsW[11]:ProposedTDV[2] )) * 100 / LocalRef( RunResultsW[11]:DesignRatingTDV[1] )  endif  }
  ; Delta Demand
	"Calc Delta El Demand - W-SpcHt"    	Proj:RunResultsW[1]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[1]:DRtgElecDemand  ) - LocalRef( RunResultsW[1]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-SpcCl"    	Proj:RunResultsW[2]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[2]:DRtgElecDemand  ) - LocalRef( RunResultsW[2]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-IAQVent"  	Proj:RunResultsW[3]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[3]:DRtgElecDemand  ) - LocalRef( RunResultsW[3]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-OthrHVAC" 	Proj:RunResultsW[4]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[4]:DRtgElecDemand  ) - LocalRef( RunResultsW[4]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-WtrHt"    	Proj:RunResultsW[5]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[5]:DRtgElecDemand  ) - LocalRef( RunResultsW[5]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-InsLtg"   	Proj:RunResultsW[6]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[6]:DRtgElecDemand  ) - LocalRef( RunResultsW[6]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-AppCkg"   	Proj:RunResultsW[7]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[7]:DRtgElecDemand  ) - LocalRef( RunResultsW[7]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-Plugs"    	Proj:RunResultsW[8]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[8]:DRtgElecDemand  ) - LocalRef( RunResultsW[8]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-Ext"      	Proj:RunResultsW[9]:DRtgDeltaDemand		= {	LocalRef( RunResultsW[9]:DRtgElecDemand  ) - LocalRef( RunResultsW[9]:PropElecDemand[2]  )   }
	"Calc Delta El Demand - W-PV"      		Proj:RunResultsW[13]:DRtgDeltaDemand	= {	LocalRef( RunResultsW[13]:DRtgElecDemand ) - LocalRef( RunResultsW[13]:PropElecDemand[2] )   }
	"Calc Delta El Demand - W-Total"    	Proj:RunResultsW[10]:DRtgDeltaDemand	= {	LocalRef( RunResultsW[10]:DRtgElecDemand ) - LocalRef( RunResultsW[10]:PropElecDemand[2] )   }
	"Calc Delta El Demand - W-Comp Ttl" 	Proj:RunResultsW[11]:DRtgDeltaDemand	= {	LocalRef( RunResultsW[11]:DRtgElecDemand ) - LocalRef( RunResultsW[11]:PropElecDemand[2] )   }

; SAC 3/30/15 - ADDED BACK IN - WorstOrientation setting stuff since this needs to be set inside DesignRating model BEMProc instance in order for results CSV export to function properly
; -- NOW -- Calculate WORST case scenario and reference THOSE RunResults objects in the main RunResults[] elements
	"Determine which RunResults is Worst case"	Proj:WorstOrientation	= {	if (		RunResultsN[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
																													RunResultsN[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
																													RunResultsN[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	1
																										else if (RunResultsE[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
																													RunResultsE[11]:CompMarginTDV <= RunResultsS[11]:CompMarginTDV .AND.
																													RunResultsE[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	2
																										else if (RunResultsS[11]:CompMarginTDV <= RunResultsN[11]:CompMarginTDV .AND.
																													RunResultsS[11]:CompMarginTDV <= RunResultsE[11]:CompMarginTDV .AND.
																													RunResultsS[11]:CompMarginTDV <= RunResultsW[11]:CompMarginTDV )	then	3	else	4	endif endif endif  }
	"Call rules to set Worst case RunResults"		Proj:Action		= {	switch (WorstOrientation)
																								case  2 :  EvalRulelist( "CARes_RunResults_SetWorst_E" )
																								case  3 :  EvalRulelist( "CARes_RunResults_SetWorst_S" )
																								case  4 :  EvalRulelist( "CARes_RunResults_SetWorst_W" )
																								default :  EvalRulelist( "CARes_RunResults_SetWorst_N" )
																							endswitch  }
END

;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_N" 1 0 0 1
;*************************************************************************
	"Revise 'Worst Case' EUseSummary name"			Proj:ResultSummary[1]:Name	= {	"Worst Case (N)"  }
	"Set worst case RunResults to N - SpcHt"    	Proj:RunResults[1]	= {	RunResultsN[1]    }
	"Set worst case RunResults to N - SpcCl"    	Proj:RunResults[2]	= {	RunResultsN[2]    }
	"Set worst case RunResults to N - IAQVent"  	Proj:RunResults[3]	= {	RunResultsN[3]    }
	"Set worst case RunResults to N - OthrHVAC" 	Proj:RunResults[4]	= {	RunResultsN[4]    }
	"Set worst case RunResults to N - WtrHt"    	Proj:RunResults[5]	= {	RunResultsN[5]    }
	"Set worst case RunResults to N - InsLtg"   	Proj:RunResults[6]	= {	RunResultsN[6]    }
	"Set worst case RunResults to N - AppCkg"   	Proj:RunResults[7]	= {	RunResultsN[7]    }
	"Set worst case RunResults to N - Plugs"    	Proj:RunResults[8]	= {	RunResultsN[8]    }
	"Set worst case RunResults to N - Ext"      	Proj:RunResults[9]	= {	RunResultsN[9]    }
	"Set worst case RunResults to N - PV"      	Proj:RunResults[13]	= {	RunResultsN[13]   }
	"Set worst case RunResults to N - Total"    	Proj:RunResults[10]	= {	RunResultsN[10]   }
	"Set worst case RunResults to N - Comp Ttl"  Proj:RunResults[11]	= {	RunResultsN[11]   }
END
;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_E" 1 0 0 1
;*************************************************************************
	"Revise 'Worst Case' EUseSummary name"			Proj:ResultSummary[1]:Name	= {	"Worst Case (E)"  }
	"Set worst case RunResults to E - SpcHt"    	Proj:RunResults[1]	= {	RunResultsE[1]    }
	"Set worst case RunResults to E - SpcCl"    	Proj:RunResults[2]	= {	RunResultsE[2]    }
	"Set worst case RunResults to E - IAQVent"  	Proj:RunResults[3]	= {	RunResultsE[3]    }
	"Set worst case RunResults to E - OthrHVAC" 	Proj:RunResults[4]	= {	RunResultsE[4]    }
	"Set worst case RunResults to E - WtrHt"    	Proj:RunResults[5]	= {	RunResultsE[5]    }
	"Set worst case RunResults to E - InsLtg"   	Proj:RunResults[6]	= {	RunResultsE[6]    }
	"Set worst case RunResults to E - AppCkg"   	Proj:RunResults[7]	= {	RunResultsE[7]    }
	"Set worst case RunResults to E - Plugs"    	Proj:RunResults[8]	= {	RunResultsE[8]    }
	"Set worst case RunResults to E - Ext"      	Proj:RunResults[9]	= {	RunResultsE[9]    }
	"Set worst case RunResults to E - PV"      	Proj:RunResults[13]	= {	RunResultsE[13]   }
	"Set worst case RunResults to E - Total"    	Proj:RunResults[10]	= {	RunResultsE[10]   }
	"Set worst case RunResults to E - Comp Ttl"  Proj:RunResults[11]	= {	RunResultsE[11]   }
END
;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_S" 1 0 0 1
;*************************************************************************
	"Revise 'Worst Case' EUseSummary name"			Proj:ResultSummary[1]:Name	= {	"Worst Case (S)"  }
	"Set worst case RunResults to S - SpcHt"    	Proj:RunResults[1]	= {	RunResultsS[1]    }
	"Set worst case RunResults to S - SpcCl"    	Proj:RunResults[2]	= {	RunResultsS[2]    }
	"Set worst case RunResults to S - IAQVent"  	Proj:RunResults[3]	= {	RunResultsS[3]    }
	"Set worst case RunResults to S - OthrHVAC" 	Proj:RunResults[4]	= {	RunResultsS[4]    }
	"Set worst case RunResults to S - WtrHt"    	Proj:RunResults[5]	= {	RunResultsS[5]    }
	"Set worst case RunResults to S - InsLtg"   	Proj:RunResults[6]	= {	RunResultsS[6]    }
	"Set worst case RunResults to S - AppCkg"   	Proj:RunResults[7]	= {	RunResultsS[7]    }
	"Set worst case RunResults to S - Plugs"    	Proj:RunResults[8]	= {	RunResultsS[8]    }
	"Set worst case RunResults to S - Ext"      	Proj:RunResults[9]	= {	RunResultsS[9]    }
	"Set worst case RunResults to S - PV"      	Proj:RunResults[13]	= {	RunResultsS[13]   }
	"Set worst case RunResults to S - Total"    	Proj:RunResults[10]	= {	RunResultsS[10]   }
	"Set worst case RunResults to S - Comp Ttl"  Proj:RunResults[11]	= {	RunResultsS[11]   }
END
;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_RunResults_SetWorst_W" 1 0 0 1
;*************************************************************************
	"Revise 'Worst Case' EUseSummary name"			Proj:ResultSummary[1]:Name	= {	"Worst Case (W)"  }
	"Set worst case RunResults to W - SpcHt"    	Proj:RunResults[1]	= {	RunResultsW[1]    }
	"Set worst case RunResults to W - SpcCl"    	Proj:RunResults[2]	= {	RunResultsW[2]    }
	"Set worst case RunResults to W - IAQVent"  	Proj:RunResults[3]	= {	RunResultsW[3]    }
	"Set worst case RunResults to W - OthrHVAC" 	Proj:RunResults[4]	= {	RunResultsW[4]    }
	"Set worst case RunResults to W - WtrHt"    	Proj:RunResults[5]	= {	RunResultsW[5]    }
	"Set worst case RunResults to W - InsLtg"   	Proj:RunResults[6]	= {	RunResultsW[6]    }
	"Set worst case RunResults to W - AppCkg"   	Proj:RunResults[7]	= {	RunResultsW[7]    }
	"Set worst case RunResults to W - Plugs"    	Proj:RunResults[8]	= {	RunResultsW[8]    }
	"Set worst case RunResults to W - Ext"      	Proj:RunResults[9]	= {	RunResultsW[9]    }
	"Set worst case RunResults to W - PV"      	Proj:RunResults[13]	= {	RunResultsW[13]   }
	"Set worst case RunResults to W - Total"    	Proj:RunResults[10]	= {	RunResultsW[10]   }
	"Set worst case RunResults to W - Comp Ttl"  Proj:RunResults[11]	= {	RunResultsW[11]   }
END
;*************************************************************************


;*************************************************************************
RULELIST "CARes_ProposedSummary" 1 0 1 1
;*************************************************************************
	"Blast all EUseSummary components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EUseSummary )  }

	"Create energy use summary component"				Proj:ResultSummary[1]					= {	CreateComp( EUseSummary, "EUSummary" )  }
	"Set parent for energy use summary"					Proj:ResultSummary[1]:Parent			= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"		Proj:ResultSummary[1]:ProjAssignFirst	= {	1  }		; SAC 3/3/16 - tic #609

	"Call subordinate rulelist to set all EUseSummary data"		Proj:Action = {	EvalRulelist( "CARes_ProposedSummary_Main" )  }
END

;*************************************************************************
RULELIST "CARes_ProposedSummary_Main" 1 0 1 1
;*************************************************************************
	"Set ResultSummary[1]:Title3[1]"				Proj:ResultSummary[1]:Title3[1]		= {	"End Use"  }

	"Set ResultSummary[1]:Enduse1[1]"			Proj:ResultSummary[1]:Enduse1[1]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[1]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse2[1]"			Proj:ResultSummary[1]:Enduse2[1]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[2]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse3[1]"			Proj:ResultSummary[1]:Enduse3[1]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[3]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse4[1]"			Proj:ResultSummary[1]:Enduse4[1]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[4]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse5[1]"			Proj:ResultSummary[1]:Enduse5[1]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[5]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse6[1]"			Proj:ResultSummary[1]:Enduse6[1]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[6]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse7[1]"			Proj:ResultSummary[1]:Enduse7[1]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[7]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse8[1]"			Proj:ResultSummary[1]:Enduse8[1]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[8]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse9[1]"			Proj:ResultSummary[1]:Enduse9[1]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  LocalRef( RunResults[9]:EnduseName  )  endif  }
	"Set ResultSummary[1]:Enduse10[1]"			Proj:ResultSummary[1]:Enduse10[1]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  LocalRef( RunResults[10]:EnduseName )  endif  }
	"Set ResultSummary[1]:Enduse11[1]"			Proj:ResultSummary[1]:Enduse11[1]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  LocalRef( RunResults[11]:EnduseName )  endif  }
	"Set ResultSummary[1]:Enduse12[1]"			Proj:ResultSummary[1]:Enduse12[1]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  LocalRef( RunResults[12]:EnduseName )  endif  }
  ; SAC 1/14/13 - added PVCredit stuff
; 	"Set ResultSummary[1]:Enduse13[1]"			Proj:ResultSummary[1]:Enduse13[1]	= {	"PV Credit"  }
  ; SAC 1/28/16 - PV now a separate enduse w/ assigned RunResults[13]
	"Set ResultSummary[1]:Enduse13[1]"			Proj:ResultSummary[1]:Enduse13[1]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  LocalRef( RunResults[13]:EnduseName )  endif  }

; SAC 12/10/12 - revised rule to calc TDV for Research simulations
	"Call subordinate rulelist to setup remaining summary data"		Proj:Action = {	switch (Local( AnalysisType ))
																													case  0 :	EvalRulelist( "CARes_Summary_Prop_Only" )			; Research  (revised to calc & report TDV)
																													case 12 :	EvalRulelist( "CARes_Summary_Prop_Only" )			; Proposed Only
																												;	case 13 :	EvalRulelist( "CARes_Summary_Prop_AndStd" )		; Proposed and Standard
																													case 13 :	EvalRulelist( "CARes_Summary_Prop_Only" )			; Proposed and Standard
																													default :	EvalRulelist( "CARes_Summary_Prop_Research" )	; Research
																												endswitch  }
END

;*************************************************************************
RULELIST "CARes_Summary_Prop_Only" 1 0 1 1
;*************************************************************************
;  ; Proposed Energy
;	"Set ResultSummary[1]:Title1[2]"				Proj:ResultSummary[1]:Title1[2]		= {	"Proposed"  }
;	"Set ResultSummary[1]:Title2[2]"				Proj:ResultSummary[1]:Title2[2]		= {	"Design"  }
;	"Set ResultSummary[1]:Title3[2]"				Proj:ResultSummary[1]:Title3[2]		= {	"(kBTU/ft²-yr)"  }
;	"Set ResultSummary[1]:Enduse1[2]"			Proj:ResultSummary[1]:Enduse1[2]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse2[2]"			Proj:ResultSummary[1]:Enduse2[2]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse3[2]"			Proj:ResultSummary[1]:Enduse3[2]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse4[2]"			Proj:ResultSummary[1]:Enduse4[2]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse5[2]"			Proj:ResultSummary[1]:Enduse5[2]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse6[2]"			Proj:ResultSummary[1]:Enduse6[2]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse7[2]"			Proj:ResultSummary[1]:Enduse7[2]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse8[2]"			Proj:ResultSummary[1]:Enduse8[2]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse9[2]"			Proj:ResultSummary[1]:Enduse9[2]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse10[2]"			Proj:ResultSummary[1]:Enduse10[2]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse11[2]"			Proj:ResultSummary[1]:Enduse11[2]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse12[2]"			Proj:ResultSummary[1]:Enduse12[2]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary[1]:Enduse13[2]"			Proj:ResultSummary[1]:Enduse13[2]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:PropTotalEnergy ), 2 )  endif  }

; Rounding:  int( (<100 *> VALUE) + 0.5 ) </ 100>

  ; Proposed Site Electric Use
	"Set ResultSummary[1]:Title1[2]"				Proj:ResultSummary[1]:Title1[2]		= {	"Proposed"  }
	"Set ResultSummary[1]:Title2[2]"				Proj:ResultSummary[1]:Title2[2]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[2]"				Proj:ResultSummary[1]:Title3[2]		= {	"Site (kWh)"  }
	"Set ResultSummary[1]:Enduse1[2]"			Proj:ResultSummary[1]:Enduse1[2]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse2[2]"			Proj:ResultSummary[1]:Enduse2[2]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse3[2]"			Proj:ResultSummary[1]:Enduse3[2]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse4[2]"			Proj:ResultSummary[1]:Enduse4[2]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
; SAC 7/18/13 - added "- none -" label for when user did not define (or assign) DHWSys objects
	"Set ResultSummary[1]:Enduse5[2]"			Proj:ResultSummary[1]:Enduse5[2]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:PropElecEnergy[1]  < 0.00001) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( (int( (RunResults[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse6[2]"			Proj:ResultSummary[1]:Enduse6[2]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse7[2]"			Proj:ResultSummary[1]:Enduse7[2]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse8[2]"			Proj:ResultSummary[1]:Enduse8[2]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse9[2]"			Proj:ResultSummary[1]:Enduse9[2]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse10[2]"			Proj:ResultSummary[1]:Enduse10[2]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. RunResults[10]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[2]"			Proj:ResultSummary[1]:Enduse11[2]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[2]"			Proj:ResultSummary[1]:Enduse12[2]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse13[2]"			Proj:ResultSummary[1]:Enduse13[2]	= {	if (LocalCompAssigned( RunResults[13] ) == 0 .OR. RunResults[13]:PropElecEnergy[1] > -0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[13]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[1]:Title1[3]"				Proj:ResultSummary[1]:Title1[3]		= {	"Proposed"  }
	"Set ResultSummary[1]:Title2[3]"				Proj:ResultSummary[1]:Title2[3]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[3]"				Proj:ResultSummary[1]:Title3[3]		= {	"Site (therms)"  }
	"Set ResultSummary[1]:Enduse1[3]"			Proj:ResultSummary[1]:Enduse1[3]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. (RunResults[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[1]:PropNatGasEnergy[1]  + RunResults[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse2[3]"			Proj:ResultSummary[1]:Enduse2[3]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. (RunResults[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[2]:PropNatGasEnergy[1]  + RunResults[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse3[3]"			Proj:ResultSummary[1]:Enduse3[3]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. (RunResults[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[3]:PropNatGasEnergy[1]  + RunResults[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse4[3]"			Proj:ResultSummary[1]:Enduse4[3]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. (RunResults[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[4]:PropNatGasEnergy[1]  + RunResults[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse5[3]"			Proj:ResultSummary[1]:Enduse5[3]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. (RunResults[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResults[5]:PropNatGasEnergy[1]  + RunResults[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse6[3]"			Proj:ResultSummary[1]:Enduse6[3]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. (RunResults[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[6]:PropNatGasEnergy[1]  + RunResults[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse7[3]"			Proj:ResultSummary[1]:Enduse7[3]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. (RunResults[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[7]:PropNatGasEnergy[1]  + RunResults[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse8[3]"			Proj:ResultSummary[1]:Enduse8[3]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. (RunResults[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[8]:PropNatGasEnergy[1]  + RunResults[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse9[3]"			Proj:ResultSummary[1]:Enduse9[3]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. (RunResults[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[9]:PropNatGasEnergy[1]  + RunResults[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse10[3]"			Proj:ResultSummary[1]:Enduse10[3]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. (RunResults[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[10]:PropNatGasEnergy[1] + RunResults[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse11[3]"			Proj:ResultSummary[1]:Enduse11[3]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. (RunResults[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[11]:PropNatGasEnergy[1] + RunResults[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse12[3]"			Proj:ResultSummary[1]:Enduse12[3]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. (RunResults[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[12]:PropNatGasEnergy[1] + RunResults[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse13[3]"			Proj:ResultSummary[1]:Enduse13[3]	= {	UNDEFINED  }		; PV

  ; Proposed TDV
	"Set ResultSummary[1]:Title1[4]"				Proj:ResultSummary[1]:Title1[4]		= {	"Proposed"  }
	"Set ResultSummary[1]:Title2[4]"				Proj:ResultSummary[1]:Title2[4]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[4]"				Proj:ResultSummary[1]:Title3[4]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[1]:Enduse1[4]"			Proj:ResultSummary[1]:Enduse1[4]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[4]"			Proj:ResultSummary[1]:Enduse2[4]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[4]"			Proj:ResultSummary[1]:Enduse3[4]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[4]"			Proj:ResultSummary[1]:Enduse4[4]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[4]"			Proj:ResultSummary[1]:Enduse5[4]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[4]"			Proj:ResultSummary[1]:Enduse6[4]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[4]"			Proj:ResultSummary[1]:Enduse7[4]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[4]"			Proj:ResultSummary[1]:Enduse8[4]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[4]"			Proj:ResultSummary[1]:Enduse9[4]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:ProposedTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[4]"			Proj:ResultSummary[1]:Enduse10[4]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[4]"			Proj:ResultSummary[1]:Enduse11[4]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[4]"			Proj:ResultSummary[1]:Enduse12[4]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse13[4]"			Proj:ResultSummary[1]:Enduse13[4]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:ProposedTDV[1] ), 2 )  endif  }

  ; Proposed Electric Demand
	"Set ResultSummary[1]:Title1[10]"			Proj:ResultSummary[1]:Title1[10]		= {	"Proposed"  }
	"Set ResultSummary[1]:Title2[10]"			Proj:ResultSummary[1]:Title2[10]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[10]"			Proj:ResultSummary[1]:Title3[10]		= {	"(kW)"  }
	"Set ResultSummary[1]:Enduse1[10]"			Proj:ResultSummary[1]:Enduse1[10]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[10]"			Proj:ResultSummary[1]:Enduse2[10]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[10]"			Proj:ResultSummary[1]:Enduse3[10]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[10]"			Proj:ResultSummary[1]:Enduse4[10]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[10]"			Proj:ResultSummary[1]:Enduse5[10]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[10]"			Proj:ResultSummary[1]:Enduse6[10]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[10]"			Proj:ResultSummary[1]:Enduse7[10]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[10]"			Proj:ResultSummary[1]:Enduse8[10]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[10]"			Proj:ResultSummary[1]:Enduse9[10]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:PropElecDemand[1]  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[10]"			Proj:ResultSummary[1]:Enduse10[10]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[10]"			Proj:ResultSummary[1]:Enduse11[10]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[10]"			Proj:ResultSummary[1]:Enduse12[10]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse13[10]"			Proj:ResultSummary[1]:Enduse13[10]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:PropElecDemand[1] ), 2 )  endif  }
END

;;*************************************************************************
;RULELIST "CARes_Summary_Prop_AndStd" 1 0 1 1
;;*************************************************************************
;
;	"Call above rulelist to setup Proposed model results"		Proj:Action = {	EvalRulelist( "CARes_Summary_Prop_Only" )  }
;
;  ; Standard Site Electric Use
;	"Set ResultSummary:Title1[5]"				Proj:ResultSummary:Title1[5]		= {	"Standard"  }
;	"Set ResultSummary:Title2[5]"				Proj:ResultSummary:Title2[5]		= {	"Design"  }
;	"Set ResultSummary:Title3[5]"				Proj:ResultSummary:Title3[5]		= {	"Site (kWh)"  }
;	"Set ResultSummary:Enduse1[5]"			Proj:ResultSummary:Enduse1[5]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse2[5]"			Proj:ResultSummary:Enduse2[5]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse3[5]"			Proj:ResultSummary:Enduse3[5]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse4[5]"			Proj:ResultSummary:Enduse4[5]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse5[5]"			Proj:ResultSummary:Enduse5[5]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse6[5]"			Proj:ResultSummary:Enduse6[5]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse7[5]"			Proj:ResultSummary:Enduse7[5]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse8[5]"			Proj:ResultSummary:Enduse8[5]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse9[5]"			Proj:ResultSummary:Enduse9[5]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse10[5]"			Proj:ResultSummary:Enduse10[5]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. RunResults[10]:StdElecEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[10]:StdElecEnergy * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse11[5]"			Proj:ResultSummary:Enduse11[5]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[11]:StdElecEnergy * Proj:CondFloorArea / 3.413), 0 )  endif  }
;	"Set ResultSummary:Enduse12[5]"			Proj:ResultSummary:Enduse12[5]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[12]:StdElecEnergy * Proj:CondFloorArea / 3.413), 0 )  endif  }
;
;  ; Standard Site Natural Gas Use
;	"Set ResultSummary:Title1[6]"				Proj:ResultSummary:Title1[6]		= {	"Standard"  }
;	"Set ResultSummary:Title2[6]"				Proj:ResultSummary:Title2[6]		= {	"Design"  }
;	"Set ResultSummary:Title3[6]"				Proj:ResultSummary:Title3[6]		= {	"Site (therms)"  }
;	"Set ResultSummary:Enduse1[6]"			Proj:ResultSummary:Enduse1[6]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[1]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse2[6]"			Proj:ResultSummary:Enduse2[6]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[2]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse3[6]"			Proj:ResultSummary:Enduse3[6]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[3]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse4[6]"			Proj:ResultSummary:Enduse4[6]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[4]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse5[6]"			Proj:ResultSummary:Enduse5[6]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[5]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse6[6]"			Proj:ResultSummary:Enduse6[6]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[6]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse7[6]"			Proj:ResultSummary:Enduse7[6]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[7]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse8[6]"			Proj:ResultSummary:Enduse8[6]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[8]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse9[6]"			Proj:ResultSummary:Enduse9[6]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:StdNatGasEnergy  < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[9]:StdNatGasEnergy  * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse10[6]"			Proj:ResultSummary:Enduse10[6]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. RunResults[10]:StdNatGasEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[10]:StdNatGasEnergy * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse11[6]"			Proj:ResultSummary:Enduse11[6]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:StdNatGasEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[11]:StdNatGasEnergy * Proj:CondFloorArea / 100), 1 )  endif  }
;	"Set ResultSummary:Enduse12[6]"			Proj:ResultSummary:Enduse12[6]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:StdNatGasEnergy < 0.00001) then  UNDEFINED  
;																											else  FltToStr( (RunResults[12]:StdNatGasEnergy * Proj:CondFloorArea / 100), 1 )  endif  }
;
;  ; Standard TDV
;	"Set ResultSummary:Title1[7]"				Proj:ResultSummary:Title1[7]		= {	"Standard"  }
;	"Set ResultSummary:Title2[7]"				Proj:ResultSummary:Title2[7]		= {	"Design"  }
;	"Set ResultSummary:Title3[7]"				Proj:ResultSummary:Title3[7]		= {	"(kTDV/ft²-yr)"  }
;	"Set ResultSummary:Enduse1[7]"			Proj:ResultSummary:Enduse1[7]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse2[7]"			Proj:ResultSummary:Enduse2[7]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse3[7]"			Proj:ResultSummary:Enduse3[7]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse4[7]"			Proj:ResultSummary:Enduse4[7]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse5[7]"			Proj:ResultSummary:Enduse5[7]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse6[7]"			Proj:ResultSummary:Enduse6[7]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse7[7]"			Proj:ResultSummary:Enduse7[7]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse8[7]"			Proj:ResultSummary:Enduse8[7]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:StandardTDV  ), 2 )  endif  }
;	"Set ResultSummary:Enduse9[7]"			Proj:ResultSummary:Enduse9[7]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:StandardTDV  ), 2 )  endif  }
; 	"Set ResultSummary:Enduse10[7]"			Proj:ResultSummary:Enduse10[7]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:StandardTDV ), 2 )  endif  }
; 	"Set ResultSummary:Enduse11[7]"			Proj:ResultSummary:Enduse11[7]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:StandardTDV ), 2 )  endif  }
; 	"Set ResultSummary:Enduse12[7]"			Proj:ResultSummary:Enduse12[7]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:StandardTDV ), 2 )  endif  }
;END

;*************************************************************************
RULELIST "CARes_Summary_Prop_Research" 1 0 1 1
;*************************************************************************
;  ; Proposed Energy
;	"Set ResultSummary:Title1[2]"				Proj:ResultSummary:Title1[2]		= {	"Proposed"  }
;	"Set ResultSummary:Title2[2]"				Proj:ResultSummary:Title2[2]		= {	"Design"  }
;	"Set ResultSummary:Title3[2]"				Proj:ResultSummary:Title3[2]		= {	"(kBTU/ft²-yr)"  }
;	"Set ResultSummary:Enduse1[2]"			Proj:ResultSummary:Enduse1[2]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse2[2]"			Proj:ResultSummary:Enduse2[2]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse3[2]"			Proj:ResultSummary:Enduse3[2]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse4[2]"			Proj:ResultSummary:Enduse4[2]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse5[2]"			Proj:ResultSummary:Enduse5[2]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse6[2]"			Proj:ResultSummary:Enduse6[2]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse7[2]"			Proj:ResultSummary:Enduse7[2]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse8[2]"			Proj:ResultSummary:Enduse8[2]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse9[2]"			Proj:ResultSummary:Enduse9[2]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:PropTotalEnergy  ), 2 )  endif  }
;	"Set ResultSummary:Enduse10[2]"			Proj:ResultSummary:Enduse10[2]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary:Enduse11[2]"			Proj:ResultSummary:Enduse11[2]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary:Enduse12[2]"			Proj:ResultSummary:Enduse12[2]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:PropTotalEnergy ), 2 )  endif  }
;	"Set ResultSummary:Enduse13[2]"			Proj:ResultSummary:Enduse13[2]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:PropTotalEnergy ), 2 )  endif  }

  ; Proposed Site Electric Use
	"Set ResultSummary[1]:Title1[2]"				Proj:ResultSummary[1]:Title1[2]		= {	"Proposed"  }
	"Set ResultSummary[1]:Title2[2]"				Proj:ResultSummary[1]:Title2[2]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[2]"				Proj:ResultSummary[1]:Title3[2]		= {	"Site (kWh)"  }
	"Set ResultSummary[1]:Enduse1[2]"			Proj:ResultSummary[1]:Enduse1[2]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse2[2]"			Proj:ResultSummary[1]:Enduse2[2]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse3[2]"			Proj:ResultSummary[1]:Enduse3[2]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse4[2]"			Proj:ResultSummary[1]:Enduse4[2]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse5[2]"			Proj:ResultSummary[1]:Enduse5[2]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:PropElecEnergy[1]  < 0.00001) then 
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( (int( (RunResults[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse6[2]"			Proj:ResultSummary[1]:Enduse6[2]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse7[2]"			Proj:ResultSummary[1]:Enduse7[2]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse8[2]"			Proj:ResultSummary[1]:Enduse8[2]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse9[2]"			Proj:ResultSummary[1]:Enduse9[2]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse10[2]"			Proj:ResultSummary[1]:Enduse10[2]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. RunResults[10]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[2]"			Proj:ResultSummary[1]:Enduse11[2]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[2]"			Proj:ResultSummary[1]:Enduse12[2]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse13[2]"			Proj:ResultSummary[1]:Enduse13[2]	= {	if (LocalCompAssigned( RunResults[13] ) == 0 .OR. RunResults[13]:PropElecEnergy[1] > -0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[13]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[1]:Title1[3]"				Proj:ResultSummary[1]:Title1[3]		= {	"Proposed"  }
	"Set ResultSummary[1]:Title2[3]"				Proj:ResultSummary[1]:Title2[3]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[3]"				Proj:ResultSummary[1]:Title3[3]		= {	"Site (therms)"  }
	"Set ResultSummary[1]:Enduse1[3]"			Proj:ResultSummary[1]:Enduse1[3]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. (RunResults[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[1]:PropNatGasEnergy[1]  + RunResults[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse2[3]"			Proj:ResultSummary[1]:Enduse2[3]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. (RunResults[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[2]:PropNatGasEnergy[1]  + RunResults[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse3[3]"			Proj:ResultSummary[1]:Enduse3[3]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. (RunResults[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[3]:PropNatGasEnergy[1]  + RunResults[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse4[3]"			Proj:ResultSummary[1]:Enduse4[3]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. (RunResults[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[4]:PropNatGasEnergy[1]  + RunResults[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse5[3]"			Proj:ResultSummary[1]:Enduse5[3]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. (RunResults[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResults[5]:PropNatGasEnergy[1]  + RunResults[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse6[3]"			Proj:ResultSummary[1]:Enduse6[3]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. (RunResults[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[6]:PropNatGasEnergy[1]  + RunResults[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse7[3]"			Proj:ResultSummary[1]:Enduse7[3]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. (RunResults[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[7]:PropNatGasEnergy[1]  + RunResults[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse8[3]"			Proj:ResultSummary[1]:Enduse8[3]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. (RunResults[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[8]:PropNatGasEnergy[1]  + RunResults[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse9[3]"			Proj:ResultSummary[1]:Enduse9[3]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. (RunResults[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResults[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[9]:PropNatGasEnergy[1]  + RunResults[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse10[3]"			Proj:ResultSummary[1]:Enduse10[3]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. (RunResults[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[10]:PropNatGasEnergy[1] + RunResults[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse11[3]"			Proj:ResultSummary[1]:Enduse11[3]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. (RunResults[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[11]:PropNatGasEnergy[1] + RunResults[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse12[3]"			Proj:ResultSummary[1]:Enduse12[3]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. (RunResults[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResults[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[12]:PropNatGasEnergy[1] + RunResults[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse13[3]"			Proj:ResultSummary[1]:Enduse13[3]	= {	UNDEFINED  }		; PV
END

;*************************************************************************
RULELIST "CARes_StandardSummary" 1 0 1 1
;*************************************************************************
  ; Standard Site Electric Use
	"Set ResultSummary[1]:Title1[5]"				Proj:ResultSummary[1]:Title1[5]		= {	"Standard"  }
	"Set ResultSummary[1]:Title2[5]"				Proj:ResultSummary[1]:Title2[5]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[5]"				Proj:ResultSummary[1]:Title3[5]		= {	"Site (kWh)"  }
	"Set ResultSummary[1]:Enduse1[5]"			Proj:ResultSummary[1]:Enduse1[5]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse2[5]"			Proj:ResultSummary[1]:Enduse2[5]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse3[5]"			Proj:ResultSummary[1]:Enduse3[5]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse4[5]"			Proj:ResultSummary[1]:Enduse4[5]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse5[5]"			Proj:ResultSummary[1]:Enduse5[5]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse6[5]"			Proj:ResultSummary[1]:Enduse6[5]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse7[5]"			Proj:ResultSummary[1]:Enduse7[5]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse8[5]"			Proj:ResultSummary[1]:Enduse8[5]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse9[5]"			Proj:ResultSummary[1]:Enduse9[5]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse10[5]"			Proj:ResultSummary[1]:Enduse10[5]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. RunResults[10]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[5]"			Proj:ResultSummary[1]:Enduse11[5]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[5]"			Proj:ResultSummary[1]:Enduse12[5]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[1]:Enduse10[2]"			Proj:ResultSummary[1]:Enduse10[2]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. RunResults[10]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[2]"			Proj:ResultSummary[1]:Enduse11[2]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[2]"			Proj:ResultSummary[1]:Enduse12[2]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Standard Site Natural Gas Use
	"Set ResultSummary[1]:Title1[6]"				Proj:ResultSummary[1]:Title1[6]		= {	"Standard"  }
	"Set ResultSummary[1]:Title2[6]"				Proj:ResultSummary[1]:Title2[6]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[6]"				Proj:ResultSummary[1]:Title3[6]		= {	"Site (therms)"  }
	"Set ResultSummary[1]:Enduse1[6]"			Proj:ResultSummary[1]:Enduse1[6]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. (RunResults[1]:StdNatGasEnergy  < 0.00001 .AND. RunResults[1]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[1]:StdNatGasEnergy  + RunResults[1]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse2[6]"			Proj:ResultSummary[1]:Enduse2[6]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. (RunResults[2]:StdNatGasEnergy  < 0.00001 .AND. RunResults[2]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[2]:StdNatGasEnergy  + RunResults[2]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse3[6]"			Proj:ResultSummary[1]:Enduse3[6]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. (RunResults[3]:StdNatGasEnergy  < 0.00001 .AND. RunResults[3]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[3]:StdNatGasEnergy  + RunResults[3]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse4[6]"			Proj:ResultSummary[1]:Enduse4[6]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. (RunResults[4]:StdNatGasEnergy  < 0.00001 .AND. RunResults[4]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[4]:StdNatGasEnergy  + RunResults[4]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse5[6]"			Proj:ResultSummary[1]:Enduse5[6]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. (RunResults[5]:StdNatGasEnergy  < 0.00001 .AND. RunResults[5]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[5]:StdNatGasEnergy  + RunResults[5]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse6[6]"			Proj:ResultSummary[1]:Enduse6[6]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. (RunResults[6]:StdNatGasEnergy  < 0.00001 .AND. RunResults[6]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[6]:StdNatGasEnergy  + RunResults[6]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse7[6]"			Proj:ResultSummary[1]:Enduse7[6]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. (RunResults[7]:StdNatGasEnergy  < 0.00001 .AND. RunResults[7]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[7]:StdNatGasEnergy  + RunResults[7]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse8[6]"			Proj:ResultSummary[1]:Enduse8[6]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. (RunResults[8]:StdNatGasEnergy  < 0.00001 .AND. RunResults[8]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[8]:StdNatGasEnergy  + RunResults[8]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse9[6]"			Proj:ResultSummary[1]:Enduse9[6]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. (RunResults[9]:StdNatGasEnergy  < 0.00001 .AND. RunResults[9]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[9]:StdNatGasEnergy  + RunResults[9]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse10[6]"			Proj:ResultSummary[1]:Enduse10[6]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. (RunResults[10]:StdNatGasEnergy < 0.00001 .AND. RunResults[10]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[10]:StdNatGasEnergy + RunResults[10]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse11[6]"			Proj:ResultSummary[1]:Enduse11[6]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. (RunResults[11]:StdNatGasEnergy < 0.00001 .AND. RunResults[11]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[11]:StdNatGasEnergy + RunResults[11]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse12[6]"			Proj:ResultSummary[1]:Enduse12[6]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. (RunResults[12]:StdNatGasEnergy < 0.00001 .AND. RunResults[12]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[12]:StdNatGasEnergy + RunResults[12]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }

  ; Standard TDV
	"Set ResultSummary[1]:Title1[7]"				Proj:ResultSummary[1]:Title1[7]		= {	"Standard"  }
	"Set ResultSummary[1]:Title2[7]"				Proj:ResultSummary[1]:Title2[7]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[7]"				Proj:ResultSummary[1]:Title3[7]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[1]:Enduse1[7]"			Proj:ResultSummary[1]:Enduse1[7]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[7]"			Proj:ResultSummary[1]:Enduse2[7]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[7]"			Proj:ResultSummary[1]:Enduse3[7]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[7]"			Proj:ResultSummary[1]:Enduse4[7]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[7]"			Proj:ResultSummary[1]:Enduse5[7]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[7]"			Proj:ResultSummary[1]:Enduse6[7]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[7]"			Proj:ResultSummary[1]:Enduse7[7]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[7]"			Proj:ResultSummary[1]:Enduse8[7]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[7]"			Proj:ResultSummary[1]:Enduse9[7]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:StandardTDV  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[7]"			Proj:ResultSummary[1]:Enduse10[7]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[7]"			Proj:ResultSummary[1]:Enduse11[7]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[7]"			Proj:ResultSummary[1]:Enduse12[7]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:StandardTDV ), 2 )  endif  }
  ; SAC 1/14/13 - added PVCredit stuff
 ; mjb-10/16/13	remove PVCredit from Std Design
;	"Set ResultSummary[1]:Enduse13[7]"			Proj:ResultSummary[1]:Enduse13[7]	= {	FltToStr( PVCredit, 2 )  }
	"Set ResultSummary[1]:Enduse13[7]"			Proj:ResultSummary[1]:Enduse13[7]	= {	" "  }
 ; mjb-10/16/13	subtract PVCredit from Prop Design
	;"Set ResultSummary[1]:Enduse13[4]"			Proj:ResultSummary[1]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
	"Set ResultSummary[1]:Enduse13[4]"			Proj:ResultSummary[1]:Enduse13[4]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResults[6]:PropPVCreditTDV[1] * -1), 2 )  endif  }	; SAC 1/28/16 - leave std PV credit alone
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[1]:Enduse10[4]"			Proj:ResultSummary[1]:Enduse10[4]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:ProposedTDV[1] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse11[4]"			Proj:ResultSummary[1]:Enduse11[4]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:ProposedTDV[1] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse12[4]"			Proj:ResultSummary[1]:Enduse12[4]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[1]:CompResultsMsg"		Proj:ResultSummary[1]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[1]:PVMinRatedPower"		Proj:ResultSummary[1]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[1]:Title1[8]"				Proj:ResultSummary[1]:Title1[8]		= {	"Compliance"  }
	"Set ResultSummary[1]:Title2[8]"				Proj:ResultSummary[1]:Title2[8]		= {	"Margin"  }
	"Set ResultSummary[1]:Title3[8]"				Proj:ResultSummary[1]:Title3[8]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[1]:Enduse1[8]"			Proj:ResultSummary[1]:Enduse1[8]		= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[8]"			Proj:ResultSummary[1]:Enduse2[8]		= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[8]"			Proj:ResultSummary[1]:Enduse3[8]		= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[8]"			Proj:ResultSummary[1]:Enduse4[8]		= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[8]"			Proj:ResultSummary[1]:Enduse5[8]		= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[8]"			Proj:ResultSummary[1]:Enduse6[8]		= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[8]"			Proj:ResultSummary[1]:Enduse7[8]		= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[8]"			Proj:ResultSummary[1]:Enduse8[8]		= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[8]"			Proj:ResultSummary[1]:Enduse9[8]		= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:CompMarginTDV  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[8]"			Proj:ResultSummary[1]:Enduse10[8]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[8]"			Proj:ResultSummary[1]:Enduse11[8]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[8]"			Proj:ResultSummary[1]:Enduse12[8]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:CompMarginTDV ), 2 )  endif  }
  ; SAC 1/14/13 - added PVCredit stuff
 	;"Set ResultSummary[1]:Enduse13[8]"			Proj:ResultSummary[1]:Enduse13[8]	= {	FltToStr( PVCredit[1], 2 )  }
	"Set ResultSummary[1]:Enduse13[8]"			Proj:ResultSummary[1]:Enduse13[8]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[6]:PropPVCreditTDV[1], 2 )  endif  }	; SAC 1/28/16 - leave std PV credit alone

 	"Set ResultSummary[1]:PassFail"				Proj:ResultSummary[1]:PassFail		= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  if (RunResults[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Standard Electric Demand
	"Set ResultSummary[1]:Title1[11]"			Proj:ResultSummary[1]:Title1[11]		= {	"Standard"  }
	"Set ResultSummary[1]:Title2[11]"			Proj:ResultSummary[1]:Title2[11]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[11]"			Proj:ResultSummary[1]:Title3[11]		= {	"(kW)"  }
	"Set ResultSummary[1]:Enduse1[11]"			Proj:ResultSummary[1]:Enduse1[11]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[11]"			Proj:ResultSummary[1]:Enduse2[11]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[11]"			Proj:ResultSummary[1]:Enduse3[11]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[11]"			Proj:ResultSummary[1]:Enduse4[11]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[11]"			Proj:ResultSummary[1]:Enduse5[11]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[11]"			Proj:ResultSummary[1]:Enduse6[11]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[11]"			Proj:ResultSummary[1]:Enduse7[11]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[11]"			Proj:ResultSummary[1]:Enduse8[11]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[11]"			Proj:ResultSummary[1]:Enduse9[11]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:StdElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[11]"			Proj:ResultSummary[1]:Enduse10[11]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[11]"			Proj:ResultSummary[1]:Enduse11[11]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[11]"			Proj:ResultSummary[1]:Enduse12[11]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[11]"			Proj:ResultSummary[1]:Enduse12[11]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:StdElecDemand ), 2 )  endif  }

  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
	"Set ResultSummary[1]:MarginkW"			Proj:ResultSummary[1]:MarginkW		= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResults[10]:PropElecDemand[1], 0 )  endif  }
	"Set ResultSummary[1]:MarginkWh"			Proj:ResultSummary[1]:MarginkWh		= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResults[10]:PropElecEnergy[1], 0 )) * CondFloorArea / 3.413  endif  }
	"Set ResultSummary[1]:MarginTherms"		Proj:ResultSummary[1]:MarginTherms	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
																												else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResults[10]:PropNatGasEnergy[1], 0 )) * CondFloorArea / 100  endif  }
  ; Percent Savings values for reporting
	"Set ResultSummary[1]:PctSavingskW"			Proj:ResultSummary[1]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdElecDemand   - ValidOr( RunResults[10]:PropElecDemand[1],   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
	"Set ResultSummary[1]:PctSavingskWh"		Proj:ResultSummary[1]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResults[10]:PropElecEnergy[1],   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
	"Set ResultSummary[1]:PctSavingsTherms"	Proj:ResultSummary[1]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResults[10]:PropNatGasEnergy[1], 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
	"Set ResultSummary[1]:PctSavingsTDV"		Proj:ResultSummary[1]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StandardTDV     - ValidOr( RunResults[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
	"Set ResultSummary[1]:PctSavingsCmpTDV"	Proj:ResultSummary[1]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[11]:StandardTDV     - ValidOr( RunResults[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
	"Set ResultSummary[1]:PctSavkWLbl"			Proj:ResultSummary[1]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingskW     )  endif  }
	"Set ResultSummary[1]:PctSavkWhLbl"			Proj:ResultSummary[1]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingskWh    )  endif  }
	"Set ResultSummary[1]:PctSavThermsLbl"		Proj:ResultSummary[1]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[1]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsTherms )  endif  }
	"Set ResultSummary[1]:PctSavTDVLbl"			Proj:ResultSummary[1]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[1]:PctSavCmpTDVLbl"		Proj:ResultSummary[1]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsCmpTDV )  endif  }
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[1]:MeetsTier1"			Proj:ResultSummary[1]:MeetsTier1		= {	if (StdDesignBase == 2016 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[1]:MeetsTier2"			Proj:ResultSummary[1]:MeetsTier2		= {	if (StdDesignBase == 2016 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	; SAC 3/25/16 - moved MeetsZNETier rule down into ...DesignRatingSummary rulelist
	;"Set ResultSummary[1]:MeetsZNETier"			Proj:ResultSummary[1]:MeetsZNETier	= {	if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[1]:DesignRating < 0.05 )==0) then  0
	;																												else if (ResultSummary[1]:MeetsTier2 > 0.5) then  1
	;																												else if (ResultSummary[1]:MeetsTier1 > 0.5 .AND. IsMultiFamily < 0.5)
	;																												then  if (CAClimateZoneCodeBase:sfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) < 1.5) then  1  else  0  endif
	;																												else if (ResultSummary[1]:MeetsTier1 > 0.5 .AND. IsMultiFamily > 0.5)
	;																												then  if (CAClimateZoneCodeBase:mfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) < 1.5) then  1  else  0  endif
	;																												else  0  endif endif endif endif  }
END

;*************************************************************************
RULELIST "CARes_DesignRatingSummary" 1 0 1 1
;*************************************************************************
  ; DesignRating Site Electric Use
	"Set ResultSummary[1]:Title1[12]"			Proj:ResultSummary[1]:Title1[12]		= {	"Reference"  }
	"Set ResultSummary[1]:Title2[12]"			Proj:ResultSummary[1]:Title2[12]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[12]"			Proj:ResultSummary[1]:Title3[12]		= {	"Site (kWh)"  }
	"Set ResultSummary[1]:Enduse1[12]"			Proj:ResultSummary[1]:Enduse1[12]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR. RunResults[1]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[1]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse2[12]"			Proj:ResultSummary[1]:Enduse2[12]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR. RunResults[2]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[2]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse3[12]"			Proj:ResultSummary[1]:Enduse3[12]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR. RunResults[3]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[3]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse4[12]"			Proj:ResultSummary[1]:Enduse4[12]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR. RunResults[4]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[4]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse5[12]"			Proj:ResultSummary[1]:Enduse5[12]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR. RunResults[5]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[5]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse6[12]"			Proj:ResultSummary[1]:Enduse6[12]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[6]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse7[12]"			Proj:ResultSummary[1]:Enduse7[12]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR. RunResults[7]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[7]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse8[12]"			Proj:ResultSummary[1]:Enduse8[12]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR. RunResults[8]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[8]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse9[12]"			Proj:ResultSummary[1]:Enduse9[12]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR. RunResults[9]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[9]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse10[12]"			Proj:ResultSummary[1]:Enduse10[12]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. RunResults[10]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[12]"			Proj:ResultSummary[1]:Enduse11[12]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[12]"			Proj:ResultSummary[1]:Enduse12[12]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse13[12]"			Proj:ResultSummary[1]:Enduse13[12]	= {	if (LocalCompAssigned( RunResults[13] ) == 0 .OR. RunResults[13]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[13]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[1]:Enduse10[17]"			Proj:ResultSummary[1]:Enduse10[17]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[17]"			Proj:ResultSummary[1]:Enduse11[17]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:PropElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[17]"			Proj:ResultSummary[1]:Enduse12[17]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:PropElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse13[17]"			Proj:ResultSummary[1]:Enduse13[17]	= {	if (LocalCompAssigned( RunResults[13] ) == 0 .OR. RunResults[13]:PropElecEnergy > 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[13]:PropElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; DesignRating Site Natural Gas Use
	"Set ResultSummary[1]:Title1[13]"			Proj:ResultSummary[1]:Title1[13]		= {	"Reference"  }
	"Set ResultSummary[1]:Title2[13]"			Proj:ResultSummary[1]:Title2[13]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[13]"			Proj:ResultSummary[1]:Title3[13]		= {	"Site (therms)"  }
	"Set ResultSummary[1]:Enduse1[13]"			Proj:ResultSummary[1]:Enduse1[13]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0 .OR.  (RunResults[1]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[1]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[1]:DRtgNatGasEnergy  + RunResults[1]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse2[13]"			Proj:ResultSummary[1]:Enduse2[13]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0 .OR.  (RunResults[2]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[2]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[2]:DRtgNatGasEnergy  + RunResults[2]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse3[13]"			Proj:ResultSummary[1]:Enduse3[13]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0 .OR.  (RunResults[3]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[3]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[3]:DRtgNatGasEnergy  + RunResults[3]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse4[13]"			Proj:ResultSummary[1]:Enduse4[13]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0 .OR.  (RunResults[4]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[4]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[4]:DRtgNatGasEnergy  + RunResults[4]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse5[13]"			Proj:ResultSummary[1]:Enduse5[13]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0 .OR.  (RunResults[5]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[5]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[5]:DRtgNatGasEnergy  + RunResults[5]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse6[13]"			Proj:ResultSummary[1]:Enduse6[13]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR.  (RunResults[6]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[6]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[6]:DRtgNatGasEnergy  + RunResults[6]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse7[13]"			Proj:ResultSummary[1]:Enduse7[13]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0 .OR.  (RunResults[7]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[7]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[7]:DRtgNatGasEnergy  + RunResults[7]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse8[13]"			Proj:ResultSummary[1]:Enduse8[13]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0 .OR.  (RunResults[8]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[8]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[8]:DRtgNatGasEnergy  + RunResults[8]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse9[13]"			Proj:ResultSummary[1]:Enduse9[13]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0 .OR.  (RunResults[9]:DRtgNatGasEnergy  < 0.00001 .AND. RunResults[9]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[9]:DRtgNatGasEnergy  + RunResults[9]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse10[13]"			Proj:ResultSummary[1]:Enduse10[13]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR.  (RunResults[10]:DRtgNatGasEnergy < 0.00001 .AND. RunResults[10]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[10]:DRtgNatGasEnergy + RunResults[10]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse11[13]"			Proj:ResultSummary[1]:Enduse11[13]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR.  (RunResults[11]:DRtgNatGasEnergy < 0.00001 .AND. RunResults[11]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[11]:DRtgNatGasEnergy + RunResults[11]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse12[13]"			Proj:ResultSummary[1]:Enduse12[13]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR.  (RunResults[12]:DRtgNatGasEnergy < 0.00001 .AND. RunResults[12]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[12]:DRtgNatGasEnergy + RunResults[12]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse13[13]"			Proj:ResultSummary[1]:Enduse13[13]	= {	UNDEFINED  }		; PV

  ; DesignRating TDV
	"Set ResultSummary[1]:Title1[14]"			Proj:ResultSummary[1]:Title1[14]		= {	"Reference"  }
	"Set ResultSummary[1]:Title2[14]"			Proj:ResultSummary[1]:Title2[14]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[14]"			Proj:ResultSummary[1]:Title3[14]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[1]:Enduse1[14]"			Proj:ResultSummary[1]:Enduse1[14]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[14]"			Proj:ResultSummary[1]:Enduse2[14]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[14]"			Proj:ResultSummary[1]:Enduse3[14]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[14]"			Proj:ResultSummary[1]:Enduse4[14]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[14]"			Proj:ResultSummary[1]:Enduse5[14]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[14]"			Proj:ResultSummary[1]:Enduse6[14]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[14]"			Proj:ResultSummary[1]:Enduse7[14]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[14]"			Proj:ResultSummary[1]:Enduse8[14]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[14]"			Proj:ResultSummary[1]:Enduse9[14]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:DesignRatingTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[14]"			Proj:ResultSummary[1]:Enduse10[14]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:DesignRatingTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[14]"			Proj:ResultSummary[1]:Enduse11[14]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:DesignRatingTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[14]"			Proj:ResultSummary[1]:Enduse12[14]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:DesignRatingTDV[1] ), 2 )  endif  }
  ; SAC 1/14/13 - added PVCredit stuff
 ; mjb-10/16/13	remove PVCredit from Std Design
;	"Set ResultSummary[1]:Enduse13[14]"			Proj:ResultSummary[1]:Enduse13[14]	= {	FltToStr( PVCredit, 2 )  }
	"Set ResultSummary[1]:Enduse13[14]"			Proj:ResultSummary[1]:Enduse13[14]	= {	" "  }		; still blank out reference PV ??
 ; mjb-10/16/13	subtract PVCredit from Prop Design
;	"Set ResultSummary[1]:Enduse13[19]"			Proj:ResultSummary[1]:Enduse13[19]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResults[6]:PropPVCreditTDV[2] * -1), 2 )  endif  }
  ; SAC 1/28/16 - replaced old DRtg PV w/ new, PVWatts-based PV
	"Set ResultSummary[1]:Enduse13[19]"			Proj:ResultSummary[1]:Enduse13[19]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:ProposedTDV[2] ), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[1]:Enduse10[19]"			Proj:ResultSummary[1]:Enduse10[19]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:ProposedTDV[2] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse11[19]"			Proj:ResultSummary[1]:Enduse11[19]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:ProposedTDV[2] ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse12[19]"			Proj:ResultSummary[1]:Enduse12[19]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Margin TDV
	"Set ResultSummary[1]:Title1[15]"			Proj:ResultSummary[1]:Title1[15]		= {	"Design Rating"  }
	"Set ResultSummary[1]:Title2[15]"			Proj:ResultSummary[1]:Title2[15]		= {	"Margin"  }
	"Set ResultSummary[1]:Title3[15]"			Proj:ResultSummary[1]:Title3[15]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[1]:Enduse1[15]"			Proj:ResultSummary[1]:Enduse1[15]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[1]:DesignRatingTDV[1]  - RunResults[1]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[15]"			Proj:ResultSummary[1]:Enduse2[15]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[2]:DesignRatingTDV[1]  - RunResults[2]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[15]"			Proj:ResultSummary[1]:Enduse3[15]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[3]:DesignRatingTDV[1]  - RunResults[3]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[15]"			Proj:ResultSummary[1]:Enduse4[15]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[4]:DesignRatingTDV[1]  - RunResults[4]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[15]"			Proj:ResultSummary[1]:Enduse5[15]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[5]:DesignRatingTDV[1]  - RunResults[5]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[15]"			Proj:ResultSummary[1]:Enduse6[15]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[6]:DesignRatingTDV[1]  - RunResults[6]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[15]"			Proj:ResultSummary[1]:Enduse7[15]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[7]:DesignRatingTDV[1]  - RunResults[7]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[15]"			Proj:ResultSummary[1]:Enduse8[15]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[8]:DesignRatingTDV[1]  - RunResults[8]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[15]"			Proj:ResultSummary[1]:Enduse9[15]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[9]:DesignRatingTDV[1]  - RunResults[9]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[15]"			Proj:ResultSummary[1]:Enduse10[15]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[10]:DesignRatingTDV[1] - RunResults[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[15]"			Proj:ResultSummary[1]:Enduse11[15]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[11]:DesignRatingTDV[1] - RunResults[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[15]"			Proj:ResultSummary[1]:Enduse12[15]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[12]:DesignRatingTDV[1] - RunResults[12]:ProposedTDV[2] ), 2 )  endif  }
  ; SAC 1/14/13 - added PVCredit stuff
; 	"Set ResultSummary[1]:Enduse13[15]"			Proj:ResultSummary[1]:Enduse13[15]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResults[6]:PropPVCreditTDV[2], 2 )  endif  }
  ; SAC 1/28/16 - replaced old DRtg PV w/ new, PVWatts-based PV
 	"Set ResultSummary[1]:Enduse13[15]"			Proj:ResultSummary[1]:Enduse13[15]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResults[13]:DesignRatingTDV[1] - RunResults[13]:ProposedTDV[2] ), 2 )  endif  }

;	 	"Set ResultSummary[1]:PassFail"				Proj:ResultSummary[1]:PassFail		= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  if (RunResults[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }
 	"Set ResultSummary[1]:DesignRating"			Proj:ResultSummary[1]:DesignRating		= {	if (IfValidAnd( RunResults[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
 																														else   ValidOr( RunResults[10]:ProposedTDV[3], 0 ) * 100 / RunResults[10]:DesignRatingTDV[2]  endif  }
 	"Set ResultSummary[1]:DesignRatingNoPV"	Proj:ResultSummary[1]:DesignRatingNoPV	= {	if (IfValidAnd( RunResults[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
 																														else  (ValidOr( RunResults[10]:ProposedTDV[3], 0 ) + ValidOr( RunResults[6]:PropPVCreditTDV[2], 0 )) * 100 / RunResults[10]:DesignRatingTDV[2]  endif  }
 	"Set ResultSummary[1]:ShowDesignRtgNoPV"	Proj:ResultSummary[1]:ShowDesignRtgNoPV = {	if (ValidOr( RunResults[6]:PropPVCreditTDV[2], 0 ) >= 0.0001) then  1  else  0  endif  }
	; SAC 3/16/16 - added new DesignRatingPVOnly & DesignRatingStd - including detailed calc of DesignRatingStd w/ fuel adjustments to StdTDV results
 	"Set ResultSummary[1]:DesignRatingPVOnly"	Proj:ResultSummary[1]:DesignRatingPVOnly	= {	if (LocalStatus( ResultSummary[1]:DesignRatingNoPV ) < 1 .OR. LocalStatus( ResultSummary[1]:DesignRating ) < 1) then  UNDEFINED
 																															else	ResultSummary[1]:DesignRatingNoPV - ResultSummary[1]:DesignRating  endif  }
 	"Set ResultSummary[1]:DesignRatingStd"		Proj:ResultSummary[1]:DesignRatingStd		= {	if (IfValidAnd( RunResults[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
													else	(	RunResults[1]:StdElecTDV[1] + RunResults[1]:StdNatGasTDV + RunResults[1]:StdOtherTDV +  ; SpcHt
															 +	RunResults[2]:StdElecTDV[1] + RunResults[2]:StdNatGasTDV + RunResults[2]:StdOtherTDV +  ; SpcCl
															 +	RunResults[3]:StdElecTDV[1]    ; IAQVent
															 +	RunResults[4]:StandardTDV[1]   ; OthrHVAC
															 +	RunResults[5]:StdElecTDV[1] + RunResults[5]:StdNatGasTDV + RunResults[5]:StdOtherTDV +  ; WtrHt
															 +	RunResults[6]:StandardTDV[1]   ; InsLtg
															 +	RunResults[7]:StdElecTDV[1] + RunResults[7]:StdNatGasTDV + RunResults[7]:StdOtherTDV +  ; AppCkg
															 +	RunResults[8]:StandardTDV[1]   ; Plugs
															 +	RunResults[9]:StandardTDV[1]   ; Ext
															 +	RunResults[13]:StandardTDV[1] ) ; PV
																	* 100 / RunResults[10]:DesignRatingTDV[2]    endif  }
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
;													else	(	RunResults[1]:StdElecTDV[1] + ((RunResults[1]:StdNatGasTDV + RunResults[1]:StdOtherTDV) *
;																											CAClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; SpcHt
;															 +	RunResults[2]:StdElecTDV[1] + ((RunResults[2]:StdNatGasTDV + RunResults[2]:StdOtherTDV) *
;																											CAClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; SpcCl
;															 +	RunResults[3]:StdElecTDV[1]    ; IAQVent
;															 +	RunResults[4]:StandardTDV[1]   ; OthrHVAC
;															 +	RunResults[5]:StdElecTDV[1] + ((RunResults[5]:StdNatGasTDV + RunResults[5]:StdOtherTDV) *
;																											CAClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; WtrHt
;															 +	RunResults[6]:StandardTDV[1]   ; InsLtg
;															 +	RunResults[7]:StdElecTDV[1] + ((RunResults[7]:StdNatGasTDV + RunResults[7]:StdOtherTDV) *
;																											CAClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; AppCkg
;															 +	RunResults[8]:StandardTDV[1]   ; Plugs
;															 +	RunResults[9]:StandardTDV[1]   ; Ext
;															 +	RunResults[13]:StandardTDV[1] ) ; PV
;																	* 100 / RunResults[10]:DesignRatingTDV    endif  }

;"store BEMProc details"		Proj:Action = {  StoreBEMProc( "ZNE", 0 )  }
;"testing"	Proj:Action	= {	MessageBox( "RunAbbrev = %s  / HERSProj:QII = %g  / ResultSummary[1]:DesignRating = %g  / EDRPVVerified = %g  / ResultSummary[1]:MeetsTier1 = %g  / StdDesignBase = %g",
;											ValidOr( RunAbbrev, "?" ), ValidOr( HERSProj:QII, -9 ), ValidOr( ResultSummary[1]:DesignRating, -9 ), ValidOr( EDRPVVerified, -9 ), ValidOr( ResultSummary[1]:MeetsTier1, -9 ), ValidOr( StdDesignBase, -9 ) )  }

	; SAC 3/25/16 - moved down from Standard results... AND revised MeetsZNETier to require HERSProj:QII & ResultSummary[*]:DesignRating <= 0
	; SAC 5/23/16 - added logic to enforce new requirement of EDRPVVerified (tic #671)
	; SAC 6/28/16 - switched StdDesignBase to CompCodeBase when performing CAClimateZoneCodeBase look-ups, because StdDesignBase is set to the dr (design rating) code base when this rule is evaluated (tic #702) 
	"Set ResultSummary[1]:MeetsZNETier"			Proj:ResultSummary[1]:MeetsZNETier	= {	if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[1]:DesignRating < 0.05 )==0 .OR. IfValidAnd( EDRPVVerified > 0.5 )==0) then  0
																													else if (ResultSummary[1]:MeetsTier2 > 0.5) then  1
																													else if (ResultSummary[1]:MeetsTier1 > 0.5 .AND. IsMultiFamily < 0.5)
																													then  if (CAClimateZoneCodeBase:sfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase ) < 1.5) then  1  else  0  endif
																													else if (ResultSummary[1]:MeetsTier1 > 0.5 .AND. IsMultiFamily > 0.5)
																													then  if (CAClimateZoneCodeBase:mfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", CompCodeBase ) < 1.5) then  1  else  0  endif
																													else  0  endif endif endif endif  }

  ; DesignRating Electric Demand
	"Set ResultSummary[1]:Title1[16]"			Proj:ResultSummary[1]:Title1[16]		= {	"Reference"  }
	"Set ResultSummary[1]:Title2[16]"			Proj:ResultSummary[1]:Title2[16]		= {	"Design"  }
	"Set ResultSummary[1]:Title3[16]"			Proj:ResultSummary[1]:Title3[16]		= {	"(kW)"  }
	"Set ResultSummary[1]:Enduse1[16]"			Proj:ResultSummary[1]:Enduse1[16]	= {	if (LocalCompAssigned( RunResults[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[1]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse2[16]"			Proj:ResultSummary[1]:Enduse2[16]	= {	if (LocalCompAssigned( RunResults[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[2]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse3[16]"			Proj:ResultSummary[1]:Enduse3[16]	= {	if (LocalCompAssigned( RunResults[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[3]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse4[16]"			Proj:ResultSummary[1]:Enduse4[16]	= {	if (LocalCompAssigned( RunResults[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[4]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse5[16]"			Proj:ResultSummary[1]:Enduse5[16]	= {	if (LocalCompAssigned( RunResults[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[5]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse6[16]"			Proj:ResultSummary[1]:Enduse6[16]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse7[16]"			Proj:ResultSummary[1]:Enduse7[16]	= {	if (LocalCompAssigned( RunResults[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[7]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse8[16]"			Proj:ResultSummary[1]:Enduse8[16]	= {	if (LocalCompAssigned( RunResults[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[8]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[1]:Enduse9[16]"			Proj:ResultSummary[1]:Enduse9[16]	= {	if (LocalCompAssigned( RunResults[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[9]:DRtgElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[16]"			Proj:ResultSummary[1]:Enduse10[16]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[16]"			Proj:ResultSummary[1]:Enduse11[16]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[16]"			Proj:ResultSummary[1]:Enduse12[16]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse13[16]"			Proj:ResultSummary[1]:Enduse13[16]	= {	UNDEFINED  }	; PV

; SAC 4/8/15 - refresh lighting and total Proposed results following (possible) resets due to design rating lighting credit reductions
  ; Proposed Site ELEC Use
	"Set ResultSummary[1]:Enduse6[17]"			Proj:ResultSummary[1]:Enduse6[17]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. RunResults[6]:PropElecEnergy[2]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[6]:PropElecEnergy[2]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse10[17]"			Proj:ResultSummary[1]:Enduse10[17]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[10]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse11[17]"			Proj:ResultSummary[1]:Enduse11[17]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. RunResults[11]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[11]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse12[17]"			Proj:ResultSummary[1]:Enduse12[17]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. RunResults[12]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[12]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[1]:Enduse13[17]"			Proj:ResultSummary[1]:Enduse13[17]	= {	if (LocalCompAssigned( RunResults[13] ) == 0 .OR. RunResults[13]:PropElecEnergy[2] > 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResults[13]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; Proposed Site FUEL Use
	"Set ResultSummary[1]:Enduse6[18]"			Proj:ResultSummary[1]:Enduse6[18]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0 .OR. (RunResults[6]:PropNatGasEnergy[2]  < 0.00001 .AND. RunResults[6]:PropOtherEnergy[2]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[6]:PropNatGasEnergy[2]  + RunResults[6]:PropOtherEnergy[2] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse10[18]"			Proj:ResultSummary[1]:Enduse10[18]	= {	if (LocalCompAssigned( RunResults[10] ) == 0 .OR. (RunResults[10]:PropNatGasEnergy[2] < 0.00001 .AND. RunResults[10]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[10]:PropNatGasEnergy[2] + RunResults[10]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse11[18]"			Proj:ResultSummary[1]:Enduse11[18]	= {	if (LocalCompAssigned( RunResults[11] ) == 0 .OR. (RunResults[11]:PropNatGasEnergy[2] < 0.00001 .AND. RunResults[11]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[11]:PropNatGasEnergy[2] + RunResults[11]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse12[18]"			Proj:ResultSummary[1]:Enduse12[18]	= {	if (LocalCompAssigned( RunResults[12] ) == 0 .OR. (RunResults[12]:PropNatGasEnergy[2] < 0.00001 .AND. RunResults[12]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResults[12]:PropNatGasEnergy[2] + RunResults[12]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[1]:Enduse13[18]"			Proj:ResultSummary[1]:Enduse13[18]	= {	UNDEFINED  }  ; PV
  ; Proposed TDV
	"Set ResultSummary[1]:Enduse6[19]"			Proj:ResultSummary[1]:Enduse6[19]	= {	if (LocalCompAssigned( RunResults[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[6]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse10[19]"			Proj:ResultSummary[1]:Enduse10[19]	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse11[19]"			Proj:ResultSummary[1]:Enduse11[19]	= {	if (LocalCompAssigned( RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse12[19]"			Proj:ResultSummary[1]:Enduse12[19]	= {	if (LocalCompAssigned( RunResults[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[12]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[1]:Enduse13[19]"			Proj:ResultSummary[1]:Enduse13[19]	= {	if (LocalCompAssigned( RunResults[13] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResults[13]:ProposedTDV[2] ), 2 )  endif  }

;	  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
;		"Set ResultSummary[1]:MarginkW"			Proj:ResultSummary[1]:MarginkW		= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
;																													else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResults[10]:PropElecDemand, 0 )  endif  }
;		"Set ResultSummary[1]:MarginkWh"			Proj:ResultSummary[1]:MarginkWh		= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResults[10]:PropElecEnergy, 0 )) * CondFloorArea / 3.413  endif  }
;		"Set ResultSummary[1]:MarginTherms"		Proj:ResultSummary[1]:MarginTherms	= {	if (LocalCompAssigned( RunResults[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResults[10]:PropNatGasEnergy, 0 )) * CondFloorArea / 100  endif  }
;	  ; Percent Savings values for reporting
;		"Set ResultSummary[1]:PctSavingskW"			Proj:ResultSummary[1]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecDemand   - ValidOr( RunResults[10]:PropElecDemand,   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
;		"Set ResultSummary[1]:PctSavingskWh"		Proj:ResultSummary[1]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResults[10]:PropElecEnergy,   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
;		"Set ResultSummary[1]:PctSavingsTherms"	Proj:ResultSummary[1]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResults[10]:PropNatGasEnergy, 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
;		"Set ResultSummary[1]:PctSavingsTDV"		Proj:ResultSummary[1]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StandardTDV     - ValidOr( RunResults[10]:ProposedTDV,      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
;		"Set ResultSummary[1]:PctSavingsCmpTDV"	Proj:ResultSummary[1]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[11]:StandardTDV     - ValidOr( RunResults[11]:ProposedTDV,      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
;		"Set ResultSummary[1]:PctSavkWLbl"			Proj:ResultSummary[1]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingskW     )  endif  }
;		"Set ResultSummary[1]:PctSavkWhLbl"			Proj:ResultSummary[1]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingskWh    )  endif  }
;		"Set ResultSummary[1]:PctSavThermsLbl"		Proj:ResultSummary[1]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[1]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsTherms )  endif  }
;		"Set ResultSummary[1]:PctSavTDVLbl"			Proj:ResultSummary[1]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[1]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsTDV    )  endif  }
;		"Set ResultSummary[1]:PctSavCmpTDVLbl"		Proj:ResultSummary[1]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[1]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[1]:PctSavingsCmpTDV )  endif  }
                          
END


;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_ProposedSummary_N" 1 0 1 1
;*************************************************************************
	"Blast all EUseSummary components if this is the first run of an analysis"	Proj:Action	= {	DeleteAllComps( EUseSummary )  }		; only for FIRST (North) run

	"Create 'Worst Case'energy use summary component"			Proj:ResultSummary[1]			= {	CreateComp( EUseSummary, "Worst Case" )  }
	"Set parent for energy use summary"								Proj:ResultSummary[1]:Parent	= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"					Proj:ResultSummary[1]:ProjAssignFirst	= {	1  }		; SAC 3/3/16 - tic #609

	"Create 'North Facing' energy use summary component"		Proj:ResultSummary[2]			= {	CreateComp( EUseSummary, "North Facing" )  }
	"Set parent for energy use summary"								Proj:ResultSummary[2]:Parent	= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"					Proj:ResultSummary[2]:ProjAssignFirst	= {	0  }		; SAC 3/3/16 - tic #609

	"Set ResultSummary[2]:Title3[1]"				Proj:ResultSummary[2]:Title3[1]		= {	"End Use"  }

	"Set ResultSummary[2]:Enduse1[1]"			Proj:ResultSummary[2]:Enduse1[1]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[1]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse2[1]"			Proj:ResultSummary[2]:Enduse2[1]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[2]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse3[1]"			Proj:ResultSummary[2]:Enduse3[1]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[3]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse4[1]"			Proj:ResultSummary[2]:Enduse4[1]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[4]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse5[1]"			Proj:ResultSummary[2]:Enduse5[1]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[5]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse6[1]"			Proj:ResultSummary[2]:Enduse6[1]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[6]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse7[1]"			Proj:ResultSummary[2]:Enduse7[1]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[7]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse8[1]"			Proj:ResultSummary[2]:Enduse8[1]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[8]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse9[1]"			Proj:ResultSummary[2]:Enduse9[1]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[9]:EnduseName  )  endif  }
	"Set ResultSummary[2]:Enduse10[1]"			Proj:ResultSummary[2]:Enduse10[1]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[10]:EnduseName )  endif  }
	"Set ResultSummary[2]:Enduse11[1]"			Proj:ResultSummary[2]:Enduse11[1]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[11]:EnduseName )  endif  }
	"Set ResultSummary[2]:Enduse12[1]"			Proj:ResultSummary[2]:Enduse12[1]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[12]:EnduseName )  endif  }
 	"Set ResultSummary[2]:Enduse13[1]"			Proj:ResultSummary[2]:Enduse13[1]	= {	if (LocalCompAssigned( RunResultsN[13] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsN[13]:EnduseName )  endif  }

  ; Proposed Site Electric Use
	"Set ResultSummary[2]:Title1[2]"				Proj:ResultSummary[2]:Title1[2]		= {	"Proposed"  }
	"Set ResultSummary[2]:Title2[2]"				Proj:ResultSummary[2]:Title2[2]		= {	"Design"  }
	"Set ResultSummary[2]:Title3[2]"				Proj:ResultSummary[2]:Title3[2]		= {	"Site (kWh)"  }
	"Set ResultSummary[2]:Enduse1[2]"			Proj:ResultSummary[2]:Enduse1[2]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR. RunResultsN[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse2[2]"			Proj:ResultSummary[2]:Enduse2[2]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR. RunResultsN[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse3[2]"			Proj:ResultSummary[2]:Enduse3[2]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR. RunResultsN[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse4[2]"			Proj:ResultSummary[2]:Enduse4[2]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR. RunResultsN[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse5[2]"			Proj:ResultSummary[2]:Enduse5[2]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR. RunResultsN[5]:PropElecEnergy[1]  < 0.00001) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr(       (int( (RunResultsN[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse6[2]"			Proj:ResultSummary[2]:Enduse6[2]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. RunResultsN[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse7[2]"			Proj:ResultSummary[2]:Enduse7[2]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR. RunResultsN[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse8[2]"			Proj:ResultSummary[2]:Enduse8[2]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR. RunResultsN[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse9[2]"			Proj:ResultSummary[2]:Enduse9[2]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR. RunResultsN[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse10[2]"			Proj:ResultSummary[2]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. RunResultsN[10]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse11[2]"			Proj:ResultSummary[2]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. RunResultsN[11]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse12[2]"			Proj:ResultSummary[2]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. RunResultsN[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[2]:Title1[3]"				Proj:ResultSummary[2]:Title1[3]		= {	"Proposed"  }
	"Set ResultSummary[2]:Title2[3]"				Proj:ResultSummary[2]:Title2[3]		= {	"Design"  }
	"Set ResultSummary[2]:Title3[3]"				Proj:ResultSummary[2]:Title3[3]		= {	"Site (therms)"  }
	"Set ResultSummary[2]:Enduse1[3]"			Proj:ResultSummary[2]:Enduse1[3]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR.  (RunResultsN[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[1]:PropNatGasEnergy[1]  + RunResultsN[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse2[3]"			Proj:ResultSummary[2]:Enduse2[3]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR.  (RunResultsN[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[2]:PropNatGasEnergy[1]  + RunResultsN[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse3[3]"			Proj:ResultSummary[2]:Enduse3[3]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR.  (RunResultsN[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[3]:PropNatGasEnergy[1]  + RunResultsN[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse4[3]"			Proj:ResultSummary[2]:Enduse4[3]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR.  (RunResultsN[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[4]:PropNatGasEnergy[1]  + RunResultsN[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse5[3]"			Proj:ResultSummary[2]:Enduse5[3]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR.  (RunResultsN[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResultsN[5]:PropNatGasEnergy[1]  + RunResultsN[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse6[3]"			Proj:ResultSummary[2]:Enduse6[3]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR.  (RunResultsN[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[6]:PropNatGasEnergy[1]  + RunResultsN[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse7[3]"			Proj:ResultSummary[2]:Enduse7[3]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR.  (RunResultsN[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[7]:PropNatGasEnergy[1]  + RunResultsN[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse8[3]"			Proj:ResultSummary[2]:Enduse8[3]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR.  (RunResultsN[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[8]:PropNatGasEnergy[1]  + RunResultsN[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse9[3]"			Proj:ResultSummary[2]:Enduse9[3]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR.  (RunResultsN[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsN[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[9]:PropNatGasEnergy[1]  + RunResultsN[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse10[3]"			Proj:ResultSummary[2]:Enduse10[3]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR.  (RunResultsN[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsN[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[10]:PropNatGasEnergy[1] + RunResultsN[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse11[3]"			Proj:ResultSummary[2]:Enduse11[3]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR.  (RunResultsN[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsN[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[11]:PropNatGasEnergy[1] + RunResultsN[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse12[3]"			Proj:ResultSummary[2]:Enduse12[3]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR.  (RunResultsN[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsN[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[12]:PropNatGasEnergy[1] + RunResultsN[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }

  ; Proposed TDV
	"Set ResultSummary[2]:Title1[4]"				Proj:ResultSummary[2]:Title1[4]		= {	"Proposed"  }
	"Set ResultSummary[2]:Title2[4]"				Proj:ResultSummary[2]:Title2[4]		= {	"Design"  }
	"Set ResultSummary[2]:Title3[4]"				Proj:ResultSummary[2]:Title3[4]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[2]:Enduse1[4]"			Proj:ResultSummary[2]:Enduse1[4]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[4]"			Proj:ResultSummary[2]:Enduse2[4]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[4]"			Proj:ResultSummary[2]:Enduse3[4]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[4]"			Proj:ResultSummary[2]:Enduse4[4]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[4]"			Proj:ResultSummary[2]:Enduse5[4]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[4]"			Proj:ResultSummary[2]:Enduse6[4]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[4]"			Proj:ResultSummary[2]:Enduse7[4]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[4]"			Proj:ResultSummary[2]:Enduse8[4]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[4]"			Proj:ResultSummary[2]:Enduse9[4]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:ProposedTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[4]"			Proj:ResultSummary[2]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[4]"			Proj:ResultSummary[2]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[4]"			Proj:ResultSummary[2]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:ProposedTDV[1] ), 2 )  endif  }

  ; Proposed Electric Demand
	"Set ResultSummary[2]:Title1[10]"			Proj:ResultSummary[2]:Title1[10]		= {	"Proposed"  }
	"Set ResultSummary[2]:Title2[10]"			Proj:ResultSummary[2]:Title2[10]		= {	"Design"  }
	"Set ResultSummary[2]:Title3[10]"			Proj:ResultSummary[2]:Title3[10]		= {	"(kW)"  }
	"Set ResultSummary[2]:Enduse1[10]"			Proj:ResultSummary[2]:Enduse1[10]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[10]"			Proj:ResultSummary[2]:Enduse2[10]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[10]"			Proj:ResultSummary[2]:Enduse3[10]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[10]"			Proj:ResultSummary[2]:Enduse4[10]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[10]"			Proj:ResultSummary[2]:Enduse5[10]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[10]"			Proj:ResultSummary[2]:Enduse6[10]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[10]"			Proj:ResultSummary[2]:Enduse7[10]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[10]"			Proj:ResultSummary[2]:Enduse8[10]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[10]"			Proj:ResultSummary[2]:Enduse9[10]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:PropElecDemand[1]  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[10]"			Proj:ResultSummary[2]:Enduse10[10]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[10]"			Proj:ResultSummary[2]:Enduse11[10]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[10]"			Proj:ResultSummary[2]:Enduse12[10]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:PropElecDemand[1] ), 2 )  endif  }
END

;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_ProposedSummary_E" 1 0 1 1
;*************************************************************************
	"Create 'East Facing' energy use summary component"		Proj:ResultSummary[3]			= {	CreateComp( EUseSummary, "East Facing" )  }
	"Set parent for energy use summary"								Proj:ResultSummary[3]:Parent	= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"					Proj:ResultSummary[3]:ProjAssignFirst	= {	0  }		; SAC 3/3/16 - tic #609

	"Set ResultSummary[3]:Title3[1]"				Proj:ResultSummary[3]:Title3[1]		= {	"End Use"  }

	"Set ResultSummary[3]:Enduse1[1]"			Proj:ResultSummary[3]:Enduse1[1]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[1]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse2[1]"			Proj:ResultSummary[3]:Enduse2[1]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[2]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse3[1]"			Proj:ResultSummary[3]:Enduse3[1]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[3]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse4[1]"			Proj:ResultSummary[3]:Enduse4[1]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[4]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse5[1]"			Proj:ResultSummary[3]:Enduse5[1]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[5]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse6[1]"			Proj:ResultSummary[3]:Enduse6[1]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[6]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse7[1]"			Proj:ResultSummary[3]:Enduse7[1]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[7]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse8[1]"			Proj:ResultSummary[3]:Enduse8[1]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[8]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse9[1]"			Proj:ResultSummary[3]:Enduse9[1]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[9]:EnduseName  )  endif  }
	"Set ResultSummary[3]:Enduse10[1]"			Proj:ResultSummary[3]:Enduse10[1]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[10]:EnduseName )  endif  }
	"Set ResultSummary[3]:Enduse11[1]"			Proj:ResultSummary[3]:Enduse11[1]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[11]:EnduseName )  endif  }
	"Set ResultSummary[3]:Enduse12[1]"			Proj:ResultSummary[3]:Enduse12[1]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[12]:EnduseName )  endif  }
 	"Set ResultSummary[3]:Enduse13[1]"			Proj:ResultSummary[3]:Enduse13[1]	= {	if (LocalCompAssigned( RunResultsE[13] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsE[13]:EnduseName )  endif  }

  ; Proposed Site Electric Use
	"Set ResultSummary[3]:Title1[2]"				Proj:ResultSummary[3]:Title1[2]		= {	"Proposed"  }
	"Set ResultSummary[3]:Title2[2]"				Proj:ResultSummary[3]:Title2[2]		= {	"Design"  }
	"Set ResultSummary[3]:Title3[2]"				Proj:ResultSummary[3]:Title3[2]		= {	"Site (kWh)"  }
	"Set ResultSummary[3]:Enduse1[2]"			Proj:ResultSummary[3]:Enduse1[2]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR. RunResultsE[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse2[2]"			Proj:ResultSummary[3]:Enduse2[2]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR. RunResultsE[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse3[2]"			Proj:ResultSummary[3]:Enduse3[2]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR. RunResultsE[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse4[2]"			Proj:ResultSummary[3]:Enduse4[2]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR. RunResultsE[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse5[2]"			Proj:ResultSummary[3]:Enduse5[2]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR. RunResultsE[5]:PropElecEnergy[1]  < 0.00001) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr(       (int( (RunResultsE[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse6[2]"			Proj:ResultSummary[3]:Enduse6[2]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. RunResultsE[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse7[2]"			Proj:ResultSummary[3]:Enduse7[2]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR. RunResultsE[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse8[2]"			Proj:ResultSummary[3]:Enduse8[2]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR. RunResultsE[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse9[2]"			Proj:ResultSummary[3]:Enduse9[2]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR. RunResultsE[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse10[2]"			Proj:ResultSummary[3]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. RunResultsE[10]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse11[2]"			Proj:ResultSummary[3]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. RunResultsE[11]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse12[2]"			Proj:ResultSummary[3]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. RunResultsE[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[3]:Title1[3]"				Proj:ResultSummary[3]:Title1[3]		= {	"Proposed"  }
	"Set ResultSummary[3]:Title2[3]"				Proj:ResultSummary[3]:Title2[3]		= {	"Design"  }
	"Set ResultSummary[3]:Title3[3]"				Proj:ResultSummary[3]:Title3[3]		= {	"Site (therms)"  }
	"Set ResultSummary[3]:Enduse1[3]"			Proj:ResultSummary[3]:Enduse1[3]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR.  (RunResultsE[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[1]:PropNatGasEnergy[1]  + RunResultsE[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse2[3]"			Proj:ResultSummary[3]:Enduse2[3]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR.  (RunResultsE[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[2]:PropNatGasEnergy[1]  + RunResultsE[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse3[3]"			Proj:ResultSummary[3]:Enduse3[3]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR.  (RunResultsE[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[3]:PropNatGasEnergy[1]  + RunResultsE[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse4[3]"			Proj:ResultSummary[3]:Enduse4[3]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR.  (RunResultsE[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[4]:PropNatGasEnergy[1]  + RunResultsE[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse5[3]"			Proj:ResultSummary[3]:Enduse5[3]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR.  (RunResultsE[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResultsE[5]:PropNatGasEnergy[1]  + RunResultsE[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse6[3]"			Proj:ResultSummary[3]:Enduse6[3]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR.  (RunResultsE[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[6]:PropNatGasEnergy[1]  + RunResultsE[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse7[3]"			Proj:ResultSummary[3]:Enduse7[3]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR.  (RunResultsE[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[7]:PropNatGasEnergy[1]  + RunResultsE[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse8[3]"			Proj:ResultSummary[3]:Enduse8[3]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR.  (RunResultsE[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[8]:PropNatGasEnergy[1]  + RunResultsE[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse9[3]"			Proj:ResultSummary[3]:Enduse9[3]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR.  (RunResultsE[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsE[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[9]:PropNatGasEnergy[1]  + RunResultsE[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse10[3]"			Proj:ResultSummary[3]:Enduse10[3]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR.  (RunResultsE[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsE[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[10]:PropNatGasEnergy[1] + RunResultsE[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse11[3]"			Proj:ResultSummary[3]:Enduse11[3]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR.  (RunResultsE[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsE[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[11]:PropNatGasEnergy[1] + RunResultsE[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse12[3]"			Proj:ResultSummary[3]:Enduse12[3]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR.  (RunResultsE[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsE[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[12]:PropNatGasEnergy[1] + RunResultsE[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }

  ; Proposed TDV
	"Set ResultSummary[3]:Title1[4]"				Proj:ResultSummary[3]:Title1[4]		= {	"Proposed"  }
	"Set ResultSummary[3]:Title2[4]"				Proj:ResultSummary[3]:Title2[4]		= {	"Design"  }
	"Set ResultSummary[3]:Title3[4]"				Proj:ResultSummary[3]:Title3[4]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[3]:Enduse1[4]"			Proj:ResultSummary[3]:Enduse1[4]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[4]"			Proj:ResultSummary[3]:Enduse2[4]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[4]"			Proj:ResultSummary[3]:Enduse3[4]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[4]"			Proj:ResultSummary[3]:Enduse4[4]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[4]"			Proj:ResultSummary[3]:Enduse5[4]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[4]"			Proj:ResultSummary[3]:Enduse6[4]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[4]"			Proj:ResultSummary[3]:Enduse7[4]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[4]"			Proj:ResultSummary[3]:Enduse8[4]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[4]"			Proj:ResultSummary[3]:Enduse9[4]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:ProposedTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[4]"			Proj:ResultSummary[3]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[4]"			Proj:ResultSummary[3]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[4]"			Proj:ResultSummary[3]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:ProposedTDV[1] ), 2 )  endif  }

  ; Proposed Electric Demand
	"Set ResultSummary[3]:Title1[10]"			Proj:ResultSummary[3]:Title1[10]		= {	"Proposed"  }
	"Set ResultSummary[3]:Title2[10]"			Proj:ResultSummary[3]:Title2[10]		= {	"Design"  }
	"Set ResultSummary[3]:Title3[10]"			Proj:ResultSummary[3]:Title3[10]		= {	"(kW)"  }
	"Set ResultSummary[3]:Enduse1[10]"			Proj:ResultSummary[3]:Enduse1[10]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[10]"			Proj:ResultSummary[3]:Enduse2[10]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[10]"			Proj:ResultSummary[3]:Enduse3[10]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[10]"			Proj:ResultSummary[3]:Enduse4[10]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[10]"			Proj:ResultSummary[3]:Enduse5[10]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[10]"			Proj:ResultSummary[3]:Enduse6[10]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[10]"			Proj:ResultSummary[3]:Enduse7[10]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[10]"			Proj:ResultSummary[3]:Enduse8[10]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[10]"			Proj:ResultSummary[3]:Enduse9[10]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:PropElecDemand[1]  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[10]"			Proj:ResultSummary[3]:Enduse10[10]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[10]"			Proj:ResultSummary[3]:Enduse11[10]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[10]"			Proj:ResultSummary[3]:Enduse12[10]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:PropElecDemand[1] ), 2 )  endif  }
END

;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_ProposedSummary_S" 1 0 1 1
;*************************************************************************
	"Create 'South Facing' energy use summary component"		Proj:ResultSummary[4]			= {	CreateComp( EUseSummary, "South Facing" )  }
	"Set parent for energy use summary"								Proj:ResultSummary[4]:Parent	= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"					Proj:ResultSummary[4]:ProjAssignFirst	= {	0  }		; SAC 3/3/16 - tic #609

	"Set ResultSummary[4]:Title3[1]"				Proj:ResultSummary[4]:Title3[1]		= {	"End Use"  }

	"Set ResultSummary[4]:Enduse1[1]"			Proj:ResultSummary[4]:Enduse1[1]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[1]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse2[1]"			Proj:ResultSummary[4]:Enduse2[1]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[2]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse3[1]"			Proj:ResultSummary[4]:Enduse3[1]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[3]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse4[1]"			Proj:ResultSummary[4]:Enduse4[1]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[4]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse5[1]"			Proj:ResultSummary[4]:Enduse5[1]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[5]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse6[1]"			Proj:ResultSummary[4]:Enduse6[1]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[6]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse7[1]"			Proj:ResultSummary[4]:Enduse7[1]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[7]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse8[1]"			Proj:ResultSummary[4]:Enduse8[1]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[8]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse9[1]"			Proj:ResultSummary[4]:Enduse9[1]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[9]:EnduseName  )  endif  }
	"Set ResultSummary[4]:Enduse10[1]"			Proj:ResultSummary[4]:Enduse10[1]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[10]:EnduseName )  endif  }
	"Set ResultSummary[4]:Enduse11[1]"			Proj:ResultSummary[4]:Enduse11[1]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[11]:EnduseName )  endif  }
	"Set ResultSummary[4]:Enduse12[1]"			Proj:ResultSummary[4]:Enduse12[1]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[12]:EnduseName )  endif  }
 	"Set ResultSummary[4]:Enduse13[1]"			Proj:ResultSummary[4]:Enduse13[1]	= {	if (LocalCompAssigned( RunResultsS[13] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsS[13]:EnduseName )  endif  }

  ; Proposed Site Electric Use
	"Set ResultSummary[4]:Title1[2]"				Proj:ResultSummary[4]:Title1[2]		= {	"Proposed"  }
	"Set ResultSummary[4]:Title2[2]"				Proj:ResultSummary[4]:Title2[2]		= {	"Design"  }
	"Set ResultSummary[4]:Title3[2]"				Proj:ResultSummary[4]:Title3[2]		= {	"Site (kWh)"  }
	"Set ResultSummary[4]:Enduse1[2]"			Proj:ResultSummary[4]:Enduse1[2]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR. RunResultsS[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse2[2]"			Proj:ResultSummary[4]:Enduse2[2]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR. RunResultsS[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse3[2]"			Proj:ResultSummary[4]:Enduse3[2]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR. RunResultsS[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse4[2]"			Proj:ResultSummary[4]:Enduse4[2]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR. RunResultsS[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse5[2]"			Proj:ResultSummary[4]:Enduse5[2]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR. RunResultsS[5]:PropElecEnergy[1]  < 0.00001) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr(       (int( (RunResultsS[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse6[2]"			Proj:ResultSummary[4]:Enduse6[2]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. RunResultsS[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse7[2]"			Proj:ResultSummary[4]:Enduse7[2]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR. RunResultsS[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse8[2]"			Proj:ResultSummary[4]:Enduse8[2]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR. RunResultsS[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse9[2]"			Proj:ResultSummary[4]:Enduse9[2]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR. RunResultsS[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse10[2]"			Proj:ResultSummary[4]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. RunResultsS[10]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse11[2]"			Proj:ResultSummary[4]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. RunResultsS[11]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse12[2]"			Proj:ResultSummary[4]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. RunResultsS[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[4]:Title1[3]"				Proj:ResultSummary[4]:Title1[3]		= {	"Proposed"  }
	"Set ResultSummary[4]:Title2[3]"				Proj:ResultSummary[4]:Title2[3]		= {	"Design"  }
	"Set ResultSummary[4]:Title3[3]"				Proj:ResultSummary[4]:Title3[3]		= {	"Site (therms)"  }
	"Set ResultSummary[4]:Enduse1[3]"			Proj:ResultSummary[4]:Enduse1[3]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR.  (RunResultsS[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[1]:PropNatGasEnergy[1]  + RunResultsS[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse2[3]"			Proj:ResultSummary[4]:Enduse2[3]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR.  (RunResultsS[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[2]:PropNatGasEnergy[1]  + RunResultsS[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse3[3]"			Proj:ResultSummary[4]:Enduse3[3]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR.  (RunResultsS[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[3]:PropNatGasEnergy[1]  + RunResultsS[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse4[3]"			Proj:ResultSummary[4]:Enduse4[3]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR.  (RunResultsS[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[4]:PropNatGasEnergy[1]  + RunResultsS[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse5[3]"			Proj:ResultSummary[4]:Enduse5[3]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR.  (RunResultsS[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResultsS[5]:PropNatGasEnergy[1]  + RunResultsS[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse6[3]"			Proj:ResultSummary[4]:Enduse6[3]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR.  (RunResultsS[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[6]:PropNatGasEnergy[1]  + RunResultsS[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse7[3]"			Proj:ResultSummary[4]:Enduse7[3]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR.  (RunResultsS[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[7]:PropNatGasEnergy[1]  + RunResultsS[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse8[3]"			Proj:ResultSummary[4]:Enduse8[3]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR.  (RunResultsS[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[8]:PropNatGasEnergy[1]  + RunResultsS[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse9[3]"			Proj:ResultSummary[4]:Enduse9[3]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR.  (RunResultsS[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsS[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[9]:PropNatGasEnergy[1]  + RunResultsS[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse10[3]"			Proj:ResultSummary[4]:Enduse10[3]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR.  (RunResultsS[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsS[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[10]:PropNatGasEnergy[1] + RunResultsS[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse11[3]"			Proj:ResultSummary[4]:Enduse11[3]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR.  (RunResultsS[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsS[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[11]:PropNatGasEnergy[1] + RunResultsS[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse12[3]"			Proj:ResultSummary[4]:Enduse12[3]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR.  (RunResultsS[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsS[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[12]:PropNatGasEnergy[1] + RunResultsS[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }

  ; Proposed TDV
	"Set ResultSummary[4]:Title1[4]"				Proj:ResultSummary[4]:Title1[4]		= {	"Proposed"  }
	"Set ResultSummary[4]:Title2[4]"				Proj:ResultSummary[4]:Title2[4]		= {	"Design"  }
	"Set ResultSummary[4]:Title3[4]"				Proj:ResultSummary[4]:Title3[4]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[4]:Enduse1[4]"			Proj:ResultSummary[4]:Enduse1[4]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[4]"			Proj:ResultSummary[4]:Enduse2[4]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[4]"			Proj:ResultSummary[4]:Enduse3[4]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[4]"			Proj:ResultSummary[4]:Enduse4[4]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[4]"			Proj:ResultSummary[4]:Enduse5[4]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[4]"			Proj:ResultSummary[4]:Enduse6[4]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[4]"			Proj:ResultSummary[4]:Enduse7[4]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[4]"			Proj:ResultSummary[4]:Enduse8[4]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[4]"			Proj:ResultSummary[4]:Enduse9[4]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:ProposedTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[4]"			Proj:ResultSummary[4]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[4]"			Proj:ResultSummary[4]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[4]"			Proj:ResultSummary[4]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:ProposedTDV[1] ), 2 )  endif  }

  ; Proposed Electric Demand
	"Set ResultSummary[4]:Title1[10]"			Proj:ResultSummary[4]:Title1[10]		= {	"Proposed"  }
	"Set ResultSummary[4]:Title2[10]"			Proj:ResultSummary[4]:Title2[10]		= {	"Design"  }
	"Set ResultSummary[4]:Title3[10]"			Proj:ResultSummary[4]:Title3[10]		= {	"(kW)"  }
	"Set ResultSummary[4]:Enduse1[10]"			Proj:ResultSummary[4]:Enduse1[10]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[10]"			Proj:ResultSummary[4]:Enduse2[10]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[10]"			Proj:ResultSummary[4]:Enduse3[10]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[10]"			Proj:ResultSummary[4]:Enduse4[10]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[10]"			Proj:ResultSummary[4]:Enduse5[10]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[10]"			Proj:ResultSummary[4]:Enduse6[10]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[10]"			Proj:ResultSummary[4]:Enduse7[10]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[10]"			Proj:ResultSummary[4]:Enduse8[10]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[10]"			Proj:ResultSummary[4]:Enduse9[10]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:PropElecDemand[1]  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[10]"			Proj:ResultSummary[4]:Enduse10[10]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[10]"			Proj:ResultSummary[4]:Enduse11[10]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[10]"			Proj:ResultSummary[4]:Enduse12[10]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:PropElecDemand[1] ), 2 )  endif  }
END

;*************************************************************************   - SAC 6/25/13
RULELIST "CARes_ProposedSummary_W" 1 0 1 1
;*************************************************************************
	"Create 'West Facing' energy use summary component"		Proj:ResultSummary[5]			= {	CreateComp( EUseSummary, "West Facing" )  }
	"Set parent for energy use summary"								Proj:ResultSummary[5]:Parent	= {	Local( Name )  }
	"Set ProjAssignFirst for energy use summary"					Proj:ResultSummary[5]:ProjAssignFirst	= {	0  }		; SAC 3/3/16 - tic #609

	"Set ResultSummary[5]:Title3[1]"				Proj:ResultSummary[5]:Title3[1]		= {	"End Use"  }

	"Set ResultSummary[5]:Enduse1[1]"			Proj:ResultSummary[5]:Enduse1[1]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[1]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse2[1]"			Proj:ResultSummary[5]:Enduse2[1]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[2]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse3[1]"			Proj:ResultSummary[5]:Enduse3[1]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[3]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse4[1]"			Proj:ResultSummary[5]:Enduse4[1]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[4]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse5[1]"			Proj:ResultSummary[5]:Enduse5[1]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[5]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse6[1]"			Proj:ResultSummary[5]:Enduse6[1]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[6]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse7[1]"			Proj:ResultSummary[5]:Enduse7[1]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[7]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse8[1]"			Proj:ResultSummary[5]:Enduse8[1]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[8]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse9[1]"			Proj:ResultSummary[5]:Enduse9[1]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[9]:EnduseName  )  endif  }
	"Set ResultSummary[5]:Enduse10[1]"			Proj:ResultSummary[5]:Enduse10[1]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[10]:EnduseName )  endif  }
	"Set ResultSummary[5]:Enduse11[1]"			Proj:ResultSummary[5]:Enduse11[1]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[11]:EnduseName )  endif  }
	"Set ResultSummary[5]:Enduse12[1]"			Proj:ResultSummary[5]:Enduse12[1]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[12]:EnduseName )  endif  }
 	"Set ResultSummary[5]:Enduse13[1]"			Proj:ResultSummary[5]:Enduse13[1]	= {	if (LocalCompAssigned( RunResultsW[13] ) == 0) then  UNDEFINED  else  LocalRef( RunResultsW[13]:EnduseName )  endif  }

  ; Proposed Site Electric Use
	"Set ResultSummary[5]:Title1[2]"				Proj:ResultSummary[5]:Title1[2]		= {	"Proposed"  }
	"Set ResultSummary[5]:Title2[2]"				Proj:ResultSummary[5]:Title2[2]		= {	"Design"  }
	"Set ResultSummary[5]:Title3[2]"				Proj:ResultSummary[5]:Title3[2]		= {	"Site (kWh)"  }
	"Set ResultSummary[5]:Enduse1[2]"			Proj:ResultSummary[5]:Enduse1[2]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR. RunResultsW[1]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[1]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse2[2]"			Proj:ResultSummary[5]:Enduse2[2]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR. RunResultsW[2]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[2]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse3[2]"			Proj:ResultSummary[5]:Enduse3[2]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR. RunResultsW[3]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[3]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse4[2]"			Proj:ResultSummary[5]:Enduse4[2]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR. RunResultsW[4]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[4]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse5[2]"			Proj:ResultSummary[5]:Enduse5[2]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR. RunResultsW[5]:PropElecEnergy[1]  < 0.00001) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr(       (int( (RunResultsW[5]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse6[2]"			Proj:ResultSummary[5]:Enduse6[2]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. RunResultsW[6]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[6]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse7[2]"			Proj:ResultSummary[5]:Enduse7[2]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR. RunResultsW[7]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[7]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse8[2]"			Proj:ResultSummary[5]:Enduse8[2]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR. RunResultsW[8]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[8]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse9[2]"			Proj:ResultSummary[5]:Enduse9[2]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR. RunResultsW[9]:PropElecEnergy[1]  < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[9]:PropElecEnergy[1]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse10[2]"			Proj:ResultSummary[5]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. RunResultsW[10]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse11[2]"			Proj:ResultSummary[5]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. RunResultsW[11]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse12[2]"			Proj:ResultSummary[5]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. RunResultsW[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Proposed Site FUEL Use
	"Set ResultSummary[5]:Title1[3]"				Proj:ResultSummary[5]:Title1[3]		= {	"Proposed"  }
	"Set ResultSummary[5]:Title2[3]"				Proj:ResultSummary[5]:Title2[3]		= {	"Design"  }
	"Set ResultSummary[5]:Title3[3]"				Proj:ResultSummary[5]:Title3[3]		= {	"Site (therms)"  }
	"Set ResultSummary[5]:Enduse1[3]"			Proj:ResultSummary[5]:Enduse1[3]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR.  (RunResultsW[1]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[1]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[1]:PropNatGasEnergy[1]  + RunResultsW[1]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse2[3]"			Proj:ResultSummary[5]:Enduse2[3]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR.  (RunResultsW[2]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[2]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[2]:PropNatGasEnergy[1]  + RunResultsW[2]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse3[3]"			Proj:ResultSummary[5]:Enduse3[3]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR.  (RunResultsW[3]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[3]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[3]:PropNatGasEnergy[1]  + RunResultsW[3]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse4[3]"			Proj:ResultSummary[5]:Enduse4[3]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR.  (RunResultsW[4]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[4]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[4]:PropNatGasEnergy[1]  + RunResultsW[4]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse5[3]"			Proj:ResultSummary[5]:Enduse5[3]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR.  (RunResultsW[5]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[5]:PropOtherEnergy[1]  < 0.00001)) then
																														if (Proj:ModelingDHW < 0.5) then  "- none -"  else  UNDEFINED  endif
																													else  FltToStr( ((RunResultsW[5]:PropNatGasEnergy[1]  + RunResultsW[5]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse6[3]"			Proj:ResultSummary[5]:Enduse6[3]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR.  (RunResultsW[6]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[6]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[6]:PropNatGasEnergy[1]  + RunResultsW[6]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse7[3]"			Proj:ResultSummary[5]:Enduse7[3]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR.  (RunResultsW[7]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[7]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[7]:PropNatGasEnergy[1]  + RunResultsW[7]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse8[3]"			Proj:ResultSummary[5]:Enduse8[3]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR.  (RunResultsW[8]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[8]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[8]:PropNatGasEnergy[1]  + RunResultsW[8]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse9[3]"			Proj:ResultSummary[5]:Enduse9[3]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR.  (RunResultsW[9]:PropNatGasEnergy[1]  < 0.00001 .AND. RunResultsW[9]:PropOtherEnergy[1]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[9]:PropNatGasEnergy[1]  + RunResultsW[9]:PropOtherEnergy[1] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse10[3]"			Proj:ResultSummary[5]:Enduse10[3]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR.  (RunResultsW[10]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsW[10]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[10]:PropNatGasEnergy[1] + RunResultsW[10]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse11[3]"			Proj:ResultSummary[5]:Enduse11[3]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR.  (RunResultsW[11]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsW[11]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[11]:PropNatGasEnergy[1] + RunResultsW[11]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse12[3]"			Proj:ResultSummary[5]:Enduse12[3]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR.  (RunResultsW[12]:PropNatGasEnergy[1] < 0.00001 .AND. RunResultsW[12]:PropOtherEnergy[1] < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[12]:PropNatGasEnergy[1] + RunResultsW[12]:PropOtherEnergy[1]) * Proj:CondFloorArea / 100), 1 )  endif  }

  ; Proposed TDV
	"Set ResultSummary[5]:Title1[4]"				Proj:ResultSummary[5]:Title1[4]		= {	"Proposed"  }
	"Set ResultSummary[5]:Title2[4]"				Proj:ResultSummary[5]:Title2[4]		= {	"Design"  }
	"Set ResultSummary[5]:Title3[4]"				Proj:ResultSummary[5]:Title3[4]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[5]:Enduse1[4]"			Proj:ResultSummary[5]:Enduse1[4]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[4]"			Proj:ResultSummary[5]:Enduse2[4]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[4]"			Proj:ResultSummary[5]:Enduse3[4]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[4]"			Proj:ResultSummary[5]:Enduse4[4]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[4]"			Proj:ResultSummary[5]:Enduse5[4]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[4]"			Proj:ResultSummary[5]:Enduse6[4]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[4]"			Proj:ResultSummary[5]:Enduse7[4]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[4]"			Proj:ResultSummary[5]:Enduse8[4]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:ProposedTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[4]"			Proj:ResultSummary[5]:Enduse9[4]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:ProposedTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[4]"			Proj:ResultSummary[5]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[4]"			Proj:ResultSummary[5]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[4]"			Proj:ResultSummary[5]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:ProposedTDV[1] ), 2 )  endif  }

  ; Proposed Electric Demand
	"Set ResultSummary[5]:Title1[10]"			Proj:ResultSummary[5]:Title1[10]		= {	"Proposed"  }
	"Set ResultSummary[5]:Title2[10]"			Proj:ResultSummary[5]:Title2[10]		= {	"Design"  }
	"Set ResultSummary[5]:Title3[10]"			Proj:ResultSummary[5]:Title3[10]		= {	"(kW)"  }
	"Set ResultSummary[5]:Enduse1[10]"			Proj:ResultSummary[5]:Enduse1[10]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[10]"			Proj:ResultSummary[5]:Enduse2[10]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[10]"			Proj:ResultSummary[5]:Enduse3[10]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[10]"			Proj:ResultSummary[5]:Enduse4[10]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[10]"			Proj:ResultSummary[5]:Enduse5[10]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[10]"			Proj:ResultSummary[5]:Enduse6[10]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[10]"			Proj:ResultSummary[5]:Enduse7[10]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[10]"			Proj:ResultSummary[5]:Enduse8[10]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:PropElecDemand[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[10]"			Proj:ResultSummary[5]:Enduse9[10]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:PropElecDemand[1]  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[10]"			Proj:ResultSummary[5]:Enduse10[10]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[10]"			Proj:ResultSummary[5]:Enduse11[10]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:PropElecDemand[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[10]"			Proj:ResultSummary[5]:Enduse12[10]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:PropElecDemand[1] ), 2 )  endif  }
END


;*************************************************************************
RULELIST "CARes_StandardSummary_NESW" 1 0 1 1
;*************************************************************************

	; Worst case run RunResults[*] all set now, so start by setting up PROPOSED summary data for the worst case run
	"Call subordinate rulelist to set worst case Proposed summary"		Proj:Action = {	EvalRulelist( "CARes_ProposedSummary_Main" )  }
	; can call generic StandardSummary rulelist to set worst case Standard summary data
	"Call subordinate rulelist to set worst case Standard summary"		Proj:Action = {	EvalRulelist( "CARes_StandardSummary" )  }

; -- NORTH Facing --
  ; Standard Site Electric Use
	"Set ResultSummary[2]:Title1[5]"				Proj:ResultSummary[2]:Title1[5]		= {	"Standard"  }
	"Set ResultSummary[2]:Title2[5]"				Proj:ResultSummary[2]:Title2[5]		= {	"Design"  }
	"Set ResultSummary[2]:Title3[5]"				Proj:ResultSummary[2]:Title3[5]		= {	"Site (kWh)"  }
	"Set ResultSummary[2]:Enduse1[5]"			Proj:ResultSummary[2]:Enduse1[5]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR. RunResultsN[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse2[5]"			Proj:ResultSummary[2]:Enduse2[5]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR. RunResultsN[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse3[5]"			Proj:ResultSummary[2]:Enduse3[5]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR. RunResultsN[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse4[5]"			Proj:ResultSummary[2]:Enduse4[5]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR. RunResultsN[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse5[5]"			Proj:ResultSummary[2]:Enduse5[5]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR. RunResultsN[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse6[5]"			Proj:ResultSummary[2]:Enduse6[5]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. RunResultsN[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse7[5]"			Proj:ResultSummary[2]:Enduse7[5]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR. RunResultsN[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse8[5]"			Proj:ResultSummary[2]:Enduse8[5]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR. RunResultsN[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse9[5]"			Proj:ResultSummary[2]:Enduse9[5]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR. RunResultsN[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse10[5]"			Proj:ResultSummary[2]:Enduse10[5]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. RunResultsN[10]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[10]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse11[5]"			Proj:ResultSummary[2]:Enduse11[5]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. RunResultsN[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[11]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse12[5]"			Proj:ResultSummary[2]:Enduse12[5]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. RunResultsN[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[12]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[2]:Enduse10[2]"			Proj:ResultSummary[2]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. RunResultsN[10]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse11[2]"			Proj:ResultSummary[2]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. RunResultsN[11]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse12[2]"			Proj:ResultSummary[2]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. RunResultsN[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsN[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Standard Site Natural Gas Use
	"Set ResultSummary[2]:Title1[6]"				Proj:ResultSummary[2]:Title1[6]		= {	"Standard"  }
	"Set ResultSummary[2]:Title2[6]"				Proj:ResultSummary[2]:Title2[6]		= {	"Design"  }
	"Set ResultSummary[2]:Title3[6]"				Proj:ResultSummary[2]:Title3[6]		= {	"Site (therms)"  }
	"Set ResultSummary[2]:Enduse1[6]"			Proj:ResultSummary[2]:Enduse1[6]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR. (RunResultsN[1]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[1]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[1]:StdNatGasEnergy  + RunResultsN[1]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse2[6]"			Proj:ResultSummary[2]:Enduse2[6]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR. (RunResultsN[2]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[2]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[2]:StdNatGasEnergy  + RunResultsN[2]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse3[6]"			Proj:ResultSummary[2]:Enduse3[6]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR. (RunResultsN[3]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[3]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[3]:StdNatGasEnergy  + RunResultsN[3]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse4[6]"			Proj:ResultSummary[2]:Enduse4[6]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR. (RunResultsN[4]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[4]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[4]:StdNatGasEnergy  + RunResultsN[4]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse5[6]"			Proj:ResultSummary[2]:Enduse5[6]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR. (RunResultsN[5]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[5]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[5]:StdNatGasEnergy  + RunResultsN[5]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse6[6]"			Proj:ResultSummary[2]:Enduse6[6]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. (RunResultsN[6]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[6]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[6]:StdNatGasEnergy  + RunResultsN[6]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse7[6]"			Proj:ResultSummary[2]:Enduse7[6]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR. (RunResultsN[7]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[7]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[7]:StdNatGasEnergy  + RunResultsN[7]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse8[6]"			Proj:ResultSummary[2]:Enduse8[6]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR. (RunResultsN[8]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[8]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[8]:StdNatGasEnergy  + RunResultsN[8]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse9[6]"			Proj:ResultSummary[2]:Enduse9[6]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR. (RunResultsN[9]:StdNatGasEnergy  < 0.00001 .AND. RunResultsN[9]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[9]:StdNatGasEnergy  + RunResultsN[9]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse10[6]"			Proj:ResultSummary[2]:Enduse10[6]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. (RunResultsN[10]:StdNatGasEnergy < 0.00001 .AND. RunResultsN[10]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[10]:StdNatGasEnergy + RunResultsN[10]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse11[6]"			Proj:ResultSummary[2]:Enduse11[6]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. (RunResultsN[11]:StdNatGasEnergy < 0.00001 .AND. RunResultsN[11]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[11]:StdNatGasEnergy + RunResultsN[11]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse12[6]"			Proj:ResultSummary[2]:Enduse12[6]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. (RunResultsN[12]:StdNatGasEnergy < 0.00001 .AND. RunResultsN[12]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[12]:StdNatGasEnergy + RunResultsN[12]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Standard TDV
	"Set ResultSummary[2]:Title1[7]"				Proj:ResultSummary[2]:Title1[7]		= {	"Standard"  }
	"Set ResultSummary[2]:Title2[7]"				Proj:ResultSummary[2]:Title2[7]		= {	"Design"  }
	"Set ResultSummary[2]:Title3[7]"				Proj:ResultSummary[2]:Title3[7]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[2]:Enduse1[7]"			Proj:ResultSummary[2]:Enduse1[7]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[7]"			Proj:ResultSummary[2]:Enduse2[7]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[7]"			Proj:ResultSummary[2]:Enduse3[7]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[7]"			Proj:ResultSummary[2]:Enduse4[7]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[7]"			Proj:ResultSummary[2]:Enduse5[7]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[7]"			Proj:ResultSummary[2]:Enduse6[7]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[7]"			Proj:ResultSummary[2]:Enduse7[7]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[7]"			Proj:ResultSummary[2]:Enduse8[7]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[7]"			Proj:ResultSummary[2]:Enduse9[7]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:StandardTDV  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[7]"			Proj:ResultSummary[2]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[7]"			Proj:ResultSummary[2]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[7]"			Proj:ResultSummary[2]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:StandardTDV ), 2 )  endif  }
 ; mjb-10/16/13	removed PVCredit from Std Design
; 	"Set ResultSummary[2]:Enduse13[7]"			Proj:ResultSummary[2]:Enduse13[7]	= {	FltToStr( PVCredit, 2 )  }
 	"Set ResultSummary[2]:Enduse13[7]"			Proj:ResultSummary[2]:Enduse13[7]	= {	" "  }

; mjb-10/16/13	subtract PVCredit from Prop Design - N
	;"Set ResultSummary[2]:Enduse13[4]"			Proj:ResultSummary[2]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
	"Set ResultSummary[2]:Enduse13[4]"			Proj:ResultSummary[2]:Enduse13[4]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsN[6]:PropPVCreditTDV[1] * -1), 2 )  endif  }

  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[2]:Enduse10[4]"			Proj:ResultSummary[2]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[4]"			Proj:ResultSummary[2]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[4]"			Proj:ResultSummary[2]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[2]:CompResultsMsg"		Proj:ResultSummary[2]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[2]:PVMinRatedPower"		Proj:ResultSummary[2]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[2]:Title1[8]"				Proj:ResultSummary[2]:Title1[8]		= {	"Compliance"  }
	"Set ResultSummary[2]:Title2[8]"				Proj:ResultSummary[2]:Title2[8]		= {	"Margin"  }
	"Set ResultSummary[2]:Title3[8]"				Proj:ResultSummary[2]:Title3[8]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[2]:Enduse1[8]"			Proj:ResultSummary[2]:Enduse1[8]		= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[8]"			Proj:ResultSummary[2]:Enduse2[8]		= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[8]"			Proj:ResultSummary[2]:Enduse3[8]		= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[8]"			Proj:ResultSummary[2]:Enduse4[8]		= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[8]"			Proj:ResultSummary[2]:Enduse5[8]		= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[8]"			Proj:ResultSummary[2]:Enduse6[8]		= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[8]"			Proj:ResultSummary[2]:Enduse7[8]		= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[8]"			Proj:ResultSummary[2]:Enduse8[8]		= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[8]"			Proj:ResultSummary[2]:Enduse9[8]		= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:CompMarginTDV  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[8]"			Proj:ResultSummary[2]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[8]"			Proj:ResultSummary[2]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[8]"			Proj:ResultSummary[2]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:CompMarginTDV ), 2 )  endif  }
 	;"Set ResultSummary[2]:Enduse13[8]"			Proj:ResultSummary[2]:Enduse13[8]	= {	FltToStr( PVCredit[2], 2 )  }
 	"Set ResultSummary[2]:Enduse13[8]"			Proj:ResultSummary[2]:Enduse13[8]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[6]:PropPVCreditTDV[1], 2 )  endif  }
  ; Pass/Fail result
 	"Set ResultSummary[2]:PassFail"				Proj:ResultSummary[2]:PassFail		= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  if (RunResultsN[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Standard Electric Demand
	"Set ResultSummary[2]:Title1[11]"			Proj:ResultSummary[2]:Title1[11]		= {	"Standard"  }
	"Set ResultSummary[2]:Title2[11]"			Proj:ResultSummary[2]:Title2[11]		= {	"Design"  }
	"Set ResultSummary[2]:Title3[11]"			Proj:ResultSummary[2]:Title3[11]		= {	"(kW)"  }
	"Set ResultSummary[2]:Enduse1[11]"			Proj:ResultSummary[2]:Enduse1[11]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[11]"			Proj:ResultSummary[2]:Enduse2[11]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[11]"			Proj:ResultSummary[2]:Enduse3[11]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[11]"			Proj:ResultSummary[2]:Enduse4[11]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[11]"			Proj:ResultSummary[2]:Enduse5[11]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[11]"			Proj:ResultSummary[2]:Enduse6[11]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[11]"			Proj:ResultSummary[2]:Enduse7[11]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[11]"			Proj:ResultSummary[2]:Enduse8[11]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[11]"			Proj:ResultSummary[2]:Enduse9[11]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:StdElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[11]"			Proj:ResultSummary[2]:Enduse10[11]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[11]"			Proj:ResultSummary[2]:Enduse11[11]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[11]"			Proj:ResultSummary[2]:Enduse12[11]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:StdElecDemand ), 2 )  endif  }

  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
	"Set ResultSummary[2]:MarginkW"			Proj:ResultSummary[2]:MarginkW		= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
																												else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsN[10]:PropElecDemand[1], 0 )  endif  }
	"Set ResultSummary[2]:MarginkWh"			Proj:ResultSummary[2]:MarginkWh		= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
																												else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsN[10]:PropElecEnergy[1], 0 )) * CondFloorArea / 3.413  endif  }
	"Set ResultSummary[2]:MarginTherms"		Proj:ResultSummary[2]:MarginTherms	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
																												else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsN[10]:PropNatGasEnergy[1], 0 )) * CondFloorArea / 100  endif  }
  ; Percent Savings values for reporting
	"Set ResultSummary[2]:PctSavingskW"			Proj:ResultSummary[2]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdElecDemand   - ValidOr( RunResultsN[10]:PropElecDemand[1],   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
	"Set ResultSummary[2]:PctSavingskWh"		Proj:ResultSummary[2]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResultsN[10]:PropElecEnergy[1],   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
	"Set ResultSummary[2]:PctSavingsTherms"	Proj:ResultSummary[2]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsN[10]:PropNatGasEnergy[1], 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
	"Set ResultSummary[2]:PctSavingsTDV"		Proj:ResultSummary[2]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StandardTDV     - ValidOr( RunResultsN[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
	"Set ResultSummary[2]:PctSavingsCmpTDV"	Proj:ResultSummary[2]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[11]:StandardTDV     - ValidOr( RunResultsN[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
	"Set ResultSummary[2]:PctSavkWLbl"			Proj:ResultSummary[2]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingskW     )  endif  }
	"Set ResultSummary[2]:PctSavkWhLbl"			Proj:ResultSummary[2]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingskWh    )  endif  }
	"Set ResultSummary[2]:PctSavThermsLbl"		Proj:ResultSummary[2]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[2]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsTherms )  endif  }
	"Set ResultSummary[2]:PctSavTDVLbl"			Proj:ResultSummary[2]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[2]:PctSavCmpTDVLbl"		Proj:ResultSummary[2]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsCmpTDV )  endif  }
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[2]:MeetsTier1"			Proj:ResultSummary[2]:MeetsTier1		= {	if (StdDesignBase == 2016 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[2]:MeetsTier2"			Proj:ResultSummary[2]:MeetsTier2		= {	if (StdDesignBase == 2016 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }

; -- EAST Facing --
  ; Standard Site Electric Use
	"Set ResultSummary[3]:Title1[5]"				Proj:ResultSummary[3]:Title1[5]		= {	"Standard"  }
	"Set ResultSummary[3]:Title2[5]"				Proj:ResultSummary[3]:Title2[5]		= {	"Design"  }
	"Set ResultSummary[3]:Title3[5]"				Proj:ResultSummary[3]:Title3[5]		= {	"Site (kWh)"  }
	"Set ResultSummary[3]:Enduse1[5]"			Proj:ResultSummary[3]:Enduse1[5]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR. RunResultsE[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse2[5]"			Proj:ResultSummary[3]:Enduse2[5]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR. RunResultsE[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse3[5]"			Proj:ResultSummary[3]:Enduse3[5]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR. RunResultsE[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse4[5]"			Proj:ResultSummary[3]:Enduse4[5]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR. RunResultsE[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse5[5]"			Proj:ResultSummary[3]:Enduse5[5]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR. RunResultsE[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse6[5]"			Proj:ResultSummary[3]:Enduse6[5]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. RunResultsE[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse7[5]"			Proj:ResultSummary[3]:Enduse7[5]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR. RunResultsE[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse8[5]"			Proj:ResultSummary[3]:Enduse8[5]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR. RunResultsE[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse9[5]"			Proj:ResultSummary[3]:Enduse9[5]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR. RunResultsE[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse10[5]"			Proj:ResultSummary[3]:Enduse10[5]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. RunResultsE[10]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[10]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse11[5]"			Proj:ResultSummary[3]:Enduse11[5]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. RunResultsE[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[11]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse12[5]"			Proj:ResultSummary[3]:Enduse12[5]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. RunResultsE[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[12]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[3]:Enduse10[2]"			Proj:ResultSummary[3]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. RunResultsE[10]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse11[2]"			Proj:ResultSummary[3]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. RunResultsE[11]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse12[2]"			Proj:ResultSummary[3]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. RunResultsE[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsE[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }

  ; Standard Site Natural Gas Use
	"Set ResultSummary[3]:Title1[6]"				Proj:ResultSummary[3]:Title1[6]		= {	"Standard"  }
	"Set ResultSummary[3]:Title2[6]"				Proj:ResultSummary[3]:Title2[6]		= {	"Design"  }
	"Set ResultSummary[3]:Title3[6]"				Proj:ResultSummary[3]:Title3[6]		= {	"Site (therms)"  }
	"Set ResultSummary[3]:Enduse1[6]"			Proj:ResultSummary[3]:Enduse1[6]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR. (RunResultsE[1]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[1]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[1]:StdNatGasEnergy  + RunResultsE[1]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse2[6]"			Proj:ResultSummary[3]:Enduse2[6]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR. (RunResultsE[2]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[2]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[2]:StdNatGasEnergy  + RunResultsE[2]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse3[6]"			Proj:ResultSummary[3]:Enduse3[6]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR. (RunResultsE[3]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[3]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[3]:StdNatGasEnergy  + RunResultsE[3]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse4[6]"			Proj:ResultSummary[3]:Enduse4[6]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR. (RunResultsE[4]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[4]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[4]:StdNatGasEnergy  + RunResultsE[4]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse5[6]"			Proj:ResultSummary[3]:Enduse5[6]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR. (RunResultsE[5]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[5]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[5]:StdNatGasEnergy  + RunResultsE[5]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse6[6]"			Proj:ResultSummary[3]:Enduse6[6]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. (RunResultsE[6]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[6]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[6]:StdNatGasEnergy  + RunResultsE[6]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse7[6]"			Proj:ResultSummary[3]:Enduse7[6]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR. (RunResultsE[7]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[7]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[7]:StdNatGasEnergy  + RunResultsE[7]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse8[6]"			Proj:ResultSummary[3]:Enduse8[6]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR. (RunResultsE[8]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[8]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[8]:StdNatGasEnergy  + RunResultsE[8]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse9[6]"			Proj:ResultSummary[3]:Enduse9[6]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR. (RunResultsE[9]:StdNatGasEnergy  < 0.00001 .AND. RunResultsE[9]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[9]:StdNatGasEnergy  + RunResultsE[9]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse10[6]"			Proj:ResultSummary[3]:Enduse10[6]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. (RunResultsE[10]:StdNatGasEnergy < 0.00001 .AND. RunResultsE[10]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[10]:StdNatGasEnergy + RunResultsE[10]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse11[6]"			Proj:ResultSummary[3]:Enduse11[6]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. (RunResultsE[11]:StdNatGasEnergy < 0.00001 .AND. RunResultsE[11]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[11]:StdNatGasEnergy + RunResultsE[11]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse12[6]"			Proj:ResultSummary[3]:Enduse12[6]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. (RunResultsE[12]:StdNatGasEnergy < 0.00001 .AND. RunResultsE[12]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[12]:StdNatGasEnergy + RunResultsE[12]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Standard TDV
	"Set ResultSummary[3]:Title1[7]"				Proj:ResultSummary[3]:Title1[7]		= {	"Standard"  }
	"Set ResultSummary[3]:Title2[7]"				Proj:ResultSummary[3]:Title2[7]		= {	"Design"  }
	"Set ResultSummary[3]:Title3[7]"				Proj:ResultSummary[3]:Title3[7]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[3]:Enduse1[7]"			Proj:ResultSummary[3]:Enduse1[7]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[7]"			Proj:ResultSummary[3]:Enduse2[7]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[7]"			Proj:ResultSummary[3]:Enduse3[7]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[7]"			Proj:ResultSummary[3]:Enduse4[7]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[7]"			Proj:ResultSummary[3]:Enduse5[7]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[7]"			Proj:ResultSummary[3]:Enduse6[7]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[7]"			Proj:ResultSummary[3]:Enduse7[7]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[7]"			Proj:ResultSummary[3]:Enduse8[7]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[7]"			Proj:ResultSummary[3]:Enduse9[7]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:StandardTDV  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[7]"			Proj:ResultSummary[3]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[7]"			Proj:ResultSummary[3]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[7]"			Proj:ResultSummary[3]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:StandardTDV ), 2 )  endif  }
 ; mjb-10/16/13	removed PVCredit from Std Design
;	"Set ResultSummary[3]:Enduse13[7]"			Proj:ResultSummary[3]:Enduse13[7]	= {	FltToStr( PVCredit, 2 )  }
	"Set ResultSummary[3]:Enduse13[7]"			Proj:ResultSummary[3]:Enduse13[7]	= {	" "  }

; mjb-10/16/13	subtract PVCredit from Prop Design - E
	;"Set ResultSummary[3]:Enduse13[4]"			Proj:ResultSummary[3]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
	"Set ResultSummary[3]:Enduse13[4]"			Proj:ResultSummary[3]:Enduse13[4]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsE[6]:PropPVCreditTDV[1] * -1), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[3]:Enduse10[4]"			Proj:ResultSummary[3]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[4]"			Proj:ResultSummary[3]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[4]"			Proj:ResultSummary[3]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[3]:CompResultsMsg"		Proj:ResultSummary[3]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[3]:PVMinRatedPower"		Proj:ResultSummary[3]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[3]:Title1[8]"				Proj:ResultSummary[3]:Title1[8]		= {	"Compliance"  }
	"Set ResultSummary[3]:Title2[8]"				Proj:ResultSummary[3]:Title2[8]		= {	"Margin"  }
	"Set ResultSummary[3]:Title3[8]"				Proj:ResultSummary[3]:Title3[8]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[3]:Enduse1[8]"			Proj:ResultSummary[3]:Enduse1[8]		= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[8]"			Proj:ResultSummary[3]:Enduse2[8]		= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[8]"			Proj:ResultSummary[3]:Enduse3[8]		= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[8]"			Proj:ResultSummary[3]:Enduse4[8]		= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[8]"			Proj:ResultSummary[3]:Enduse5[8]		= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[8]"			Proj:ResultSummary[3]:Enduse6[8]		= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[8]"			Proj:ResultSummary[3]:Enduse7[8]		= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[8]"			Proj:ResultSummary[3]:Enduse8[8]		= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[8]"			Proj:ResultSummary[3]:Enduse9[8]		= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:CompMarginTDV  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[8]"			Proj:ResultSummary[3]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[8]"			Proj:ResultSummary[3]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[8]"			Proj:ResultSummary[3]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:CompMarginTDV ), 2 )  endif  }
 	;"Set ResultSummary[3]:Enduse13[8]"			Proj:ResultSummary[3]:Enduse13[8]	= {	FltToStr( PVCredit[1], 2 )  }
 	"Set ResultSummary[3]:Enduse13[8]"			Proj:ResultSummary[3]:Enduse13[8]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[6]:PropPVCreditTDV[1], 2 )  endif  }
  ; Pass/Fail result
 	"Set ResultSummary[3]:PassFail"				Proj:ResultSummary[3]:PassFail		= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  if (RunResultsE[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Standard Electric Demand
	"Set ResultSummary[3]:Title1[11]"			Proj:ResultSummary[3]:Title1[11]		= {	"Standard"  }
	"Set ResultSummary[3]:Title2[11]"			Proj:ResultSummary[3]:Title2[11]		= {	"Design"  }
	"Set ResultSummary[3]:Title3[11]"			Proj:ResultSummary[3]:Title3[11]		= {	"(kW)"  }
	"Set ResultSummary[3]:Enduse1[11]"			Proj:ResultSummary[3]:Enduse1[11]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[11]"			Proj:ResultSummary[3]:Enduse2[11]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[11]"			Proj:ResultSummary[3]:Enduse3[11]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[11]"			Proj:ResultSummary[3]:Enduse4[11]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[11]"			Proj:ResultSummary[3]:Enduse5[11]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[11]"			Proj:ResultSummary[3]:Enduse6[11]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[11]"			Proj:ResultSummary[3]:Enduse7[11]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[11]"			Proj:ResultSummary[3]:Enduse8[11]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[11]"			Proj:ResultSummary[3]:Enduse9[11]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:StdElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[11]"			Proj:ResultSummary[3]:Enduse10[11]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[11]"			Proj:ResultSummary[3]:Enduse11[11]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[11]"			Proj:ResultSummary[3]:Enduse12[11]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:StdElecDemand ), 2 )  endif  }

  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
	"Set ResultSummary[3]:MarginkW"			Proj:ResultSummary[3]:MarginkW		= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
																												else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsE[10]:PropElecDemand[1], 0 )  endif  }
	"Set ResultSummary[3]:MarginkWh"			Proj:ResultSummary[3]:MarginkWh		= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
																												else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsE[10]:PropElecEnergy[1], 0 )) * CondFloorArea / 3.413  endif  }
	"Set ResultSummary[3]:MarginTherms"		Proj:ResultSummary[3]:MarginTherms	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
																												else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsE[10]:PropNatGasEnergy[1], 0 )) * CondFloorArea / 100  endif  }
  ; Percent Savings values for reporting
	"Set ResultSummary[3]:PctSavingskW"			Proj:ResultSummary[3]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdElecDemand   - ValidOr( RunResultsE[10]:PropElecDemand[1],   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
	"Set ResultSummary[3]:PctSavingskWh"		Proj:ResultSummary[3]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResultsE[10]:PropElecEnergy[1],   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
	"Set ResultSummary[3]:PctSavingsTherms"	Proj:ResultSummary[3]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsE[10]:PropNatGasEnergy[1], 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
	"Set ResultSummary[3]:PctSavingsTDV"		Proj:ResultSummary[3]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StandardTDV     - ValidOr( RunResultsE[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
	"Set ResultSummary[3]:PctSavingsCmpTDV"	Proj:ResultSummary[3]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[11]:StandardTDV     - ValidOr( RunResultsE[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
	"Set ResultSummary[3]:PctSavkWLbl"			Proj:ResultSummary[3]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingskW     )  endif  }
	"Set ResultSummary[3]:PctSavkWhLbl"			Proj:ResultSummary[3]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingskWh    )  endif  }
	"Set ResultSummary[3]:PctSavThermsLbl"		Proj:ResultSummary[3]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[3]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsTherms )  endif  }
	"Set ResultSummary[3]:PctSavTDVLbl"			Proj:ResultSummary[3]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[3]:PctSavCmpTDVLbl"		Proj:ResultSummary[3]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsCmpTDV )  endif  }
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[3]:MeetsTier1"			Proj:ResultSummary[3]:MeetsTier1		= {	if (StdDesignBase == 2016 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[3]:MeetsTier2"			Proj:ResultSummary[3]:MeetsTier2		= {	if (StdDesignBase == 2016 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }

; -- SOUTH Facing --
  ; Standard Site Electric Use
	"Set ResultSummary[4]:Title1[5]"				Proj:ResultSummary[4]:Title1[5]		= {	"Standard"  }
	"Set ResultSummary[4]:Title2[5]"				Proj:ResultSummary[4]:Title2[5]		= {	"Design"  }
	"Set ResultSummary[4]:Title3[5]"				Proj:ResultSummary[4]:Title3[5]		= {	"Site (kWh)"  }
	"Set ResultSummary[4]:Enduse1[5]"			Proj:ResultSummary[4]:Enduse1[5]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR. RunResultsS[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse2[5]"			Proj:ResultSummary[4]:Enduse2[5]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR. RunResultsS[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse3[5]"			Proj:ResultSummary[4]:Enduse3[5]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR. RunResultsS[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse4[5]"			Proj:ResultSummary[4]:Enduse4[5]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR. RunResultsS[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse5[5]"			Proj:ResultSummary[4]:Enduse5[5]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR. RunResultsS[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse6[5]"			Proj:ResultSummary[4]:Enduse6[5]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. RunResultsS[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse7[5]"			Proj:ResultSummary[4]:Enduse7[5]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR. RunResultsS[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse8[5]"			Proj:ResultSummary[4]:Enduse8[5]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR. RunResultsS[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse9[5]"			Proj:ResultSummary[4]:Enduse9[5]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR. RunResultsS[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse10[5]"			Proj:ResultSummary[4]:Enduse10[5]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. RunResultsS[10]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[10]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse11[5]"			Proj:ResultSummary[4]:Enduse11[5]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. RunResultsS[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[11]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse12[5]"			Proj:ResultSummary[4]:Enduse12[5]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. RunResultsS[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[12]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[4]:Enduse10[2]"			Proj:ResultSummary[4]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. RunResultsS[10]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse11[2]"			Proj:ResultSummary[4]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. RunResultsS[11]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse12[2]"			Proj:ResultSummary[4]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. RunResultsS[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsS[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; Standard Site Natural Gas Use
	"Set ResultSummary[4]:Title1[6]"				Proj:ResultSummary[4]:Title1[6]		= {	"Standard"  }
	"Set ResultSummary[4]:Title2[6]"				Proj:ResultSummary[4]:Title2[6]		= {	"Design"  }
	"Set ResultSummary[4]:Title3[6]"				Proj:ResultSummary[4]:Title3[6]		= {	"Site (therms)"  }
	"Set ResultSummary[4]:Enduse1[6]"			Proj:ResultSummary[4]:Enduse1[6]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR. (RunResultsS[1]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[1]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[1]:StdNatGasEnergy  + RunResultsS[1]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse2[6]"			Proj:ResultSummary[4]:Enduse2[6]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR. (RunResultsS[2]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[2]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[2]:StdNatGasEnergy  + RunResultsS[2]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse3[6]"			Proj:ResultSummary[4]:Enduse3[6]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR. (RunResultsS[3]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[3]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[3]:StdNatGasEnergy  + RunResultsS[3]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse4[6]"			Proj:ResultSummary[4]:Enduse4[6]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR. (RunResultsS[4]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[4]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[4]:StdNatGasEnergy  + RunResultsS[4]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse5[6]"			Proj:ResultSummary[4]:Enduse5[6]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR. (RunResultsS[5]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[5]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[5]:StdNatGasEnergy  + RunResultsS[5]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse6[6]"			Proj:ResultSummary[4]:Enduse6[6]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. (RunResultsS[6]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[6]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[6]:StdNatGasEnergy  + RunResultsS[6]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse7[6]"			Proj:ResultSummary[4]:Enduse7[6]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR. (RunResultsS[7]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[7]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[7]:StdNatGasEnergy  + RunResultsS[7]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse8[6]"			Proj:ResultSummary[4]:Enduse8[6]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR. (RunResultsS[8]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[8]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[8]:StdNatGasEnergy  + RunResultsS[8]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse9[6]"			Proj:ResultSummary[4]:Enduse9[6]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR. (RunResultsS[9]:StdNatGasEnergy  < 0.00001 .AND. RunResultsS[9]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[9]:StdNatGasEnergy  + RunResultsS[9]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse10[6]"			Proj:ResultSummary[4]:Enduse10[6]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. (RunResultsS[10]:StdNatGasEnergy < 0.00001 .AND. RunResultsS[10]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[10]:StdNatGasEnergy + RunResultsS[10]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse11[6]"			Proj:ResultSummary[4]:Enduse11[6]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. (RunResultsS[11]:StdNatGasEnergy < 0.00001 .AND. RunResultsS[11]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[11]:StdNatGasEnergy + RunResultsS[11]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse12[6]"			Proj:ResultSummary[4]:Enduse12[6]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. (RunResultsS[12]:StdNatGasEnergy < 0.00001 .AND. RunResultsS[12]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[12]:StdNatGasEnergy + RunResultsS[12]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Standard TDV
	"Set ResultSummary[4]:Title1[7]"				Proj:ResultSummary[4]:Title1[7]		= {	"Standard"  }
	"Set ResultSummary[4]:Title2[7]"				Proj:ResultSummary[4]:Title2[7]		= {	"Design"  }
	"Set ResultSummary[4]:Title3[7]"				Proj:ResultSummary[4]:Title3[7]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[4]:Enduse1[7]"			Proj:ResultSummary[4]:Enduse1[7]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[7]"			Proj:ResultSummary[4]:Enduse2[7]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[7]"			Proj:ResultSummary[4]:Enduse3[7]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[7]"			Proj:ResultSummary[4]:Enduse4[7]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[7]"			Proj:ResultSummary[4]:Enduse5[7]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[7]"			Proj:ResultSummary[4]:Enduse6[7]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[7]"			Proj:ResultSummary[4]:Enduse7[7]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[7]"			Proj:ResultSummary[4]:Enduse8[7]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[7]"			Proj:ResultSummary[4]:Enduse9[7]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:StandardTDV  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[7]"			Proj:ResultSummary[4]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[7]"			Proj:ResultSummary[4]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[7]"			Proj:ResultSummary[4]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:StandardTDV ), 2 )  endif  }
 ; mjb-10/16/13	removed PVCredit from Std Design
;	"Set ResultSummary[4]:Enduse13[7]"			Proj:ResultSummary[4]:Enduse13[7]	= {	FltToStr( PVCredit, 2 )  }
	"Set ResultSummary[4]:Enduse13[7]"			Proj:ResultSummary[4]:Enduse13[7]	= {	" "  }

; mjb-10/16/13	subtract PVCredit from Prop Design - S
	;"Set ResultSummary[4]:Enduse13[4]"			Proj:ResultSummary[4]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
	"Set ResultSummary[4]:Enduse13[4]"			Proj:ResultSummary[4]:Enduse13[4]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsS[6]:PropPVCreditTDV[1] * -1), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[4]:Enduse10[4]"			Proj:ResultSummary[4]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[4]"			Proj:ResultSummary[4]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[4]"			Proj:ResultSummary[4]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[4]:CompResultsMsg"		Proj:ResultSummary[4]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[4]:PVMinRatedPower"		Proj:ResultSummary[4]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[4]:Title1[8]"				Proj:ResultSummary[4]:Title1[8]		= {	"Compliance"  }
	"Set ResultSummary[4]:Title2[8]"				Proj:ResultSummary[4]:Title2[8]		= {	"Margin"  }
	"Set ResultSummary[4]:Title3[8]"				Proj:ResultSummary[4]:Title3[8]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[4]:Enduse1[8]"			Proj:ResultSummary[4]:Enduse1[8]		= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[8]"			Proj:ResultSummary[4]:Enduse2[8]		= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[8]"			Proj:ResultSummary[4]:Enduse3[8]		= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[8]"			Proj:ResultSummary[4]:Enduse4[8]		= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[8]"			Proj:ResultSummary[4]:Enduse5[8]		= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[8]"			Proj:ResultSummary[4]:Enduse6[8]		= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[8]"			Proj:ResultSummary[4]:Enduse7[8]		= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[8]"			Proj:ResultSummary[4]:Enduse8[8]		= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[8]"			Proj:ResultSummary[4]:Enduse9[8]		= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:CompMarginTDV  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[8]"			Proj:ResultSummary[4]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[8]"			Proj:ResultSummary[4]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[8]"			Proj:ResultSummary[4]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:CompMarginTDV ), 2 )  endif  }
 	;"Set ResultSummary[4]:Enduse13[8]"			Proj:ResultSummary[4]:Enduse13[8]	= {	FltToStr( PVCredit[1], 2 )  }
 	"Set ResultSummary[4]:Enduse13[8]"			Proj:ResultSummary[4]:Enduse13[8]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[6]:PropPVCreditTDV[1], 2 )  endif  }
  ; Pass/Fail result
 	"Set ResultSummary[4]:PassFail"				Proj:ResultSummary[4]:PassFail		= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  if (RunResultsS[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Standard Electric Demand
	"Set ResultSummary[4]:Title1[11]"			Proj:ResultSummary[4]:Title1[11]		= {	"Standard"  }
	"Set ResultSummary[4]:Title2[11]"			Proj:ResultSummary[4]:Title2[11]		= {	"Design"  }
	"Set ResultSummary[4]:Title3[11]"			Proj:ResultSummary[4]:Title3[11]		= {	"(kW)"  }
	"Set ResultSummary[4]:Enduse1[11]"			Proj:ResultSummary[4]:Enduse1[11]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[11]"			Proj:ResultSummary[4]:Enduse2[11]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[11]"			Proj:ResultSummary[4]:Enduse3[11]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[11]"			Proj:ResultSummary[4]:Enduse4[11]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[11]"			Proj:ResultSummary[4]:Enduse5[11]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[11]"			Proj:ResultSummary[4]:Enduse6[11]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[11]"			Proj:ResultSummary[4]:Enduse7[11]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[11]"			Proj:ResultSummary[4]:Enduse8[11]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[11]"			Proj:ResultSummary[4]:Enduse9[11]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:StdElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[11]"			Proj:ResultSummary[4]:Enduse10[11]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[11]"			Proj:ResultSummary[4]:Enduse11[11]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[11]"			Proj:ResultSummary[4]:Enduse12[11]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:StdElecDemand ), 2 )  endif  }

  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
	"Set ResultSummary[4]:MarginkW"			Proj:ResultSummary[4]:MarginkW		= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
																												else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsS[10]:PropElecDemand[1], 0 )  endif  }
	"Set ResultSummary[4]:MarginkWh"			Proj:ResultSummary[4]:MarginkWh		= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
																												else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsS[10]:PropElecEnergy[1], 0 )) * CondFloorArea / 3.413  endif  }
	"Set ResultSummary[4]:MarginTherms"		Proj:ResultSummary[4]:MarginTherms	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
																												else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsS[10]:PropNatGasEnergy[1], 0 )) * CondFloorArea / 100  endif  }
  ; Percent Savings values for reporting
	"Set ResultSummary[4]:PctSavingskW"			Proj:ResultSummary[4]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdElecDemand   - ValidOr( RunResultsS[10]:PropElecDemand[1],   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
	"Set ResultSummary[4]:PctSavingskWh"		Proj:ResultSummary[4]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResultsS[10]:PropElecEnergy[1],   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
	"Set ResultSummary[4]:PctSavingsTherms"	Proj:ResultSummary[4]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsS[10]:PropNatGasEnergy[1], 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
	"Set ResultSummary[4]:PctSavingsTDV"		Proj:ResultSummary[4]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[10]:StandardTDV     - ValidOr( RunResultsS[10]:ProposedTDV[1],      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
	"Set ResultSummary[4]:PctSavingsCmpTDV"	Proj:ResultSummary[4]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  (RunResults[11]:StandardTDV     - ValidOr( RunResultsS[11]:ProposedTDV[1],      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
	"Set ResultSummary[4]:PctSavkWLbl"			Proj:ResultSummary[4]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingskW     )  endif  }
	"Set ResultSummary[4]:PctSavkWhLbl"			Proj:ResultSummary[4]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingskWh    )  endif  }
	"Set ResultSummary[4]:PctSavThermsLbl"		Proj:ResultSummary[4]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[4]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsTherms )  endif  }
	"Set ResultSummary[4]:PctSavTDVLbl"			Proj:ResultSummary[4]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[4]:PctSavCmpTDVLbl"		Proj:ResultSummary[4]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsCmpTDV )  endif  }
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[4]:MeetsTier1"			Proj:ResultSummary[4]:MeetsTier1		= {	if (StdDesignBase == 2016 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[4]:MeetsTier2"			Proj:ResultSummary[4]:MeetsTier2		= {	if (StdDesignBase == 2016 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }

; -- WEST Facing --
  ; Standard Site Electric Use
	"Set ResultSummary[5]:Title1[5]"				Proj:ResultSummary[5]:Title1[5]		= {	"Standard"  }
	"Set ResultSummary[5]:Title2[5]"				Proj:ResultSummary[5]:Title2[5]		= {	"Design"  }
	"Set ResultSummary[5]:Title3[5]"				Proj:ResultSummary[5]:Title3[5]		= {	"Site (kWh)"  }
	"Set ResultSummary[5]:Enduse1[5]"			Proj:ResultSummary[5]:Enduse1[5]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR. RunResultsW[1]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[1]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse2[5]"			Proj:ResultSummary[5]:Enduse2[5]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR. RunResultsW[2]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[2]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse3[5]"			Proj:ResultSummary[5]:Enduse3[5]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR. RunResultsW[3]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[3]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse4[5]"			Proj:ResultSummary[5]:Enduse4[5]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR. RunResultsW[4]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[4]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse5[5]"			Proj:ResultSummary[5]:Enduse5[5]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR. RunResultsW[5]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[5]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse6[5]"			Proj:ResultSummary[5]:Enduse6[5]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. RunResultsW[6]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[6]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse7[5]"			Proj:ResultSummary[5]:Enduse7[5]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR. RunResultsW[7]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[7]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse8[5]"			Proj:ResultSummary[5]:Enduse8[5]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR. RunResultsW[8]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[8]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse9[5]"			Proj:ResultSummary[5]:Enduse9[5]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR. RunResultsW[9]:StdElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[9]:StdElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse10[5]"			Proj:ResultSummary[5]:Enduse10[5]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. RunResultsW[10]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[10]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse11[5]"			Proj:ResultSummary[5]:Enduse11[5]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. RunResultsW[11]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[11]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse12[5]"			Proj:ResultSummary[5]:Enduse12[5]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. RunResultsW[12]:StdElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[12]:StdElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
	"Set ResultSummary[5]:Enduse10[2]"			Proj:ResultSummary[5]:Enduse10[2]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. RunResultsW[10]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[10]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse11[2]"			Proj:ResultSummary[5]:Enduse11[2]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. RunResultsW[11]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[11]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse12[2]"			Proj:ResultSummary[5]:Enduse12[2]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. RunResultsW[12]:PropElecEnergy[1] < 0.00001) then  UNDEFINED  
																													else  FltToStr(       (int( (RunResultsW[12]:PropElecEnergy[1] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; Standard Site Natural Gas Use
	"Set ResultSummary[5]:Title1[6]"				Proj:ResultSummary[5]:Title1[6]		= {	"Standard"  }
	"Set ResultSummary[5]:Title2[6]"				Proj:ResultSummary[5]:Title2[6]		= {	"Design"  }
	"Set ResultSummary[5]:Title3[6]"				Proj:ResultSummary[5]:Title3[6]		= {	"Site (therms)"  }
	"Set ResultSummary[5]:Enduse1[6]"			Proj:ResultSummary[5]:Enduse1[6]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR. (RunResultsW[1]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[1]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[1]:StdNatGasEnergy  + RunResultsW[1]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse2[6]"			Proj:ResultSummary[5]:Enduse2[6]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR. (RunResultsW[2]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[2]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[2]:StdNatGasEnergy  + RunResultsW[2]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse3[6]"			Proj:ResultSummary[5]:Enduse3[6]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR. (RunResultsW[3]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[3]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[3]:StdNatGasEnergy  + RunResultsW[3]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse4[6]"			Proj:ResultSummary[5]:Enduse4[6]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR. (RunResultsW[4]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[4]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[4]:StdNatGasEnergy  + RunResultsW[4]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse5[6]"			Proj:ResultSummary[5]:Enduse5[6]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR. (RunResultsW[5]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[5]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[5]:StdNatGasEnergy  + RunResultsW[5]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse6[6]"			Proj:ResultSummary[5]:Enduse6[6]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. (RunResultsW[6]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[6]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[6]:StdNatGasEnergy  + RunResultsW[6]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse7[6]"			Proj:ResultSummary[5]:Enduse7[6]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR. (RunResultsW[7]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[7]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[7]:StdNatGasEnergy  + RunResultsW[7]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse8[6]"			Proj:ResultSummary[5]:Enduse8[6]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR. (RunResultsW[8]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[8]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[8]:StdNatGasEnergy  + RunResultsW[8]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse9[6]"			Proj:ResultSummary[5]:Enduse9[6]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR. (RunResultsW[9]:StdNatGasEnergy  < 0.00001 .AND. RunResultsW[9]:StdOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[9]:StdNatGasEnergy  + RunResultsW[9]:StdOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse10[6]"			Proj:ResultSummary[5]:Enduse10[6]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. (RunResultsW[10]:StdNatGasEnergy < 0.00001 .AND. RunResultsW[10]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[10]:StdNatGasEnergy + RunResultsW[10]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse11[6]"			Proj:ResultSummary[5]:Enduse11[6]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. (RunResultsW[11]:StdNatGasEnergy < 0.00001 .AND. RunResultsW[11]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[11]:StdNatGasEnergy + RunResultsW[11]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse12[6]"			Proj:ResultSummary[5]:Enduse12[6]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. (RunResultsW[12]:StdNatGasEnergy < 0.00001 .AND. RunResultsW[12]:StdOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[12]:StdNatGasEnergy + RunResultsW[12]:StdOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Standard TDV
	"Set ResultSummary[5]:Title1[7]"				Proj:ResultSummary[5]:Title1[7]		= {	"Standard"  }
	"Set ResultSummary[5]:Title2[7]"				Proj:ResultSummary[5]:Title2[7]		= {	"Design"  }
	"Set ResultSummary[5]:Title3[7]"				Proj:ResultSummary[5]:Title3[7]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[5]:Enduse1[7]"			Proj:ResultSummary[5]:Enduse1[7]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[7]"			Proj:ResultSummary[5]:Enduse2[7]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[7]"			Proj:ResultSummary[5]:Enduse3[7]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[7]"			Proj:ResultSummary[5]:Enduse4[7]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[7]"			Proj:ResultSummary[5]:Enduse5[7]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[7]"			Proj:ResultSummary[5]:Enduse6[7]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[7]"			Proj:ResultSummary[5]:Enduse7[7]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[7]"			Proj:ResultSummary[5]:Enduse8[7]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:StandardTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[7]"			Proj:ResultSummary[5]:Enduse9[7]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:StandardTDV  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[7]"			Proj:ResultSummary[5]:Enduse10[7]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[7]"			Proj:ResultSummary[5]:Enduse11[7]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:StandardTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[7]"			Proj:ResultSummary[5]:Enduse12[7]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:StandardTDV ), 2 )  endif  }
  ; mjb-10/16/13	removed PVCredit from Std Design
;	"Set ResultSummary[5]:Enduse13[7]"			Proj:ResultSummary[5]:Enduse13[7]	= {	FltToStr( PVCredit, 2 )  }
	"Set ResultSummary[5]:Enduse13[7]"			Proj:ResultSummary[5]:Enduse13[7]	= {	" "  }

; mjb-10/16/13	subtract PVCredit from Prop Design - W
	;"Set ResultSummary[5]:Enduse13[4]"			Proj:ResultSummary[5]:Enduse13[4]	= {	FltToStr( (PVCredit[1] * -1), 2 )  }
	"Set ResultSummary[5]:Enduse13[4]"			Proj:ResultSummary[5]:Enduse13[4]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsW[6]:PropPVCreditTDV[1] * -1), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[5]:Enduse10[4]"			Proj:ResultSummary[5]:Enduse10[4]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[4]"			Proj:ResultSummary[5]:Enduse11[4]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:ProposedTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[4]"			Proj:ResultSummary[5]:Enduse12[4]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:ProposedTDV[1] ), 2 )  endif  }
  ; SAC 4/17/15 - copy CompResultsMsg down from Proj into EUseSummary (to ensure that it is carried into subsequent models and back to user input)
	"Set ResultSummary[5]:CompResultsMsg"		Proj:ResultSummary[5]:CompResultsMsg	= {	if (GlobalStatus( Proj:CompResultsMsg ) > 0) then  Proj:CompResultsMsg  else  UNCHANGED  endif  }
  ; SAC 3/3/16 - ensure access to PVMinRatedPower in projects following analysis (tic #609)
	"Set ResultSummary[5]:PVMinRatedPower"		Proj:ResultSummary[5]:PVMinRatedPower	= {	if (IfValidAnd( Proj:PVCompCredit > 0 ) .AND. IfValidAnd( Proj:PVCredit[1] > 0 ) .AND. IfValidAnd( Proj:PVMinRatedPower[2] > 0 ))
																														then  Proj:PVMinRatedPower[2]  else  UNCHANGED  endif  }

  ; Compliance Margin TDV
	"Set ResultSummary[5]:Title1[8]"				Proj:ResultSummary[5]:Title1[8]		= {	"Compliance"  }
	"Set ResultSummary[5]:Title2[8]"				Proj:ResultSummary[5]:Title2[8]		= {	"Margin"  }
	"Set ResultSummary[5]:Title3[8]"				Proj:ResultSummary[5]:Title3[8]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[5]:Enduse1[8]"			Proj:ResultSummary[5]:Enduse1[8]		= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[8]"			Proj:ResultSummary[5]:Enduse2[8]		= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[8]"			Proj:ResultSummary[5]:Enduse3[8]		= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[8]"			Proj:ResultSummary[5]:Enduse4[8]		= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[8]"			Proj:ResultSummary[5]:Enduse5[8]		= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[8]"			Proj:ResultSummary[5]:Enduse6[8]		= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[8]"			Proj:ResultSummary[5]:Enduse7[8]		= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[8]"			Proj:ResultSummary[5]:Enduse8[8]		= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:CompMarginTDV  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[8]"			Proj:ResultSummary[5]:Enduse9[8]		= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:CompMarginTDV  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[8]"			Proj:ResultSummary[5]:Enduse10[8]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[8]"			Proj:ResultSummary[5]:Enduse11[8]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[8]"			Proj:ResultSummary[5]:Enduse12[8]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:CompMarginTDV ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse13[8]"			Proj:ResultSummary[5]:Enduse13[8]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[6]:PropPVCreditTDV[1], 2 )  endif  }
  ; Pass/Fail result
 	"Set ResultSummary[5]:PassFail"				Proj:ResultSummary[5]:PassFail		= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  if (RunResultsW[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }

  ; Standard Electric Demand
	"Set ResultSummary[5]:Title1[11]"			Proj:ResultSummary[5]:Title1[11]		= {	"Standard"  }
	"Set ResultSummary[5]:Title2[11]"			Proj:ResultSummary[5]:Title2[11]		= {	"Design"  }
	"Set ResultSummary[5]:Title3[11]"			Proj:ResultSummary[5]:Title3[11]		= {	"(kW)"  }
	"Set ResultSummary[5]:Enduse1[11]"			Proj:ResultSummary[5]:Enduse1[11]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[11]"			Proj:ResultSummary[5]:Enduse2[11]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[11]"			Proj:ResultSummary[5]:Enduse3[11]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[11]"			Proj:ResultSummary[5]:Enduse4[11]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[11]"			Proj:ResultSummary[5]:Enduse5[11]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[11]"			Proj:ResultSummary[5]:Enduse6[11]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[11]"			Proj:ResultSummary[5]:Enduse7[11]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[11]"			Proj:ResultSummary[5]:Enduse8[11]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:StdElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[11]"			Proj:ResultSummary[5]:Enduse9[11]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:StdElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[11]"			Proj:ResultSummary[5]:Enduse10[11]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[11]"			Proj:ResultSummary[5]:Enduse11[11]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:StdElecDemand ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[11]"			Proj:ResultSummary[5]:Enduse12[11]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:StdElecDemand ), 2 )  endif  }

  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
	"Set ResultSummary[5]:MarginkW"			Proj:ResultSummary[5]:MarginkW		= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
																												else  ValidOr( RunResultsW[10]:StdElecDemand, 0 ) - ValidOr( RunResultsW[10]:PropElecDemand[1], 0 )  endif  }
	"Set ResultSummary[5]:MarginkWh"			Proj:ResultSummary[5]:MarginkWh		= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
																												else  (ValidOr( RunResultsW[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsW[10]:PropElecEnergy[1], 0 )) * CondFloorArea / 3.413  endif  }
	"Set ResultSummary[5]:MarginTherms"		Proj:ResultSummary[5]:MarginTherms	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
																												else  (ValidOr( RunResultsW[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsW[10]:PropNatGasEnergy[1], 0 )) * CondFloorArea / 100  endif  }
  ; Percent Savings values for reporting
	"Set ResultSummary[5]:PctSavingskW"			Proj:ResultSummary[5]:PctSavingskW		= {	if (IfValidAnd( RunResultsW[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
																														else  (RunResultsW[10]:StdElecDemand   - ValidOr( RunResultsW[10]:PropElecDemand[1],   0 )) * 100 / RunResultsW[10]:StdElecDemand    endif  }
	"Set ResultSummary[5]:PctSavingskWh"		Proj:ResultSummary[5]:PctSavingskWh		= {	if (IfValidAnd( RunResultsW[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
																														else  (RunResultsW[10]:StdElecEnergy   - ValidOr( RunResultsW[10]:PropElecEnergy[1],   0 )) * 100 / RunResultsW[10]:StdElecEnergy    endif  }
	"Set ResultSummary[5]:PctSavingsTherms"	Proj:ResultSummary[5]:PctSavingsTherms	= {	if (IfValidAnd( RunResultsW[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
																														else  (RunResultsW[10]:StdNatGasEnergy - ValidOr( RunResultsW[10]:PropNatGasEnergy[1], 0 )) * 100 / RunResultsW[10]:StdNatGasEnergy  endif  }
	"Set ResultSummary[5]:PctSavingsTDV"		Proj:ResultSummary[5]:PctSavingsTDV		= {	if (IfValidAnd( RunResultsW[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  (RunResultsW[10]:StandardTDV     - ValidOr( RunResultsW[10]:ProposedTDV[1],      0 )) * 100 / RunResultsW[10]:StandardTDV      endif  }
	"Set ResultSummary[5]:PctSavingsCmpTDV"	Proj:ResultSummary[5]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResultsW[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
																														else  (RunResultsW[11]:StandardTDV     - ValidOr( RunResultsW[11]:ProposedTDV[1],      0 )) * 100 / RunResultsW[11]:StandardTDV      endif  }
	"Set ResultSummary[5]:PctSavkWLbl"			Proj:ResultSummary[5]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingskW     )  endif  }
	"Set ResultSummary[5]:PctSavkWhLbl"			Proj:ResultSummary[5]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingskWh    )  endif  }
	"Set ResultSummary[5]:PctSavThermsLbl"		Proj:ResultSummary[5]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[5]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsTherms )  endif  }
	"Set ResultSummary[5]:PctSavTDVLbl"			Proj:ResultSummary[5]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsTDV    )  endif  }
	"Set ResultSummary[5]:PctSavCmpTDVLbl"		Proj:ResultSummary[5]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsCmpTDV )  endif  }
	; SAC 3/21/16 - added tier results
	; SAC 5/23/16 - modified to require QII (tic #671)
	"Set ResultSummary[5]:MeetsTier1"			Proj:ResultSummary[5]:MeetsTier1		= {	if (StdDesignBase == 2016 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV >= 14.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
	"Set ResultSummary[5]:MeetsTier2"			Proj:ResultSummary[5]:MeetsTier2		= {	if (StdDesignBase == 2016 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV >= 29.95 ) .AND.
																															IfValidAnd( HERSProj:QII > 0.5 )) then  1  else  0  endif  }
END

;*************************************************************************
RULELIST "CARes_DesignRatingSummary_NESW" 1 0 1 1
;*************************************************************************

;		; Worst case run RunResults[*] all set now, so start by setting up PROPOSED summary data for the worst case run
;		"Call subordinate rulelist to set worst case Proposed summary"		Proj:Action = {	EvalRulelist( "CARes_ProposedSummary_Main" )  }
	; can call generic DesignRatingSummary rulelist to set worst case DesignRating summary data
	"Call subordinate rulelist to set worst case DesignRating summary"		Proj:Action = {	EvalRulelist( "CARes_DesignRatingSummary" )  }

; -- NORTH Facing --
  ; DesignRating Site Electric Use
	"Set ResultSummary[2]:Title1[12]"			Proj:ResultSummary[2]:Title1[12]		= {	"Reference"  }
	"Set ResultSummary[2]:Title2[12]"			Proj:ResultSummary[2]:Title2[12]		= {	"Design"     }
	"Set ResultSummary[2]:Title3[12]"			Proj:ResultSummary[2]:Title3[12]		= {	"Site (kWh)"  }
	"Set ResultSummary[2]:Enduse1[12]"			Proj:ResultSummary[2]:Enduse1[12]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR. RunResultsN[1]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[1]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse2[12]"			Proj:ResultSummary[2]:Enduse2[12]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR. RunResultsN[2]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[2]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse3[12]"			Proj:ResultSummary[2]:Enduse3[12]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR. RunResultsN[3]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[3]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse4[12]"			Proj:ResultSummary[2]:Enduse4[12]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR. RunResultsN[4]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[4]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse5[12]"			Proj:ResultSummary[2]:Enduse5[12]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR. RunResultsN[5]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[5]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse6[12]"			Proj:ResultSummary[2]:Enduse6[12]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. RunResultsN[6]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[6]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse7[12]"			Proj:ResultSummary[2]:Enduse7[12]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR. RunResultsN[7]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[7]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse8[12]"			Proj:ResultSummary[2]:Enduse8[12]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR. RunResultsN[8]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[8]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse9[12]"			Proj:ResultSummary[2]:Enduse9[12]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR. RunResultsN[9]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[9]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse10[12]"			Proj:ResultSummary[2]:Enduse10[12]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. RunResultsN[10]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[10]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse11[12]"			Proj:ResultSummary[2]:Enduse11[12]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. RunResultsN[11]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[11]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse12[12]"			Proj:ResultSummary[2]:Enduse12[12]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. RunResultsN[12]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[12]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
  ; SAC 4/8/15 - refresh lighting and total Proposed results following (possible) resets due to design rating lighting credit reductions
  ; Proposed Site ELEC Use
	"Set ResultSummary[2]:Enduse6[17]"			Proj:ResultSummary[2]:Enduse6[17]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. RunResultsN[6]:PropElecEnergy[2]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[6]:PropElecEnergy[2]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse10[17]"			Proj:ResultSummary[2]:Enduse10[17]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[10]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse11[17]"			Proj:ResultSummary[2]:Enduse11[17]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. RunResultsN[11]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[11]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[2]:Enduse12[17]"			Proj:ResultSummary[2]:Enduse12[17]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. RunResultsN[12]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsN[12]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; Proposed Site FUEL Use
	"Set ResultSummary[2]:Enduse6[18]"			Proj:ResultSummary[2]:Enduse6[18]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR. (RunResultsN[6]:PropNatGasEnergy[2]  < 0.00001 .AND. RunResultsN[6]:PropOtherEnergy[2]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsN[6]:PropNatGasEnergy[2]  + RunResultsN[6]:PropOtherEnergy[2] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse10[18]"			Proj:ResultSummary[2]:Enduse10[18]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR. (RunResultsN[10]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsN[10]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsN[10]:PropNatGasEnergy[2] + RunResultsN[10]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse11[18]"			Proj:ResultSummary[2]:Enduse11[18]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR. (RunResultsN[11]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsN[11]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsN[11]:PropNatGasEnergy[2] + RunResultsN[11]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse12[18]"			Proj:ResultSummary[2]:Enduse12[18]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR. (RunResultsN[12]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsN[12]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsN[12]:PropNatGasEnergy[2] + RunResultsN[12]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Proposed TDV
	"Set ResultSummary[2]:Enduse6[19]"			Proj:ResultSummary[2]:Enduse6[19]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[19]"			Proj:ResultSummary[2]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[19]"			Proj:ResultSummary[2]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[19]"			Proj:ResultSummary[2]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Site Natural Gas Use
	"Set ResultSummary[2]:Title1[13]"			Proj:ResultSummary[2]:Title1[13]		= {	"Reference"  }
	"Set ResultSummary[2]:Title2[13]"			Proj:ResultSummary[2]:Title2[13]		= {	"Design"     }
	"Set ResultSummary[2]:Title3[13]"			Proj:ResultSummary[2]:Title3[13]		= {	"Site (therms)"  }
	"Set ResultSummary[2]:Enduse1[13]"			Proj:ResultSummary[2]:Enduse1[13]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0 .OR.  (RunResultsN[1]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[1]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[1]:DRtgNatGasEnergy  + RunResultsN[1]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse2[13]"			Proj:ResultSummary[2]:Enduse2[13]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0 .OR.  (RunResultsN[2]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[2]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[2]:DRtgNatGasEnergy  + RunResultsN[2]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse3[13]"			Proj:ResultSummary[2]:Enduse3[13]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0 .OR.  (RunResultsN[3]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[3]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[3]:DRtgNatGasEnergy  + RunResultsN[3]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse4[13]"			Proj:ResultSummary[2]:Enduse4[13]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0 .OR.  (RunResultsN[4]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[4]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[4]:DRtgNatGasEnergy  + RunResultsN[4]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse5[13]"			Proj:ResultSummary[2]:Enduse5[13]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0 .OR.  (RunResultsN[5]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[5]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[5]:DRtgNatGasEnergy  + RunResultsN[5]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse6[13]"			Proj:ResultSummary[2]:Enduse6[13]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0 .OR.  (RunResultsN[6]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[6]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[6]:DRtgNatGasEnergy  + RunResultsN[6]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse7[13]"			Proj:ResultSummary[2]:Enduse7[13]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0 .OR.  (RunResultsN[7]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[7]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[7]:DRtgNatGasEnergy  + RunResultsN[7]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse8[13]"			Proj:ResultSummary[2]:Enduse8[13]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0 .OR.  (RunResultsN[8]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[8]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[8]:DRtgNatGasEnergy  + RunResultsN[8]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse9[13]"			Proj:ResultSummary[2]:Enduse9[13]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0 .OR.  (RunResultsN[9]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsN[9]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[9]:DRtgNatGasEnergy  + RunResultsN[9]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse10[13]"			Proj:ResultSummary[2]:Enduse10[13]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0 .OR.  (RunResultsN[10]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsN[10]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[10]:DRtgNatGasEnergy + RunResultsN[10]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse11[13]"			Proj:ResultSummary[2]:Enduse11[13]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0 .OR.  (RunResultsN[11]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsN[11]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[11]:DRtgNatGasEnergy + RunResultsN[11]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[2]:Enduse12[13]"			Proj:ResultSummary[2]:Enduse12[13]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0 .OR.  (RunResultsN[12]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsN[12]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsN[12]:DRtgNatGasEnergy + RunResultsN[12]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; DesignRating TDV
	"Set ResultSummary[2]:Title1[14]"			Proj:ResultSummary[2]:Title1[14]		= {	"Reference"  }
	"Set ResultSummary[2]:Title2[14]"			Proj:ResultSummary[2]:Title2[14]		= {	"Design"     }
	"Set ResultSummary[2]:Title3[14]"			Proj:ResultSummary[2]:Title3[14]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[2]:Enduse1[14]"			Proj:ResultSummary[2]:Enduse1[14]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[14]"			Proj:ResultSummary[2]:Enduse2[14]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[14]"			Proj:ResultSummary[2]:Enduse3[14]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[14]"			Proj:ResultSummary[2]:Enduse4[14]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[14]"			Proj:ResultSummary[2]:Enduse5[14]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[14]"			Proj:ResultSummary[2]:Enduse6[14]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[14]"			Proj:ResultSummary[2]:Enduse7[14]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[14]"			Proj:ResultSummary[2]:Enduse8[14]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[14]"			Proj:ResultSummary[2]:Enduse9[14]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:DesignRatingTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[14]"			Proj:ResultSummary[2]:Enduse10[14]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:DesignRatingTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[14]"			Proj:ResultSummary[2]:Enduse11[14]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:DesignRatingTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[14]"			Proj:ResultSummary[2]:Enduse12[14]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:DesignRatingTDV[1] ), 2 )  endif  }
 ; mjb-10/16/13	removed PVCredit from Std Design
; 	"Set ResultSummary[2]:Enduse13[7]"			Proj:ResultSummary[2]:Enduse13[7]	= {	FltToStr( PVCredit, 2 )  }
 	"Set ResultSummary[2]:Enduse13[7]"			Proj:ResultSummary[2]:Enduse13[7]	= {	" "  }

; mjb-10/16/13	subtract PVCredit from Prop Design - N
	"Set ResultSummary[2]:Enduse13[19]"			Proj:ResultSummary[2]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsN[6]:PropPVCreditTDV[2] * -1), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[2]:Enduse10[19]"			Proj:ResultSummary[2]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[19]"			Proj:ResultSummary[2]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[19]"			Proj:ResultSummary[2]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Margin TDV
	"Set ResultSummary[2]:Title1[15]"			Proj:ResultSummary[2]:Title1[15]		= {	"Design Rating"  }
	"Set ResultSummary[2]:Title2[15]"			Proj:ResultSummary[2]:Title2[15]		= {	"Margin"  }
	"Set ResultSummary[2]:Title3[15]"			Proj:ResultSummary[2]:Title3[15]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[2]:Enduse1[15]"			Proj:ResultSummary[2]:Enduse1[15]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[1]:DesignRatingTDV[1]  - RunResultsN[1]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[15]"			Proj:ResultSummary[2]:Enduse2[15]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[2]:DesignRatingTDV[1]  - RunResultsN[2]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[15]"			Proj:ResultSummary[2]:Enduse3[15]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[3]:DesignRatingTDV[1]  - RunResultsN[3]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[15]"			Proj:ResultSummary[2]:Enduse4[15]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[4]:DesignRatingTDV[1]  - RunResultsN[4]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[15]"			Proj:ResultSummary[2]:Enduse5[15]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[5]:DesignRatingTDV[1]  - RunResultsN[5]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[15]"			Proj:ResultSummary[2]:Enduse6[15]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[6]:DesignRatingTDV[1]  - RunResultsN[6]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[15]"			Proj:ResultSummary[2]:Enduse7[15]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[7]:DesignRatingTDV[1]  - RunResultsN[7]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[15]"			Proj:ResultSummary[2]:Enduse8[15]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[8]:DesignRatingTDV[1]  - RunResultsN[8]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[15]"			Proj:ResultSummary[2]:Enduse9[15]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[9]:DesignRatingTDV[1]  - RunResultsN[9]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[15]"			Proj:ResultSummary[2]:Enduse10[15]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[10]:DesignRatingTDV[1] - RunResultsN[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[15]"			Proj:ResultSummary[2]:Enduse11[15]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[11]:DesignRatingTDV[1] - RunResultsN[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[15]"			Proj:ResultSummary[2]:Enduse12[15]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsN[12]:DesignRatingTDV[1] - RunResultsN[12]:ProposedTDV[2] ), 2 )  endif  }
 	;"Set ResultSummary[2]:Enduse13[15]"			Proj:ResultSummary[2]:Enduse13[15]	= {	FltToStr( PVCredit, 2 )  }
 	"Set ResultSummary[2]:Enduse13[15]"			Proj:ResultSummary[2]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsN[6]:PropPVCreditTDV[2], 2 )  endif  }
;	  ; Pass/Fail result
;	 	"Set ResultSummary[2]:PassFail"				Proj:ResultSummary[2]:PassFail		= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  if (RunResultsN[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }
 	"Set ResultSummary[2]:DesignRating"			Proj:ResultSummary[2]:DesignRating		= {	if (IfValidAnd( RunResultsN[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
 																														else   ValidOr( RunResultsN[10]:ProposedTDV[3], 0 ) * 100 / RunResultsN[10]:DesignRatingTDV[2]  endif  }
 	"Set ResultSummary[2]:DesignRatingNoPV"	Proj:ResultSummary[2]:DesignRatingNoPV	= {	if (IfValidAnd( RunResultsN[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
 																														else  (ValidOr( RunResultsN[10]:ProposedTDV[3], 0 ) + ValidOr( RunResultsN[6]:PropPVCreditTDV[2], 0 )) * 100 / RunResultsN[10]:DesignRatingTDV[2]  endif  }
 	"Set ResultSummary[2]:ShowDesignRtgNoPV"	Proj:ResultSummary[2]:ShowDesignRtgNoPV = {	if (ValidOr( RunResultsN[6]:PropPVCreditTDV[2], 0 ) >= 0.0001) then  1  else  0  endif  }
	; SAC 3/16/16 - added new DesignRatingPVOnly & DesignRatingStd - including detailed calc of DesignRatingStd w/ fuel adjustments to StdTDV results
 	"Set ResultSummary[2]:DesignRatingPVOnly"	Proj:ResultSummary[2]:DesignRatingPVOnly	= {	if (LocalStatus( ResultSummary[2]:DesignRatingNoPV ) < 1 .OR. LocalStatus( ResultSummary[2]:DesignRating ) < 1) then  UNDEFINED
 																															else	ResultSummary[2]:DesignRatingNoPV - ResultSummary[2]:DesignRating  endif  }
 	"Set ResultSummary[2]:DesignRatingStd"		Proj:ResultSummary[2]:DesignRatingStd		= {	if (IfValidAnd( RunResultsN[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
													else	(	RunResultsN[1]:StdElecTDV[1] + RunResultsN[1]:StdNatGasTDV + RunResultsN[1]:StdOtherTDV +  ; SpcHt
															 +	RunResultsN[2]:StdElecTDV[1] + RunResultsN[2]:StdNatGasTDV + RunResultsN[2]:StdOtherTDV +  ; SpcCl
															 +	RunResultsN[3]:StdElecTDV[1]    ; IAQVent
															 +	RunResultsN[4]:StandardTDV[1]   ; OthrHVAC
															 +	RunResultsN[5]:StdElecTDV[1] + RunResultsN[5]:StdNatGasTDV + RunResultsN[5]:StdOtherTDV +  ; WtrHt
															 +	RunResultsN[6]:StandardTDV[1]   ; InsLtg
															 +	RunResultsN[7]:StdElecTDV[1] + RunResultsN[7]:StdNatGasTDV + RunResultsN[7]:StdOtherTDV +  ; AppCkg
															 +	RunResultsN[8]:StandardTDV[1]   ; Plugs
															 +	RunResultsN[9]:StandardTDV[1]   ; Ext
															 +	RunResultsN[13]:StandardTDV[1] ) ; PV
																	* 100 / RunResultsN[10]:DesignRatingTDV[2]    endif  }
; SAC 3/31/16 - revised rules REMOVING application of design rating fuel adjustment multipliers to ProposedTDV (mods made elsewhere to apply inverse adjustment to DR reference TDV)
;													else	(	RunResultsN[1]:StdElecTDV[1] + ((RunResultsN[1]:StdNatGasTDV + RunResultsN[1]:StdOtherTDV) *
;																											CAClimateZoneCodeBase:HtgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; SpcHt
;															 +	RunResultsN[2]:StdElecTDV[1] + ((RunResultsN[2]:StdNatGasTDV + RunResultsN[2]:StdOtherTDV) *
;																											CAClimateZoneCodeBase:ClgDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; SpcCl
;															 +	RunResultsN[3]:StdElecTDV[1]    ; IAQVent
;															 +	RunResultsN[4]:StandardTDV[1]   ; OthrHVAC
;															 +	RunResultsN[5]:StdElecTDV[1] + ((RunResultsN[5]:StdNatGasTDV + RunResultsN[5]:StdOtherTDV) *
;																											CAClimateZoneCodeBase:DHWDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; WtrHt
;															 +	RunResultsN[6]:StandardTDV[1]   ; InsLtg
;															 +	RunResultsN[7]:StdElecTDV[1] + ((RunResultsN[7]:StdNatGasTDV + RunResultsN[7]:StdOtherTDV) *
;																											CAClimateZoneCodeBase:AppDRPFuelTDVMult( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ))  ; AppCkg
;															 +	RunResultsN[8]:StandardTDV[1]   ; Plugs
;															 +	RunResultsN[9]:StandardTDV[1]   ; Ext
;															 +	RunResultsN[13]:StandardTDV[1] ) ; PV
;																	* 100 / RunResultsN[10]:DesignRatingTDV    endif  }

	; SAC 3/25/16 - moved down from Standard results... AND revised MeetsZNETier to require HERSProj:QII & ResultSummary[*]:DesignRating <= 0
	"Set ResultSummary[2]:MeetsZNETier"			Proj:ResultSummary[2]:MeetsZNETier	= {	if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[2]:DesignRating < 0.05 )==0 .OR. IfValidAnd( EDRPVVerified > 0.5 )==0) then  0
																													else if (ResultSummary[2]:MeetsTier2 > 0.5) then  1
																													else if (ResultSummary[2]:MeetsTier1 > 0.5 .AND. IsMultiFamily < 0.5)
																													then  if (CAClimateZoneCodeBase:sfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) < 1.5) then  1  else  0  endif
																													else if (ResultSummary[2]:MeetsTier1 > 0.5 .AND. IsMultiFamily > 0.5)
																													then  if (CAClimateZoneCodeBase:mfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) < 1.5) then  1  else  0  endif
																													else  0  endif endif endif endif  }

  ; DesignRating Electric Demand
	"Set ResultSummary[2]:Title1[16]"			Proj:ResultSummary[2]:Title1[16]		= {	"Reference"  }
	"Set ResultSummary[2]:Title2[16]"			Proj:ResultSummary[2]:Title2[16]		= {	"Design"     }
	"Set ResultSummary[2]:Title3[16]"			Proj:ResultSummary[2]:Title3[16]		= {	"(kW)"  }
	"Set ResultSummary[2]:Enduse1[16]"			Proj:ResultSummary[2]:Enduse1[16]	= {	if (LocalCompAssigned( RunResultsN[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[1]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse2[16]"			Proj:ResultSummary[2]:Enduse2[16]	= {	if (LocalCompAssigned( RunResultsN[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[2]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse3[16]"			Proj:ResultSummary[2]:Enduse3[16]	= {	if (LocalCompAssigned( RunResultsN[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[3]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse4[16]"			Proj:ResultSummary[2]:Enduse4[16]	= {	if (LocalCompAssigned( RunResultsN[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[4]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse5[16]"			Proj:ResultSummary[2]:Enduse5[16]	= {	if (LocalCompAssigned( RunResultsN[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[5]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse6[16]"			Proj:ResultSummary[2]:Enduse6[16]	= {	if (LocalCompAssigned( RunResultsN[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[6]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse7[16]"			Proj:ResultSummary[2]:Enduse7[16]	= {	if (LocalCompAssigned( RunResultsN[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[7]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse8[16]"			Proj:ResultSummary[2]:Enduse8[16]	= {	if (LocalCompAssigned( RunResultsN[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[8]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[2]:Enduse9[16]"			Proj:ResultSummary[2]:Enduse9[16]	= {	if (LocalCompAssigned( RunResultsN[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[9]:DRtgElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse10[16]"			Proj:ResultSummary[2]:Enduse10[16]	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[10]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse11[16]"			Proj:ResultSummary[2]:Enduse11[16]	= {	if (LocalCompAssigned( RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[11]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[2]:Enduse12[16]"			Proj:ResultSummary[2]:Enduse12[16]	= {	if (LocalCompAssigned( RunResultsN[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsN[12]:DRtgElecDemand ), 2 )  endif  }

;	  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
;		"Set ResultSummary[2]:MarginkW"			Proj:ResultSummary[2]:MarginkW		= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
;																													else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsN[10]:PropElecDemand[2], 0 )  endif  }
;		"Set ResultSummary[2]:MarginkWh"			Proj:ResultSummary[2]:MarginkWh		= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsN[10]:PropElecEnergy, 0 )) * CondFloorArea / 3.413  endif  }
;		"Set ResultSummary[2]:MarginTherms"		Proj:ResultSummary[2]:MarginTherms	= {	if (LocalCompAssigned( RunResultsN[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsN[10]:PropNatGasEnergy, 0 )) * CondFloorArea / 100  endif  }
;	  ; Percent Savings values for reporting
;		"Set ResultSummary[2]:PctSavingskW"			Proj:ResultSummary[2]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecDemand   - ValidOr( RunResultsN[10]:PropElecDemand[2],   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
;		"Set ResultSummary[2]:PctSavingskWh"		Proj:ResultSummary[2]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResultsN[10]:PropElecEnergy,   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
;		"Set ResultSummary[2]:PctSavingsTherms"	Proj:ResultSummary[2]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsN[10]:PropNatGasEnergy, 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
;		"Set ResultSummary[2]:PctSavingsTDV"		Proj:ResultSummary[2]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StandardTDV     - ValidOr( RunResultsN[10]:ProposedTDV[2],      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
;		"Set ResultSummary[2]:PctSavingsCmpTDV"	Proj:ResultSummary[2]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[11]:StandardTDV     - ValidOr( RunResultsN[11]:ProposedTDV[2],      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
;		"Set ResultSummary[2]:PctSavkWLbl"			Proj:ResultSummary[2]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingskW     )  endif  }
;		"Set ResultSummary[2]:PctSavkWhLbl"			Proj:ResultSummary[2]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingskWh    )  endif  }
;		"Set ResultSummary[2]:PctSavThermsLbl"		Proj:ResultSummary[2]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[2]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsTherms )  endif  }
;		"Set ResultSummary[2]:PctSavTDVLbl"			Proj:ResultSummary[2]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[2]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsTDV    )  endif  }
;		"Set ResultSummary[2]:PctSavCmpTDVLbl"		Proj:ResultSummary[2]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[2]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[2]:PctSavingsCmpTDV )  endif  }

; -- EAST Facing --
  ; DesignRating Site Electric Use
	"Set ResultSummary[3]:Title1[12]"			Proj:ResultSummary[3]:Title1[12]		= {	"Reference"  }
	"Set ResultSummary[3]:Title2[12]"			Proj:ResultSummary[3]:Title2[12]		= {	"Design"     }
	"Set ResultSummary[3]:Title3[12]"			Proj:ResultSummary[3]:Title3[12]		= {	"Site (kWh)"  }
	"Set ResultSummary[3]:Enduse1[12]"			Proj:ResultSummary[3]:Enduse1[12]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR. RunResultsE[1]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[1]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse2[12]"			Proj:ResultSummary[3]:Enduse2[12]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR. RunResultsE[2]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[2]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse3[12]"			Proj:ResultSummary[3]:Enduse3[12]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR. RunResultsE[3]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[3]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse4[12]"			Proj:ResultSummary[3]:Enduse4[12]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR. RunResultsE[4]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[4]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse5[12]"			Proj:ResultSummary[3]:Enduse5[12]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR. RunResultsE[5]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[5]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse6[12]"			Proj:ResultSummary[3]:Enduse6[12]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. RunResultsE[6]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[6]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse7[12]"			Proj:ResultSummary[3]:Enduse7[12]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR. RunResultsE[7]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[7]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse8[12]"			Proj:ResultSummary[3]:Enduse8[12]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR. RunResultsE[8]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[8]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse9[12]"			Proj:ResultSummary[3]:Enduse9[12]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR. RunResultsE[9]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[9]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse10[12]"			Proj:ResultSummary[3]:Enduse10[12]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. RunResultsE[10]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[10]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse11[12]"			Proj:ResultSummary[3]:Enduse11[12]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. RunResultsE[11]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[11]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse12[12]"			Proj:ResultSummary[3]:Enduse12[12]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. RunResultsE[12]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[12]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
  ; SAC 4/8/15 - refresh lighting and total Proposed results following (possible) resets due to design rating lighting credit reductions
  ; Proposed Site ELEC Use
	"Set ResultSummary[3]:Enduse6[17]"			Proj:ResultSummary[3]:Enduse6[17]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. RunResultsE[6]:PropElecEnergy[2]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[6]:PropElecEnergy[2]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse10[17]"			Proj:ResultSummary[3]:Enduse10[17]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[10]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse11[17]"			Proj:ResultSummary[3]:Enduse11[17]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. RunResultsE[11]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[11]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[3]:Enduse12[17]"			Proj:ResultSummary[3]:Enduse12[17]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. RunResultsE[12]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsE[12]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; Proposed Site FUEL Use
	"Set ResultSummary[3]:Enduse6[18]"			Proj:ResultSummary[3]:Enduse6[18]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR. (RunResultsE[6]:PropNatGasEnergy[2]  < 0.00001 .AND. RunResultsE[6]:PropOtherEnergy[2]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsE[6]:PropNatGasEnergy[2]  + RunResultsE[6]:PropOtherEnergy[2] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse10[18]"			Proj:ResultSummary[3]:Enduse10[18]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR. (RunResultsE[10]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsE[10]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsE[10]:PropNatGasEnergy[2] + RunResultsE[10]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse11[18]"			Proj:ResultSummary[3]:Enduse11[18]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR. (RunResultsE[11]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsE[11]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsE[11]:PropNatGasEnergy[2] + RunResultsE[11]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse12[18]"			Proj:ResultSummary[3]:Enduse12[18]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR. (RunResultsE[12]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsE[12]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsE[12]:PropNatGasEnergy[2] + RunResultsE[12]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Proposed TDV
	"Set ResultSummary[3]:Enduse6[19]"			Proj:ResultSummary[3]:Enduse6[19]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[19]"			Proj:ResultSummary[3]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[19]"			Proj:ResultSummary[3]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[19]"			Proj:ResultSummary[3]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Site Natural Gas Use
	"Set ResultSummary[3]:Title1[13]"			Proj:ResultSummary[3]:Title1[13]		= {	"Reference"  }
	"Set ResultSummary[3]:Title2[13]"			Proj:ResultSummary[3]:Title2[13]		= {	"Design"     }
	"Set ResultSummary[3]:Title3[13]"			Proj:ResultSummary[3]:Title3[13]		= {	"Site (therms)"  }
	"Set ResultSummary[3]:Enduse1[13]"			Proj:ResultSummary[3]:Enduse1[13]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0 .OR.  (RunResultsE[1]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[1]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[1]:DRtgNatGasEnergy  + RunResultsE[1]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse2[13]"			Proj:ResultSummary[3]:Enduse2[13]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0 .OR.  (RunResultsE[2]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[2]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[2]:DRtgNatGasEnergy  + RunResultsE[2]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse3[13]"			Proj:ResultSummary[3]:Enduse3[13]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0 .OR.  (RunResultsE[3]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[3]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[3]:DRtgNatGasEnergy  + RunResultsE[3]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse4[13]"			Proj:ResultSummary[3]:Enduse4[13]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0 .OR.  (RunResultsE[4]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[4]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[4]:DRtgNatGasEnergy  + RunResultsE[4]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse5[13]"			Proj:ResultSummary[3]:Enduse5[13]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0 .OR.  (RunResultsE[5]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[5]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[5]:DRtgNatGasEnergy  + RunResultsE[5]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse6[13]"			Proj:ResultSummary[3]:Enduse6[13]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0 .OR.  (RunResultsE[6]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[6]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[6]:DRtgNatGasEnergy  + RunResultsE[6]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse7[13]"			Proj:ResultSummary[3]:Enduse7[13]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0 .OR.  (RunResultsE[7]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[7]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[7]:DRtgNatGasEnergy  + RunResultsE[7]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse8[13]"			Proj:ResultSummary[3]:Enduse8[13]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0 .OR.  (RunResultsE[8]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[8]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[8]:DRtgNatGasEnergy  + RunResultsE[8]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse9[13]"			Proj:ResultSummary[3]:Enduse9[13]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0 .OR.  (RunResultsE[9]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsE[9]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[9]:DRtgNatGasEnergy  + RunResultsE[9]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse10[13]"			Proj:ResultSummary[3]:Enduse10[13]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0 .OR.  (RunResultsE[10]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsE[10]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[10]:DRtgNatGasEnergy + RunResultsE[10]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse11[13]"			Proj:ResultSummary[3]:Enduse11[13]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0 .OR.  (RunResultsE[11]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsE[11]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[11]:DRtgNatGasEnergy + RunResultsE[11]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[3]:Enduse12[13]"			Proj:ResultSummary[3]:Enduse12[13]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0 .OR.  (RunResultsE[12]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsE[12]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsE[12]:DRtgNatGasEnergy + RunResultsE[12]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; DesignRating TDV
	"Set ResultSummary[3]:Title1[14]"			Proj:ResultSummary[3]:Title1[14]		= {	"Reference"  }
	"Set ResultSummary[3]:Title2[14]"			Proj:ResultSummary[3]:Title2[14]		= {	"Design"     }
	"Set ResultSummary[3]:Title3[14]"			Proj:ResultSummary[3]:Title3[14]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[3]:Enduse1[14]"			Proj:ResultSummary[3]:Enduse1[14]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[14]"			Proj:ResultSummary[3]:Enduse2[14]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[14]"			Proj:ResultSummary[3]:Enduse3[14]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[14]"			Proj:ResultSummary[3]:Enduse4[14]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[14]"			Proj:ResultSummary[3]:Enduse5[14]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[14]"			Proj:ResultSummary[3]:Enduse6[14]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[14]"			Proj:ResultSummary[3]:Enduse7[14]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[14]"			Proj:ResultSummary[3]:Enduse8[14]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[14]"			Proj:ResultSummary[3]:Enduse9[14]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:DesignRatingTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[14]"			Proj:ResultSummary[3]:Enduse10[14]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:DesignRatingTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[14]"			Proj:ResultSummary[3]:Enduse11[14]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:DesignRatingTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[14]"			Proj:ResultSummary[3]:Enduse12[14]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:DesignRatingTDV[1] ), 2 )  endif  }
 ; mjb-10/16/13	removed PVCredit from Std Design
;	"Set ResultSummary[3]:Enduse13[7]"			Proj:ResultSummary[3]:Enduse13[7]	= {	FltToStr( PVCredit, 2 )  }
	"Set ResultSummary[3]:Enduse13[7]"			Proj:ResultSummary[3]:Enduse13[7]	= {	" "  }

; mjb-10/16/13	subtract PVCredit from Prop Design - E
	;"Set ResultSummary[3]:Enduse13[4]"			Proj:ResultSummary[3]:Enduse13[4]	= {	FltToStr( (PVCredit * -1), 2 )  }
	"Set ResultSummary[3]:Enduse13[19]"			Proj:ResultSummary[3]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsE[6]:PropPVCreditTDV[2] * -1), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[3]:Enduse10[19]"			Proj:ResultSummary[3]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[19]"			Proj:ResultSummary[3]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[19]"			Proj:ResultSummary[3]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Margin TDV
	"Set ResultSummary[3]:Title1[15]"			Proj:ResultSummary[3]:Title1[15]		= {	"Design Rating"  }
	"Set ResultSummary[3]:Title2[15]"			Proj:ResultSummary[3]:Title2[15]		= {	"Margin"  }
	"Set ResultSummary[3]:Title3[15]"			Proj:ResultSummary[3]:Title3[15]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[3]:Enduse1[15]"			Proj:ResultSummary[3]:Enduse1[15]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[1]:DesignRatingTDV[1]  - RunResultsE[1]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[15]"			Proj:ResultSummary[3]:Enduse2[15]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[2]:DesignRatingTDV[1]  - RunResultsE[2]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[15]"			Proj:ResultSummary[3]:Enduse3[15]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[3]:DesignRatingTDV[1]  - RunResultsE[3]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[15]"			Proj:ResultSummary[3]:Enduse4[15]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[4]:DesignRatingTDV[1]  - RunResultsE[4]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[15]"			Proj:ResultSummary[3]:Enduse5[15]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[5]:DesignRatingTDV[1]  - RunResultsE[5]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[15]"			Proj:ResultSummary[3]:Enduse6[15]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[6]:DesignRatingTDV[1]  - RunResultsE[6]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[15]"			Proj:ResultSummary[3]:Enduse7[15]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[7]:DesignRatingTDV[1]  - RunResultsE[7]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[15]"			Proj:ResultSummary[3]:Enduse8[15]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[8]:DesignRatingTDV[1]  - RunResultsE[8]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[15]"			Proj:ResultSummary[3]:Enduse9[15]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[9]:DesignRatingTDV[1]  - RunResultsE[9]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[15]"			Proj:ResultSummary[3]:Enduse10[15]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[10]:DesignRatingTDV[1] - RunResultsE[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[15]"			Proj:ResultSummary[3]:Enduse11[15]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[11]:DesignRatingTDV[1] - RunResultsE[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[15]"			Proj:ResultSummary[3]:Enduse12[15]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsE[12]:DesignRatingTDV[1] - RunResultsE[12]:ProposedTDV[2] ), 2 )  endif  }
 	;"Set ResultSummary[3]:Enduse13[15]"			Proj:ResultSummary[3]:Enduse13[15]	= {	FltToStr( PVCredit, 2 )  }
 	"Set ResultSummary[3]:Enduse13[15]"			Proj:ResultSummary[3]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsE[6]:PropPVCreditTDV[2], 2 )  endif  }
;	  ; Pass/Fail result
;	 	"Set ResultSummary[3]:PassFail"				Proj:ResultSummary[3]:PassFail		= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  if (RunResultsE[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }
 	"Set ResultSummary[3]:DesignRating"			Proj:ResultSummary[3]:DesignRating		= {	if (IfValidAnd( RunResultsE[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
 																														else   ValidOr( RunResultsE[10]:ProposedTDV[3], 0 ) * 100 / RunResultsE[10]:DesignRatingTDV[2]  endif  }
 	"Set ResultSummary[3]:DesignRatingNoPV"	Proj:ResultSummary[3]:DesignRatingNoPV	= {	if (IfValidAnd( RunResultsE[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
 																														else  (ValidOr( RunResultsE[10]:ProposedTDV[3], 0 ) + ValidOr( RunResultsE[6]:PropPVCreditTDV[2], 0 )) * 100 / RunResultsE[10]:DesignRatingTDV[2]  endif  }
 	"Set ResultSummary[3]:ShowDesignRtgNoPV"	Proj:ResultSummary[3]:ShowDesignRtgNoPV = {	if (ValidOr( RunResultsE[6]:PropPVCreditTDV[2], 0 ) >= 0.0001) then  1  else  0  endif  }
	; SAC 3/16/16 - added new DesignRatingPVOnly & DesignRatingStd 
 	"Set ResultSummary[3]:DesignRatingPVOnly"	Proj:ResultSummary[3]:DesignRatingPVOnly	= {	if (LocalStatus( ResultSummary[3]:DesignRatingNoPV ) < 1 .OR. LocalStatus( ResultSummary[3]:DesignRating ) < 1) then  UNDEFINED
 																															else	ResultSummary[3]:DesignRatingNoPV - ResultSummary[3]:DesignRating  endif  }
 	"Set ResultSummary[3]:DesignRatingStd"		Proj:ResultSummary[3]:DesignRatingStd		= {	ResultSummary[2]:DesignRatingStd  }		; no orientation variation in Std or DsgnRtg runs...
	; SAC 3/25/16 - moved down from Standard results... AND revised MeetsZNETier to require HERSProj:QII & ResultSummary[*]:DesignRating <= 0
	"Set ResultSummary[3]:MeetsZNETier"			Proj:ResultSummary[3]:MeetsZNETier	= {	if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[3]:DesignRating < 0.05 )==0 .OR. IfValidAnd( EDRPVVerified > 0.5 )==0) then  0
																													else if (ResultSummary[3]:MeetsTier2 > 0.5) then  1
																													else if (ResultSummary[3]:MeetsTier1 > 0.5 .AND. IsMultiFamily < 0.5)
																													then  if (CAClimateZoneCodeBase:sfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) < 1.5) then  1  else  0  endif
																													else if (ResultSummary[3]:MeetsTier1 > 0.5 .AND. IsMultiFamily > 0.5)
																													then  if (CAClimateZoneCodeBase:mfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) < 1.5) then  1  else  0  endif
																													else  0  endif endif endif endif  }

  ; DesignRating Electric Demand
	"Set ResultSummary[3]:Title1[16]"			Proj:ResultSummary[3]:Title1[16]		= {	"Reference"  }
	"Set ResultSummary[3]:Title2[16]"			Proj:ResultSummary[3]:Title2[16]		= {	"Design"     }
	"Set ResultSummary[3]:Title3[16]"			Proj:ResultSummary[3]:Title3[16]		= {	"(kW)"  }
	"Set ResultSummary[3]:Enduse1[16]"			Proj:ResultSummary[3]:Enduse1[16]	= {	if (LocalCompAssigned( RunResultsE[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[1]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse2[16]"			Proj:ResultSummary[3]:Enduse2[16]	= {	if (LocalCompAssigned( RunResultsE[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[2]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse3[16]"			Proj:ResultSummary[3]:Enduse3[16]	= {	if (LocalCompAssigned( RunResultsE[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[3]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse4[16]"			Proj:ResultSummary[3]:Enduse4[16]	= {	if (LocalCompAssigned( RunResultsE[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[4]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse5[16]"			Proj:ResultSummary[3]:Enduse5[16]	= {	if (LocalCompAssigned( RunResultsE[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[5]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse6[16]"			Proj:ResultSummary[3]:Enduse6[16]	= {	if (LocalCompAssigned( RunResultsE[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[6]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse7[16]"			Proj:ResultSummary[3]:Enduse7[16]	= {	if (LocalCompAssigned( RunResultsE[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[7]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse8[16]"			Proj:ResultSummary[3]:Enduse8[16]	= {	if (LocalCompAssigned( RunResultsE[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[8]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[3]:Enduse9[16]"			Proj:ResultSummary[3]:Enduse9[16]	= {	if (LocalCompAssigned( RunResultsE[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[9]:DRtgElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse10[16]"			Proj:ResultSummary[3]:Enduse10[16]	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[10]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse11[16]"			Proj:ResultSummary[3]:Enduse11[16]	= {	if (LocalCompAssigned( RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[11]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[3]:Enduse12[16]"			Proj:ResultSummary[3]:Enduse12[16]	= {	if (LocalCompAssigned( RunResultsE[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsE[12]:DRtgElecDemand ), 2 )  endif  }

;	  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
;		"Set ResultSummary[3]:MarginkW"			Proj:ResultSummary[3]:MarginkW		= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
;																													else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsE[10]:PropElecDemand[2], 0 )  endif  }
;		"Set ResultSummary[3]:MarginkWh"			Proj:ResultSummary[3]:MarginkWh		= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsE[10]:PropElecEnergy, 0 )) * CondFloorArea / 3.413  endif  }
;		"Set ResultSummary[3]:MarginTherms"		Proj:ResultSummary[3]:MarginTherms	= {	if (LocalCompAssigned( RunResultsE[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsE[10]:PropNatGasEnergy, 0 )) * CondFloorArea / 100  endif  }
;	  ; Percent Savings values for reporting
;		"Set ResultSummary[3]:PctSavingskW"			Proj:ResultSummary[3]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecDemand   - ValidOr( RunResultsE[10]:PropElecDemand[2],   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
;		"Set ResultSummary[3]:PctSavingskWh"		Proj:ResultSummary[3]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResultsE[10]:PropElecEnergy,   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
;		"Set ResultSummary[3]:PctSavingsTherms"	Proj:ResultSummary[3]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsE[10]:PropNatGasEnergy, 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
;		"Set ResultSummary[3]:PctSavingsTDV"		Proj:ResultSummary[3]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StandardTDV     - ValidOr( RunResultsE[10]:ProposedTDV[2],      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
;		"Set ResultSummary[3]:PctSavingsCmpTDV"	Proj:ResultSummary[3]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[11]:StandardTDV     - ValidOr( RunResultsE[11]:ProposedTDV[2],      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
;		"Set ResultSummary[3]:PctSavkWLbl"			Proj:ResultSummary[3]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingskW     )  endif  }
;		"Set ResultSummary[3]:PctSavkWhLbl"			Proj:ResultSummary[3]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingskWh    )  endif  }
;		"Set ResultSummary[3]:PctSavThermsLbl"		Proj:ResultSummary[3]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[3]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsTherms )  endif  }
;		"Set ResultSummary[3]:PctSavTDVLbl"			Proj:ResultSummary[3]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[3]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsTDV    )  endif  }
;		"Set ResultSummary[3]:PctSavCmpTDVLbl"		Proj:ResultSummary[3]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[3]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[3]:PctSavingsCmpTDV )  endif  }

; -- SOUTH Facing --
  ; DesignRating Site Electric Use
	"Set ResultSummary[4]:Title1[12]"			Proj:ResultSummary[4]:Title1[12]		= {	"Reference"  }
	"Set ResultSummary[4]:Title2[12]"			Proj:ResultSummary[4]:Title2[12]		= {	"Design"     }
	"Set ResultSummary[4]:Title3[12]"			Proj:ResultSummary[4]:Title3[12]		= {	"Site (kWh)"  }
	"Set ResultSummary[4]:Enduse1[12]"			Proj:ResultSummary[4]:Enduse1[12]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR. RunResultsS[1]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[1]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse2[12]"			Proj:ResultSummary[4]:Enduse2[12]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR. RunResultsS[2]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[2]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse3[12]"			Proj:ResultSummary[4]:Enduse3[12]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR. RunResultsS[3]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[3]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse4[12]"			Proj:ResultSummary[4]:Enduse4[12]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR. RunResultsS[4]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[4]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse5[12]"			Proj:ResultSummary[4]:Enduse5[12]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR. RunResultsS[5]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[5]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse6[12]"			Proj:ResultSummary[4]:Enduse6[12]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. RunResultsS[6]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[6]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse7[12]"			Proj:ResultSummary[4]:Enduse7[12]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR. RunResultsS[7]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[7]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse8[12]"			Proj:ResultSummary[4]:Enduse8[12]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR. RunResultsS[8]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[8]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse9[12]"			Proj:ResultSummary[4]:Enduse9[12]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR. RunResultsS[9]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[9]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse10[12]"			Proj:ResultSummary[4]:Enduse10[12]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. RunResultsS[10]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[10]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse11[12]"			Proj:ResultSummary[4]:Enduse11[12]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. RunResultsS[11]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[11]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse12[12]"			Proj:ResultSummary[4]:Enduse12[12]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. RunResultsS[12]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[12]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
  ; SAC 4/8/15 - refresh lighting and total Proposed results following (possible) resets due to design rating lighting credit reductions
  ; Proposed Site ELEC Use
	"Set ResultSummary[4]:Enduse6[17]"			Proj:ResultSummary[4]:Enduse6[17]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. RunResultsS[6]:PropElecEnergy[2]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[6]:PropElecEnergy[2]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse10[17]"			Proj:ResultSummary[4]:Enduse10[17]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[10]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse11[17]"			Proj:ResultSummary[4]:Enduse11[17]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. RunResultsS[11]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[11]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[4]:Enduse12[17]"			Proj:ResultSummary[4]:Enduse12[17]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. RunResultsS[12]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsS[12]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; Proposed Site FUEL Use
	"Set ResultSummary[4]:Enduse6[18]"			Proj:ResultSummary[4]:Enduse6[18]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR. (RunResultsS[6]:PropNatGasEnergy[2]  < 0.00001 .AND. RunResultsS[6]:PropOtherEnergy[2]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsS[6]:PropNatGasEnergy[2]  + RunResultsS[6]:PropOtherEnergy[2] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse10[18]"			Proj:ResultSummary[4]:Enduse10[18]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR. (RunResultsS[10]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsS[10]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsS[10]:PropNatGasEnergy[2] + RunResultsS[10]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse11[18]"			Proj:ResultSummary[4]:Enduse11[18]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR. (RunResultsS[11]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsS[11]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsS[11]:PropNatGasEnergy[2] + RunResultsS[11]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse12[18]"			Proj:ResultSummary[4]:Enduse12[18]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR. (RunResultsS[12]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsS[12]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsS[12]:PropNatGasEnergy[2] + RunResultsS[12]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Proposed TDV
	"Set ResultSummary[4]:Enduse6[19]"			Proj:ResultSummary[4]:Enduse6[19]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[19]"			Proj:ResultSummary[4]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[19]"			Proj:ResultSummary[4]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[19]"			Proj:ResultSummary[4]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Site Natural Gas Use
	"Set ResultSummary[4]:Title1[13]"			Proj:ResultSummary[4]:Title1[13]		= {	"Reference"  }
	"Set ResultSummary[4]:Title2[13]"			Proj:ResultSummary[4]:Title2[13]		= {	"Design"     }
	"Set ResultSummary[4]:Title3[13]"			Proj:ResultSummary[4]:Title3[13]		= {	"Site (therms)"  }
	"Set ResultSummary[4]:Enduse1[13]"			Proj:ResultSummary[4]:Enduse1[13]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0 .OR.  (RunResultsS[1]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[1]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[1]:DRtgNatGasEnergy  + RunResultsS[1]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse2[13]"			Proj:ResultSummary[4]:Enduse2[13]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0 .OR.  (RunResultsS[2]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[2]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[2]:DRtgNatGasEnergy  + RunResultsS[2]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse3[13]"			Proj:ResultSummary[4]:Enduse3[13]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0 .OR.  (RunResultsS[3]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[3]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[3]:DRtgNatGasEnergy  + RunResultsS[3]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse4[13]"			Proj:ResultSummary[4]:Enduse4[13]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0 .OR.  (RunResultsS[4]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[4]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[4]:DRtgNatGasEnergy  + RunResultsS[4]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse5[13]"			Proj:ResultSummary[4]:Enduse5[13]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0 .OR.  (RunResultsS[5]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[5]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[5]:DRtgNatGasEnergy  + RunResultsS[5]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse6[13]"			Proj:ResultSummary[4]:Enduse6[13]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0 .OR.  (RunResultsS[6]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[6]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[6]:DRtgNatGasEnergy  + RunResultsS[6]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse7[13]"			Proj:ResultSummary[4]:Enduse7[13]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0 .OR.  (RunResultsS[7]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[7]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[7]:DRtgNatGasEnergy  + RunResultsS[7]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse8[13]"			Proj:ResultSummary[4]:Enduse8[13]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0 .OR.  (RunResultsS[8]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[8]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[8]:DRtgNatGasEnergy  + RunResultsS[8]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse9[13]"			Proj:ResultSummary[4]:Enduse9[13]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0 .OR.  (RunResultsS[9]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsS[9]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[9]:DRtgNatGasEnergy  + RunResultsS[9]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse10[13]"			Proj:ResultSummary[4]:Enduse10[13]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0 .OR.  (RunResultsS[10]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsS[10]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[10]:DRtgNatGasEnergy + RunResultsS[10]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse11[13]"			Proj:ResultSummary[4]:Enduse11[13]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0 .OR.  (RunResultsS[11]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsS[11]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[11]:DRtgNatGasEnergy + RunResultsS[11]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[4]:Enduse12[13]"			Proj:ResultSummary[4]:Enduse12[13]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0 .OR.  (RunResultsS[12]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsS[12]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsS[12]:DRtgNatGasEnergy + RunResultsS[12]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; DesignRating TDV
	"Set ResultSummary[4]:Title1[14]"			Proj:ResultSummary[4]:Title1[14]		= {	"Reference"  }
	"Set ResultSummary[4]:Title2[14]"			Proj:ResultSummary[4]:Title2[14]		= {	"Design"     }
	"Set ResultSummary[4]:Title3[14]"			Proj:ResultSummary[4]:Title3[14]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[4]:Enduse1[14]"			Proj:ResultSummary[4]:Enduse1[14]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[14]"			Proj:ResultSummary[4]:Enduse2[14]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[14]"			Proj:ResultSummary[4]:Enduse3[14]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[14]"			Proj:ResultSummary[4]:Enduse4[14]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[14]"			Proj:ResultSummary[4]:Enduse5[14]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[14]"			Proj:ResultSummary[4]:Enduse6[14]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[14]"			Proj:ResultSummary[4]:Enduse7[14]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[14]"			Proj:ResultSummary[4]:Enduse8[14]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[14]"			Proj:ResultSummary[4]:Enduse9[14]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:DesignRatingTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[14]"			Proj:ResultSummary[4]:Enduse10[14]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:DesignRatingTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[14]"			Proj:ResultSummary[4]:Enduse11[14]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:DesignRatingTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[14]"			Proj:ResultSummary[4]:Enduse12[14]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:DesignRatingTDV[1] ), 2 )  endif  }
 ; mjb-10/16/13	removed PVCredit from Std Design
;	"Set ResultSummary[4]:Enduse13[7]"			Proj:ResultSummary[4]:Enduse13[7]	= {	FltToStr( PVCredit, 2 )  }
	"Set ResultSummary[4]:Enduse13[7]"			Proj:ResultSummary[4]:Enduse13[7]	= {	" "  }

; mjb-10/16/13	subtract PVCredit from Prop Design - S
	;"Set ResultSummary[4]:Enduse13[4]"			Proj:ResultSummary[4]:Enduse13[4]	= {	FltToStr( (PVCredit * -1), 2 )  }
	"Set ResultSummary[4]:Enduse13[19]"			Proj:ResultSummary[4]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsS[6]:PropPVCreditTDV[2] * -1), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[4]:Enduse10[19]"			Proj:ResultSummary[4]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[19]"			Proj:ResultSummary[4]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[19]"			Proj:ResultSummary[4]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Margin TDV
	"Set ResultSummary[4]:Title1[15]"			Proj:ResultSummary[4]:Title1[15]		= {	"Design Rating"  }
	"Set ResultSummary[4]:Title2[15]"			Proj:ResultSummary[4]:Title2[15]		= {	"Margin"  }
	"Set ResultSummary[4]:Title3[15]"			Proj:ResultSummary[4]:Title3[15]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[4]:Enduse1[15]"			Proj:ResultSummary[4]:Enduse1[15]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[1]:DesignRatingTDV[1]  - RunResultsS[1]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[15]"			Proj:ResultSummary[4]:Enduse2[15]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[2]:DesignRatingTDV[1]  - RunResultsS[2]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[15]"			Proj:ResultSummary[4]:Enduse3[15]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[3]:DesignRatingTDV[1]  - RunResultsS[3]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[15]"			Proj:ResultSummary[4]:Enduse4[15]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[4]:DesignRatingTDV[1]  - RunResultsS[4]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[15]"			Proj:ResultSummary[4]:Enduse5[15]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[5]:DesignRatingTDV[1]  - RunResultsS[5]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[15]"			Proj:ResultSummary[4]:Enduse6[15]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[6]:DesignRatingTDV[1]  - RunResultsS[6]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[15]"			Proj:ResultSummary[4]:Enduse7[15]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[7]:DesignRatingTDV[1]  - RunResultsS[7]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[15]"			Proj:ResultSummary[4]:Enduse8[15]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[8]:DesignRatingTDV[1]  - RunResultsS[8]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[15]"			Proj:ResultSummary[4]:Enduse9[15]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[9]:DesignRatingTDV[1]  - RunResultsS[9]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[15]"			Proj:ResultSummary[4]:Enduse10[15]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[10]:DesignRatingTDV[1] - RunResultsS[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[15]"			Proj:ResultSummary[4]:Enduse11[15]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[11]:DesignRatingTDV[1] - RunResultsS[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[15]"			Proj:ResultSummary[4]:Enduse12[15]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsS[12]:DesignRatingTDV[1] - RunResultsS[12]:ProposedTDV[2] ), 2 )  endif  }
 	;"Set ResultSummary[4]:Enduse13[15]"			Proj:ResultSummary[4]:Enduse13[15]	= {	FltToStr( PVCredit, 2 )  }
 	"Set ResultSummary[4]:Enduse13[15]"			Proj:ResultSummary[4]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsS[6]:PropPVCreditTDV[2], 2 )  endif  }
;	  ; Pass/Fail result
;	 	"Set ResultSummary[4]:PassFail"				Proj:ResultSummary[4]:PassFail		= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  if (RunResultsS[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }
 	"Set ResultSummary[4]:DesignRating"			Proj:ResultSummary[4]:DesignRating		= {	if (IfValidAnd( RunResultsS[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
 																														else   ValidOr( RunResultsS[10]:ProposedTDV[3], 0 ) * 100 / RunResultsS[10]:DesignRatingTDV[2]  endif  }
 	"Set ResultSummary[4]:DesignRatingNoPV"	Proj:ResultSummary[4]:DesignRatingNoPV	= {	if (IfValidAnd( RunResultsS[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
 																														else  (ValidOr( RunResultsS[10]:ProposedTDV[3], 0 ) + ValidOr( RunResultsS[6]:PropPVCreditTDV[2], 0 )) * 100 / RunResultsS[10]:DesignRatingTDV[2]  endif  }
 	"Set ResultSummary[4]:ShowDesignRtgNoPV"	Proj:ResultSummary[4]:ShowDesignRtgNoPV = {	if (ValidOr( RunResultsS[6]:PropPVCreditTDV[2], 0 ) >= 0.0001) then  1  else  0  endif  }
	; SAC 3/16/16 - added new DesignRatingPVOnly & DesignRatingStd 
 	"Set ResultSummary[4]:DesignRatingPVOnly"	Proj:ResultSummary[4]:DesignRatingPVOnly	= {	if (LocalStatus( ResultSummary[4]:DesignRatingNoPV ) < 1 .OR. LocalStatus( ResultSummary[4]:DesignRating ) < 1) then  UNDEFINED
 																															else	ResultSummary[4]:DesignRatingNoPV - ResultSummary[4]:DesignRating  endif  }
 	"Set ResultSummary[4]:DesignRatingStd"		Proj:ResultSummary[4]:DesignRatingStd		= {	ResultSummary[3]:DesignRatingStd  }
	; SAC 3/25/16 - moved down from Standard results... AND revised MeetsZNETier to require HERSProj:QII & ResultSummary[*]:DesignRating <= 0
	"Set ResultSummary[4]:MeetsZNETier"			Proj:ResultSummary[4]:MeetsZNETier	= {	if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[4]:DesignRating < 0.05 )==0 .OR. IfValidAnd( EDRPVVerified > 0.5 )==0) then  0
																													else if (ResultSummary[4]:MeetsTier2 > 0.5) then  1
																													else if (ResultSummary[4]:MeetsTier1 > 0.5 .AND. IsMultiFamily < 0.5)
																													then  if (CAClimateZoneCodeBase:sfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) < 1.5) then  1  else  0  endif
																													else if (ResultSummary[4]:MeetsTier1 > 0.5 .AND. IsMultiFamily > 0.5)
																													then  if (CAClimateZoneCodeBase:mfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) < 1.5) then  1  else  0  endif
																													else  0  endif endif endif endif  }

  ; DesignRating Electric Demand
	"Set ResultSummary[4]:Title1[16]"			Proj:ResultSummary[4]:Title1[16]		= {	"Reference"  }
	"Set ResultSummary[4]:Title2[16]"			Proj:ResultSummary[4]:Title2[16]		= {	"Design"     }
	"Set ResultSummary[4]:Title3[16]"			Proj:ResultSummary[4]:Title3[16]		= {	"(kW)"  }
	"Set ResultSummary[4]:Enduse1[16]"			Proj:ResultSummary[4]:Enduse1[16]	= {	if (LocalCompAssigned( RunResultsS[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[1]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse2[16]"			Proj:ResultSummary[4]:Enduse2[16]	= {	if (LocalCompAssigned( RunResultsS[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[2]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse3[16]"			Proj:ResultSummary[4]:Enduse3[16]	= {	if (LocalCompAssigned( RunResultsS[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[3]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse4[16]"			Proj:ResultSummary[4]:Enduse4[16]	= {	if (LocalCompAssigned( RunResultsS[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[4]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse5[16]"			Proj:ResultSummary[4]:Enduse5[16]	= {	if (LocalCompAssigned( RunResultsS[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[5]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse6[16]"			Proj:ResultSummary[4]:Enduse6[16]	= {	if (LocalCompAssigned( RunResultsS[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[6]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse7[16]"			Proj:ResultSummary[4]:Enduse7[16]	= {	if (LocalCompAssigned( RunResultsS[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[7]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse8[16]"			Proj:ResultSummary[4]:Enduse8[16]	= {	if (LocalCompAssigned( RunResultsS[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[8]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[4]:Enduse9[16]"			Proj:ResultSummary[4]:Enduse9[16]	= {	if (LocalCompAssigned( RunResultsS[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[9]:DRtgElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse10[16]"			Proj:ResultSummary[4]:Enduse10[16]	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[10]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse11[16]"			Proj:ResultSummary[4]:Enduse11[16]	= {	if (LocalCompAssigned( RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[11]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[4]:Enduse12[16]"			Proj:ResultSummary[4]:Enduse12[16]	= {	if (LocalCompAssigned( RunResultsS[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsS[12]:DRtgElecDemand ), 2 )  endif  }

;	  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
;		"Set ResultSummary[4]:MarginkW"			Proj:ResultSummary[4]:MarginkW		= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
;																													else  ValidOr( RunResults[10]:StdElecDemand, 0 ) - ValidOr( RunResultsS[10]:PropElecDemand[2], 0 )  endif  }
;		"Set ResultSummary[4]:MarginkWh"			Proj:ResultSummary[4]:MarginkWh		= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsS[10]:PropElecEnergy, 0 )) * CondFloorArea / 3.413  endif  }
;		"Set ResultSummary[4]:MarginTherms"		Proj:ResultSummary[4]:MarginTherms	= {	if (LocalCompAssigned( RunResultsS[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResults[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsS[10]:PropNatGasEnergy, 0 )) * CondFloorArea / 100  endif  }
;	  ; Percent Savings values for reporting
;		"Set ResultSummary[4]:PctSavingskW"			Proj:ResultSummary[4]:PctSavingskW		= {	if (IfValidAnd( RunResults[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecDemand   - ValidOr( RunResultsS[10]:PropElecDemand[2],   0 )) * 100 / RunResults[10]:StdElecDemand    endif  }
;		"Set ResultSummary[4]:PctSavingskWh"		Proj:ResultSummary[4]:PctSavingskWh		= {	if (IfValidAnd( RunResults[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdElecEnergy   - ValidOr( RunResultsS[10]:PropElecEnergy,   0 )) * 100 / RunResults[10]:StdElecEnergy    endif  }
;		"Set ResultSummary[4]:PctSavingsTherms"	Proj:ResultSummary[4]:PctSavingsTherms	= {	if (IfValidAnd( RunResults[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StdNatGasEnergy - ValidOr( RunResultsS[10]:PropNatGasEnergy, 0 )) * 100 / RunResults[10]:StdNatGasEnergy  endif  }
;		"Set ResultSummary[4]:PctSavingsTDV"		Proj:ResultSummary[4]:PctSavingsTDV		= {	if (IfValidAnd( RunResults[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[10]:StandardTDV     - ValidOr( RunResultsS[10]:ProposedTDV[2],      0 )) * 100 / RunResults[10]:StandardTDV      endif  }
;		"Set ResultSummary[4]:PctSavingsCmpTDV"	Proj:ResultSummary[4]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResults[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResults[11]:StandardTDV     - ValidOr( RunResultsS[11]:ProposedTDV[2],      0 )) * 100 / RunResults[11]:StandardTDV      endif  }
;		"Set ResultSummary[4]:PctSavkWLbl"			Proj:ResultSummary[4]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingskW     )  endif  }
;		"Set ResultSummary[4]:PctSavkWhLbl"			Proj:ResultSummary[4]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingskWh    )  endif  }
;		"Set ResultSummary[4]:PctSavThermsLbl"		Proj:ResultSummary[4]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[4]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsTherms )  endif  }
;		"Set ResultSummary[4]:PctSavTDVLbl"			Proj:ResultSummary[4]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[4]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsTDV    )  endif  }
;		"Set ResultSummary[4]:PctSavCmpTDVLbl"		Proj:ResultSummary[4]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[4]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[4]:PctSavingsCmpTDV )  endif  }

; -- WEST Facing --
  ; DesignRating Site Electric Use
	"Set ResultSummary[5]:Title1[12]"			Proj:ResultSummary[5]:Title1[12]		= {	"Reference"  }
	"Set ResultSummary[5]:Title2[12]"			Proj:ResultSummary[5]:Title2[12]		= {	"Design"     }
	"Set ResultSummary[5]:Title3[12]"			Proj:ResultSummary[5]:Title3[12]		= {	"Site (kWh)"  }
	"Set ResultSummary[5]:Enduse1[12]"			Proj:ResultSummary[5]:Enduse1[12]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR. RunResultsW[1]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[1]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse2[12]"			Proj:ResultSummary[5]:Enduse2[12]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR. RunResultsW[2]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[2]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse3[12]"			Proj:ResultSummary[5]:Enduse3[12]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR. RunResultsW[3]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[3]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse4[12]"			Proj:ResultSummary[5]:Enduse4[12]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR. RunResultsW[4]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[4]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse5[12]"			Proj:ResultSummary[5]:Enduse5[12]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR. RunResultsW[5]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[5]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse6[12]"			Proj:ResultSummary[5]:Enduse6[12]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. RunResultsW[6]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[6]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse7[12]"			Proj:ResultSummary[5]:Enduse7[12]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR. RunResultsW[7]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[7]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse8[12]"			Proj:ResultSummary[5]:Enduse8[12]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR. RunResultsW[8]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[8]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse9[12]"			Proj:ResultSummary[5]:Enduse9[12]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR. RunResultsW[9]:DRtgElecEnergy  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[9]:DRtgElecEnergy  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse10[12]"			Proj:ResultSummary[5]:Enduse10[12]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. RunResultsW[10]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[10]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse11[12]"			Proj:ResultSummary[5]:Enduse11[12]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. RunResultsW[11]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[11]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse12[12]"			Proj:ResultSummary[5]:Enduse12[12]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. RunResultsW[12]:DRtgElecEnergy < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[12]:DRtgElecEnergy * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
  ; SAC 4/8/15 - refresh lighting and total Proposed results following (possible) resets due to design rating lighting credit reductions
  ; Proposed Site ELEC Use
	"Set ResultSummary[5]:Enduse6[17]"			Proj:ResultSummary[5]:Enduse6[17]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. RunResultsW[6]:PropElecEnergy[2]  < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[6]:PropElecEnergy[2]  * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse10[17]"			Proj:ResultSummary[5]:Enduse10[17]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[10]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse11[17]"			Proj:ResultSummary[5]:Enduse11[17]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. RunResultsW[11]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[11]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
	"Set ResultSummary[5]:Enduse12[17]"			Proj:ResultSummary[5]:Enduse12[17]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. RunResultsW[12]:PropElecEnergy[2] < 0.00001) then  UNDEFINED  
																													else  FltToStr( (int( (RunResultsW[12]:PropElecEnergy[2] * Proj:CondFloorArea / 3.413) + 0.5 )), 0 )  endif  }
  ; Proposed Site FUEL Use
	"Set ResultSummary[5]:Enduse6[18]"			Proj:ResultSummary[5]:Enduse6[18]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR. (RunResultsW[6]:PropNatGasEnergy[2]  < 0.00001 .AND. RunResultsW[6]:PropOtherEnergy[2]  < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsW[6]:PropNatGasEnergy[2]  + RunResultsW[6]:PropOtherEnergy[2] ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse10[18]"			Proj:ResultSummary[5]:Enduse10[18]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR. (RunResultsW[10]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsW[10]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsW[10]:PropNatGasEnergy[2] + RunResultsW[10]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse11[18]"			Proj:ResultSummary[5]:Enduse11[18]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR. (RunResultsW[11]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsW[11]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsW[11]:PropNatGasEnergy[2] + RunResultsW[11]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse12[18]"			Proj:ResultSummary[5]:Enduse12[18]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR. (RunResultsW[12]:PropNatGasEnergy[2] < 0.00001 .AND. RunResultsW[12]:PropOtherEnergy[2] < 0.00001)) then  UNDEFINED  
																													else  FltToStr(      ((RunResultsW[12]:PropNatGasEnergy[2] + RunResultsW[12]:PropOtherEnergy[2]) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; Proposed TDV
	"Set ResultSummary[5]:Enduse6[19]"			Proj:ResultSummary[5]:Enduse6[19]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[19]"			Proj:ResultSummary[5]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[19]"			Proj:ResultSummary[5]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[19]"			Proj:ResultSummary[5]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Site Natural Gas Use
	"Set ResultSummary[5]:Title1[13]"			Proj:ResultSummary[5]:Title1[13]		= {	"Reference"  }
	"Set ResultSummary[5]:Title2[13]"			Proj:ResultSummary[5]:Title2[13]		= {	"Design"     }
	"Set ResultSummary[5]:Title3[13]"			Proj:ResultSummary[5]:Title3[13]		= {	"Site (therms)"  }
	"Set ResultSummary[5]:Enduse1[13]"			Proj:ResultSummary[5]:Enduse1[13]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0 .OR.  (RunResultsW[1]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[1]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[1]:DRtgNatGasEnergy  + RunResultsW[1]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse2[13]"			Proj:ResultSummary[5]:Enduse2[13]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0 .OR.  (RunResultsW[2]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[2]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[2]:DRtgNatGasEnergy  + RunResultsW[2]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse3[13]"			Proj:ResultSummary[5]:Enduse3[13]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0 .OR.  (RunResultsW[3]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[3]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[3]:DRtgNatGasEnergy  + RunResultsW[3]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse4[13]"			Proj:ResultSummary[5]:Enduse4[13]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0 .OR.  (RunResultsW[4]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[4]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[4]:DRtgNatGasEnergy  + RunResultsW[4]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse5[13]"			Proj:ResultSummary[5]:Enduse5[13]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0 .OR.  (RunResultsW[5]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[5]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[5]:DRtgNatGasEnergy  + RunResultsW[5]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse6[13]"			Proj:ResultSummary[5]:Enduse6[13]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0 .OR.  (RunResultsW[6]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[6]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[6]:DRtgNatGasEnergy  + RunResultsW[6]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse7[13]"			Proj:ResultSummary[5]:Enduse7[13]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0 .OR.  (RunResultsW[7]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[7]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[7]:DRtgNatGasEnergy  + RunResultsW[7]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse8[13]"			Proj:ResultSummary[5]:Enduse8[13]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0 .OR.  (RunResultsW[8]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[8]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[8]:DRtgNatGasEnergy  + RunResultsW[8]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse9[13]"			Proj:ResultSummary[5]:Enduse9[13]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0 .OR.  (RunResultsW[9]:DRtgNatGasEnergy  < 0.00001 .AND. RunResultsW[9]:DRtgOtherEnergy  < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[9]:DRtgNatGasEnergy  + RunResultsW[9]:DRtgOtherEnergy ) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse10[13]"			Proj:ResultSummary[5]:Enduse10[13]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0 .OR.  (RunResultsW[10]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsW[10]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[10]:DRtgNatGasEnergy + RunResultsW[10]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse11[13]"			Proj:ResultSummary[5]:Enduse11[13]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0 .OR.  (RunResultsW[11]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsW[11]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[11]:DRtgNatGasEnergy + RunResultsW[11]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
	"Set ResultSummary[5]:Enduse12[13]"			Proj:ResultSummary[5]:Enduse12[13]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0 .OR.  (RunResultsW[12]:DRtgNatGasEnergy < 0.00001 .AND. RunResultsW[12]:DRtgOtherEnergy < 0.00001)) then  UNDEFINED  
																													else  FltToStr( ((RunResultsW[12]:DRtgNatGasEnergy + RunResultsW[12]:DRtgOtherEnergy) * Proj:CondFloorArea / 100), 1 )  endif  }
  ; DesignRating TDV
	"Set ResultSummary[5]:Title1[14]"			Proj:ResultSummary[5]:Title1[14]		= {	"Reference"  }
	"Set ResultSummary[5]:Title2[14]"			Proj:ResultSummary[5]:Title2[14]		= {	"Design"     }
	"Set ResultSummary[5]:Title3[14]"			Proj:ResultSummary[5]:Title3[14]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[5]:Enduse1[14]"			Proj:ResultSummary[5]:Enduse1[14]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[14]"			Proj:ResultSummary[5]:Enduse2[14]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[14]"			Proj:ResultSummary[5]:Enduse3[14]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[14]"			Proj:ResultSummary[5]:Enduse4[14]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[14]"			Proj:ResultSummary[5]:Enduse5[14]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[14]"			Proj:ResultSummary[5]:Enduse6[14]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[14]"			Proj:ResultSummary[5]:Enduse7[14]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[14]"			Proj:ResultSummary[5]:Enduse8[14]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:DesignRatingTDV[1]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[14]"			Proj:ResultSummary[5]:Enduse9[14]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:DesignRatingTDV[1]  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[14]"			Proj:ResultSummary[5]:Enduse10[14]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:DesignRatingTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[14]"			Proj:ResultSummary[5]:Enduse11[14]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:DesignRatingTDV[1] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[14]"			Proj:ResultSummary[5]:Enduse12[14]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:DesignRatingTDV[1] ), 2 )  endif  }
  ; mjb-10/16/13	removed PVCredit from Std Design
;	"Set ResultSummary[5]:Enduse13[7]"			Proj:ResultSummary[5]:Enduse13[7]	= {	FltToStr( PVCredit, 2 )  }
	"Set ResultSummary[5]:Enduse13[7]"			Proj:ResultSummary[5]:Enduse13[7]	= {	" "  }

; mjb-10/16/13	subtract PVCredit from Prop Design - W
	;"Set ResultSummary[5]:Enduse13[4]"			Proj:ResultSummary[5]:Enduse13[4]	= {	FltToStr( (PVCredit * -1), 2 )  }
	"Set ResultSummary[5]:Enduse13[19]"			Proj:ResultSummary[5]:Enduse13[19]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( (RunResultsW[6]:PropPVCreditTDV[2] * -1), 2 )  endif  }
  ; SAC 10/17/13 - re-write some proposed model results to ensure PVCredit accounted for
 	"Set ResultSummary[5]:Enduse10[19]"			Proj:ResultSummary[5]:Enduse10[19]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[19]"			Proj:ResultSummary[5]:Enduse11[19]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[19]"			Proj:ResultSummary[5]:Enduse12[19]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:ProposedTDV[2] ), 2 )  endif  }

  ; DesignRating Margin TDV
	"Set ResultSummary[5]:Title1[15]"			Proj:ResultSummary[5]:Title1[15]		= {	"Design Rating"  }
	"Set ResultSummary[5]:Title2[15]"			Proj:ResultSummary[5]:Title2[15]		= {	"Margin"  }
	"Set ResultSummary[5]:Title3[15]"			Proj:ResultSummary[5]:Title3[15]		= {	"(kTDV/ft²-yr)"  }
	"Set ResultSummary[5]:Enduse1[15]"			Proj:ResultSummary[5]:Enduse1[15]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[1]:DesignRatingTDV[1]  - RunResultsW[1]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[15]"			Proj:ResultSummary[5]:Enduse2[15]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[2]:DesignRatingTDV[1]  - RunResultsW[2]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[15]"			Proj:ResultSummary[5]:Enduse3[15]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[3]:DesignRatingTDV[1]  - RunResultsW[3]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[15]"			Proj:ResultSummary[5]:Enduse4[15]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[4]:DesignRatingTDV[1]  - RunResultsW[4]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[15]"			Proj:ResultSummary[5]:Enduse5[15]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[5]:DesignRatingTDV[1]  - RunResultsW[5]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[15]"			Proj:ResultSummary[5]:Enduse6[15]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[6]:DesignRatingTDV[1]  - RunResultsW[6]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[15]"			Proj:ResultSummary[5]:Enduse7[15]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[7]:DesignRatingTDV[1]  - RunResultsW[7]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[15]"			Proj:ResultSummary[5]:Enduse8[15]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[8]:DesignRatingTDV[1]  - RunResultsW[8]:ProposedTDV[2]  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[15]"			Proj:ResultSummary[5]:Enduse9[15]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[9]:DesignRatingTDV[1]  - RunResultsW[9]:ProposedTDV[2]  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[15]"			Proj:ResultSummary[5]:Enduse10[15]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[10]:DesignRatingTDV[1] - RunResultsW[10]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[15]"			Proj:ResultSummary[5]:Enduse11[15]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[11]:DesignRatingTDV[1] - RunResultsW[11]:ProposedTDV[2] ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[15]"			Proj:ResultSummary[5]:Enduse12[15]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( ( RunResultsW[12]:DesignRatingTDV[1] - RunResultsW[12]:ProposedTDV[2] ), 2 )  endif  }
 	;"Set ResultSummary[5]:Enduse13[15]"			Proj:ResultSummary[5]:Enduse13[15]	= {	FltToStr( PVCredit, 2 )  }
 	"Set ResultSummary[5]:Enduse13[15]"			Proj:ResultSummary[5]:Enduse13[15]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( RunResultsW[6]:PropPVCreditTDV[2], 2 )  endif  }
;	  ; Pass/Fail result
;	 	"Set ResultSummary[5]:PassFail"				Proj:ResultSummary[5]:PassFail		= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  if (RunResultsW[11]:CompMarginTDV >= 0) then "PASS"  else  "FAIL"  endif endif  }
 	"Set ResultSummary[5]:DesignRating"			Proj:ResultSummary[5]:DesignRating		= {	if (IfValidAnd( RunResultsW[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
 																														else   ValidOr( RunResultsW[10]:ProposedTDV[3], 0 ) * 100 / RunResultsW[10]:DesignRatingTDV[2]  endif  }
 	"Set ResultSummary[5]:DesignRatingNoPV"	Proj:ResultSummary[5]:DesignRatingNoPV	= {	if (IfValidAnd( RunResultsW[10]:DesignRatingTDV[2] != 0 )==0) then  UNDEFINED
 																														else  (ValidOr( RunResultsW[10]:ProposedTDV[3], 0 ) + ValidOr( RunResultsW[6]:PropPVCreditTDV[2], 0 )) * 100 / RunResultsW[10]:DesignRatingTDV[2]  endif  }
 	"Set ResultSummary[5]:ShowDesignRtgNoPV"	Proj:ResultSummary[5]:ShowDesignRtgNoPV = {	if (ValidOr( RunResultsW[6]:PropPVCreditTDV[2], 0 ) >= 0.0001) then  1  else  0  endif  }
	; SAC 3/16/16 - added new DesignRatingPVOnly & DesignRatingStd 
 	"Set ResultSummary[5]:DesignRatingPVOnly"	Proj:ResultSummary[5]:DesignRatingPVOnly	= {	if (LocalStatus( ResultSummary[5]:DesignRatingNoPV ) < 1 .OR. LocalStatus( ResultSummary[5]:DesignRating ) < 1) then  UNDEFINED
 																															else	ResultSummary[5]:DesignRatingNoPV - ResultSummary[5]:DesignRating  endif  }
 	"Set ResultSummary[5]:DesignRatingStd"		Proj:ResultSummary[5]:DesignRatingStd		= {	ResultSummary[4]:DesignRatingStd  }
	; SAC 3/25/16 - moved down from Standard results... AND revised MeetsZNETier to require HERSProj:QII & ResultSummary[*]:DesignRating <= 0
	"Set ResultSummary[5]:MeetsZNETier"			Proj:ResultSummary[5]:MeetsZNETier	= {	if (IfValidAnd( HERSProj:QII > 0.5 )==0 .OR. IfValidAnd( ResultSummary[5]:DesignRating < 0.05 )==0 .OR. IfValidAnd( EDRPVVerified > 0.5 )==0) then  0
																													else if (ResultSummary[5]:MeetsTier2 > 0.5) then  1
																													else if (ResultSummary[5]:MeetsTier1 > 0.5 .AND. IsMultiFamily < 0.5)
																													then  if (CAClimateZoneCodeBase:sfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) < 1.5) then  1  else  0  endif
																													else if (ResultSummary[5]:MeetsTier1 > 0.5 .AND. IsMultiFamily > 0.5)
																													then  if (CAClimateZoneCodeBase:mfMinZNETier( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase ) < 1.5) then  1  else  0  endif
																													else  0  endif endif endif endif  }

  ; DesignRating Electric Demand
	"Set ResultSummary[5]:Title1[16]"			Proj:ResultSummary[5]:Title1[16]		= {	"Reference"  }
	"Set ResultSummary[5]:Title2[16]"			Proj:ResultSummary[5]:Title2[16]		= {	"Design"     }
	"Set ResultSummary[5]:Title3[16]"			Proj:ResultSummary[5]:Title3[16]		= {	"(kW)"  }
	"Set ResultSummary[5]:Enduse1[16]"			Proj:ResultSummary[5]:Enduse1[16]	= {	if (LocalCompAssigned( RunResultsW[1]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[1]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse2[16]"			Proj:ResultSummary[5]:Enduse2[16]	= {	if (LocalCompAssigned( RunResultsW[2]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[2]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse3[16]"			Proj:ResultSummary[5]:Enduse3[16]	= {	if (LocalCompAssigned( RunResultsW[3]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[3]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse4[16]"			Proj:ResultSummary[5]:Enduse4[16]	= {	if (LocalCompAssigned( RunResultsW[4]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[4]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse5[16]"			Proj:ResultSummary[5]:Enduse5[16]	= {	if (LocalCompAssigned( RunResultsW[5]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[5]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse6[16]"			Proj:ResultSummary[5]:Enduse6[16]	= {	if (LocalCompAssigned( RunResultsW[6]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[6]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse7[16]"			Proj:ResultSummary[5]:Enduse7[16]	= {	if (LocalCompAssigned( RunResultsW[7]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[7]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse8[16]"			Proj:ResultSummary[5]:Enduse8[16]	= {	if (LocalCompAssigned( RunResultsW[8]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[8]:DRtgElecDemand  ), 2 )  endif  }
	"Set ResultSummary[5]:Enduse9[16]"			Proj:ResultSummary[5]:Enduse9[16]	= {	if (LocalCompAssigned( RunResultsW[9]  ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[9]:DRtgElecDemand  ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse10[16]"			Proj:ResultSummary[5]:Enduse10[16]	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[10]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse11[16]"			Proj:ResultSummary[5]:Enduse11[16]	= {	if (LocalCompAssigned( RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[11]:DRtgElecDemand ), 2 )  endif  }
 	"Set ResultSummary[5]:Enduse12[16]"			Proj:ResultSummary[5]:Enduse12[16]	= {	if (LocalCompAssigned( RunResultsW[12] ) == 0) then  UNDEFINED  else  FltToStr( LocalRef( RunResultsW[12]:DRtgElecDemand ), 2 )  endif  }

;	  ; Demand & Energy Use Margins (added w/ CAHP mods 10/8/14)
;		"Set ResultSummary[5]:MarginkW"			Proj:ResultSummary[5]:MarginkW		= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
;																													else  ValidOr( RunResultsW[10]:StdElecDemand, 0 ) - ValidOr( RunResultsW[10]:PropElecDemand[2], 0 )  endif  }
;		"Set ResultSummary[5]:MarginkWh"			Proj:ResultSummary[5]:MarginkWh		= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResultsW[10]:StdElecEnergy, 0 ) - ValidOr( RunResultsW[10]:PropElecEnergy, 0 )) * CondFloorArea / 3.413  endif  }
;		"Set ResultSummary[5]:MarginTherms"		Proj:ResultSummary[5]:MarginTherms	= {	if (LocalCompAssigned( RunResultsW[10] ) == 0) then  UNDEFINED
;																													else  (ValidOr( RunResultsW[10]:StdNatGasEnergy, 0 ) - ValidOr( RunResultsW[10]:PropNatGasEnergy, 0 )) * CondFloorArea / 100  endif  }
;	  ; Percent Savings values for reporting
;		"Set ResultSummary[5]:PctSavingskW"			Proj:ResultSummary[5]:PctSavingskW		= {	if (IfValidAnd( RunResultsW[10]:StdElecDemand > 0.001 )==0) then  UNDEFINED
;																															else  (RunResultsW[10]:StdElecDemand   - ValidOr( RunResultsW[10]:PropElecDemand[2],   0 )) * 100 / RunResultsW[10]:StdElecDemand    endif  }
;		"Set ResultSummary[5]:PctSavingskWh"		Proj:ResultSummary[5]:PctSavingskWh		= {	if (IfValidAnd( RunResultsW[10]:StdElecEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResultsW[10]:StdElecEnergy   - ValidOr( RunResultsW[10]:PropElecEnergy,   0 )) * 100 / RunResultsW[10]:StdElecEnergy    endif  }
;		"Set ResultSummary[5]:PctSavingsTherms"	Proj:ResultSummary[5]:PctSavingsTherms	= {	if (IfValidAnd( RunResultsW[10]:StdNatGasEnergy > 0.001 )==0) then  UNDEFINED
;																															else  (RunResultsW[10]:StdNatGasEnergy - ValidOr( RunResultsW[10]:PropNatGasEnergy, 0 )) * 100 / RunResultsW[10]:StdNatGasEnergy  endif  }
;		"Set ResultSummary[5]:PctSavingsTDV"		Proj:ResultSummary[5]:PctSavingsTDV		= {	if (IfValidAnd( RunResultsW[10]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResultsW[10]:StandardTDV     - ValidOr( RunResultsW[10]:ProposedTDV[2],      0 )) * 100 / RunResultsW[10]:StandardTDV      endif  }
;		"Set ResultSummary[5]:PctSavingsCmpTDV"	Proj:ResultSummary[5]:PctSavingsCmpTDV	= {	if (IfValidAnd( RunResultsW[11]:StandardTDV     > 0.001 )==0) then  UNDEFINED
;																															else  (RunResultsW[11]:StandardTDV     - ValidOr( RunResultsW[11]:ProposedTDV[2],      0 )) * 100 / RunResultsW[11]:StandardTDV      endif  }
;		"Set ResultSummary[5]:PctSavkWLbl"			Proj:ResultSummary[5]:PctSavkWLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingskW     > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingskW     < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingskW     )  endif  }
;		"Set ResultSummary[5]:PctSavkWhLbl"			Proj:ResultSummary[5]:PctSavkWhLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingskWh    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingskWh    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingskWh    )  endif  }
;		"Set ResultSummary[5]:PctSavThermsLbl"		Proj:ResultSummary[5]:PctSavThermsLbl	= {	if (IfValidAnd( ResultSummary[5]:PctSavingsTherms > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsTherms < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsTherms )  endif  }
;		"Set ResultSummary[5]:PctSavTDVLbl"			Proj:ResultSummary[5]:PctSavTDVLbl		= {	if (IfValidAnd( ResultSummary[5]:PctSavingsTDV    > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsTDV    < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsTDV    )  endif  }
;		"Set ResultSummary[5]:PctSavCmpTDVLbl"		Proj:ResultSummary[5]:PctSavCmpTDVLbl	= {	if (IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV > 0.0001 )==0 .AND. IfValidAnd( ResultSummary[5]:PctSavingsCmpTDV < -0.0001 )==0) then  "-"  else  Format( "%.1f", ResultSummary[5]:PctSavingsCmpTDV )  endif  }

END


;*************************************************************************
RULELIST "CARes_SummaryTab" 1 0 1 1
;*************************************************************************
;	"Set EUseSummary:ComplyMessage"		EUseSummary:ComplyMessage		= {	if (GlobalCompAssigned( Proj:RunResults[11] ) == 0) then  UNDEFINED
;																									else if (Proj:RunResultsW[11]:CompMarginTDV >= 0) then "COMPLIES"  else  "DOES NOT COMPLY"  endif endif  }
	"Set EUseSummary:ComplyMessage"		EUseSummary:ComplyMessage		= {	if (Proj:RunResults[11]:CompMarginTDV >= 0) then "COMPLIES"  else  "DOES NOT COMPLY"  endif  }

	"Set EUseSummary:SummaryCol1[4]"		EUseSummary:SummaryCol1[4]		= {	"Standard Design"  }
	"Set EUseSummary:SummaryCol1[5]"		EUseSummary:SummaryCol1[5]		= {	"Proposed Design"  }

	"Set EUseSummary:SummaryCol2[1]"		EUseSummary:SummaryCol2[1]		= {	"Compliance"     }
	"Set EUseSummary:SummaryCol2[2]"		EUseSummary:SummaryCol2[2]		= {	"Total"          }
	"Set EUseSummary:SummaryCol2[3]"		EUseSummary:SummaryCol2[3]		= {	"(kTDV/ft²-yr)"  }
;	"Set EUseSummary:SummaryCol2[4]"		EUseSummary:SummaryCol2[4]		= {	if (GlobalCompAssigned( Proj:RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResults[11]:StandardTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol2[5]"		EUseSummary:SummaryCol2[5]		= {	if (GlobalCompAssigned( Proj:RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResults[11]:ProposedTDV ), 2 )  endif  }
	"Set EUseSummary:SummaryCol2[4]"		EUseSummary:SummaryCol2[4]		= {	FltToStr( Proj:RunResults[11]:StandardTDV, 2 )  }
	"Set EUseSummary:SummaryCol2[5]"		EUseSummary:SummaryCol2[5]		= {	FltToStr( Proj:RunResults[11]:ProposedTDV[1], 2 )  }

	"Set EUseSummary:SummaryCol3[1]"		EUseSummary:SummaryCol3[1]		= {	"Compliance"     }
	"Set EUseSummary:SummaryCol3[2]"		EUseSummary:SummaryCol3[2]		= {	"Margin"         }
	"Set EUseSummary:SummaryCol3[3]"		EUseSummary:SummaryCol3[3]		= {	"(kTDV/ft²-yr)"  }
;	"Set EUseSummary:SummaryCol3[5]"		EUseSummary:SummaryCol3[5]		= {	if (GlobalCompAssigned( Proj:RunResults[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResults[11]:CompMarginTDV ), 2 )  endif  }
	"Set EUseSummary:SummaryCol3[5]"		EUseSummary:SummaryCol3[5]		= {	FltToStr( Proj:RunResults[11]:CompMarginTDV, 2 )  }
END

;*************************************************************************
RULELIST "CARes_SummaryTab_NESW" 1 0 1 1
;*************************************************************************
;	"Set EUseSummary:ComplyMessage"		EUseSummary:ComplyMessage		= {	if (GlobalCompAssigned( Proj:RunResults[11] ) == 0) then  UNDEFINED
;																									else if (Proj:RunResults[11]:CompMarginTDV >= 0) then "COMPLIES"  else  "DOES NOT COMPLY"  endif endif  }
	"Set EUseSummary:ComplyMessage"		EUseSummary:ComplyMessage		= {	if (Proj:RunResults[11]:CompMarginTDV >= 0) then "COMPLIES"  else  "DOES NOT COMPLY"  endif  }

	"Set EUseSummary:SummaryCol1[4]"		EUseSummary:SummaryCol1[4]		= {	"Standard Design"  }
	"Set EUseSummary:SummaryCol1[5]"		EUseSummary:SummaryCol1[5]		= {	"Proposed Designs:"  }
;	"Set EUseSummary:SummaryCol1[6]"		EUseSummary:SummaryCol1[6]		= {	if (GlobalCompAssigned( Proj:ResultSummary[2] ) == 0) then  UNDEFINED  else  Proj:ResultSummary[2]:Name  endif  }
;	"Set EUseSummary:SummaryCol1[7]"		EUseSummary:SummaryCol1[7]		= {	if (GlobalCompAssigned( Proj:ResultSummary[3] ) == 0) then  UNDEFINED  else  Proj:ResultSummary[3]:Name  endif  }
;	"Set EUseSummary:SummaryCol1[8]"		EUseSummary:SummaryCol1[8]		= {	if (GlobalCompAssigned( Proj:ResultSummary[4] ) == 0) then  UNDEFINED  else  Proj:ResultSummary[4]:Name  endif  }
;	"Set EUseSummary:SummaryCol1[9]"		EUseSummary:SummaryCol1[9]		= {	if (GlobalCompAssigned( Proj:ResultSummary[5] ) == 0) then  UNDEFINED  else  Proj:ResultSummary[5]:Name  endif  }
	"Set EUseSummary:SummaryCol1[6]"		EUseSummary:SummaryCol1[6]		= {	Proj:ResultSummary[2]:Name  }
	"Set EUseSummary:SummaryCol1[7]"		EUseSummary:SummaryCol1[7]		= {	Proj:ResultSummary[3]:Name  }
	"Set EUseSummary:SummaryCol1[8]"		EUseSummary:SummaryCol1[8]		= {	Proj:ResultSummary[4]:Name  }
	"Set EUseSummary:SummaryCol1[9]"		EUseSummary:SummaryCol1[9]		= {	Proj:ResultSummary[5]:Name  }

	"Set EUseSummary:SummaryCol2[1]"		EUseSummary:SummaryCol2[1]		= {	"Compliance"     }
	"Set EUseSummary:SummaryCol2[2]"		EUseSummary:SummaryCol2[2]		= {	"Total"          }
	"Set EUseSummary:SummaryCol2[3]"		EUseSummary:SummaryCol2[3]		= {	"(kTDV/ft²-yr)"  }
;	"Set EUseSummary:SummaryCol2[4]"		EUseSummary:SummaryCol2[4]		= {	if (GlobalCompAssigned( Proj:RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsN[11]:StandardTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol2[6]"		EUseSummary:SummaryCol2[6]		= {	if (GlobalCompAssigned( Proj:RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsN[11]:ProposedTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol2[7]"		EUseSummary:SummaryCol2[7]		= {	if (GlobalCompAssigned( Proj:RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsE[11]:ProposedTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol2[8]"		EUseSummary:SummaryCol2[8]		= {	if (GlobalCompAssigned( Proj:RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsS[11]:ProposedTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol2[9]"		EUseSummary:SummaryCol2[9]		= {	if (GlobalCompAssigned( Proj:RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsW[11]:ProposedTDV ), 2 )  endif  }
	"Set EUseSummary:SummaryCol2[4]"		EUseSummary:SummaryCol2[4]		= {	FltToStr( Proj:RunResultsN[11]:StandardTDV, 2 )  }
	"Set EUseSummary:SummaryCol2[6]"		EUseSummary:SummaryCol2[6]		= {	FltToStr( Proj:RunResultsN[11]:ProposedTDV[1], 2 )  }
	"Set EUseSummary:SummaryCol2[7]"		EUseSummary:SummaryCol2[7]		= {	FltToStr( Proj:RunResultsE[11]:ProposedTDV[1], 2 )  }
	"Set EUseSummary:SummaryCol2[8]"		EUseSummary:SummaryCol2[8]		= {	FltToStr( Proj:RunResultsS[11]:ProposedTDV[1], 2 )  }
	"Set EUseSummary:SummaryCol2[9]"		EUseSummary:SummaryCol2[9]		= {	FltToStr( Proj:RunResultsW[11]:ProposedTDV[1], 2 )  }

	"Set EUseSummary:SummaryCol3[1]"		EUseSummary:SummaryCol3[1]		= {	"Compliance"     }
	"Set EUseSummary:SummaryCol3[2]"		EUseSummary:SummaryCol3[2]		= {	"Margin"         }
	"Set EUseSummary:SummaryCol3[3]"		EUseSummary:SummaryCol3[3]		= {	"(kTDV/ft²-yr)"  }
;	"Set EUseSummary:SummaryCol3[6]"		EUseSummary:SummaryCol3[6]		= {	if (GlobalCompAssigned( Proj:RunResultsN[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsN[11]:CompMarginTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol3[7]"		EUseSummary:SummaryCol3[7]		= {	if (GlobalCompAssigned( Proj:RunResultsE[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsE[11]:CompMarginTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol3[8]"		EUseSummary:SummaryCol3[8]		= {	if (GlobalCompAssigned( Proj:RunResultsS[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsS[11]:CompMarginTDV ), 2 )  endif  }
;	"Set EUseSummary:SummaryCol3[9]"		EUseSummary:SummaryCol3[9]		= {	if (GlobalCompAssigned( Proj:RunResultsW[11] ) == 0) then  UNDEFINED  else  FltToStr( GlobalRef( Proj:RunResultsW[11]:CompMarginTDV ), 2 )  endif  }
	"Set EUseSummary:SummaryCol3[6]"		EUseSummary:SummaryCol3[6]		= {	FltToStr( Proj:RunResultsN[11]:CompMarginTDV, 2 )  }
	"Set EUseSummary:SummaryCol3[7]"		EUseSummary:SummaryCol3[7]		= {	FltToStr( Proj:RunResultsE[11]:CompMarginTDV, 2 )  }
	"Set EUseSummary:SummaryCol3[8]"		EUseSummary:SummaryCol3[8]		= {	FltToStr( Proj:RunResultsS[11]:CompMarginTDV, 2 )  }
	"Set EUseSummary:SummaryCol3[9]"		EUseSummary:SummaryCol3[9]		= {	FltToStr( Proj:RunResultsW[11]:CompMarginTDV, 2 )  }
END
;*************************************************************************


;*************************************************************************
;*************************************************************************
;88888
RULELIST  "FinalCompliance" 1 0 0 1
;
;   Rules which make the final determination of whether the building passes
;   the compliance test or not.
;
;*************************************************************************
;*************************************************************************

   ;--------------------------------------------------------------------
   ; ... Rules
   ;--------------------------------------------------------------------

END
;*************************************************************************


;*************************************************************************
RULELIST "CheckFileHash"   1 0 0 0
;*************************************************************************

	"Set Proj:FileHashStatus - check #1"	Proj:FileHashStatus	= {
							if (LocalStatus( FileHashToCheck ) < 1 .OR. LocalStatus( FileHashID ) < 1) then  1
							else if (strlen( FileHashToCheck ) < 64) then  2
							else if (CAResFileHashes:HaveHash1( "HashID", FileHashID ) > 0.5)
							then	if (FileHashToCheck == CAResFileHashes:Hash1( "HashID", FileHashID )) then  0  else  3  endif
							else  0  endif endif endif  }
	"Set Proj:FileHashStatus - check #2"	Proj:FileHashStatus	= {
							if (FileHashStatus == 3 .AND. CAResFileHashes:HaveHash2( "HashID", FileHashID ) > 0.5)
							then  if (FileHashToCheck == CAResFileHashes:Hash2( "HashID", FileHashID )) then  0  else  4  endif
							else  UNCHANGED  endif  }
END

;*************************************************************************
RULELIST "SetReportKeys"   1 0 0 0
;*************************************************************************
; Res - Open Source - 9/8/13
   "Set Proj:RptPrvKey[1]"    Proj:RptPrvKey[1]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  1) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec",  1 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[2]"    Proj:RptPrvKey[2]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  2) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec",  2 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[3]"    Proj:RptPrvKey[3]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  3) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec",  3 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[4]"    Proj:RptPrvKey[4]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  4) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec",  4 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[5]"    Proj:RptPrvKey[5]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  5) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec",  5 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[6]"    Proj:RptPrvKey[6]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  6) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec",  6 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[7]"    Proj:RptPrvKey[7]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  7) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec",  7 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[8]"    Proj:RptPrvKey[8]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  8) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec",  8 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[9]"    Proj:RptPrvKey[9]  = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >=  9) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec",  9 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[10]"   Proj:RptPrvKey[10] = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >= 10) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec", 10 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[11]"   Proj:RptPrvKey[11] = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >= 11) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec", 11 )  else  UNDEFINED  endif  }
   "Set Proj:RptPrvKey[12]"   Proj:RptPrvKey[12] = {   if (CAResKeys:NumRecs( "KeyType", "Prv" ) >= 12) then  CAResKeys:KeyText( "KeyType", "Prv", "KeyRec", 12 )  else  UNDEFINED  endif  }

   "Set Proj:RptPubKey[1]"    Proj:RptPubKey[1]  = {   if (CAResKeys:NumRecs( "KeyType", "Pub" ) >=  1) then  CAResKeys:KeyText( "KeyType", "Pub", "KeyRec",  1 )  else  UNDEFINED  endif  }
   "Set Proj:RptPubKey[2]"    Proj:RptPubKey[2]  = {   if (CAResKeys:NumRecs( "KeyType", "Pub" ) >=  2) then  CAResKeys:KeyText( "KeyType", "Pub", "KeyRec",  2 )  else  UNDEFINED  endif  }
   "Set Proj:RptPubKey[3]"    Proj:RptPubKey[3]  = {   if (CAResKeys:NumRecs( "KeyType", "Pub" ) >=  3) then  CAResKeys:KeyText( "KeyType", "Pub", "KeyRec",  3 )  else  UNDEFINED  endif  }
   "Set Proj:RptPubKey[4]"    Proj:RptPubKey[4]  = {   if (CAResKeys:NumRecs( "KeyType", "Pub" ) >=  4) then  CAResKeys:KeyText( "KeyType", "Pub", "KeyRec",  4 )  else  UNDEFINED  endif  }
   "Set Proj:RptPubKey[5]"    Proj:RptPubKey[5]  = {   if (CAResKeys:NumRecs( "KeyType", "Pub" ) >=  5) then  CAResKeys:KeyText( "KeyType", "Pub", "KeyRec",  5 )  else  UNDEFINED  endif  }
   "Set Proj:RptPubKey[6]"    Proj:RptPubKey[6]  = {   if (CAResKeys:NumRecs( "KeyType", "Pub" ) >=  6) then  CAResKeys:KeyText( "KeyType", "Pub", "KeyRec",  6 )  else  UNDEFINED  endif  }
END
;*************************************************************************


;*************************************************************************
;*************************************************************************

ENDFILE
