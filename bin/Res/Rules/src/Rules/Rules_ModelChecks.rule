; -------------------------------------------------------------------------
; Rules pertaining to:   Checks Performed on Proposed Model for Energy Code and general Simulation Worthiness
; CEC Title-24 Residential Energy Code
; -------------------------------------------------------------------------
; Copyright (c) 2012-2014, California Energy Commission
; Copyright (c) 2012-2014, Wrightsoft Corporation
; All rights reserved.
; Redistribution and use in source and binary forms, with or without modification,
; are permitted provided that the following conditions are met:
; - Redistributions of source code must retain the above copyright notice, this
;   list of conditions and the following disclaimer.
; - Redistributions in binary form must reproduce the above copyright notice, this
;   list of conditions, the following disclaimer in the documentation and/or other
;   materials provided with the distribution.
; - Neither the name of the California Energy Commission nor the names of its
;   contributors may be used to endorse or promote products derived from this
;   software without specific prior written permission.
; DISCLAIMER: THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
; THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
; NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION,
; WRIGHTSOFT CORPORATION, ITRON, INC. OR ANY OTHER AUTHOR OR COPYRIGHT HOLDER OF
; THIS SOFTWARE (COLLECTIVELY, THE "AUTHORS") BE LIABLE FOR ANY DIRECT, INDIRECT,
; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
; OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
; LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
; OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  EACH LICENSEE AND SUBLICENSEE OF THE
; SOFTWARE AGREES NOT TO ASSERT ANY CLAIM AGAINST ANY OF THE AUTHORS RELATING TO
; THIS SOFTWARE, WHETHER DUE TO PERFORMANCE ISSUES, TITLE OR INFRINGEMENT ISSUES,
; STRICT LIABILITY OR OTHERWISE.
; -------------------------------------------------------------------------


;*************************************************************************
RULELIST "ProposedModelCodeCheck" 1 0 0 0
;
;   Rules which are executed on the input building description to ensure
;   that all mandatory requirements are met and that there aren't any errors
;   or omissions in the user model.
;
;*************************************************************************

	"Check for valid ClimateZone specified"
		Proj:Action		= {	if (ClimateZone > 0.5 .AND. ClimateZone < 16.5) then  UNCHANGED
									else	PostError( "A valid CEC Climate Zone must be specified prior to performing analysis (see Project tab of Project tabbed dialog)" )  endif  }

  ; SAC 4/16/15 - prevent analysis for anything other than Single Family, New Construction for 2016 analysis (for the time being)
  ; SAC 7/8/15 - revise limit to allow multifamily analysis
  ; SAC 9/20/15 - remove error message preventing 2016 EAA analysis w/out BypassRuleLimits set
;	"(temporarily) Prevent 2016 code compliance for any models other than single family new construction"
;		Proj:Action		= {	if (CompCodeBase >= 2016 .AND. BypassRuleLimits < 1.5 .AND. (RunScope != 1 .OR. IsAddAlone > 0.5))
;									then  PostError( "2016 Title-24 compliance analyis currently available only for New Construction projects." )
;									else  UNCHANGED  endif  }

  ; SAC 2/9/15 - check flag documenting requirement of alterations including at least 2 categories of upgraded component(s)
	"Call subordinate rulelist to generate max estimated alteration cateogries"
		Proj:Action		= {	if (RunScope == 2 .AND. SumAcrossIf( Zone:IsNew, Zone:FloorArea > 1 ) < 0.5) then  EvalRulelist( "Count_NumAlterations" )
									else  UNCHANGED  endif  }
	"Report AlterIncl2Categs problem"
		Proj:Action		= {	if (RunScope == 2 .AND. SumAcrossIf( Zone:IsNew, Zone:FloorArea > 1 ) < 0.5)
									then	if (IfValidAnd( AlterIncl2Categs > 0.5 )==0)
											then	PostError( "Proj:AlterIncl2Categs (CBECC-Res: checkbox in Project dialog > Analysis tab) must be selected to confirm that alterations span multiple categories (as per standard section 150.2(b)2)." )
											else if (IfValidAnd( NumAlterations < 2 ))
											then	PostWarning( "Number of alterations (from standard table 150.2-B) is %.0f, despite user confirming multiple alterations specified (Proj:AlterIncl2Categs).", NumAlterations )
											else  UNCHANGED  endif endif
									else  UNCHANGED  endif  }

; SAC 6/25/14 - checks no longer @ Proj level, as of introduction of DwellUnit object
;	"Check for consistency in conditioned areas between dwelling unit & physical model inputs"
;		Proj:Action		= {	if (IsMultiFamily < 0.5 .OR. UnitTotCondFlrArea == CondFloorArea) then  UNCHANGED
;									else	PostError( "The sum of each dwelling unit count * area (%.1f) must be equal to the sum of the areas of each conditioned zone in the model (%.1f)",
;															UnitTotCondFlrArea, CondFloorArea )  endif  }

	; SAC 4/21/15 - added check to ensure at least one zone where Status = 'Existing' for EAA projects
	"Check to ensure at least one zone of Status = 'Existing' present when Run Scope = 'Addition and/or Alteration'"
		Proj:Action		= {	if (RunScope != 2 .OR. SumChildrenIf( Zone:FloorArea, Zone:Status = 1 ) > 0.1) then  UNCHANGED
									else	PostError( "At least one 'Existing' zone must be specified when Run Scope = 'Addition and/or Alteration'.  If this model is of an addition alone, then change Run Scope to 'New Construction' and select 'Addition Alone project'." )  endif  }

	; SAC 6/6/13 - added check for conditioned/living/sleeping zones present in model
	"Check for at least one conditioned zone plus one zone of each (conditioned) type (living & sleeping) when control credits selected"
		Proj:Action		= {	if (Proj:ZonalControl < 0.5 .AND. SumAll( Zone:CondFloorArea ) < 0.1)
									then  PostError( "At least one conditioned zone must be specified in the model prior to performing analysis" )
									else if (Proj:ZonalControl > 0.5 .AND. SumAll( Zone:LvgCondFloorArea ) < 0.1 .AND. SumAll( Zone:SlpCondFloorArea ) < 0.1)
									then	PostError( "At least one Living and one Sleeping zone must exist in the model when Zonal Control Credit is selected" )
									else if (Proj:ZonalControl > 0.5 .AND. SumAll( Zone:LvgCondFloorArea ) < 0.1)
									then	PostError( "No zones classified as 'Living' are present in the model.  At least one Living and one Sleeping zone must exist in the model when Zonal Control Credit is selected" )
									else if (Proj:ZonalControl > 0.5 .AND. SumAll( Zone:SlpCondFloorArea ) < 0.1)
									then	PostError( "No zones classified as 'Sleeping' are present in the model.  At least one Living and one Sleeping zone must exist in the model when Zonal Control Credit is selected" )
									else	UNCHANGED  endif endif endif endif  }

	; SAC 10/26/15 - check to confirm DwellUnit:CondFlrArea is equal to DwellUnitType:CondFlrArea
	"Check for valid DwellUnit:DwellUnitTypeRef assignment and consistency between DwellUnit: and DwellUnitType:CondFlrArea"
		DwellUnit:Action	= {	if (IsMultiFamily < 0.5) then  UNCHANGED
										else if (LocalCompAssigned( DwellUnitTypeRef ) == 0 .OR. IfValidAnd( DwellUnitTypeRef:CondFlrArea > 0 )==0)
										then  PostError( "DwellUnit '%s' contains no reference to a DwellUnitType object (or the referenced DwellUnitType has no valid conditioned floor area).", Name )
										else if (IfValidAnd( CondFlrArea > 0 )==0)
										then	PostError( "DwellUnit '%s' contains no valid conditioned floor area.", Name )
										else if ( CondFlrArea < (DwellUnitTypeRef:CondFlrArea + 0.1) .AND. CondFlrArea > (DwellUnitTypeRef:CondFlrArea - 0.1) ) then  UNCHANGED
										else	PostError( "DwellUnit '%s' conditioned floor area (%g) must be equal to that of its referenced DwellUnitType '%s' (%g).", Name, CondFlrArea, DwellUnitTypeRef:Name, DwellUnitTypeRef:CondFlrArea )
										endif endif endif endif  }

; checks for valid & minimum IAQ ventilation (for both SFam & MFam models) - SAC 9/10/13 added
; mjb 12/17/13 - do not check for IAQ fan if E+A+A
; SAC 7/29/15 - do not check IAQ vent if it has been disabled by user (when BypassRuleLimits is activated)
	"Check for single family IAQ ventilation valid and sufficient"
		Proj:Action		= {	if (IsMultiFamily > 0.5 .OR. IAQDisabled > 0) then  UNCHANGED
									else if (UnitIAQOption[1] == 3)		; "CFI (Central Fan Integrated) IAQ"
									then	PostError( "Model IAQ option 'CFI (Central Fan Integrated) IAQ' is not yet implemented.  Another selection needs to be made on the IAQ tab of the Project data dialog box." )
									else if (UnitIAQCFMTot[1]  < UnitMinIAQCFM[1] .AND. RunScope == 1)
									then	PostError( "Minimum IAQ Ventilation NOT MET:  %s required, %s entered (CFM).  Review inputs on the IAQ tab of the Project data dialog box.", FltToStr( UnitMinIAQCFM[1] , 1 ), FltToStr( UnitIAQCFMTot[1] , 1 ) )
									else	UNCHANGED  endif endif endif  }

; SAC 11/12/14 - added DwellUnit IAQ CFM checks, replacing old MFam ones that were removed 6/25/14 (GC issue 410)
	"Check for single family IAQ ventilation valid and sufficient"
		DwellUnit:Action	= {	if (IsMultiFamily < 0.5 .OR. LocalCompAssigned( DwellUnitTypeRef ) == 0 .OR. IfValidAnd( MinIAQCFM > 0.05 )==0 .OR. IfValidAnd( DwellUnitTypeRef:IAQDisabled > 0 )) then  UNCHANGED
										else if (DwellUnitTypeRef:IAQOption == 3) 
										then	PostError( "Model IAQ option 'CFI (Central Fan Integrated) IAQ' is not yet implemented.  Another IAQ selection needs to be made for DwellUnit '%s' (DwellUnitType '%s').", Name, DwellUnitTypeRef:Name )
										else if (TotalIAQCFM < MinIAQCFM .AND. RunScope == 1)
										then	PostError( "Minimum IAQ Ventilation NOT MET:  %s required, %s entered (CFM).  Review inputs for DwellUnit '%s' (DwellUnitType '%s').", FltToStr( MinIAQCFM, 1 ), FltToStr( TotalIAQCFM, 1 ), Name, DwellUnitTypeRef:Name )
										else	UNCHANGED  endif endif endif  }

  ; SAC 3/4/16 - Check to confirm validity between PV compliance credit & detailed (EDR) PV system size (tic #609)
  ; SAC 3/25/16 - Revised rule to throw similar error when PVCompCredit and DesignRatingCalcs are selected but No EDR PV
	"Check for valid EDR PV system size when activated along w/ PV compliance credit"
		Proj:Action		= {	if (IfValidAnd(StandardsVersion >= 2017)==0 .OR. EnablePVCredit < 1 .OR. PVCompCredit < 1 .OR. IfValidAnd( AllowDesignRating > 0.5 )==0 .OR. IfValidAnd( DesignRatingCalcs > 0.5 )==0) then  UNCHANGED
									else if (IfValidAnd( PVWDCSysTotal > 0 )==0)
									then	PostError( "When both the PV compliance credit and Energy Design Rating (EDR) PV system credit features are activated, an EDR PV system size must be specified that is >= the minimum PV compliance credit system size of %g kWdc.", PVMinRatedPower[1] )
									else if (IfValidAnd( PVWDCSysTotal < PVMinRatedPower[1] ))
									then	PostError( "When both the PV compliance credit and Energy Design Rating (EDR) PV system credit features are activated, the EDR PV system size (%g kWdc) must be >= the minimum PV compliance credit system size of %g kWdc.", PVWDCSysTotal, PVMinRatedPower[1] )
									else	UNCHANGED  endif endif endif  }

	"Prevent Unconditioned Zones in compliance analysis (for the time being)"		; SAC 11/18/14 - 
		Zone:Action		= {	if (IfValidAnd( Type = 10 ))
									then  if (Proj:ZonalControl < 0.5)
											then  PostError( "Zone '%s' Type must be switched from Unconditioned to Conditioned.  Unconditioned zones are not currently supported in compliance analysis", Name )
											else  PostError( "Zone '%s' Type must be switched from Unconditioned to Living or Sleeping.  Unconditioned zones are not currently supported in compliance analysis", Name )
											endif
									else  UNCHANGED  endif  }

  ; SAC 1/6/14 - check for combination of zonal control credit & heat pump-conditioned zones
	"Check for combination of zonal control credit & heat pump-conditioned zones"
		Zone:Action	= {	if (Proj:ZonalControl < 0.5 .OR. CondFloorArea < 0.1 .OR. LocalCompAssigned( ActiveHVACSystem ) < 0.5) then  UNCHANGED
								else if (ActiveHVACSystem:Type == 2) then  PostError( "Zonal control credit (Building tab of Project dialog) is not compatible with zones, such as '%s', conditioned by a heat pump system.", Name )
								else  UNCHANGED  endif endif  }

; SAC 1/15/14 - removed check - testing analysis for validity... (GC issue #258)
;  ; mjb 1/8/14 - check for combination of zonal control credit & combined hydronic systems
;	"Check for combination of zonal control credit & combined hydronic systems"
;		Zone:Action	= {	if (Proj:ZonalControl < 0.5 .OR. CondFloorArea < 0.1 .OR. LocalCompAssigned( ActiveHVACSystem ) < 0.5) then  UNCHANGED
;								else if (ActiveHVACSystem:HeatSysType == 9) then  PostError( "Zonal control credit (Building tab of Project dialog) is not compatible with zones, such as '%s', conditioned by a combined hydronic system.", Name )
;								else  UNCHANGED  endif endif  }

	; SAC 6/6/13 - added check for minimum R-5 slab edge insulation when 'Heated Slab' is selected
	"Check for minimum R-5 slab edge insulation when 'Heated Slab' is selected"
		SlabFloor:Action	= {	if (HeatedSlab > 0.5 .AND. (EdgeInsulRValue < 5 .OR. EdgeInsulDepth < 16))
										then	PostError( "Slab floor '%s' requires minimum of R-5, 16 in. depth edge insulation since it is specified as heated", Name )
										else  UNCHANGED  endif  }

  ; SAC 8/26/14 - added check to prevent compliance analysis on Conditioned attics
;	"Check to ensure no Attic:Type = Conditioned..."
;		Attic:Action	= {	if (FloorArea > 0.1 .AND. Type = 1 .AND. Proj:BypassRuleLimits < 0.5)
;									then  PostError( "Attic '%s' Type of 'Conditioned' is not allowed when performing compliance analysis.  Revise this input before reinitiating analysis.", Name )
;									else  UNCHANGED  endif  }

	; EM 2/13/15	
;TO BE IMPLEMENTED WITH PRESCRIPTIVE ADDITIONS ROOF MODS - ADD LOGIC EXCLUSIVE TO E+A+A 								
	;"Check for Attic over new zone"
	;	Attic:Action	= {	if (FloorAreaOverNewZone > 0.1 .AND. FloorAreaOverNewZone < (FloorArea - 0.1) )
	;								then  PostError( "Attic '%s' is over a combination of new zone and existing space / garage.  Create a separate attic for the new zone(s).", Name )
	;								else  UNCHANGED  endif  }

	; SAC 10/7/13 - augmented rule to disable SmartVent (FixedFlowOAV) in addition to NightBreeze (VarFlowOAV)
	"Check for HVAC system type (or CFI cool vent) NOT available"  ; SAC 10/3/13 - GC issue ??? - prevent system type 'Variable Outdoor Air Ventilation Central Heat/Cool System'
		HVACSys:Action		= {	if (FloorAreaServed[1] < 0.1) then  UNCHANGED
										else if (TypeOK < 0.5) then  PostError( "HVAC system '%s' type '%s' not currently available for analysis.", Name, EnumString( Type ) )
										else if (CFIClVentCompat > 0.5 .AND. Type != 3 .AND. CFIClVentOption > 0 .AND. Proj:EnableFixedFlowOAV < 0.5)
										then  PostError( "HVAC system '%s' specified as supplying CFI Cool Vent, but this feature is not currently available for analysis.", Name )
										else  UNCHANGED  endif endif endif  }


; SAC 11/25/14 - added checks to ensure that num htg/clg equip is > 0 and all equip for specified number is actually assigned
	"Check for valid DwellUnitType Num*EquipTypes"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1) then  UNCHANGED
											else if (HVACSysType < 1) then  PostError( "DwellUnitType '%s' has no HVAC system type specified.", Name )
											else if (HVACSysType == 2 .AND. Proj:BypassRuleLimits < 0.5 .AND. IfValidAnd( NumHtPumpEquipTypes > 0.5 )==0)
											then  PostError( "One or more heat pump equipment assignments must be defined for DwellUnitType '%s'.", Name )
											else if (HVACSysType == 1 .AND. Proj:BypassRuleLimits < 0.5 .AND. IfValidAnd( NumHeatEquipTypes > 0.5 )==0)
											then  PostError( "One or more heating equipment assignments must be defined for DwellUnitType '%s'.", Name )
											else if (HVACSysType == 1 .AND. Proj:BypassRuleLimits < 0.5 .AND. IfValidAnd( NumCoolEquipTypes > 0.5 )==0)
											then  PostError( "One or more cooling equipment assignments must be defined for DwellUnitType '%s'.", Name )
											else	UNCHANGED  endif endif endif endif endif  }

	"Check for valid DwellUnitType equip assignments - heat pump #1"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 2 .OR. IfValidAnd( NumHtPumpEquipTypes >= 1 )==0 .OR. LocalCompAssigned( HVACHtPumpRef[1] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for heat pump #1.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - heat pump #2"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 2 .OR. IfValidAnd( NumHtPumpEquipTypes >= 2 )==0 .OR. LocalCompAssigned( HVACHtPumpRef[2] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for heat pump #2.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - heat pump #3"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 2 .OR. IfValidAnd( NumHtPumpEquipTypes >= 3 )==0 .OR. LocalCompAssigned( HVACHtPumpRef[3] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for heat pump #3.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - heat pump #4"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 2 .OR. IfValidAnd( NumHtPumpEquipTypes >= 4 )==0 .OR. LocalCompAssigned( HVACHtPumpRef[4] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for heat pump #4.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - heat pump #5"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 2 .OR. IfValidAnd( NumHtPumpEquipTypes >= 5 )==0 .OR. LocalCompAssigned( HVACHtPumpRef[5] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for heat pump #5.", Name )  endif  }

	"Check for valid DwellUnitType equip assignments - cooling #1"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 1 .OR. IfValidAnd( NumCoolEquipTypes >= 1 )==0 .OR. LocalCompAssigned( HVACCoolRef[1] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for cooling #1.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - cooling #2"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 1 .OR. IfValidAnd( NumCoolEquipTypes >= 2 )==0 .OR. LocalCompAssigned( HVACCoolRef[2] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for cooling #2.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - cooling #3"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 1 .OR. IfValidAnd( NumCoolEquipTypes >= 3 )==0 .OR. LocalCompAssigned( HVACCoolRef[3] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for cooling #3.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - cooling #4"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 1 .OR. IfValidAnd( NumCoolEquipTypes >= 4 )==0 .OR. LocalCompAssigned( HVACCoolRef[4] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for cooling #4.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - cooling #5"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 1 .OR. IfValidAnd( NumCoolEquipTypes >= 5 )==0 .OR. LocalCompAssigned( HVACCoolRef[5] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for cooling #5.", Name )  endif  }

	"Check for valid DwellUnitType equip assignments - heating #1"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 1 .OR. IfValidAnd( NumHeatEquipTypes >= 1 )==0 .OR. LocalCompAssigned( HVACHeatRef[1] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for heating #1.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - heating #2"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 1 .OR. IfValidAnd( NumHeatEquipTypes >= 2 )==0 .OR. LocalCompAssigned( HVACHeatRef[2] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for heating #2.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - heating #3"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 1 .OR. IfValidAnd( NumHeatEquipTypes >= 3 )==0 .OR. LocalCompAssigned( HVACHeatRef[3] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for heating #3.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - heating #4"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 1 .OR. IfValidAnd( NumHeatEquipTypes >= 4 )==0 .OR. LocalCompAssigned( HVACHeatRef[4] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for heating #4.", Name )  endif  }
	"Check for valid DwellUnitType equip assignments - heating #5"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. HVACSysType != 1 .OR. IfValidAnd( NumHeatEquipTypes >= 5 )==0 .OR. LocalCompAssigned( HVACHeatRef[5] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
											else  PostError( "DwellUnitType '%s' is lacking an equipment assignment for heating #5.", Name )  endif  }

   ; same checks for SFam HVACSys objects
	"Check for valid HVACSys:Num*EquipTypes"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else if (Type < 1) then  PostError( "HVACSys '%s' has no HVAC system type specified.", Name )
									else if (Type == 2 .AND. Proj:BypassRuleLimits < 0.5 .AND. IfValidAnd( NumHtPumpSystemTypes > 0.5 )==0)
									then  PostError( "One or more heat pump equipment assignments must be defined for HVACSys '%s'.", Name )
									else if ((Type == 1 .OR. Type == 3) .AND. Proj:BypassRuleLimits < 0.5 .AND. IfValidAnd( NumHeatSystemTypes > 0.5 )==0)
									then  PostError( "One or more heating equipment assignments must be defined for HVACSys '%s'.", Name )
									else if ((Type == 1 .OR. Type == 3) .AND. Proj:BypassRuleLimits < 0.5 .AND. IfValidAnd( NumCoolSystemTypes > 0.5 )==0)
									then  PostError( "One or more cooling equipment assignments must be defined for HVACSys '%s'.", Name )
									else	UNCHANGED  endif endif endif endif endif  }

	"Check for valid HVACSys equip assignments - heat pump #1"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. Type != 2 .OR. IfValidAnd( NumHtPumpSystemTypes >= 1 )==0 .OR. LocalCompAssigned( HtPumpSystem[1] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heat pump #1.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heat pump #2"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. Type != 2 .OR. IfValidAnd( NumHtPumpSystemTypes >= 2 )==0 .OR. LocalCompAssigned( HtPumpSystem[2] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heat pump #2.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heat pump #3"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. Type != 2 .OR. IfValidAnd( NumHtPumpSystemTypes >= 3 )==0 .OR. LocalCompAssigned( HtPumpSystem[3] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heat pump #3.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heat pump #4"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. Type != 2 .OR. IfValidAnd( NumHtPumpSystemTypes >= 4 )==0 .OR. LocalCompAssigned( HtPumpSystem[4] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heat pump #4.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heat pump #5"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. Type != 2 .OR. IfValidAnd( NumHtPumpSystemTypes >= 5 )==0 .OR. LocalCompAssigned( HtPumpSystem[5] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heat pump #5.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heat pump #6"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. Type != 2 .OR. IfValidAnd( NumHtPumpSystemTypes >= 6 )==0 .OR. LocalCompAssigned( HtPumpSystem[6] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heat pump #6.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heat pump #7"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. Type != 2 .OR. IfValidAnd( NumHtPumpSystemTypes >= 7 )==0 .OR. LocalCompAssigned( HtPumpSystem[7] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heat pump #7.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heat pump #8"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. Type != 2 .OR. IfValidAnd( NumHtPumpSystemTypes >= 8 )==0 .OR. LocalCompAssigned( HtPumpSystem[8] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heat pump #8.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heat pump #9"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. Type != 2 .OR. IfValidAnd( NumHtPumpSystemTypes >= 9 )==0 .OR. LocalCompAssigned( HtPumpSystem[9] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heat pump #9.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heat pump #10"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. Type != 2 .OR. IfValidAnd( NumHtPumpSystemTypes >= 10 )==0 .OR. LocalCompAssigned( HtPumpSystem[10] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heat pump #10.", Name )  endif  }

	"Check for valid HVACSys equip assignments - cooling #1"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumCoolSystemTypes >= 1 )==0 .OR. LocalCompAssigned( CoolSystem[1] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for cooling #1.", Name )  endif  }
	"Check for valid HVACSys equip assignments - cooling #2"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumCoolSystemTypes >= 2 )==0 .OR. LocalCompAssigned( CoolSystem[2] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for cooling #2.", Name )  endif  }
	"Check for valid HVACSys equip assignments - cooling #3"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumCoolSystemTypes >= 3 )==0 .OR. LocalCompAssigned( CoolSystem[3] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for cooling #3.", Name )  endif  }
	"Check for valid HVACSys equip assignments - cooling #4"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumCoolSystemTypes >= 4 )==0 .OR. LocalCompAssigned( CoolSystem[4] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for cooling #4.", Name )  endif  }
	"Check for valid HVACSys equip assignments - cooling #5"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumCoolSystemTypes >= 5 )==0 .OR. LocalCompAssigned( CoolSystem[5] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for cooling #5.", Name )  endif  }
	"Check for valid HVACSys equip assignments - cooling #6"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumCoolSystemTypes >= 6 )==0 .OR. LocalCompAssigned( CoolSystem[6] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for cooling #6.", Name )  endif  }
	"Check for valid HVACSys equip assignments - cooling #7"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumCoolSystemTypes >= 7 )==0 .OR. LocalCompAssigned( CoolSystem[7] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for cooling #7.", Name )  endif  }
	"Check for valid HVACSys equip assignments - cooling #8"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumCoolSystemTypes >= 8 )==0 .OR. LocalCompAssigned( CoolSystem[8] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for cooling #8.", Name )  endif  }
	"Check for valid HVACSys equip assignments - cooling #9"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumCoolSystemTypes >= 9 )==0 .OR. LocalCompAssigned( CoolSystem[9] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for cooling #9.", Name )  endif  }
	"Check for valid HVACSys equip assignments - cooling #10"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumCoolSystemTypes >= 10 )==0 .OR. LocalCompAssigned( CoolSystem[10] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for cooling #10.", Name )  endif  }

	"Check for valid HVACSys equip assignments - heating #1"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumHeatSystemTypes >= 1 )==0 .OR. LocalCompAssigned( HeatSystem[1] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heating #1.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heating #2"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumHeatSystemTypes >= 2 )==0 .OR. LocalCompAssigned( HeatSystem[2] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heating #2.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heating #3"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumHeatSystemTypes >= 3 )==0 .OR. LocalCompAssigned( HeatSystem[3] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heating #3.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heating #4"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumHeatSystemTypes >= 4 )==0 .OR. LocalCompAssigned( HeatSystem[4] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heating #4.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heating #5"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumHeatSystemTypes >= 5 )==0 .OR. LocalCompAssigned( HeatSystem[5] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heating #5.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heating #6"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumHeatSystemTypes >= 6 )==0 .OR. LocalCompAssigned( HeatSystem[6] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heating #6.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heating #7"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumHeatSystemTypes >= 7 )==0 .OR. LocalCompAssigned( HeatSystem[7] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heating #7.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heating #8"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumHeatSystemTypes >= 8 )==0 .OR. LocalCompAssigned( HeatSystem[8] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heating #8.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heating #9"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumHeatSystemTypes >= 9 )==0 .OR. LocalCompAssigned( HeatSystem[9] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heating #9.", Name )  endif  }
	"Check for valid HVACSys equip assignments - heating #10"
		HVACSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1 .OR. (Type != 1 .AND. Type != 3) .OR. IfValidAnd( NumHeatSystemTypes >= 10 )==0 .OR. LocalCompAssigned( HeatSystem[10] ) > 0.5 .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else  PostError( "HVACSys '%s' is lacking an equipment assignment for heating #10.", Name )  endif  }

										
;this rule copied from simulation check so that it is evaluated prior to HVACdist placement.
	"Check for existing DistribSystem not of a ducted type but assigned to an HVAC system requiring ducts (or vice-versa)"
		HVACSys:Action	= {	if (strlen( DuctMsg ) < 3) then  UNCHANGED
									else if (HtOrClDucted > 0.5 .AND. LocalCompAssigned( DistribSystem ) == 0)
									then	switch (HtOrClDucted)
												case  1 : PostError( "Ducts required for heating system but not defined for HVAC system '%s' (%s)", Name, EnumString( Type ) )
												case  2 : PostError( "Ducts required for cooling system but not defined for HVAC system '%s' (%s)", Name, EnumString( Type ) )
												default : PostError( "Ducts required for heating & cooling systems but not defined for HVAC system '%s' (%s)", Name, EnumString( Type ) )
											endswitch
									else if (HtOrClDucted > 0.5 .AND. DistribSystem:DuctsPresent == 0 .AND. DistribSystem:Type != 7 .AND. DistribSystem:Type != 12)
									then	switch (HtOrClDucted)
												case  1 : PostError( "Ducts required for heating system but assigned distribution system lacks ducts for HVAC system '%s' (%s)", Name, EnumString( Type ) )
												case  2 : PostError( "Ducts required for cooling system but assigned distribution system lacks ducts for HVAC system '%s' (%s)", Name, EnumString( Type ) )
												default : PostError( "Ducts required for htg & clg systems but assigned distribution system lacks ducts for HVAC system '%s' (%s)", Name, EnumString( Type ) )
											endswitch
									else if (HtOrClDucted < 0.5 .AND. LocalCompAssigned( DistribSystem ) > 0)
									then	if (DistribSystem:DuctsPresent > 0)
											then  PostError( "Ducts not required for heating or cooling but included in assigned distribution system for HVAC system '%s' (%s)", Name, EnumString( Type ) )
											else  UNCHANGED  endif
									else  UNCHANGED  endif endif endif endif  }


; SAC 11/14/14 - added checks to ensure that heating & cooling equipment types and counts are consistent w/ each other for all centrally ducted systems
	"Check for consistent Num*EquipTypes for centrally ducted heat/cool systems"
		DwellUnitType:Action	= {	if (IfValidAnd( NumHeatEquipTypes = NumCoolEquipTypes ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1) then  UNCHANGED
											else	PostError( "Centrally ducted HVAC system serving DwellUnitType '%s' must have consistent numbers of heating and cooling unit types (%.0f <> %.0f).", Name, NumHeatEquipTypes, NumCoolEquipTypes )  endif  }
	"Check for consistent Counts for heat/cool unit type #1 (for centrally ducted heat/cool systems)"
		DwellUnitType:Action	= {	if (IfValidAnd( NumHeatEquipTypes >= 1 )==0 .OR. IfValidAnd( NumCoolEquipTypes >= 1 )==0 .OR. IfValidAnd( HeatEquipCount[1] = CoolEquipCount[1] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1) then  UNCHANGED
											else	PostError( "Centrally ducted HVAC system serving DwellUnitType '%s' must have consistent counts of heating and cooling unit type #1 (%.0f <> %.0f).", Name, HeatEquipCount[1], CoolEquipCount[1] )  endif  }
	"Check for consistent Counts for heat/cool unit type #2 (for centrally ducted heat/cool systems)"
		DwellUnitType:Action	= {	if (IfValidAnd( NumHeatEquipTypes >= 2 )==0 .OR. IfValidAnd( NumCoolEquipTypes >= 2 )==0 .OR. IfValidAnd( HeatEquipCount[2] = CoolEquipCount[2] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1) then  UNCHANGED
											else	PostError( "Centrally ducted HVAC system serving DwellUnitType '%s' must have consistent counts of heating and cooling unit type #2 (%.0f <> %.0f).", Name, HeatEquipCount[2], CoolEquipCount[2] )  endif  }
	"Check for consistent Counts for heat/cool unit type #3 (for centrally ducted heat/cool systems)"
		DwellUnitType:Action	= {	if (IfValidAnd( NumHeatEquipTypes >= 3 )==0 .OR. IfValidAnd( NumCoolEquipTypes >= 3 )==0 .OR. IfValidAnd( HeatEquipCount[3] = CoolEquipCount[3] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1) then  UNCHANGED
											else	PostError( "Centrally ducted HVAC system serving DwellUnitType '%s' must have consistent counts of heating and cooling unit type #3 (%.0f <> %.0f).", Name, HeatEquipCount[3], CoolEquipCount[3] )  endif  }
	"Check for consistent Counts for heat/cool unit type #4 (for centrally ducted heat/cool systems)"
		DwellUnitType:Action	= {	if (IfValidAnd( NumHeatEquipTypes >= 4 )==0 .OR. IfValidAnd( NumCoolEquipTypes >= 4 )==0 .OR. IfValidAnd( HeatEquipCount[4] = CoolEquipCount[4] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1) then  UNCHANGED
											else	PostError( "Centrally ducted HVAC system serving DwellUnitType '%s' must have consistent counts of heating and cooling unit type #4 (%.0f <> %.0f).", Name, HeatEquipCount[4], CoolEquipCount[4] )  endif  }
	"Check for consistent Counts for heat/cool unit type #5 (for centrally ducted heat/cool systems)"
		DwellUnitType:Action	= {	if (IfValidAnd( NumHeatEquipTypes >= 5 )==0 .OR. IfValidAnd( NumCoolEquipTypes >= 5 )==0 .OR. IfValidAnd( HeatEquipCount[5] = CoolEquipCount[5] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1) then  UNCHANGED
											else	PostError( "Centrally ducted HVAC system serving DwellUnitType '%s' must have consistent counts of heating and cooling unit type #5 (%.0f <> %.0f).", Name, HeatEquipCount[5], CoolEquipCount[5] )  endif  }

; SAC 11/14/14 - added checks to ensure that heating & cooling equipment types and counts are consistent w/ each other for all centrally ducted systems
	"Check for consistent Num*SystemTypes for centrally ducted heat/cool systems"
		HVACSys:Action	= {	if (IfValidAnd( NumHeatSystemTypes = NumCoolSystemTypes ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else	PostError( "Centrally ducted HVAC system '%s' must have consistent numbers of heating and cooling unit types (%.0f <> %.0f).", Name, NumHeatSystemTypes, NumCoolSystemTypes )  endif  }
	"Check for consistent Counts for heat/cool unit type #1 (for centrally ducted heat/cool systems)"
		HVACSys:Action	= {	if (IfValidAnd( NumHeatSystemTypes >= 1 )==0 .OR. IfValidAnd( NumCoolSystemTypes >= 1 )==0 .OR. IfValidAnd( HeatSystemCount[1] = CoolSystemCount[1] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else	PostError( "Centrally ducted HVAC system '%s' must have consistent counts of heating and cooling unit type #1 (%.0f <> %.0f).", Name, HeatSystemCount[1], CoolSystemCount[1] )  endif  }
	"Check for consistent Counts for heat/cool unit type #2 (for centrally ducted heat/cool systems)"
		HVACSys:Action	= {	if (IfValidAnd( NumHeatSystemTypes >= 2 )==0 .OR. IfValidAnd( NumCoolSystemTypes >= 2 )==0 .OR. IfValidAnd( HeatSystemCount[2] = CoolSystemCount[2] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else	PostError( "Centrally ducted HVAC system '%s' must have consistent counts of heating and cooling unit type #2 (%.0f <> %.0f).", Name, HeatSystemCount[2], CoolSystemCount[2] )  endif  }
	"Check for consistent Counts for heat/cool unit type #3 (for centrally ducted heat/cool systems)"
		HVACSys:Action	= {	if (IfValidAnd( NumHeatSystemTypes >= 3 )==0 .OR. IfValidAnd( NumCoolSystemTypes >= 3 )==0 .OR. IfValidAnd( HeatSystemCount[3] = CoolSystemCount[3] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else	PostError( "Centrally ducted HVAC system '%s' must have consistent counts of heating and cooling unit type #3 (%.0f <> %.0f).", Name, HeatSystemCount[3], CoolSystemCount[3] )  endif  }
	"Check for consistent Counts for heat/cool unit type #4 (for centrally ducted heat/cool systems)"
		HVACSys:Action	= {	if (IfValidAnd( NumHeatSystemTypes >= 4 )==0 .OR. IfValidAnd( NumCoolSystemTypes >= 4 )==0 .OR. IfValidAnd( HeatSystemCount[4] = CoolSystemCount[4] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else	PostError( "Centrally ducted HVAC system '%s' must have consistent counts of heating and cooling unit type #4 (%.0f <> %.0f).", Name, HeatSystemCount[4], CoolSystemCount[4] )  endif  }
	"Check for consistent Counts for heat/cool unit type #5 (for centrally ducted heat/cool systems)"
		HVACSys:Action	= {	if (IfValidAnd( NumHeatSystemTypes >= 5 )==0 .OR. IfValidAnd( NumCoolSystemTypes >= 5 )==0 .OR. IfValidAnd( HeatSystemCount[5] = CoolSystemCount[5] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else	PostError( "Centrally ducted HVAC system '%s' must have consistent counts of heating and cooling unit type #5 (%.0f <> %.0f).", Name, HeatSystemCount[5], CoolSystemCount[5] )  endif  }
	"Check for consistent Counts for heat/cool unit type #6 (for centrally ducted heat/cool systems)"
		HVACSys:Action	= {	if (IfValidAnd( NumHeatSystemTypes >= 6 )==0 .OR. IfValidAnd( NumCoolSystemTypes >= 6 )==0 .OR. IfValidAnd( HeatSystemCount[6] = CoolSystemCount[6] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else	PostError( "Centrally ducted HVAC system '%s' must have consistent counts of heating and cooling unit type #6 (%.0f <> %.0f).", Name, HeatSystemCount[6], CoolSystemCount[6] )  endif  }
	"Check for consistent Counts for heat/cool unit type #7 (for centrally ducted heat/cool systems)"
		HVACSys:Action	= {	if (IfValidAnd( NumHeatSystemTypes >= 7 )==0 .OR. IfValidAnd( NumCoolSystemTypes >= 7 )==0 .OR. IfValidAnd( HeatSystemCount[7] = CoolSystemCount[7] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else	PostError( "Centrally ducted HVAC system '%s' must have consistent counts of heating and cooling unit type #7 (%.0f <> %.0f).", Name, HeatSystemCount[7], CoolSystemCount[7] )  endif  }
	"Check for consistent Counts for heat/cool unit type #8 (for centrally ducted heat/cool systems)"
		HVACSys:Action	= {	if (IfValidAnd( NumHeatSystemTypes >= 8 )==0 .OR. IfValidAnd( NumCoolSystemTypes >= 8 )==0 .OR. IfValidAnd( HeatSystemCount[8] = CoolSystemCount[8] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else	PostError( "Centrally ducted HVAC system '%s' must have consistent counts of heating and cooling unit type #8 (%.0f <> %.0f).", Name, HeatSystemCount[8], CoolSystemCount[8] )  endif  }
	"Check for consistent Counts for heat/cool unit type #9 (for centrally ducted heat/cool systems)"
		HVACSys:Action	= {	if (IfValidAnd( NumHeatSystemTypes >= 9 )==0 .OR. IfValidAnd( NumCoolSystemTypes >= 9 )==0 .OR. IfValidAnd( HeatSystemCount[9] = CoolSystemCount[9] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else	PostError( "Centrally ducted HVAC system '%s' must have consistent counts of heating and cooling unit type #9 (%.0f <> %.0f).", Name, HeatSystemCount[9], CoolSystemCount[9] )  endif  }
	"Check for consistent Counts for heat/cool unit type #10 (for centrally ducted heat/cool systems)"
		HVACSys:Action	= {	if (IfValidAnd( NumHeatSystemTypes >= 10 )==0 .OR. IfValidAnd( NumCoolSystemTypes >= 10 )==0 .OR. IfValidAnd( HeatSystemCount[10] = CoolSystemCount[10] ) .OR. EqpCountsMustAlign < 0.5 .OR. Proj:IsMultiFamily > 0.5 .OR. FloorAreaServed < 1) then  UNCHANGED
									else	PostError( "Centrally ducted HVAC system '%s' must have consistent counts of heating and cooling unit type #10 (%.0f <> %.0f).", Name, HeatSystemCount[10], CoolSystemCount[10] )  endif  }


	; SAC 11/14/13 - added check for heat pumps including valid capacities
;	"debug HP CAP check"									HVACHtPump:Action	= {	PostWarning( "HVACHtPump '%s' Type = %g  Cap47 = %g  Cap47 = %g", Name, Type, Cap47, Cap17 )	}
	"Check for valid HVACHtPump capacities"		HVACHtPump:Action	= {	if (FloorAreaServed < 0.1) then  UNCHANGED
																								else if (LocalStatus( Cap47 ) < 1 .OR. (LocalStatus( Cap17 ) < 1 .AND. Type < 12))
																								then	PostError( "Heat pump '%s' must have valid Cap47 & Cap17 inputs in order to be simulated.", Name )
																								else if (IfValidAnd(Cap47 > 0.1) .AND. (IfValidAnd(Cap17 > 0.1) .OR. Type == 12)) then  UNCHANGED
																								else	PostError( "Heat pump '%s' must have valid Cap47 & Cap17 inputs in order to be simulated.", Name )  endif endif endif  }

	"Check for all conditioned zones having valid assignments of HVAC Systems w/ valid Heating systems"  ; SAC 6/7/13 - per GC issue #103
		Zone:Action			= {	if (Type < 0.5 .OR. Type > 9.5) then  UNCHANGED
										else if (LocalCompAssigned( ActiveHVACSystem ) == 0)
										then	PostError( "Zone '%s' is a conditioned zone that must have a valid HVAC system assigned in order to be simulated.", Name )
										else if (LocalStatus( ActiveHVACSystem:Type ) == 0)
										then	PostError( "HVAC system '%s' assigned to zone '%s' must specify a valid system Type in order to be simulated.", ActiveHVACSystem:Name, Name )
										else if (ActiveHVACSystem:Type == 2)
										then	if (ActiveHVACSystem:HaveHeating == 0)
												then	PostError( "HVAC system '%s' assigned to zone '%s' must include a valid heat pump component in order to be simulated.", ActiveHVACSystem:Name, Name )
												else if (ActiveHVACSystem:HtPumpSystem:Type < 0.5)
												then	PostError( "Heat pump component '%s' of HVAC system '%s' assigned to zone '%s' must be of a valid type in order to be simulated.", ActiveHVACSystem:HtPumpSystem:Name, ActiveHVACSystem:Name, Name )
												else  UNCHANGED  endif endif
										else if (ActiveHVACSystem:Type == 1 .OR. (ActiveHVACSystem:Type == 3 .AND. Proj:EnableVarFlowOAV > 0.5))  ; SAC 10/3/13 - reporting Type = 3 not available above - was:  .OR. HVACSystem:Type == 3)
										then 	if (LocalCompAssigned( ActiveHVACSystem:HeatSystem ) == 0)
												then	PostError( "HVAC system '%s' assigned to zone '%s' must include a valid heating component in order to be simulated.", ActiveHVACSystem:Name, Name )
												else if (ActiveHVACSystem:HeatSystem:Type < 0.5)
												then	PostError( "Heating component '%s' of HVAC system '%s' assigned to zone '%s' must be of a valid type in order to be simulated.", ActiveHVACSystem:HeatSystem:Name, ActiveHVACSystem:Name, Name )
												else  UNCHANGED  endif endif
										else	PostError( "HVAC system '%s' assigned to zone '%s' cannot be simulated due to a unrecognized system type (%.0f).", ActiveHVACSystem:Name, Name, ActiveHVACSystem:Type )
										endif endif endif endif endif  }

; "Dbg-1"		HVACSys:Action	= {	MessageBox( "Proj:RunScope = %g  Fan:Status = %g", Proj:RunScope, Fan:Status )  }

	"Check for mandatory minimum fan system efficacy (ACM 2.2.12)"
		HVACSys:Action	= {	if ( LocalCompAssigned( Fan ) == 0 .OR. (Proj:RunScope == 2 .AND. Fan:Status == 2 .AND. Fan:IsVerified) .OR. (Proj:RunScope == 2 .AND. Fan:Status == 1) .OR. Proj:BypassRuleLimits > 0.5) then  UNCHANGED
									else if (Fan:Type == 1 .AND. Fan:WperCFMCool > 0.58)
									then	PostError( "Fan '%s' (%s) has efficacy of %g W/CFM which is higher than the mandatory maximum of 0.58", Name, EnumString( Type ), Fan:WperCFMCool )
									else  UNCHANGED  endif endif  }

	"Check for mandatory minimum HVACCool system airflow"
	; SAC 12/23/13 - added improved defaulting of HVACCool:FloorAreaServed and revised logic enable this rule to be evaluated on each HVACCool object rather than each HVACSys (which was causing GC issue #249)
		HVACCool:Action	= {	if ( FloorAreaServed < 0.1 .OR. Proj:RunScope != 1 .OR. Type < 2 .OR. Type == 5 .OR. Type == 16 .OR. Type == 20 .OR. Type == 21 .OR. Proj:BypassRuleLimits > 0.5) then UNCHANGED
										else if ( IsZonal < 1 .AND. CFMperTon < 350 ) then PostError( "Cooling System '%s' has airflow of %g CFM/Ton which is less than the mandatory minimum of 350 for non-zonal systems", Name, CFMperTon )
										else if ( IsZonal > 0 .AND. CFMperTon < 150 ) then PostError( "Cooling System '%s' has airflow of %g CFM/Ton which is less than the mandatory minimum of 150 for zonal systems", Name, CFMperTon )
										else  UNCHANGED  endif endif endif  }

	"Check for mandatory minimum HVACHtPump system airflow"
		HVACHtPump:Action	= {	if ( FloorAreaServed < 0.1 .OR. Proj:RunScope != 1 .OR. Type < 1 .OR. Type == 7 .OR. Type == 10 .OR. Type == 11 .OR. Type == 20 .OR. Type == 21 .OR. Proj:BypassRuleLimits > 0.5) then UNCHANGED
										else if ( IsZonal < 1 .AND. CFMperTon < 350 ) then PostError( "Heat Pump System '%s' has airflow of %g CFM/Ton which is less than the mandatory minimum of 350 for non-zonal systems", Name, CFMperTon )
										else if ( IsZonal > 0 .AND. CFMperTon < 150 ) then PostError( "Heat Pump System '%s' has airflow of %g CFM/Ton which is less than the mandatory minimum of 150 for zonal systems", Name, CFMperTon )
										else  UNCHANGED  endif endif endif  }

  ; SAC 1/6/14 - added checks for water heaters assigned to each combined hydronic system AND that each such assignment is valid
  ; SAC 1/6/16 - removed check preventing elec equipment from serving as combined hydronic heat source (tic 374)
	"Check for proper DHWHeater: for each assignment as a combined hydronic system"
		HVACHeat:Action	= {	if (FloorAreaServed < 0.1 .OR. Type < 1 .OR. Type != 9) then  UNCHANGED
										else if (LocalCompAssigned( CHWHeater ) < 0.5) then  PostError( "Combined hydronic heating system '%s' must include a valid water heater assginment.", Name )
								;		else if (      CHWHeater:CanBeCHWHeater < 0.5) then  PostError( "The water heater '%s' assigned to combined hydronic heating system '%s' cannot be electric powered.", CHWHeater:Name, Name )
										else  UNCHANGED  endif endif  }  ; endif  }

; "store BEMProc details"		Proj:Action = {  StoreBEMProc( "b4 InterCondZnArea chk", 0 )  }
; "Dbg-1"	Proj:Action	= {	MessageBox( "SumAll( Zone:CondFloorArea ) = %g  //  MaxAll( Zone:CondFloorArea ) = %g", SumAll( Zone:CondFloorArea ), MaxAll( Zone:CondFloorArea ) )  }

	"Check for at least some inter-conditioned zone surface area (when multiple conditioned zones are present)"
		Zone:Action		= {	if (Type < 10 .AND. InterCondZnArea < 1 .AND. ComponentCount( Zone ) > 1.5)
									then	if (SumAll( Zone:CondFloorArea ) > (MaxAll( Zone:CondFloorArea )+1))
											then	PostError( "Zone '%s' has no common surface with another conditioned zone (each conditioned zone must be at least one)", Name )
											else  UNCHANGED  endif
									else  UNCHANGED  endif  }

	"Check for consistent altered/existing HVAC system types when HVAC altered & verified"
		Zone:Action		= {	if (Proj:RunScope != 2 .OR. HVACSysStatus != 2 .OR. HVACSysVerified == 0 .OR.
											LocalCompAssigned( AltHVACSystem ) == 0 .OR. LocalCompAssigned( exHVACSystem ) == 0) then  UNCHANGED
									else if (AltHVACSystem:Type != exHVACSystem:Type)
									then	PostError( "Zone '%s' has incompatible altered and existing HVAC system assignments.  To get compliance credit, altered and verified system types must be consistent.", Name )
									else if (AltHVACSystem:Type == 2)
									then	; heat pump system
											if (	CA13HeatingEquipment:HSPFValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", AltHVACSystem:HtPumpSysTypeAbbrev ) > 0 .AND. 
													CA13HeatingEquipment:HSPFValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType",  exHVACSystem:HtPumpSysTypeAbbrev ) < 1)
											then	PostError( "Zone '%s' has incompatible altered and existing heating systems.  Altered system uses HSPF and existing does not.  To get compliance credit, altered and verified heating system types must be consistent.", Name )
											else if (CA13CoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", AltHVACSystem:HtPumpSysTypeAbbrev ) > 0 .AND. 
														CA13CoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType",  exHVACSystem:HtPumpSysTypeAbbrev ) < 1)
											then	PostError( "Zone '%s' has incompatible altered and existing cooling systems.  Altered system uses SEER and existing does not.  To get compliance credit, altered and verified cooling system types must be consistent.", Name )
											else if (CA13CoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", AltHVACSystem:HtPumpSysTypeAbbrev ) > 0 .AND. 
														CA13CoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType",  exHVACSystem:HtPumpSysTypeAbbrev ) < 1)
											then	PostError( "Zone '%s' has incompatible altered and existing cooling systems.  Altered system uses EER and existing does not.  To get compliance credit, altered and verified cooling system types must be consistent.", Name )
											else  UNCHANGED  endif endif endif
									else
											if (CA13HeatingEquipment:AFUEValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", AltHVACSystem:HeatSysTypeAbbrev ) > 0 .AND. 
														CA13HeatingEquipment:AFUEValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType",  exHVACSystem:HeatSysTypeAbbrev ) < 1)
											then	PostError( "Zone '%s' has incompatible altered and existing heating systems.  Altered system uses AFUE and existing does not.  To get compliance credit, altered and verified heating system types must be consistent.", Name )
											else if (CA13CoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", AltHVACSystem:CoolSysTypeAbbrev ) > 0 .AND. 
														CA13CoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType",  exHVACSystem:CoolSysTypeAbbrev ) < 1)
											then	PostError( "Zone '%s' has incompatible altered and existing cooling systems.  Altered system uses SEER and existing does not.  To get compliance credit, altered and verified cooling system types must be consistent.", Name )
											else if (CA13CoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", AltHVACSystem:CoolSysTypeAbbrev ) > 0 .AND. 
														CA13CoolingEquipment:EERValid(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType",  exHVACSystem:CoolSysTypeAbbrev ) < 1)
											then	PostError( "Zone '%s' has incompatible altered and existing cooling systems.  Altered system uses EER and existing does not.  To get compliance credit, altered and verified cooling system types must be consistent.", Name )
											else  UNCHANGED  endif endif endif
									endif endif endif  }

; SAC 10/26/15 - removed restriction on combination of central and non-central DHW systems
;	; SAC 3/19/15 - Check to ensure that for 2016 std design we don't have a COMBINATION of central and non-central DHW systems, since non-central std design needs to be modeled as instantaneous via simulation
;	;						and we don't have logic/rules yet to setup std design central DHW systems for simulation
;	"Ensure no combination of central & non-central DHW systems for 2016 rules"
;		Proj:Action		= {	if (Proj:IsMultiFamily > 0.5 .AND. Proj:StdDesignBase == 2016 .AND. SumAll( DwellUnitType:NumDUsCntrlDHW ) > 0.5 .AND. SumAll( DwellUnitType:NumDUsNonCntrlDHW ) > 0.5)
;									then  PostError( "Multifamily models being analyzed using 2016 Title-24 rules cannot include both central and non-central DHW systems.  Convert to all central or all non-central before re-analyzing the model." )
;									else  UNCHANGED  endif  }

  ; SAC 1/11/16 - check to ensure that New Cons projects include DHW use
  ; SAC 2/24/16 - altered logic to include EAA & AA projects in those requiring DHW use (tic #607)
	"Ensure DHW in New Cons projects"	Proj:Action	= {	if (AnalysisType < 1) then  UNCHANGED		; allow no DHW in Research-mode analysis
																			else if (SumAcrossIf( DHWSys:FloorAreaServed, DHWSys:TotNumDHWHeaters > 0 ) > 0.5) then  UNCHANGED
																			else	PostError( "All compliance projects must include DHW equipment and assignments to zones/dwelling units." )
																			endif endif  }

  ; SAC 2/26/16 - added for error checking associated w/ ticket #607
	"Ensure that there are valid (new/alt/ex) DHWSys objects to assign to any Zones or DwellUnitTypes lacking DHWSys assignments"
		Proj:Action		= {	if (LocalCompAssigned( MaxDHWSysByCateg[1] ) < 1 .AND. LocalCompAssigned( MaxDHWSysByCateg[4] ) < 1 .AND. SumAll( Zone:DHWUnassignedFloorArea[1] ) >= 1)
									then	PostError( "The model includes one or more Zones with a DHW status of 'New' but no New DHWSys object to assign to the Zone(s)." )
									else if (RunScope == 2 .AND. LocalCompAssigned( MaxDHWSysByCateg[2] ) < 1 .AND. LocalCompAssigned( MaxDHWSysByCateg[5] ) < 1 .AND. SumAll( Zone:DHWUnassignedFloorArea[2] ) >= 1)
									then	PostError( "The model includes one or more Zones with a DHW status of 'Altered' but no Altered DHWSys object to assign to the Zone(s)." )
									else if ((RunScope == 2 .OR. IsAddAlone > 0) .AND. LocalCompAssigned( MaxDHWSysByCateg[3] ) < 1 .AND. LocalCompAssigned( MaxDHWSysByCateg[6] ) < 1 .AND.
												SumAll( Zone:DHWUnassignedFloorArea[3] ) >= 1)
									then	PostError( "The model includes one or more Zones with a DHW status of 'Existing' but no Existing DHWSys object to assign to the Zone(s)." )
									else	UNCHANGED  endif endif endif  }

	; SAC 8/17/16 - added check to ensure that all pertinent DHW assignments are present in each DwellUnitType
   "Check for all pertinent DHW system assignments in each (modeled) DwellUnitType"
      DwellUnitType:Action	= {
         if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1) then  UNCHANGED
         else if (IfValidAnd( NumDHWSysTypes >= 1 ) .AND. LocalCompAssigned( DHWSysRef[1] )==0)
         then  PostError( "DHW system assignment #1 missing in dwelling unit type '%s'", Name )
         else if (IfValidAnd( NumDHWSysTypes >= 2 ) .AND. LocalCompAssigned( DHWSysRef[2] )==0)
         then  PostError( "DHW system assignment #2 missing in dwelling unit type '%s'", Name )
         else if (IfValidAnd( NumDHWSysTypes >= 3 ) .AND. LocalCompAssigned( DHWSysRef[3] )==0)
         then  PostError( "DHW system assignment #3 missing in dwelling unit type '%s'", Name )
         else if (IfValidAnd( NumDHWSysTypes >= 4 ) .AND. LocalCompAssigned( DHWSysRef[4] )==0)
         then  PostError( "DHW system assignment #4 missing in dwelling unit type '%s'", Name )
         else if (IfValidAnd( NumDHWSysTypes >= 5 ) .AND. LocalCompAssigned( DHWSysRef[5] )==0)
         then  PostError( "DHW system assignment #5 missing in dwelling unit type '%s'", Name )
         else  UNCHANGED  endif endif endif endif endif endif  }

	; SAC 10/24/15 - added check to ensure only one DHWSys assignment to DwellUnitTypes when a central DHWSys is assigned
	"Check for no more than 1 DwellUnitType DHW system when a central system is assigned"
		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. AssignedDUFlrArea < 1 .OR. NumDHWSysTypes < 2) then  UNCHANGED
											else if (LocalCompAssigned( DHWSysRef[1] ) .AND. IfValidAnd( DHWSysRef[1]:CentralDHW > 0.5 ) .AND.
														( (                          LocalCompAssigned( DHWSysRef[2] )) .OR.
														  (NumDHWSysTypes >= 3 .AND. LocalCompAssigned( DHWSysRef[3] )) .OR.
														  (NumDHWSysTypes >= 4 .AND. LocalCompAssigned( DHWSysRef[4] )) .OR.
														  (NumDHWSysTypes >= 5 .AND. LocalCompAssigned( DHWSysRef[5] )) ) )
											then	PostError( "DHW system #1 assigned to dwelling unit type '%s' is central, so no other DHW systems can be assigned.", Name )
											else if (NumDHWSysTypes >= 2 .AND. LocalCompAssigned( DHWSysRef[2] ) .AND. IfValidAnd( DHWSysRef[2]:CentralDHW > 0.5 ) .AND.
														( (                          LocalCompAssigned( DHWSysRef[1] )) .OR.
														  (NumDHWSysTypes >= 3 .AND. LocalCompAssigned( DHWSysRef[3] )) .OR.
														  (NumDHWSysTypes >= 4 .AND. LocalCompAssigned( DHWSysRef[4] )) .OR.
														  (NumDHWSysTypes >= 5 .AND. LocalCompAssigned( DHWSysRef[5] )) ) )
											then	PostError( "DHW system #2 assigned to dwelling unit type '%s' is central, so no other DHW systems can be assigned.", Name )
											else if (NumDHWSysTypes >= 3 .AND. LocalCompAssigned( DHWSysRef[3] ) .AND. IfValidAnd( DHWSysRef[3]:CentralDHW > 0.5 ) .AND.
														( (                          LocalCompAssigned( DHWSysRef[1] )) .OR.
														  (                          LocalCompAssigned( DHWSysRef[2] )) .OR.
														  (NumDHWSysTypes >= 4 .AND. LocalCompAssigned( DHWSysRef[4] )) .OR.
														  (NumDHWSysTypes >= 5 .AND. LocalCompAssigned( DHWSysRef[5] )) ) )
											then	PostError( "DHW system #3 assigned to dwelling unit type '%s' is central, so no other DHW systems can be assigned.", Name )
											else if (NumDHWSysTypes >= 4 .AND. LocalCompAssigned( DHWSysRef[4] ) .AND. IfValidAnd( DHWSysRef[4]:CentralDHW > 0.5 ) .AND.
														( (                          LocalCompAssigned( DHWSysRef[1] )) .OR.
														  (                          LocalCompAssigned( DHWSysRef[2] )) .OR.
														  (                          LocalCompAssigned( DHWSysRef[3] )) .OR.
														  (NumDHWSysTypes >= 5 .AND. LocalCompAssigned( DHWSysRef[5] )) ) )
											then	PostError( "DHW system #4 assigned to dwelling unit type '%s' is central, so no other DHW systems can be assigned.", Name )
											else if (NumDHWSysTypes >= 5 .AND. LocalCompAssigned( DHWSysRef[5] ) .AND. IfValidAnd( DHWSysRef[5]:CentralDHW > 0.5 ) .AND.
														( LocalCompAssigned( DHWSysRef[1] ) .OR.
														  LocalCompAssigned( DHWSysRef[2] ) .OR.
														  LocalCompAssigned( DHWSysRef[3] ) .OR.
														  LocalCompAssigned( DHWSysRef[4] ) ) )
											then	PostError( "DHW system #5 assigned to dwelling unit type '%s' is central, so no other DHW systems can be assigned.", Name )
											else	UNCHANGED  endif endif endif endif endif endif  }

	; SAC 9/30/15 - new check similar to the one below for conflicts in existing vs. new/altered DHWSys objects
	; SAC 10/5/15 - added logic to check to ensure that there is at least one DHWHeater assigned (w/ Count > 0) to every DHWSys object w/ assigned floor area
	"Ensure DHWSys objects not assigned to serve BOTH new/altered & existing areas"
		DHWSys:Action		= {	if (Proj:RunScope == 2 .AND. ExFlrAreaServed >= 1 .AND. (AltFlrAreaServed + NewFlrAreaServed) >= 1)
										then	if (Proj:IsMultiFamily > 0.5)
												then	PostError( "DHW System '%s' is assigned to a combination of existing and new/altered dwelling unit types.  No one system can be referenced as an existing system and a new/altered system by different dwelling unit types.", Name )
												else	PostError( "DHW System '%s' is assigned to a combination of existing and new/altered zones.  No one system can be referenced as an existing system and a new/altered system by different zones.", Name )
												endif
										else if (IfValidAnd( FloorAreaServed >= 1 ) .AND. IfValidAnd( FirstDHWHtrIndex > 0 )==0)
										then	PostError( "DHW System '%s' is assigned to one or more dwelling units/zones but no valid DHW heaters (w/ counts > 0) are assigned.", Name )
										else	UNCHANGED  endif endif  }

	; SAC 4/13/16 - new check to ensure "Heat Pump (2016)" DHWHeaters are not assigned to new or altered DHWSys objects
	"Ensure central DHW systems are not served by 'Heat Pump (2016)' water heaters (heater #1)"
		DHWSys:Action		= {	if (Proj:IsMultiFamily < 0.5 .OR. CentralDHW < 0.5 .OR. (AltFlrAreaServed + NewFlrAreaServed) < 1) then  UNCHANGED
										else if (NumDHWHeaters < 1 .OR. IfValidAnd( HeaterMult[1] > 0 )==0 .OR. LocalCompAssigned( DHWHeater[1] ) != ComponentType( "DHWHeater" )) then  UNCHANGED
										else if (DHWHeater[1]:HeaterElementType != 5) then  UNCHANGED
										else	PostError( "Compliance analysis not enabled for DHW heater #1 of type 'Heat Pump (2016)' serving central DHW System '%s'", Name )  endif endif endif  }
	"Ensure central DHW systems are not served by 'Heat Pump (2016)' water heaters (heater #2)"
		DHWSys:Action		= {	if (Proj:IsMultiFamily < 0.5 .OR. CentralDHW < 0.5 .OR. (AltFlrAreaServed + NewFlrAreaServed) < 1) then  UNCHANGED
										else if (NumDHWHeaters < 2 .OR. IfValidAnd( HeaterMult[2] > 0 )==0 .OR. LocalCompAssigned( DHWHeater[2] ) != ComponentType( "DHWHeater" )) then  UNCHANGED
										else if (DHWHeater[2]:HeaterElementType != 5) then  UNCHANGED
										else	PostError( "Compliance analysis not enabled for DHW heater #2 of type 'Heat Pump (2016)' serving central DHW System '%s'", Name )  endif endif endif  }
	"Ensure central DHW systems are not served by 'Heat Pump (2016)' water heaters (heater #3)"
		DHWSys:Action		= {	if (Proj:IsMultiFamily < 0.5 .OR. CentralDHW < 0.5 .OR. (AltFlrAreaServed + NewFlrAreaServed) < 1) then  UNCHANGED
										else if (NumDHWHeaters < 3 .OR. IfValidAnd( HeaterMult[3] > 0 )==0 .OR. LocalCompAssigned( DHWHeater[3] ) != ComponentType( "DHWHeater" )) then  UNCHANGED
										else if (DHWHeater[3]:HeaterElementType != 5) then  UNCHANGED
										else	PostError( "Compliance analysis not enabled for DHW heater #3 of type 'Heat Pump (2016)' serving central DHW System '%s'", Name )  endif endif endif  }
	"Ensure central DHW systems are not served by 'Heat Pump (2016)' water heaters (heater #4)"
		DHWSys:Action		= {	if (Proj:IsMultiFamily < 0.5 .OR. CentralDHW < 0.5 .OR. (AltFlrAreaServed + NewFlrAreaServed) < 1) then  UNCHANGED
										else if (NumDHWHeaters < 4 .OR. IfValidAnd( HeaterMult[4] > 0 )==0 .OR. LocalCompAssigned( DHWHeater[4] ) != ComponentType( "DHWHeater" )) then  UNCHANGED
										else if (DHWHeater[4]:HeaterElementType != 5) then  UNCHANGED
										else	PostError( "Compliance analysis not enabled for DHW heater #4 of type 'Heat Pump (2016)' serving central DHW System '%s'", Name )  endif endif endif  }
	"Ensure central DHW systems are not served by 'Heat Pump (2016)' water heaters (heater #5)"
		DHWSys:Action		= {	if (Proj:IsMultiFamily < 0.5 .OR. CentralDHW < 0.5 .OR. (AltFlrAreaServed + NewFlrAreaServed) < 1) then  UNCHANGED
										else if (NumDHWHeaters < 5 .OR. IfValidAnd( HeaterMult[5] > 0 )==0 .OR. LocalCompAssigned( DHWHeater[5] ) != ComponentType( "DHWHeater" )) then  UNCHANGED
										else if (DHWHeater[5]:HeaterElementType != 5) then  UNCHANGED
										else	PostError( "Compliance analysis not enabled for DHW heater #5 of type 'Heat Pump (2016)' serving central DHW System '%s'", Name )  endif endif endif  }
	"Ensure central DHW systems are not served by 'Heat Pump (2016)' water heaters (heater #6)"
		DHWSys:Action		= {	if (Proj:IsMultiFamily < 0.5 .OR. CentralDHW < 0.5 .OR. (AltFlrAreaServed + NewFlrAreaServed) < 1) then  UNCHANGED
										else if (NumDHWHeaters < 6 .OR. IfValidAnd( HeaterMult[6] > 0 )==0 .OR. LocalCompAssigned( DHWHeater[6] ) != ComponentType( "DHWHeater" )) then  UNCHANGED
										else if (DHWHeater[6]:HeaterElementType != 5) then  UNCHANGED
										else	PostError( "Compliance analysis not enabled for DHW heater #6 of type 'Heat Pump (2016)' serving central DHW System '%s'", Name )  endif endif endif  }

	; SAC 12/23/14 - new check for conflicts in existing vs. new/altered DHWHeater objects
	"Ensure DHWHeater objects not assigned to serve BOTH new/altered & existing areas"
		DHWHeater:Action	= {	if (Proj:RunScope == 2 .AND. ExFlrAreaServed >= 1 .AND. (AltFlrAreaServed + NewFlrAreaServed) >= 1)
										then	PostError( "DHW Heater '%s' is assigned to DHW system(s) that serve a combination of existing and new/altered zones.  This heater should be copied and assigned separately to systems serving existing vs. new/altered zones before performing compliance analysis.", Name )
										else	UNCHANGED  endif  }
	; SAC 10/27/15 - check for this heater serving BOTH new/altered, central DHW systems -AND- other systems (existing or non-central)
	"Ensure this heater does not serve BOTH new/altered, central DHW systems -AND- other systems (existing or non-central)"
		DHWHeater:Action	= {	if (NewCntrlAreaServed >= 1 .AND. FloorAreaServed > (NewCntrlAreaServed + 1))
										then	if (Proj:RunScope == 2)
												then	PostError( "DHW Heater '%s' is assigned to a combination of new/altered Central DHW system(s) and other (existing and/or non-central) systems, which is not allowed in compliance analysis.", Name )
												else	PostError( "DHW Heater '%s' is assigned to both Central and Non-Central DHW system(s), which is not allowed in compliance analysis.", Name )
												endif
										else  UNCHANGED  endif  }

	; SAC 3/18/16 - check for valid inputs for new HPWH model
	"Ensure valid inputs to simulate DHWHeater via new HPWH model"
		DHWHeater:Action	= {	if (FloorAreaServed < 1 .OR. HeaterElementType .NE. 5) then  UNCHANGED
										else if (Proj:CSEDHWUseMethod == 1)
										then	PostError( "DHW Heater '%s' heater element type of '%s' invalid when CSEDHWUseMethod = '%s'.", Name, EnumString( HeaterElementType ), EnumString( Proj:CSEDHWUseMethod ) )
										else if (HPWH_NEEARated > 0.5 .AND. ASHPType < 1)
										then	PostError( "Valid selection for ASHP Type required for DHW Heater '%s' with '%s' heater element type.", Name, EnumString( HeaterElementType ) )
										else if (HPWH_NEEARated > 0.5 .AND. (ASHPType == 16 .OR. ASHPType == 17) .AND. Proj:EnableResearchMode < 1)
										then	PostError( "DHW Heater '%s' specifies a Sanden HPWH option that require activation of EnableResearchMode (and cannot be used in compliance analysis).", Name )
										else if (IfValidAnd( TankOutside > 0 )==0 .AND. LocalCompAssigned( TankZone ) < 1)
										then	PostError( "Tank location (Garage, Zone, Attic or CrawlSpace) must be defined for DHW Heater '%s' with '%s' heater element type.", Name, EnumString( HeaterElementType ) )
										else if (IfValidAnd( ASHPSplit > 0 ) .AND. IfValidAnd( ASHPTSrcOutside > 0 )==0 .AND. LocalCompAssigned( ASHPTSrcZone ) < 1)
										then	PostError( "DHW Heater '%s' heat source location (Garage, Zone, Attic or CrawlSpace) must be defined for '%s' heater element type.", Name, EnumString( HeaterElementType ) )
										else	UNCHANGED  endif endif endif endif endif endif  }

	; SAC 4/14/16 - ensure that 'Heat Pump (2013...)' isn't used in compliance analysis (for 2016 analysis)
	"Ensure valid inputs to simulate DHWHeater via new HPWH model"
		DHWHeater:Action	= {	if (IfValidAnd(Proj:StandardsVersion >= 2017)==0 .OR. IfValidAnd(Proj:AnalysisType = 13)==0 .OR. FloorAreaServed < 1) then  UNCHANGED
										else if (HeaterElementType == 3)
										then	PostError( "Heater element type '%s' is not allowed for compliance analysis - DHW Heater '%s' .", EnumString( HeaterElementType ), Name )
										else	UNCHANGED  endif endif  }

	; SAC 6/17/16 - added checks to PREVENT use of Monthly solar fractions when doing T-24 compliance analysis (tic #682)
	"Prevent use of DHWSys monthly solar fractions when doing T-24 compliance analysis"
		DHWSys:Action	= {	if (IfValidAnd( FloorAreaServed[1] > 0.1 )==0 .OR. SolFracType != 2) then  UNCHANGED
									else	if (IfValidAnd( SolFracAnnRpt > 0 ))
											then	PostError( "Selection of Monthly solar fractions for DHWSys '%s' invalid for compliance analysis - suggest switching to Annual and using monthly average of %.3f.", Name, SolFracAnnRpt )
											else	PostError( "Selection of Monthly solar fractions for DHWSys '%s' invalid for compliance analysis.", Name )
											endif  endif  }
	"Prevent use of DwellUnitType monthly DHW solar fractions when doing T-24 compliance analysis"
		DwellUnitType:Action	= {	if (IfValidAnd( NumAssigningDUs > 0.5 )==0 .OR. IfValidAnd( AssignedDUFlrArea > 0.1 )==0 .OR.
												 IfValidAnd( HtEqpUsedAsDHWHtr > 0.5 )==0 .OR. DHWSolFracType != 2) then  UNCHANGED
											else	if (IfValidAnd( DHWSolFracMonAvg > 0 ))
													then	PostError( "Selection of Monthly solar fractions for DwellUnitType '%s' invalid for compliance analysis - suggest switching to Annual and using monthly average of %.3f.", Name, DHWSolFracMonAvg )
													else	PostError( "Selection of Monthly solar fractions for DwellUnitType '%s' invalid for compliance analysis.", Name )
													endif  endif  }

; SAC 12/30/15 - throw error if HVACDist assigned to both heat/cool and heating-only systems - tic 544 - fix logic 1/4/16
	"Throw err** if HVACDist assigned to both heat/cool and heating-only systems"	HVACDist:Action  = {  
				if (FloorAreaServed < 0.1 .OR. IfValidAnd( Proj:CondFloorArea > 1 ) == 0) then  UNCHANGED
				else if (ServesCooling < 1 .OR. ServesCooling == ServesHeating) then  UNCHANGED
				else	PostError( "Distribution system '%s' is assigned to both heat+cool and heating-only systems, which is not allowed in compliance analysis.", Name )  endif endif  }

; SAC 5/11/15 - check to confirm valid Attic assigned for supply and return ducts if needed (issue 536)
	"Check confirm that Attic selected for active distribution systems are valid"
		HVACDist:Action	= {	if (FloorAreaServed < 0.1 .OR. IfValidAnd( Type = 1 )==0) then  UNCHANGED
										else if (LocalCompAssigned( SupplyDuctAttic ) == 0)
										then	PostError( "HVACDist '%s' is specified to have ducts located in an attic, but no attic is selected for the supply ducts.", Name )
										else if (IfValidAnd( SupplyDuctAttic:FloorArea <= 0 ))
										then	PostError( "HVACDist '%s' has an invalid attic '%s' (with no floor area) specified as the location of the supply ducts.", Name, SupplyDuctAttic:Name )
										else if (LocalCompAssigned( ReturnDuctAttic ) == 0)
										then	PostError( "HVACDist '%s' is specified to have ducts located in an attic, but no attic is selected for the return ducts.", Name )
										else if (IfValidAnd( ReturnDuctAttic:FloorArea <= 0 ))
										then	PostError( "HVACDist '%s' has an invalid attic '%s' (with no floor area) specified as the location of the return ducts.", Name, ReturnDuctAttic:Name )
										else	UNCHANGED  endif endif endif endif endif  }

; SAC 5/14/15 - check to confirm valid SupplyDuctLoc/ReturnDuctLoc assigned for supply and return ducts if needed (issue 536)
	"Check confirm that SupplyDuctLoc selected for active distribution systems are valid"
		HVACDist:Action	= {	if (FloorAreaServed < 0.1 .OR. IfValidAnd( Type = 13 )==0) then  UNCHANGED
										else if (LocalCompAssigned( SupplyDuctLoc ) == 0)
										then	PostError( "HVACDist '%s' is specified to have ducts located in multiple places, but no zone/attic/garage/crawlspace is selected for the supply ducts.", Name )
										else if (LocalCompAssigned( SupplyDuctLoc ) = ComponentType( "Attic" ))
										then	if (IfValidAnd( SupplyDuctLoc:FloorArea <= 0 ))
												then	PostError( "HVACDist '%s' has an invalid attic '%s' (with no floor area) specified as the location of the supply ducts.", Name, SupplyDuctLoc:Name )
												else	UNCHANGED  endif
										else	UNCHANGED  endif endif endif  }
	"Check confirm that ReturnDuctLoc selected for active distribution systems are valid"
		HVACDist:Action	= {	if (FloorAreaServed < 0.1 .OR. IfValidAnd( Type = 13 )==0) then  UNCHANGED
										else if (LocalCompAssigned( ReturnDuctLoc ) == 0)
										then	PostError( "HVACDist '%s' is specified to have ducts located in multiple places, but no zone/attic/garage/crawlspace is selected for the return ducts.", Name )
										else if (LocalCompAssigned( ReturnDuctLoc ) = ComponentType( "Attic" ))
										then	if (IfValidAnd( ReturnDuctLoc:FloorArea <= 0 ))
												then	PostError( "HVACDist '%s' has an invalid attic '%s' (with no floor area) specified as the location of the return ducts.", Name, ReturnDuctLoc:Name )
												else	UNCHANGED  endif
										else	UNCHANGED  endif endif endif  }
												
; mjb	5/6/14 add check for QII and Buried Duct combo
	"Check for QII and Buried Ducts"		HVACDist:Action	= {	if (FloorAreaServed < 0.1) then  UNCHANGED
																					else if (AreBuried .OR. AreDeeplyBuried) then 
																						if (Project:InsulConsQuality < 1.5) then PostError( "HVACDist '%s' has buried and/or deeply buried ducts. To get compliance credit, this project must also have Quality Insulation Installation (QII).", Name ) 
																						else UNCHANGED endif
																					else UNCHANGED endif endif	}

; SAC 1/3/16 - check for HVACDist:DuctInsRvalOpt too high in certain cases (tic 597)
	"Check for HVACDist:DuctInsRvalOpt exceeding allowed value when duct design not verified"
		HVACDist:Action	= {	if (FloorAreaServed < 0.1 .OR. Status == 1 .OR. DefaultSystem > 0.5) then  UNCHANGED
										else if (DuctDesign < 0.5 .AND. IfValidAnd( DuctInsRvalOpt >= 801 )) 
										then	PostError( "Duct insulation R-value of HVACDist '%s' (R-%g) exceeds the maximum of R-8 allowed for ducts that are not verified and buried.", Name, (DuctInsRvalOpt/100) )
										else if (DuctDesign > 0.5 .AND. IfValidAnd( AreBuried < 0.5 ) .AND. IfValidAnd( AreDeeplyBuried < 0.5 ) .AND.
													(IfValidAnd( DuctDesignInsRvalue > 8 ) .OR. IfValidAnd( RetDuctDesignInsRvalue > 8 ))) 
										then	if (IfValidAnd( DuctDesignInsRvalue > 8 ) .AND. IfValidAnd( RetDuctDesignInsRvalue > 8 ))
												then	PostError( "Supply and return duct R-values of HVACDist '%s' (R-%g and R-%g respectively) cannot exceed R-8 unless verified and buried.", Name, DuctDesignInsRvalue, RetDuctDesignInsRvalue )
												else if (IfValidAnd( DuctDesignInsRvalue > 8 ))
												then	PostError( "Supply duct R-value of HVACDist '%s' (R-%g) cannot exceed R-8 unless verified and buried.", Name,    DuctDesignInsRvalue )
												else	PostError( "Return duct R-value of HVACDist '%s' (R-%g) cannot exceed R-8 unless verified and buried.", Name, RetDuctDesignInsRvalue )
												endif endif
										else	UNCHANGED  endif endif endif  }

;; SAC 11/20/13 - disable E+A+A
;	"Check RunScope"	Proj:Action	= {	if (RunScope != 1) then  PostError( "Project RunScope not yet implemented - must be set back to default of 'Newly Constructed' to perform analysis." )  else  UNCHANGED  endif  }
;	"Check ExtWall:Status          "		ExtWall:Action          	= {	if (Status != 3) then  PostError(           "ExtWall Status not yet implemented - '%s' Status must be set back to default of 'New' to perform compliance analysis", Name )  else  UNCHANGED  endif  }
;	"Check ExteriorFloor:Status    "		ExteriorFloor:Action    	= {	if (Status != 3) then  PostError(     "ExteriorFloor Status not yet implemented - '%s' Status must be set back to default of 'New' to perform compliance analysis", Name )  else  UNCHANGED  endif  }
;	"Check CathedralCeiling:Status "		CathedralCeiling:Action 	= {	if (Status != 3) then  PostError(  "CathedralCeiling Status not yet implemented - '%s' Status must be set back to default of 'New' to perform compliance analysis", Name )  else  UNCHANGED  endif  }
;	"Check CeilingBelowAttic:Status"		CeilingBelowAttic:Action	= {	if (Status != 3) then  PostError( "CeilingBelowAttic Status not yet implemented - '%s' Status must be set back to default of 'New' to perform compliance analysis", Name )  else  UNCHANGED  endif  }
;	"Check FloorOverCrawl:Status   "		FloorOverCrawl:Action   	= {	if (Status != 3) then  PostError(    "FloorOverCrawl Status not yet implemented - '%s' Status must be set back to default of 'New' to perform compliance analysis", Name )  else  UNCHANGED  endif  }
;	"Check Window:Status           "		Window:Action           	= {	if (Status != 3) then  PostError(            "Window Status not yet implemented - '%s' Status must be set back to default of 'New' to perform compliance analysis", Name )  else  UNCHANGED  endif  }

END

;*************************************************************************
RULELIST "ProposedModelSimulationCheck" 1 0 0 0
;
;   Rules which are executed on the input building description to ensure
;   that there aren't any errors or omissions in the user model that might
;   prevent simulation.
;
;*************************************************************************

	"Check for existence of at least one zone object"
		Proj:Action	= {	if (AnalysisType > 0 .AND. ComponentCount( Zone ) < 1)		; SAC 2/4/16 - disable check for 'Research' mode
								then  PostError( "At least one Zone object must be present in the model prior to simulation" )
								else  UNCHANGED  endif  }


  ; SAC 6/24/14 - prevent selection of ZonalControl for Multifamily models (incompatible w/ new DwellUnitType & DwellUnit objects)
	"Prevent selection of ZonalControl for Multifamily models"
		Proj:Action	= {	if (ZonalControl > 0.5 .AND. IsMultiFamily > 0.5)
								then  PostError( "Zonal Control Credit is not an available analysis option for multifamily buildings." )  else  UNCHANGED  endif  }

; SAC 8/1/14 - removed check to prevent compliance analysis on Conditioned attics
;  ; SAC 4/25/14 - revised Attic:Type check to ALLOW conditioned attics when Proj:BypassRuleLimits is set
;	"Check to ensure no Attic:Type = Conditioned..."		; SAC 4/7/14
;		Attic:Action	= {	if (FloorArea > 0.1 .AND. Type = 1 .AND. Proj:BypassRuleLimits < 0.5) then  PostError( "Attic:Type of 'Conditioned' is not yet implemented.  Revise this input prior to performing analysis." )
;									else  UNCHANGED  endif  }


; SAC 11/3/14 - added checks to ensure that all construction assignments are of the proper CanAssignTo selection for each surface in the model
;		0, Cons:CanAssignTo,  0
;		2,              0,    "Exterior Walls"  
;		2,             10,    "Interior Walls"  
;		; 2,             20,    "Underground Walls"      ; SAC 2/15/12
;		2,              1,    "Attic Roofs"  
;		2,              2,    "Cathedral Ceilings"  
;		2,              3,    "Ceilings (below attic)"  
;		2,              6,    "Interior Ceilings"        ; SAC 2/15/12 - restored by SAC 9/30/13  
;		2,              4,    "Interior Floors"  
;		2,              5,    "Exterior Floors"  
;		2,              9,    "Floors Over Crawlspace"   ; SAC 3/4/13
;		; 2,              7,    "Slab Floors"            ; SAC 2/15/12
;		; 2,              8,    "Underground Floors"     ; SAC 2/15/12

	"Prevent invalid Attic:Construction assignments"		Attic:Action	= {
						if (LocalCompAssigned( Construction ) < 0.5) then						PostError( "Attic '%s' missing its Construction reference.", Name )
						else if (IfValidAnd(   Construction:CanAssignTo ==  1 )==0) then	PostError( "Attic '%s' references incompatible construction object '%s' (CanAssignTo = '%s').", Name, Construction:Name, EnumString( Construction:CanAssignTo ) )
						else if (IfValidAnd(   Construction:DisplayInpErrMsg > 0 )) then  PostError( "Attic '%s' construction '%s':  %s", Name, Construction:Name, Construction:InputErrMsg )
						else  UNCHANGED  endif endif endif  }
	"Prevent invalid Attic:exConstruction assignments"		Attic:Action	= {
						if (IfValidAnd( FloorArea > 0.1 )==0 .OR. Status != 2 .OR. IfValidAnd( IsVerified == 1 )==0) then  UNCHANGED
						else if (LocalCompAssigned( exConstruction ) < 0.5) then				PostError( "Attic '%s' missing its existing exConstruction reference.", Name )
						else if (IfValidAnd( exConstruction:CanAssignTo ==  1 )==0) then	PostError( "Attic '%s' references incompatible construction object '%s' (CanAssignTo = '%s').", Name, Construction:Name, EnumString( Construction:CanAssignTo ) )
						else if (IfValidAnd( exConstruction:DisplayInpErrMsg > 0 )) then  PostError( "Attic '%s' existing construction '%s':  %s", Name, exConstruction:Name, exConstruction:InputErrMsg )
						else  UNCHANGED  endif endif endif endif  }

	"Prevent invalid ExtWall:Construction assignments"			ExtWall:Action	= {
						if (LocalCompAssigned( Construction ) < 0.5) then						PostError( "ExtWall '%s' missing its Construction reference.", Name )
						else if (IfValidAnd(   Construction:CanAssignTo ==  0 )==0) then	PostError( "ExtWall '%s' references incompatible construction object '%s' (CanAssignTo = '%s').", Name, Construction:Name, EnumString( Construction:CanAssignTo ) )
						else if (IfValidAnd(   Construction:DisplayInpErrMsg > 0 )) then  PostError( "ExtWall '%s' construction '%s':  %s", Name, Construction:Name, Construction:InputErrMsg )
						else  UNCHANGED  endif endif endif  }
	"Prevent invalid ExtWall:exConstruction assignments"		ExtWall:Action	= {
						if (IfValidAnd( FloorArea > 0.1 )==0 .OR. Status != 2 .OR. IfValidAnd( IsVerified == 1 )==0) then  UNCHANGED
						else if (LocalCompAssigned( exConstruction ) < 0.5) then				PostError( "ExtWall '%s' missing its existing exConstruction reference.", Name )
						else if (IfValidAnd( exConstruction:CanAssignTo ==  0 )==0) then	PostError( "ExtWall '%s' references incompatible existing construction object '%s' (CanAssignTo = '%s').", Name, exConstruction:Name, EnumString( exConstruction:CanAssignTo ) )
						else if (IfValidAnd( exConstruction:DisplayInpErrMsg > 0 )) then  PostError( "ExtWall '%s' construction '%s':  %s", Name, Construction:Name, Construction:InputErrMsg )
						else  UNCHANGED  endif endif endif endif  }
;		"Prevent invalid ExtWall", "Exterior Wall",   "Ext Wall <pi>-<i>",      0,  0,  0, "Zone",   "Garage", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   6000
;	1,           "Construction assignments",      BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons", 0, "CanAssignTo",  6012, "Construction assembly" 
;		 CTRL, "exConstruction",    7034, TDCT_Combo,  115, 380, 300, 220, 12, FNT_STD, "Construction:",                      TA_LEFT,   -95, 4,     0, TA_LEFT, 0, 0,  None, Status = 2 And IsVerified = 1,  -100, 100,  ""
;	1,           "exConstruction assignments",    BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons", 0, "CanAssignTo",  3208, "existing construction for this (altered) wall object" 

	"Prevent invalid IntWall:Construction assignments"			IntWall:Action	= {
						if (LocalCompAssigned( Construction ) < 0.5) then						PostError( "IntWall '%s' missing its Construction reference.", Name )
						else if (IfValidAnd(   Construction:CanAssignTo == 10 )==0) then	PostError( "IntWall '%s' references incompatible construction object '%s' (CanAssignTo = '%s').", Name, Construction:Name, EnumString( Construction:CanAssignTo ) )
						else if (IfValidAnd(   Construction:DisplayInpErrMsg > 0 )) then  PostError( "IntWall '%s' construction '%s':  %s", Name, Construction:Name, Construction:InputErrMsg )
						else  UNCHANGED  endif endif endif  }
;		"Prevent invalid IntWall", "Interior Wall",   "Int Wall <pi>-<i>",     0,  0,  0, "Zone",   "Garage", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   6600
;	1,           "Construction assignments",      BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  10, "CanAssignTo",  6012, "Construction assembly" 
;		 CTRL, "exConstruction",    7034, TDCT_Combo,  115, 330, 300, 220, 12, FNT_STD, "Construction:",                      TA_LEFT,   -95, 4,     0, TA_LEFT, 0, 0,  None, Proj:RunScope = 2 And ParCndZnAdjGarArea > 0.1 And Status = 2 And IsVerified = 1,  -100, 100,  ""
;	1,           "exConstruction assignments",    BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  10, "CanAssignTo",  3208, "existing construction for this (altered) wall object" 

;		"Prevent invalid UndWall", "Underground Wall",  "Und Wall <pi>-<i>",      0,  0,  0, "Zone",   "", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   6600
;	1,           "Construction assignments",      BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  20, "CanAssignTo",  6012, "Construction assembly" 
;	1,           "exConstruction assignments",    BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  20, "CanAssignTo",  3208, "existing construction for this (altered) wall object" 

;		"Prevent invalid CathedralCeiling",  "Cathedral Ceiling",  "Cath Clg <pi>-<i>",      0,  0,  0, "Zone",   "Garage", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   7000
;	1,           "Construction assignments",      BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",   2, "CanAssignTo",  6012, "Construction assembly" 
;		 CTRL, "exConstruction",    8215, TDCT_Combo,  145, 400, 300, 180, 12, FNT_STD, "Construction:",                      TA_LEFT,   -95, 4,     0, TA_LEFT, 0, 0,  None, Status = 2 And IsVerified = 1,  -100, 100,  ""
;	1,           "exConstruction assignments",    BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",   2, "CanAssignTo",  3208, "existing construction for this (altered) ceiling object" 

	"Prevent invalid CeilingBelowAttic:Construction assignments"	CeilingBelowAttic:Action	= {
						if (LocalCompAssigned( Construction ) < 0.5) then					PostError( "CeilingBelowAttic '%s' missing its Construction reference.", Name )
						else if (IfValidAnd(   Construction:CanAssignTo ==  3 )==0) then	PostError( "CeilingBelowAttic '%s' references incompatible construction object '%s' (CanAssignTo = '%s').", Name, Construction:Name, EnumString( Construction:CanAssignTo ) )
						else if (IfValidAnd(   Construction:DisplayInpErrMsg > 0 )) then  PostError( "CeilingBelowAttic '%s' construction '%s':  %s", Name, Construction:Name, Construction:InputErrMsg )
						else  UNCHANGED  endif endif endif  }
;		 CTRL, "exConstruction",    8213, TDCT_Combo,  145, 335, 300, 180, 12, FNT_STD, "Construction:",                      TA_LEFT,   -95, 4,     0, TA_LEFT, 0, 0,  None, Status = 2 And IsVerified = 1,  -100, 100,  ""
;	1,           "exConstruction assignments",    BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",   3, "CanAssignTo",  3208, "existing construction for this (altered) ceiling object" 

	"Prevent invalid InteriorCeiling:Construction assignments"	InteriorCeiling:Action	= {
						if (LocalCompAssigned( Construction ) < 0.5) then					PostError( "InteriorCeiling '%s' missing its Construction reference.", Name )
						else if (IfValidAnd(   Construction:CanAssignTo ==  6 )==0) then	PostError( "InteriorCeiling '%s' references incompatible construction object '%s' (CanAssignTo = '%s').", Name, Construction:Name, EnumString( Construction:CanAssignTo ) )
						else if (IfValidAnd(   Construction:DisplayInpErrMsg > 0 )) then  PostError( "InteriorCeiling '%s' construction '%s':  %s", Name, Construction:Name, Construction:InputErrMsg )
						else  UNCHANGED  endif endif endif  }
;		"Prevent invalid InteriorCeiling",   "Interior Ceiling",  "Int Clg <pi>-<i>",       0,  0,  0, "Zone",   "Garage", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   7000
;	1,           "Construction assignments",      BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  6, "CanAssignTo",  6012, "Construction assembly" 
;		 CTRL, "exConstruction",    8934, TDCT_Combo,  115, 385, 300, 210, 12, FNT_STD, "Construction:",                      TA_LEFT,   -95, 4,     0, TA_LEFT, 0, 0,  None, Status = 2 And IsVerified = 1,  -100, 100,  ""
;	1,           "exConstruction assignments",    BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  6, "CanAssignTo",  3208, "existing construction for this (altered) ceiling object" 

;		"Prevent invalid ExteriorFloor",     "Exterior Floor",  "Ext Flr <pi>-<i>",     0,  0,  0, "Zone",   "Garage", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   7000
;	1,           "Construction assignments",      BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  5, "CanAssignTo",  6012, "Construction assembly" 
;		 CTRL, "exConstruction",    8610, TDCT_Combo,  145, 340, 300, 220, 12, FNT_STD, "Construction:",                      TA_LEFT,   -95, 4,     0, TA_LEFT, 0, 0,  None, Status = 2 And IsVerified = 1,  -100, 100,  ""
;	1,           "exConstruction assignments",    BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  5, "CanAssignTo",  3208, "existing construction for this (altered) floor object" 

	"Prevent invalid FloorOverCrawl:Construction assignments"	FloorOverCrawl:Action	= {
						if (LocalCompAssigned( Construction ) < 0.5) then					PostError( "FloorOverCrawl '%s' missing its Construction reference.", Name )
						else if (IfValidAnd(   Construction:CanAssignTo ==  9 )==0) then	PostError( "FloorOverCrawl '%s' references incompatible construction object '%s' (CanAssignTo = '%s').", Name, Construction:Name, EnumString( Construction:CanAssignTo ) )
						else if (IfValidAnd(   Construction:DisplayInpErrMsg > 0 )) then  PostError( "FloorOverCrawl '%s' construction '%s':  %s", Name, Construction:Name, Construction:InputErrMsg )
						else  UNCHANGED  endif endif endif  }
;		 CTRL, "exConstruction",    8614, TDCT_Combo,  145, 305, 300, 180, 12, FNT_STD, "Construction:",                      TA_LEFT,   -95, 4,     0, TA_LEFT, 0, 0,  None, Status = 2 And IsVerified = 1,  -100, 100,  ""
;	1,           "exConstruction assignments",    BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  9, "CanAssignTo",  3208, "existing construction for this (altered) floor object" 

	"Prevent invalid InteriorFloor:Construction assignments"	InteriorFloor:Action	= {
						if (LocalCompAssigned( Construction ) < 0.5) then					PostError( "InteriorFloor '%s' missing its Construction reference.", Name )
						else if (IfValidAnd(   Construction:CanAssignTo ==  4 )==0) then	PostError( "InteriorFloor '%s' references incompatible construction object '%s' (CanAssignTo = '%s').", Name, Construction:Name, EnumString( Construction:CanAssignTo ) )
						else if (IfValidAnd(   Construction:DisplayInpErrMsg > 0 )) then  PostError( "InteriorFloor '%s' construction '%s':  %s", Name, Construction:Name, Construction:InputErrMsg )
						else  UNCHANGED  endif endif endif  }
;		"Prevent invalid InteriorFloor",     "Interior Floor",  "Int Flr <pi>-<i>",     0,  0,  0, "Zone",   "", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   7000
;	1,           "Construction assignments",      BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  4, "CanAssignTo",                       6012, "Construction assembly" 
;		 CTRL, "exConstruction",    8834, TDCT_Combo,  115, 385, 300, 210, 12, FNT_STD, "Construction:",                      TA_LEFT,   -95, 4,     0, TA_LEFT, 0, 0,  None, Status = 2 And IsVerified = 1,  -100, 100,  ""
;	1,           "exConstruction assignments",    BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  4, "CanAssignTo",  3208, "existing construction for this (altered) floor object" 

;		"Prevent invalid UndFloor",     "Underground Floor",   "Und Flr <pi>-<i>",     0,  0,  0, "Zone",   "", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   7000
;	1,           "Construction assignments",      BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  8, "CanAssignTo",  6012, "Construction assembly" 
;	1,           "exConstruction assignments",    BEMP_Obj,  1,  0,  0, "",                 0,  1, "Cons",  8, "CanAssignTo",  3208, "existing construction for this (altered) floor object" 



	"Check for valid IntWall:Outside assignment"
		IntWall:Action	= {	if (ParentComponentType() == "Zone" .AND. LocalCompAssigned( Outside ) == ComponentType( "Garage" ) .AND. Proj:HasGarage < 0.1)
									then	PostError( "Interior wall '%s' assigns garage '%s' as being on the outside, but garage modeling is disabled in the Project dialog",
																Name, Outside:Name )
									else  UNCHANGED  endif  }
	"Check for valid InteriorFloor:Outside assignment"
		InteriorFloor:Action	= {	if (ParentComponentType() == "Zone" .AND. LocalCompAssigned( Outside ) == ComponentType( "Garage" ) .AND. Proj:HasGarage < 0.1)
											then	PostError( "Interior floor '%s' assigns garage '%s' as being on the outside, but garage modeling is disabled in the Project dialog",
																		Name, Outside:Name )
											else  UNCHANGED  endif  }
			; 0,  "IntWall", "Interior Wall",   "Int Wall <pi>-<i>",   300,  0,  0, "Zone",   "Garage", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   6600
			; 1,           "Outside",           BEMP_Obj,  1,  0,  0, "",                 0,  2, "Zone",     0, "",    "Garage",     0, "",     6012, "The name of the conditioned zone on the other side of this wall (or none for adiabatic)" 
			; 0,  "InteriorFloor",     "Interior Floor",  "Int Flr <pi>-<i>",   300,  0,  0, "Zone",   "", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   7000
			; 1,           "Outside",           BEMP_Obj,  1,  0,  0, "",                 0,  2, "Zone",     0, "",            "Garage",     0, "",  6012, "This zone or the name of the conditioned zone below this floor" 
			; 
			; 0,  "InteriorCeiling",   "Interior Ceiling",  "Int Clg <pi>-<i>",     300,  0,  0, "Zone",   "Garage", "", "", "", "", "", "", "", "", "", "", "", "", "",  -1,  1,  0,  0,  0,  0,   7000
			; 1,           "Outside",           BEMP_Obj,  1,  0,  0, "",                 0,  1, "Zone",     0, "",             6012, "This zone or the name of the conditioned zone above this ceiling" 

  ; SAC 10/20/14 - check for valid Attic assigned to every CeilingBelowAttic
	"Check for valid Attic assigned to every CeilingBelowAttic:AtticZone"
		CeilingBelowAttic:Action	= {	if (IfValidAnd( Area > 0.1 ) .AND. LocalCompAssigned( AtticZone ) < 0.1)
													then	PostError( "Ceiling below attic '%s' lacks the required assignment of AtticZone", Name )
													else  UNCHANGED  endif  }

  ; SAC 1/28/13 - added checks to ensure that each Zone & Garage has at least 6 adjacent surfaces
	"Set IntWall:SurfaceCount to 1"				IntWall:SurfaceCount				= {	1  }
	"Set InteriorCeiling:SurfaceCount to 1"	InteriorCeiling:SurfaceCount	= {	1  }
	"Set InteriorFloor:SurfaceCount to 1"		InteriorFloor:SurfaceCount		= {	1  }
	"Set Zone:SurfaceCount to # of child surfaces"		Zone:SurfaceCount	= {
						ChildCount( CathedralCeiling  ) + ChildCount( ExtWall ) + ChildCount( SlabFloor     ) + 
						ChildCount( CeilingBelowAttic ) + ChildCount( IntWall ) + ChildCount( InteriorFloor ) + ChildCount( FloorOverCrawl ) + 
						ChildCount( InteriorCeiling   ) + ChildCount( UndWall ) + ChildCount( ExteriorFloor ) + ChildCount( UndFloor ) +
						SumRevRef( IntWall:Outside,         IntWall:SurfaceCount         ) +
						SumRevRef( InteriorCeiling:Outside, InteriorCeiling:SurfaceCount ) +
						SumRevRef( InteriorFloor:Outside,   InteriorFloor:SurfaceCount   )  }
	"Set Garage:SurfaceCount to # of child surfaces"		Garage:SurfaceCount	= {
						ChildCount( CathedralCeiling  ) + ChildCount( ExtWall ) + ChildCount( SlabFloor     ) +
						ChildCount( CeilingBelowAttic ) + ChildCount( IntWall ) + ChildCount( ExteriorFloor ) + ChildCount( FloorOverCrawl ) +
						ChildCount( InteriorCeiling   ) +
						SumRevRef( IntWall:Outside,         IntWall:SurfaceCount         ) +
						SumRevRef( InteriorCeiling:Outside, InteriorCeiling:SurfaceCount ) +
						SumRevRef( InteriorFloor:Outside,   InteriorFloor:SurfaceCount   )  }

  ; secondary check to ensure max individual child/adjacent surface area < sum of all surface areas
	"Set Zone:SurfaceAreaSum to sum of child/adjacent surface areas"		Zone:SurfaceAreaSum	= {
						SumChildren( CathedralCeiling:Area  ) + SumChildren( ExtWall:Area ) + SumChildren( SlabFloor:Area     ) + 
						SumChildren( CeilingBelowAttic:Area ) + SumChildren( IntWall:Area ) + SumChildren( InteriorFloor:Area ) + SumChildren( FloorOverCrawl:Area ) + 
						SumChildren( InteriorCeiling:Area   ) + SumChildren( UndWall:Area ) + SumChildren( ExteriorFloor:Area ) + SumChildren( UndFloor:Area ) +
						SumRevRef( IntWall:Outside,         IntWall:Area         ) +
						SumRevRef( InteriorCeiling:Outside, InteriorCeiling:Area ) +
						SumRevRef( InteriorFloor:Outside,   InteriorFloor:Area   )  }
	"Set Zone:SurfaceAreaSum to sum of child/adjacent surface areas"		Garage:SurfaceAreaSum	= {
						SumChildren( CathedralCeiling:Area  ) + SumChildren( ExtWall:Area ) + SumChildren( SlabFloor:Area     ) +
						SumChildren( CeilingBelowAttic:Area ) + SumChildren( IntWall:Area ) + SumChildren( ExteriorFloor:Area ) +
						SumChildren( InteriorCeiling:Area   ) + SumChildren( FloorOverCrawl:Area ) +
						SumRevRef( IntWall:Outside,         IntWall:Area         ) +
						SumRevRef( InteriorCeiling:Outside, InteriorCeiling:Area ) +
						SumRevRef( InteriorFloor:Outside,   InteriorFloor:Area   )  }

	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 1 CathClgs"		Zone:SurfaceAreaMax	= {	if (ChildCount( CathedralCeiling  ) > 0) then                       MaxChild( CathedralCeiling:Area  )    else  0  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 2 ClgBlwAs"		Zone:SurfaceAreaMax	= {	if (ChildCount( CeilingBelowAttic ) > 0) then  max( SurfaceAreaMax, MaxChild( CeilingBelowAttic:Area ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 3 IntClgs"			Zone:SurfaceAreaMax	= {	if (ChildCount( InteriorCeiling   ) > 0) then  max( SurfaceAreaMax, MaxChild( InteriorCeiling:Area   ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 4 ExtWalls"		Zone:SurfaceAreaMax	= {	if (ChildCount( ExtWall           ) > 0) then  max( SurfaceAreaMax, MaxChild( ExtWall:Area           ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 5 IntWalls"		Zone:SurfaceAreaMax	= {	if (ChildCount( IntWall           ) > 0) then  max( SurfaceAreaMax, MaxChild( IntWall:Area           ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 6 UndWalls"		Zone:SurfaceAreaMax	= {	if (ChildCount( UndWall           ) > 0) then  max( SurfaceAreaMax, MaxChild( UndWall:Area           ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 7 SlabFlrs"		Zone:SurfaceAreaMax	= {	if (ChildCount( SlabFloor         ) > 0) then  max( SurfaceAreaMax, MaxChild( SlabFloor:Area         ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 8 IntFlrs"			Zone:SurfaceAreaMax	= {	if (ChildCount( InteriorFloor     ) > 0) then  max( SurfaceAreaMax, MaxChild( InteriorFloor:Area     ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 9 ExtFlrs"			Zone:SurfaceAreaMax	= {	if (ChildCount( ExteriorFloor     ) > 0) then  max( SurfaceAreaMax, MaxChild( ExteriorFloor:Area     ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 10 UndFlrs"		Zone:SurfaceAreaMax	= {	if (ChildCount( UndFloor          ) > 0) then  max( SurfaceAreaMax, MaxChild( UndFloor:Area          ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 11 adj IntWalls"	Zone:SurfaceAreaMax	= {	if (SumRevRef( IntWall:Outside,         IntWall:Area         ) > 0) then  max( SurfaceAreaMax, SumRevRef( IntWall:Outside,         IntWall:Area         ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 12 adj IntClgs"	Zone:SurfaceAreaMax	= {	if (SumRevRef( InteriorCeiling:Outside, InteriorCeiling:Area ) > 0) then  max( SurfaceAreaMax, SumRevRef( InteriorCeiling:Outside, InteriorCeiling:Area ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 13 adj IntFlrs"	Zone:SurfaceAreaMax	= {	if (SumRevRef( InteriorFloor:Outside,   InteriorFloor:Area   ) > 0) then  max( SurfaceAreaMax, SumRevRef( InteriorFloor:Outside,   InteriorFloor:Area   ) )  else  UNCHANGED  endif  }
	"Set Zone:SurfaceAreaMax to MAX of child/adj surface areas - 14 FlrsOvrCrwl"	Zone:SurfaceAreaMax	= {	if (ChildCount( FloorOverCrawl    ) > 0) then  max( SurfaceAreaMax, MaxChild( FloorOverCrawl:Area    ) )  else  UNCHANGED  endif  }

	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 1 CathClgs"			Garage:SurfaceAreaMax	= {	if (ChildCount( CathedralCeiling  ) > 0) then                       MaxChild( CathedralCeiling:Area  )    else  0  endif  }
	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 2 ClgBlwAs"			Garage:SurfaceAreaMax	= {	if (ChildCount( CeilingBelowAttic ) > 0) then  max( SurfaceAreaMax, MaxChild( CeilingBelowAttic:Area ) )  else  UNCHANGED  endif  }
	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 3 IntClgs"			Garage:SurfaceAreaMax	= {	if (ChildCount( InteriorCeiling   ) > 0) then  max( SurfaceAreaMax, MaxChild( InteriorCeiling:Area   ) )  else  UNCHANGED  endif  }
	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 4 ExtWalls"			Garage:SurfaceAreaMax	= {	if (ChildCount( ExtWall           ) > 0) then  max( SurfaceAreaMax, MaxChild( ExtWall:Area           ) )  else  UNCHANGED  endif  }
	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 5 IntWalls"			Garage:SurfaceAreaMax	= {	if (ChildCount( IntWall           ) > 0) then  max( SurfaceAreaMax, MaxChild( IntWall:Area           ) )  else  UNCHANGED  endif  }
;	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 6 UndWalls"			Garage:SurfaceAreaMax	= {	if (ChildCount( UndWall           ) > 0) then  max( SurfaceAreaMax, MaxChild( UndWall:Area           ) )  else  UNCHANGED  endif  }
	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 7 SlabFlrs"			Garage:SurfaceAreaMax	= {	if (ChildCount( SlabFloor         ) > 0) then  max( SurfaceAreaMax, MaxChild( SlabFloor:Area         ) )  else  UNCHANGED  endif  }
;	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 8 IntFlrs"			Garage:SurfaceAreaMax	= {	if (ChildCount( InteriorFloor     ) > 0) then  max( SurfaceAreaMax, MaxChild( InteriorFloor:Area     ) )  else  UNCHANGED  endif  }
	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 9 ExtFlrs"			Garage:SurfaceAreaMax	= {	if (ChildCount( ExteriorFloor     ) > 0) then  max( SurfaceAreaMax, MaxChild( ExteriorFloor:Area     ) )  else  UNCHANGED  endif  }
;	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 10 UndFlrs"			Garage:SurfaceAreaMax	= {	if (ChildCount( UndFloor          ) > 0) then  max( SurfaceAreaMax, MaxChild( UndFloor:Area          ) )  else  UNCHANGED  endif  }
	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 11 adj IntWalls"	Garage:SurfaceAreaMax	= {	if (SumRevRef( IntWall:Outside,         IntWall:Area         ) > 0) then  max( SurfaceAreaMax, SumRevRef( IntWall:Outside,         IntWall:Area         ) )  else  UNCHANGED  endif  }
	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 12 adj IntClgs"	Garage:SurfaceAreaMax	= {	if (SumRevRef( InteriorCeiling:Outside, InteriorCeiling:Area ) > 0) then  max( SurfaceAreaMax, SumRevRef( InteriorCeiling:Outside, InteriorCeiling:Area ) )  else  UNCHANGED  endif  }
	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 13 adj IntFlrs"	Garage:SurfaceAreaMax	= {	if (SumRevRef( InteriorFloor:Outside,   InteriorFloor:Area   ) > 0) then  max( SurfaceAreaMax, SumRevRef( InteriorFloor:Outside,   InteriorFloor:Area   ) )  else  UNCHANGED  endif  }
	"Set Garage:SurfaceAreaMax to MAX of child/adj surface areas - 14 FlrsOvrCrwl"	Garage:SurfaceAreaMax	= {	if (ChildCount( FloorOverCrawl    ) > 0) then  max( SurfaceAreaMax, MaxChild( FloorOverCrawl:Area    ) )  else  UNCHANGED  endif  }

	"Check for sufficient Zone:SurfaceCount"		Zone:Action		= {	if (SurfaceCount < 6)
																							then	PostError( "Zone '%s' has too few child and/or adjacent surfaces (%g, minimum is 6) to be simulated.", Name, SurfaceCount )
																							else if (SurfaceAreaMax > (SurfaceAreaSum / 2))
																							then	PostError( "The largest child/adjacent surface of zone '%s' is too large in relation to the sum of all child/adjacent surface areas (%g > %g).", Name, SurfaceAreaMax, (SurfaceAreaSum / 2) )
																							else	UNCHANGED  endif endif  }
	"Check for sufficient Garage:SurfaceCount"	Garage:Action	= {	if (Proj:HasGarage < 0.5) then  UNCHANGED
																							else if (SurfaceCount < 6)
																							then	PostError( "Garage '%s' has too few child and/or adjacent surfaces (%g, minimum is 6) to be simulated.", Name, SurfaceCount )
																							else if (SurfaceAreaMax > (SurfaceAreaSum / 2))
																							then	PostError( "The largest child/adjacent surface of garage '%s' is too large in relation to the sum of all child/adjacent surface areas (%g > %g).", Name, SurfaceAreaMax, (SurfaceAreaSum / 2) )
																							else	UNCHANGED  endif endif endif  }


	"Check consistency between Zone area & the sum of the child DwellUnit areas"		; SAC 6/25/14
		Zone:Action = {	if (Proj:IsMultiFamily < 0.5 .OR. Proj:ZonalControl > 0.5)	then  UNCHANGED
								else if (Type == 10 .AND.  DwellingUnitArea_Cond > 1) then  PostError( "Zone '%s' in Unconditioned but has conditioned dwelling unit assigned area of %s SqFt.", Name, FltToStr( DwellingUnitArea_Cond ) )
								else if (Type  < 10 .AND. (DwellingUnitArea_Cond <= (FloorArea-1) .OR. DwellingUnitArea_Cond >= (FloorArea+1)))
								then	PostError( "There is a mismatch between conditioned area (%s SqFt) and assigned dwelling unit area (%s SqFt) for zone '%s'", FltToStr( FloorArea ), FltToStr( DwellingUnitArea_Cond ), Name )
								else  UNCHANGED  endif endif endif  }
;		"Check for mismatch between zone area & dwelling unit zone assignment & area inputs (no zonal controls)"  ; SAC 7/29/13 - GC issue #137
;				Zone:Action		= {	if (Proj:IsMultiFamily < 0.5 .OR. Proj:ZonalControl > 0.5)	then  UNCHANGED
;											else if (Type == 10 .AND. DwellingUnitArea_Cond > 1) then  PostError( "Zone '%s' in Unconditioned but has conditioned dwelling unit assigned area of %s SqFt.", Name, FltToStr( DwellingUnitArea_Cond ) )
;											else if (Type == 1  .AND. DwellingUnitArea_Cond != FloorArea) then  PostError( "There is a mismatch between conditioned area (%s SqFt) and assigned dwelling unit area (%s SqFt) for zone '%s'", FltToStr( FloorArea ), FltToStr( DwellingUnitArea_Cond ), Name )
;											else  UNCHANGED  endif endif endif  }
;		"Check for mismatch between zone area & dwelling unit zone assignment & area inputs (with zonal controls)"  ; SAC 7/29/13 - GC issue #137
;				Zone:Action		= {	if (Proj:IsMultiFamily < 0.5 .OR. Proj:ZonalControl < 0.5)	then  UNCHANGED
;											else if (Type == 10 .AND. (DwellingUnitArea_Liv > 1 .OR. DwellingUnitArea_Slp > 1)) then  PostError( "Zone '%s' in Unconditioned but has conditioned (living and/or sleeping) dwelling unit assigned area of %s SqFt.", Name, FltToStr( (DwellingUnitArea_Liv + DwellingUnitArea_Slp) ) )
;											else if (Type == 2  .AND.  DwellingUnitArea_Slp > 1) then  PostError( "Living zone '%s' is assigned in dwelling unit screen(s) as a sleeping zone (total of %s SqFt).", Name, FltToStr( DwellingUnitArea_Slp ) )
;											else if (Type == 3  .AND.  DwellingUnitArea_Liv > 1) then  PostError( "Sleeping zone '%s' is assigned in dwelling unit screen(s) as a living zone (total of %s SqFt).", Name, FltToStr( DwellingUnitArea_Liv ) )
;											else if (Type == 2  .AND.  DwellingUnitArea_Liv != FloorArea) then  PostError( "There is a mismatch between living area (%s SqFt) and assigned dwelling unit area (%s SqFt) for zone '%s'", FltToStr( FloorArea ), FltToStr( DwellingUnitArea_Liv ), Name )
;											else if (Type == 3  .AND.  DwellingUnitArea_Slp != FloorArea) then  PostError( "There is a mismatch between sleeping area (%s SqFt) and assigned dwelling unit area (%s SqFt) for zone '%s'", FltToStr( FloorArea ), FltToStr( DwellingUnitArea_Slp ), Name )
;											else  UNCHANGED  endif endif endif endif endif endif  }

	"Check for CrawlSpace objects w/ Type settings that are not yet implemented"  ; SAC 10/17/13 - GC issue #213
			CrawlSpace:Action		= {	if (Area < 0.1) then  UNCHANGED
												else if (Type != 0)	; "Normal (vented)"
												then	PostError( "Crawl space type '%s' selected for '%s' is not currently implemented.  This must be changed to 'Normal (vented)' in order to perform the analysis.", EnumString( Type ), Name )
												else  UNCHANGED  endif endif  }

	; SAC 3/11/14 - added logic to bypass this check for certain Library Mats (used only for reference of certain properties)
	"Check for sufficient inputs supplied for Mat(erial) objects"  ; SAC 10/17/13 - GC issue #213
			Mat:Action		= {	if (LocalStatus( Conductivity ) .OR. LocalStatus( ConductivityQII ) .OR. (LocalStatus( Thickness ) .AND. LocalStatus( Resistance ))) then  UNCHANGED
										else if (Name == "Ceiling Insul" .OR. Name == "Other Insul") then  UNCHANGED
										else  PostError( "Either Conductivity or both Thickness and Resistance must be specified for Material '%s' prior to performing analysis.", Name )  endif endif  }

	"Check for valid Attic assigned to each Zone to handle ClVent IZXFER object(s)"
			Zone:Action		= {	if (IfValidAnd( ClVentAirFlow > 0.01 )==0 .OR. IfValidAnd( ClVentPower > 0.01 )==0 .OR. IfValidAnd( Proj:CondFloorArea > 1 )==0) then  UNCHANGED
										else if ((SumAll( Attic:FloorAreaOverCond ) / Proj:CondFloorArea) < 0.1) then  UNCHANGED		; the problem of insufficient Attic area will be reported elsewhere
										else if (LocalCompAssigned( MaxClVentableAttic ) > 0.5) then  UNCHANGED								; everything should be OK
										else	PostError( "Zone '%s' has cool vent flow and power defined, but no Attic assigned (via MaxClVentableAttic) to receive the flow.", Name )  endif endif endif  }

	; SAC 10/7/13 - augmented rule to disable SmartVent (FixedFlowOAV) in addition to NightBreeze (VarFlowOAV)
	"Check for HVAC system type (or CFI cool vent) NOT available"  ; SAC 10/3/13 - GC issue ??? - prevent system type 'Variable Outdoor Air Ventilation Central Heat/Cool System'
		HVACSys:Action		= {	if (FloorAreaServed[1] < 0.1) then  UNCHANGED
										else if (TypeOK < 0.5) then  PostError( "HVAC system '%s' type '%s' not currently available for analysis.", Name, EnumString( Type ) )
										else if (CFIClVentCompat > 0.5 .AND. Type != 3 .AND. CFIClVentOption > 0 .AND. Proj:EnableFixedFlowOAV < 0.5)
										then  PostError( "HVAC system '%s' specified as supplying CFI Cool Vent, but this feature is not currently available for analysis.", Name )
										else  UNCHANGED  endif endif endif  }

	; SAC 10/20/14 - check for valid Attic assigned for use as rsOAVReliefZn when activating CFIClVent / OAV features
	"Check for valid Attic assigned as rsOAVReliefZn for OAV (CFI cool vent) HVAC system"
		HVACSys:Action		= {	if (FloorAreaServed[1] < 0.1 .OR. Proj:EnableClVent < 0.5 .OR. Proj:UnitClVentOption != 3) then  UNCHANGED
										else if (Type == 3 .OR. ((Type == 1 .OR. Type == 2) .AND. CFIClVentOption > 0))
										then	if (LocalStatus( CFIClVentFlow ) < 2 .OR. LocalStatus( CFIClVentPwr ) < 2) then  UNCHANGED
												else if (CFIClVentFlow <= 0 .OR. CFIClVentPwr < 0) then  UNCHANGED
												else if (LocalCompAssigned( CFIClVentAttic ) < 0.5)
												then  PostError( "HVAC system '%s' specified as supplying CFI Cool Vent, but has no Attic assignment (CFIClVentAttic needed to serve as OAVReliefZn).", Name )
												else  UNCHANGED  endif endif endif
										else  UNCHANGED  endif endif  }

	"Check for ducted HVAC systems including a fan"  ; SAC 6/7/13 - GC issue #103
		HVACSys:Action		= {	if (FloorAreaServed[1] < 0.1 .OR. LocalCompAssigned( DistribSystem ) == 0) then  UNCHANGED
										else if (DistribSystem:DuctsPresent < 0.5) then  UNCHANGED
										else if (LocalCompAssigned( Fan ) == 0)
										then  PostError( "HVAC system '%s' requires a Fan assignment since its distribution system is ducted.", Name )
										else if (Fan:Type < 0.5)
										then  PostError( "Fan '%s' assigned to HVAC system '%s' must be of a valid Type, since the corresponding distribution system is ducted.", Fan:Name, Name )
										else  UNCHANGED  endif endif endif endif  }


	"Check for heating system type availability (& other err**s)"
		HVACHeat:Action	= {	if (FloorAreaServed > 0.1)
										then	if (IsAvailable < 0.5)
												then  PostError( "Heating system '%s' - system type %s is not yet available for compliance analysis", Name, TypeAbbrevStr )
								;				else if (DisplayCHData >= 0 .AND. CHUCndPipeLength > 10)
												else if (Type = 9 .AND. IfValidAnd(CHUCndPipeLength > 10))
												then  PostError( "Current combined hydronic system pipe (in uncond space) length limit is 10 ft (system '%s')", Name )
												else  UNCHANGED  endif endif
										else  UNCHANGED  endif  }

	"Check for heat pump system type availability"
		HVACHtPump:Action	= {	if (FloorAreaServed < 0.1 .OR. IsAvailable > 0.5) then  UNCHANGED
										else  PostError( "Heat pump system '%s' - system type %s is not yet available for compliance analysis", Name, TypeAbbrevStr )  endif  }

	"Check for cooling system type availability"
		HVACCool:Action	= {	if (FloorAreaServed < 0.1 .OR. IsAvailable > 0.5) then  UNCHANGED
										else PostError( "Cooling system '%s' - system type %s is not yet available for compliance analysis", Name, TypeAbbrevStr )  endif  }

	"Check for fan type availability"
		HVACFan:Action		= {	if (FloorAreaServed < 0.1 .OR. IsAvailable > 0.5) then  UNCHANGED
										else PostError( "Fan '%s' - fan type %s is not yet available for compliance analysis", Name, TypeAbbrevStr )  endif  }

; SAC 5/22/14 - added additional check to ensure valid HVACDist:Type selections
; SAC 7/14/14 - added check to prevent modeling of ducts in crawl spaces where crawl space area < 10% of overall conditioned area (GC issue #324)
	"Check for valid distribution system type"
		HVACDist:Action	= {	if (FloorAreaServed < 0.1 .OR. IfValidAnd( Proj:CondFloorArea > 1 ) == 0) then  UNCHANGED
										else	switch (Type)
													case  1 :	; "Ducts located in attic (Ventilated and Unventilated)"
																	if (ComponentCount( Attic ) < 0.5 .OR. SumAll( Attic:FloorArea ) < 1)
																	then	PostError( "Distribution system '%s' - system type %s is not valid when no attic exists", Name, TypeAbbrevStr )
																	else if ((SumAll( Attic:FloorAreaOverCond ) / Proj:CondFloorArea) <= 0.0999)
																	then	PostError( "Distribution system '%s' - system type %s is not valid when attic area above conditioned rooms < 10% of total conditioned area", Name, TypeAbbrevStr )
																	else	UNCHANGED  endif endif
													case  2 :	; "Ducts located in a crawl space"
																	if (ComponentCount( CrawlSpace ) < 0.5 .OR. SumAll( CrawlSpace:Area ) < 1)
																	then	PostError( "Distribution system '%s' - system type %s is not valid when no crawl spaces exist", Name, TypeAbbrevStr )
																	else if ((SumAll( CrawlSpace:Area ) / Proj:CondFloorArea) <= 0.1499)
																	then	PostError( "Distribution system '%s' - system type %s is not valid when crawl space area < 15% of total conditioned area", Name, TypeAbbrevStr )
																	else	UNCHANGED  endif endif
													case  4 :	; "Ducts located in a garage"
																	if (ComponentCount( Garage ) < 0.5 .OR. SumAll( Garage:Area ) < 1)
																	then	PostError( "Distribution system '%s' - system type %s is not valid when no garages exist", Name, TypeAbbrevStr )
																	else	UNCHANGED  endif
													default :  UNCHANGED
												endswitch  endif  }

; DEBUGGING
;	"store BEMProc details"		Proj:Action = {  StoreBEMProc( "b4 sys type chk", 0 )  }
;	"Post messagebox"				HVACSys:Action = {  MessageBox( "Clg: '%s', Type %g, IsHP %g -- Htg: '%s', Type %g, IsHP %g",
;																	CoolSystem:Name, CoolSystem:Type, CA13CoolingEquipment:IsHP( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSystem:TypeAbbrevStr ),
;																	HeatSystem:Name, HeatSystem:Type, CA13HeatingEquipment:IsHP( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSystem:TypeAbbrevStr ) )  }
; DEBUGGING

	"Check for valid combinations of heating/cooling system types"
		HVACSys:Action	= {	     if ((Type == 1 .OR. Type == 3) .AND. strlen( HeatEquipIssue   ) > 2) then  PostError( "%s for HVAC system '%s' (%s)",   HeatEquipIssue, Name, EnumString( Type ) )
									else if ((Type == 1 .OR. Type == 3) .AND. strlen( CoolEquipIssue   ) > 2) then  PostError( "%s for HVAC system '%s' (%s)",   CoolEquipIssue, Name, EnumString( Type ) )
									else if (                Type == 2  .AND. strlen( HtPumpEquipIssue ) > 2) then  PostError( "%s for HVAC system '%s' (%s)", HtPumpEquipIssue, Name, EnumString( Type ) )
									else if (Type == 1 .OR. Type == 3)
									then  if (LocalCompAssigned( HeatSystem[1] ) == 0 .AND. LocalCompAssigned( CoolSystem[1] ) == 0)
											then	PostError( "HVAC system '%s' (%s) must have heating & cooling equipment objects defined", Name, EnumString( Type ) )
											else if (LocalCompAssigned( HeatSystem[1] ) == 0)
; ??? Allow simulation of systems that exclude either/both heating &/or cooling equipment ???
											then	PostError( "HVAC system '%s' (%s) must have heating equipment defined", Name, EnumString( Type ) )
											else if (LocalCompAssigned( CoolSystem[1] ) == 0)
											then	PostError( "HVAC system '%s' (%s) must have cooling equipment defined", Name, EnumString( Type ) )
											else if (CoolSystem[1]:Type == 1  .AND.
														CA13HeatingEquipment:IsHP( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSystem[1]:TypeAbbrevStr ))
											then	PostError( "HVAC system '%s' (%s) cannot have heat pump heating & no cooling equipment", Name, EnumString( Type ) )
											else if (CoolSystem[1]:Type > 1  .AND.
														CA13CoolingEquipment:IsHP( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", CoolSystem[1]:TypeAbbrevStr ) !=
														CA13HeatingEquipment:IsHP( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", HeatSystem[1]:TypeAbbrevStr ))
											then	PostError( "HVAC system '%s' (%s) cannot have a mixture of heat pump & non-HP equipment", Name, EnumString( Type ) )
											else  UNCHANGED  endif endif endif endif endif
									else  UNCHANGED
									endif endif endif endif  }


;	"store BEMProc details"		proj:Action = {  StoreBEMProc( "b4 Duct Check", 0 )  }
;	"debugging"		proj:Action		= {	MessageBox( "checking HVACSys for valid duct assignments" )  }
;	"debugging"		HVACSys:Action		= {	MessageBox( "checking HVACSys '%s' for valid duct assignments", HVACSys:Name )  }
;	"debugging duct flag error"		HVACSys:Action		= {	MessageBox( "checking HtOrClDucted before error msg %g", HVACSys:HtOrClDucted )  }

; SAC 9/4/13 - added logic to allow no ducts when distrib system's HVACDist:Type = 12 ("LowLlCod - Verified low-leakage ducts in conditioned space") - GC issue 163
	"Check for existing DistribSystem not of a ducted type but assigned to an HVAC system requiring ducts (or vice-versa)"
		HVACSys:Action	= {	if (strlen( DuctMsg ) < 3 .OR. FloorAreaServed < 0.1 ) then  UNCHANGED
									else if (HtOrClDucted > 0.5 .AND. LocalCompAssigned( DistribSystem ) == 0)
									then	switch (HtOrClDucted)
												case  1 : PostError( "Ducts required for heating system but not defined for HVAC system '%s' (%s)", Name, EnumString( Type ) )
												case  2 : PostError( "Ducts required for cooling system but not defined for HVAC system '%s' (%s)", Name, EnumString( Type ) )
												default : PostError( "Ducts required for heating & cooling systems but not defined for HVAC system '%s' (%s)", Name, EnumString( Type ) )
											endswitch
									else if (HtOrClDucted > 0.5 .AND. DistribSystem:DuctsPresent == 0 .AND. DistribSystem:Type != 7 .AND. DistribSystem:Type != 12)
									then	switch (HtOrClDucted)
												case  1 : PostError( "Ducts required for heating system but assigned distribution system lacks ducts for HVAC system '%s' (%s)", Name, EnumString( Type ) )
												case  2 : PostError( "Ducts required for cooling system but assigned distribution system lacks ducts for HVAC system '%s' (%s)", Name, EnumString( Type ) )
												default : PostError( "Ducts required for htg & clg systems but assigned distribution system lacks ducts for HVAC system '%s' (%s)", Name, EnumString( Type ) )
											endswitch
									else if (HtOrClDucted < 0.5 .AND. LocalCompAssigned( DistribSystem ) > 0)
									then	if (DistribSystem:DuctsPresent > 0)
											then  PostError( "Ducts not required for heating or cooling but included in assigned distribution system for HVAC system '%s' (%s)", Name, EnumString( Type ) )
											else  UNCHANGED  endif
									else  UNCHANGED  endif endif endif endif  }

  ; SAC 1/6/16 - removed check preventing elec equipment from serving as combined hydronic heat source (tic 374)
	"Check Combined Hydronic heating system properties"
		HVACHeat:Action	= {	if (FloorAreaServed > 0.1 .AND. Type = 9)   ; "CombHydro - Water heating system can be storage gas/elec/ht pump"
										then	if (LocalCompAssigned( CHWHeater ) < 0.5)
												then  PostError( "Combined hydronic heating system '%s' must have an assigned water heater.", Name )
												else if (CHWHeater:CanBeCHWHeater < 0.5)
												then  PostError( "Invalid water heater type referenced by combined hydronic heating system '%s'.", Name )
												else  UNCHANGED  endif endif
										else  UNCHANGED  endif  }

; SAC 5/12/15 - added checks for valid DHWSys:SystemType & DHWSys:MFamDistType specified (issue 537)
; SAC 5/13/15 - revisions to this check to ensure proper SystemType for central systems (issue 537)
	"Check DHWSys:SystemType selection"		DHWSys:Action	= {	if (IfValidAnd( SystemType > 0 )==0)
																					then	PostError( "DHWSys '%s' must have a valid Distribution (SystemType) option selected.", Name )
																					else if (Proj:IsMultiFamily > 0.5 .AND. IfValidAnd( CentralDHW > 0 ) .AND.
																									SystemType != 3840 .AND. SystemType != 4096 .AND. SystemType != 4352 .AND.
																									SystemType != 8392704 .AND. SystemType != 8392960 )
																					then	PostError( "DHWSys '%s' Dwelling Unit Distribution (SystemType) is not compatible with multifamily, central systems.", Name )
																					else	UNCHANGED  endif endif  }
; SAC 5/13/15 - REMOVED this check preventing MFamDistType = '- none -', as this turns out to be a valid selection, even when CentralDHW is checked. (issue 537)
;	"Check DHWSys:MFamDistType selection"	DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. CentralDHW < 0.5 .OR. MFamDistType > 0.5) then  UNCHANGED
;																					else	PostError( "DHWSys '%s' must have a valid Central System Distribution (MFamDistType) option selected.", Name )  endif  }

  ; SAC 4/20/14 - checks for HVACSys assiged as DHW heaters being configured to do so
	"Check for HVACSys assignment #1 able to serve as a DHWHeater"
		DHWSys:Action	= {	if (NumDHWHeaters > 0 .AND. IfValidAnd( HeaterMult[1] > 0 ) .AND. LocalCompAssigned( DHWHeater[1] ) == ComponentType( "HVACSys" ))
									then	if (DHWHeater[1]:CanBeDHWHtr > 0.5) then  UNCHANGED
											else  PostError( "HVACSys '%s' assigned as first DHW heater of DHWSys '%s' is not configured to serve as a DHW heater.", DHWHeater[1]:Name, Name )
											endif
									else	UNCHANGED  endif  }
	"Check for HVACSys assignment #2 able to serve as a DHWHeater"
		DHWSys:Action	= {	if (NumDHWHeaters > 1 .AND. IfValidAnd( HeaterMult[2] > 0 ) .AND. LocalCompAssigned( DHWHeater[2] ) == ComponentType( "HVACSys" ))
									then	if (DHWHeater[2]:CanBeDHWHtr > 0.5) then  UNCHANGED
											else  PostError( "HVACSys '%s' assigned as second DHW heater of DHWSys '%s' is not configured to serve as a DHW heater.", DHWHeater[2]:Name, Name )
											endif
									else	UNCHANGED  endif  }
	"Check for HVACSys assignment #3 able to serve as a DHWHeater"
		DHWSys:Action	= {	if (NumDHWHeaters > 2 .AND. IfValidAnd( HeaterMult[3] > 0 ) .AND. LocalCompAssigned( DHWHeater[3] ) == ComponentType( "HVACSys" ))
									then	if (DHWHeater[3]:CanBeDHWHtr > 0.5) then  UNCHANGED
											else  PostError( "HVACSys '%s' assigned as third DHW heater of DHWSys '%s' is not configured to serve as a DHW heater.", DHWHeater[3]:Name, Name )
											endif
									else	UNCHANGED  endif  }
	"Check for HVACSys assignment #4 able to serve as a DHWHeater"
		DHWSys:Action	= {	if (NumDHWHeaters > 3 .AND. IfValidAnd( HeaterMult[4] > 0 ) .AND. LocalCompAssigned( DHWHeater[4] ) == ComponentType( "HVACSys" ))
									then	if (DHWHeater[4]:CanBeDHWHtr > 0.5) then  UNCHANGED
											else  PostError( "HVACSys '%s' assigned as fourth DHW heater of DHWSys '%s' is not configured to serve as a DHW heater.", DHWHeater[4]:Name, Name )
											endif
									else	UNCHANGED  endif  }
	"Check for HVACSys assignment #5 able to serve as a DHWHeater"
		DHWSys:Action	= {	if (NumDHWHeaters > 4 .AND. IfValidAnd( HeaterMult[5] > 0 ) .AND. LocalCompAssigned( DHWHeater[5] ) == ComponentType( "HVACSys" ))
									then	if (DHWHeater[5]:CanBeDHWHtr > 0.5) then  UNCHANGED
											else  PostError( "HVACSys '%s' assigned as fifth DHW heater of DHWSys '%s' is not configured to serve as a DHW heater.", DHWHeater[5]:Name, Name )
											endif
									else	UNCHANGED  endif  }
	"Check for HVACSys assignment #6 able to serve as a DHWHeater"
		DHWSys:Action	= {	if (NumDHWHeaters > 5 .AND. IfValidAnd( HeaterMult[6] > 0 ) .AND. LocalCompAssigned( DHWHeater[6] ) == ComponentType( "HVACSys" ))
									then	if (DHWHeater[6]:CanBeDHWHtr > 0.5) then  UNCHANGED
											else  PostError( "HVACSys '%s' assigned as sixth DHW heater of DHWSys '%s' is not configured to serve as a DHW heater.", DHWHeater[6]:Name, Name )
											endif
									else	UNCHANGED  endif  }

; SAC 5/7/14 - added logic to check for tank insulation R-value being too low to be simulated (lower limit set @ 2)
;	"Check for HVACSys-based DHW inputs having invalid tank R-value(s)"
;		HVACSys:Action	= {	if (CanBeDHWHtr < 0.1 .OR. DHWFloorAreaServed < 0.1) then  UNCHANGED
;									else if ((ValidOr( DHWIntInsulRVal, 0 ) + ValidOr( DHWExtInsulRVal, 0 )) < 2)
;									then	PostError( "HVACSys '%s' is referenced as a DHW heater but its DHW tank insulation R-value is below the minimum of 2 F-ft2-h/Btu", Name )
;									else	UNCHANGED  endif endif  }

	; SAC 11/10/15 - added check based on request from CEC-TF
	"Check for valid multifamily DHW dustribution type for central systems"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. CentralDHW < 0.5 .OR. MFamDistType > 0.5 .OR. IfValidAnd( NumDUsServed > 8 )==0 .OR. (Proj:RunScope == 2 .AND. Status = 1)) then  UNCHANGED
									else  PostError( "DHW system '%s' must be set to a distribution type other than '%s' since it serves more than 8 dwelling units (%g).", Name, EnumString( MFamDistType ), NumDUsServed )
									endif  }

  ; SAC 10/7/13 - added check to ensure that ALL REQUIRED recirculation pipe inputs are specified (iff they are to be simulated)
	"Check multifamily recirculation DHW pump HP"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5) then  UNCHANGED
									else if (LocalStatus( RecircPumpHP  ) < 1) then  PostError( "DHW system '%s' recirculation pump horsepower must be specified.", Name )
									else if (RecircPumpHP <= 0) then  PostError( "DHW system '%s' recirculation pump horsepower (%g) must be > 0.", Name, RecircPumpHP )
									else  UNCHANGED  endif endif endif  }
	"Check multifamily recirculation DHW pump efficiency"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5) then  UNCHANGED
									else if (LocalStatus( RecircPumpEff ) < 1) then  PostError( "DHW system '%s' recirculation pump efficiency must be specified.", Name )
									else if (RecircPumpEff <= 0) then  PostError( "DHW system '%s' recirculation pump efficiency (%g) must be > 0.", Name, RecircPumpEff )
									else  UNCHANGED  endif endif endif  }
	"Check multifamily recirculation DHW pipe inputs (being defined)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5) then  UNCHANGED
									else if (LocalStatus( RecircPipeLen[1] ) < 1 .OR. LocalStatus( RecircPipeLen[2] ) < 1 .OR. LocalStatus( RecircPipeLen[3] ) < 1 .OR.
											   LocalStatus( RecircPipeLen[4] ) < 1 .OR. LocalStatus( RecircPipeLen[5] ) < 1 .OR. LocalStatus( RecircPipeLen[6] ) < 1 )
									then  PostError( "All 6 DHW system '%s' recirculation pipe lengths (3 supply, 3 return) must be specified.", Name )
									else if (LocalStatus( RecircPipeDia[1] ) < 1 .OR. LocalStatus( RecircPipeDia[2] ) < 1 .OR. LocalStatus( RecircPipeDia[3] ) < 1 .OR.
											   LocalStatus( RecircPipeDia[4] ) < 1 .OR. LocalStatus( RecircPipeDia[5] ) < 1 .OR. LocalStatus( RecircPipeDia[6] ) < 1 )
									then  PostError( "All 6 DHW system '%s' recirculation pipe diameters (3 supply, 3 return) must be specified.", Name )
									else	UNCHANGED  endif endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeLen[1] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeLen[1] ) < 1) then  UNCHANGED
									else if (RecircPipeLen[1] <= 0) then  PostError( "Recirculation DHW System '%s' supply pipe #1 length (%g) must be > 0.", Name, RecircPipeLen[1] )
									else  UNCHANGED  endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeLen[2] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeLen[2] ) < 1) then  UNCHANGED
									else if (RecircPipeLen[2] <= 0) then  PostError( "Recirculation DHW System '%s' supply pipe #2 length (%g) must be > 0.", Name, RecircPipeLen[2] )
									else  UNCHANGED  endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeLen[3] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeLen[3] ) < 1) then  UNCHANGED
									else if (RecircPipeLen[3] <= 0) then  PostError( "Recirculation DHW System '%s' supply pipe #3 length (%g) must be > 0.", Name, RecircPipeLen[3] )
									else  UNCHANGED  endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeLen[4] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeLen[4] ) < 1) then  UNCHANGED
									else if (RecircPipeLen[4] <= 0) then  PostError( "Recirculation DHW System '%s' return pipe #1 length (%g) must be > 0.", Name, RecircPipeLen[4] )
									else  UNCHANGED  endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeLen[5] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeLen[5] ) < 1) then  UNCHANGED
									else if (RecircPipeLen[5] <= 0) then  PostError( "Recirculation DHW System '%s' return pipe #2 length (%g) must be > 0.", Name, RecircPipeLen[5] )
									else  UNCHANGED  endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeLen[6] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeLen[6] ) < 1) then  UNCHANGED
									else if (RecircPipeLen[6] <= 0) then  PostError( "Recirculation DHW System '%s' return pipe #3 length (%g) must be > 0.", Name, RecircPipeLen[6] )
									else  UNCHANGED  endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeDia[1] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeDia[1] ) < 1) then  UNCHANGED
									else if (RecircPipeDia[1] <= 0) then  PostError( "Recirculation DHW System '%s' supply pipe #1 diameter (%g) must be > 0.", Name, RecircPipeDia[1] )
									else  UNCHANGED  endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeDia[2] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeDia[2] ) < 1) then  UNCHANGED
									else if (RecircPipeDia[2] <= 0) then  PostError( "Recirculation DHW System '%s' supply pipe #2 diameter (%g) must be > 0.", Name, RecircPipeDia[2] )
									else  UNCHANGED  endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeDia[3] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeDia[3] ) < 1) then  UNCHANGED
									else if (RecircPipeDia[3] <= 0) then  PostError( "Recirculation DHW System '%s' supply pipe #3 diameter (%g) must be > 0.", Name, RecircPipeDia[3] )
									else  UNCHANGED  endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeDia[4] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeDia[4] ) < 1) then  UNCHANGED
									else if (RecircPipeDia[4] <= 0) then  PostError( "Recirculation DHW System '%s' return pipe #1 diameter (%g) must be > 0.", Name, RecircPipeDia[4] )
									else  UNCHANGED  endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeDia[5] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeDia[5] ) < 1) then  UNCHANGED
									else if (RecircPipeDia[5] <= 0) then  PostError( "Recirculation DHW System '%s' return pipe #2 diameter (%g) must be > 0.", Name, RecircPipeDia[5] )
									else  UNCHANGED  endif endif  }
	"Check multifamily recirculation DHW pipe inputs (RecircPipeDia[6] > 0)"
		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. MFamDistType < 0.5 .OR. UseDefaultLoops > 0.5 .OR. LocalStatus( RecircPipeDia[6] ) < 1) then  UNCHANGED
									else if (RecircPipeDia[6] <= 0) then  PostError( "Recirculation DHW System '%s' return pipe #3 diameter (%g) must be > 0.", Name, RecircPipeDia[6] )
									else  UNCHANGED  endif endif  }

; SAC 9/4/15 - new check for valid DHW solar fraction data, depending on SolFracType
	"Check for valid DHWSys solar fraction data"
		DHWSys:Action	= {	if (IfValidAnd( SystemType > 0 )==0 .OR. NumDHWHeaters < 1 .OR. IfValidAnd( HeaterMult[1] > 0 )==0 .OR. 
											LocalCompAssigned( DHWHeater[1] ) < 1 .OR. IfValidAnd( SimDHWSys > 0 )==0)  then  UNCHANGED
									else if (SolFracType == 1 .AND. IfValidAnd( SolFracAnn >= 0 )==0)
									then	PostError( "DHW System '%s' requires specification of a valid Annual Solar Fraction (SolFracAnn).", Name )
									else if (SolFracType == 2 .AND. (IfValidAnd( SolFracMon[1] >= 0 )==0 .OR. IfValidAnd( SolFracMon[2] >= 0 )==0 .OR. IfValidAnd( SolFracMon[3] >= 0 )==0 .OR. IfValidAnd( SolFracMon[4] >= 0 )==0 .OR.
												IfValidAnd( SolFracMon[5] >= 0 )==0 .OR. IfValidAnd( SolFracMon[6] >= 0 )==0 .OR. IfValidAnd( SolFracMon[7] >= 0 )==0 .OR. IfValidAnd( SolFracMon[8] >= 0 )==0 .OR.
												IfValidAnd( SolFracMon[9] >= 0 )==0 .OR. IfValidAnd( SolFracMon[10] >= 0 )==0 .OR. IfValidAnd( SolFracMon[11] >= 0 )==0 .OR. IfValidAnd( SolFracMon[12] >= 0 )==0 ))
									then	PostError( "DHW System '%s' requires specification of all Monthly Solar Fractions (SolFracMon[1-12]).", Name )
									else	UNCHANGED  endif endif endif  }
	"Check for valid DwellUnitType DHW solar fraction data"
		DwellUnitType:Action	= {	if (HtEqpUsedAsDHWHtr < 0.5 .OR. AssignedDUFlrArea < 1)  then  UNCHANGED
											else if (DHWSolFracType == 1 .AND. IfValidAnd( DHWSolFracAnn >= 0 )==0)
											then	PostError( "DwellUnitType '%s' requires specification of a valid Annual Solar Fraction (DHWSolFracAnn).", Name )
											else if (DHWSolFracType == 2 .AND. (IfValidAnd( DHWSolFracMon[1] >= 0 )==0 .OR. IfValidAnd( DHWSolFracMon[2] >= 0 )==0 .OR. IfValidAnd( DHWSolFracMon[3] >= 0 )==0 .OR. IfValidAnd( DHWSolFracMon[4] >= 0 )==0 .OR.
														IfValidAnd( DHWSolFracMon[5] >= 0 )==0 .OR. IfValidAnd( DHWSolFracMon[6] >= 0 )==0 .OR. IfValidAnd( DHWSolFracMon[7] >= 0 )==0 .OR. IfValidAnd( DHWSolFracMon[8] >= 0 )==0 .OR.
														IfValidAnd( DHWSolFracMon[9] >= 0 )==0 .OR. IfValidAnd( DHWSolFracMon[10] >= 0 )==0 .OR. IfValidAnd( DHWSolFracMon[11] >= 0 )==0 .OR. IfValidAnd( DHWSolFracMon[12] >= 0 )==0 ))
											then	PostError( "DwellUnitType '%s' requires specification of all Monthly Solar Fractions (DHWSolFracMon[1-12]).", Name )
											else	UNCHANGED  endif endif endif  }

	; SAC 5/12/16 - check for DwellUnitTypes w/ multiple DHWSys assignments AND Proj:CSEDHWUseMethod NOT the older, 2013 mode
  ; LDH 7/25/2016 - removed in order to test multiple DHW system assignments.
;	"Check for valid number of DwellUnitType DHW system assignments"
;		DwellUnitType:Action	= {	if (Proj:IsMultiFamily < 0.5 .OR. Proj:CSEDHWUseMethod == 1 .OR. AssignedDUFlrArea < 1)  then  UNCHANGED
;											else if (IfValidAnd( NumDHWSysTypes > 1 ))
;											then	PostError( "DwellUnitType '%s' cannot have more than 1 water heating system assignment.", Name )
;											else	UNCHANGED  endif endif  }
; SAC 7/23/16 - removed constraint of only a single dwelling unit served per DHWSys (for new CSEDHWUseMethod)
;	; SAC 6/15/16 - check for Zones w/ multiple DHWSys assignments AND Proj:CSEDHWUseMethod NOT the older, 2013 mode (tic #666)
;	"Check for no more than 1 DHW system assigned in a SFam model"
;		Proj:Action				= {	if (Proj:IsMultiFamily > 0.5 .OR. Proj:CSEDHWUseMethod == 1)  then  UNCHANGED
;											else if (SumAll( DHWSys:SimDHWSys ) > 1)
;											then	PostError( "No single dwelling unit can be served by more than 1 water heating system (%g assigned systems).", SumAll( DHWSys:SimDHWSys ) )
;											else	UNCHANGED  endif endif  }

; SAC 12/23/14 - REMOVED following check - thereby allowing SFam distribution types in MFam projects (GC issue 458)
;  	"Check for allowed dwelling unit distribution if multi-family distribution used"
;  ;		DHWSys:Action	= {	if (Proj:IsMultiFamily > 0.5 .AND. (SystemType = 3840 .OR. SystemType = 4096 .OR. SystemType = 8392704)) then UNCHANGED
;  ;									else PostError( "Dwelling Unit distribution system not applicable with multi-family system" )	endif  }
;  ; SAC 3/21/14 - first version (above) throws error for EVERY single family project - seems like the opposite logic is what was meant??
;  		DHWSys:Action	= {	if (Proj:IsMultiFamily < 0.5) then  UNCHANGED
;  									else if (SystemType = 3840 .OR. SystemType = 4096 .OR. SystemType = 8392704) then  UNCHANGED
;  									else  PostError( "Dwelling Unit distribution system not applicable with multi-family system" )  endif endif  }

; SAC 11/10/15 - removed check on DHWHeater fuel - no longer pertinent since addition of global GasType
;; SAC 5/1/15 - added code to ignore this error for 2016 standard design (and other post-Proposed) models (issue 531)
;	"Check for consistency between NatGas availability and DHWHeater:HeaterElementType"
;		DHWHeater:Action	= {	if (Proj:StdDesignBase == 2016 .AND. (Proj:RunAbbrev == "s" .OR. Proj:RunAbbrev == "dr")) then  UNCHANGED
;										else if (Proj:NatGasAvailable < 0.5 .AND. HeaterElementType = 1)   ; NatGas NOT available, but is the current selection for this DHWHeater
;										then	if (FloorAreaServed > 0.1)
;								;		then	if (	CountRefs( HVACHeat:CHWHeater  ) > 0.5 .OR. CountRefs( DHWSys:DHWHeater[1] ) > 0.5 .OR.  ; only report error if this heater is actually referenced
;								;						CountRefs( DHWSys:DHWHeater[2] ) > 0.5 .OR. CountRefs( DHWSys:DHWHeater[3] ) > 0.5 .OR. CountRefs( DHWSys:DHWHeater[4] ) > 0.5 .OR. 
;								;						CountRefs( DHWSys:DHWHeater[5] ) > 0.5 .OR. CountRefs( DHWSys:DHWHeater[6] ) > 0.5 )
;												then  PostError( "DHW heater '%s' element type set to Natural Gas, but Natural Gas registered as not available on site.", Name )
;												else  UNCHANGED  endif
;										else  UNCHANGED  endif endif  }
; SAC 5/2/15
	"Check for models whose standard design water heating cause analysis incompatibilities"
		Proj:Action	= {	if (StdDHWFuelErrMsg > 0) then  PostError( "Standard design water heating:  %s.", EnumString( StdDHWFuelErrMsg ) )
								else	UNCHANGED  endif  }

  ; SAC 6/17/14 - added to report DHWHeater:TankType selections that are no longer allowed
  ; SAC 11/10/15 - added recently selectable 'Electric Mini Tank'
	"Check for selection of currently unavailable DHWHeater:TankType"
		DHWHeater:Action	= {	if (IfValidAnd( FloorAreaServed > 0.1 ) .AND. (IfValidAnd( TankType > 99 ) .OR. IfValidAnd( TankType = 8 )))
										then	switch (TankType)
													case  100 : PostError( "DHW heater '%s' tank type of 'Boiler' is not compatible with the currently selected heater element type '%s'.",               Name, EnumString( HeaterElementType ) )
													case  101 : PostError( "DHW heater '%s' tank type of 'Indirect' is not compatible with the currently selected heater element type '%s'.",             Name, EnumString( HeaterElementType ) )
													case  102 : PostError( "DHW heater '%s' tank type of 'Large Instantaneous' is not compatible with the currently selected heater element type '%s'.",  Name, EnumString( HeaterElementType ) )
													case  103 : PostError( "DHW heater '%s' tank type of 'Large Storage' is not compatible with the currently selected heater element type '%s'.",        Name, EnumString( HeaterElementType ) )
													case  104 : PostError( "DHW heater '%s' tank type of 'Large Tankless' is not compatible with the currently selected heater element type '%s'.",       Name, EnumString( HeaterElementType ) )
													case  105 : PostError( "DHW heater '%s' tank type of 'Small Instantaneous' is not compatible with the currently selected heater element type '%s'.",  Name, EnumString( HeaterElementType ) )
													case  107 : PostError( "DHW heater '%s' tank type of 'Unfired Storage Tank' is not compatible with the currently selected heater element type '%s'.", Name, EnumString( HeaterElementType ) )
												;	case  108 : PostError( "DHW heater '%s' tank type of 'Electric Mini Tank' is not compatible with the currently selected heater element type '%s'.",   Name, EnumString( HeaterElementType ) )
													case    8 : PostError( "DHW heater '%s' tank type issue - 'Electric Mini Tank' now implemented only as optional inputs to Gas Instantaneous heaters.", Name )
													default   : UNCHANGED
												endswitch
										else	UNCHANGED  endif  }
	"Check for selection of currently unavailable HVACSys:DHWTankType"
		HVACSys:Action	= {	if (IfValidAnd( DHWFloorAreaServed > 0.1 ) .AND. (IfValidAnd( DHWTankType > 99 ) .OR. IfValidAnd( DHWTankType = 8 )))
										then	switch (DHWTankType)
													case  100 : PostError( "HVAC system '%s' DHW tank type of 'Boiler' is not compatible with the currently selected heater element type '%s'.",               Name, EnumString( DHWHeaterElementType ) )
													case  101 : PostError( "HVAC system '%s' DHW tank type of 'Indirect' is not compatible with the currently selected heater element type '%s'.",             Name, EnumString( DHWHeaterElementType ) )
													case  102 : PostError( "HVAC system '%s' DHW tank type of 'Large Instantaneous' is not compatible with the currently selected heater element type '%s'.",  Name, EnumString( DHWHeaterElementType ) )
													case  103 : PostError( "HVAC system '%s' DHW tank type of 'Large Storage' is not compatible with the currently selected heater element type '%s'.",        Name, EnumString( DHWHeaterElementType ) )
													case  104 : PostError( "HVAC system '%s' DHW tank type of 'Large Tankless' is not compatible with the currently selected heater element type '%s'.",       Name, EnumString( DHWHeaterElementType ) )
													case  105 : PostError( "HVAC system '%s' DHW tank type of 'Small Instantaneous' is not compatible with the currently selected heater element type '%s'.",  Name, EnumString( DHWHeaterElementType ) )
													case  107 : PostError( "HVAC system '%s' DHW tank type of 'Unfired Storage Tank' is not compatible with the currently selected heater element type '%s'.", Name, EnumString( DHWHeaterElementType ) )
												;	case  108 : PostError( "HVAC system '%s' DHW tank type of 'Electric Mini Tank' is not compatible with the currently selected heater element type '%s'.",   Name, EnumString( DHWHeaterElementType ) )
													case    8 : PostError( "DHW heater '%s' tank type issue - 'Electric Mini Tank' now implemented only as optional inputs to Gas Instantaneous heaters.", Name )
													default   : UNCHANGED
												endswitch
										else	UNCHANGED  endif  }

	; SAC 1/14/14 - appliance fuel checks added (cooking OK to remain nat gas even when nat gas not available on site)
	"Check for consistency between NatGas availability and Proj:ApplDryerFuel[1] options (single-family)"
		Proj:Action	= {	if (Proj:StdDesignBase > 2015 .OR. NatGasAvailable > 0.5 .OR. IsMultiFamily > 0.5 .OR. ApplDryerFuel[1] != 2) then  UNCHANGED
								else  PostError( "Project's clothes dryer fuel set to Natural Gas (Project data, Appliances tab), but Natural Gas registered as not available on site." )  endif  }
	"Check for consistency between NatGas availability and Proj:ApplDryerFuel[*] options (multi-family)"
		Zone:Action	= {	if (Proj:StdDesignBase > 2015 .OR. Proj:NatGasAvailable > 0.5 .OR. Proj:IsMultiFamily < 0.5 .OR. Appl_DryerGain[2] < 0.01) then  UNCHANGED
								else	PostError( "Clothes dryer fuel set to Natural Gas for dwelling unit(s) assigned to Zone '%s', but Natural Gas registered as not available on site.", Name )  endif  }


; SAC 11/12/14 - added checks to ensure that valid Zones are assigned for all appliances listed as present in model (GC issue 379)
	; SAC 2/4/16 - toggled OFF these checks when in Research mode
	"Check for single family Refrigerator appliance location"
		Proj:Action		= {	if (IsMultiFamily > 0.5 .OR. IfValidAnd( Appl_HaveRefrig[1] > 0.5 )==0 .OR. AnalysisType < 1) then  UNCHANGED
									else if (LocalCompAssigned( ApplRefrigZone[1] ) < 0.5) 
									then  PostError( "Valid Zone must be selected for refrigerator location (on Appliances tab of Project tabbed dialog)." )
									else  UNCHANGED  endif endif  }
	"Check for single family Dishwasher appliance location"
		Proj:Action		= {	if (IsMultiFamily > 0.5 .OR. IfValidAnd( Appl_HaveDish[1] > 0.5 )==0 .OR. AnalysisType < 1) then  UNCHANGED
									else if (LocalCompAssigned( ApplDishZone[1] ) < 0.5) 
									then  PostError( "Valid Zone must be selected for dishwasher location (on Appliances tab of Project tabbed dialog)." )
									else  UNCHANGED  endif endif  }
	"Check for single family Clothes Washer appliance location"
		Proj:Action		= {	if (IsMultiFamily > 0.5 .OR. IfValidAnd( Appl_HaveWasher[1] > 0.5 )==0 .OR. AnalysisType < 1) then  UNCHANGED
									else if (LocalCompAssigned( ApplWasherZone[1] ) < 0.5) 
									then  PostError( "Valid Zone must be selected for clothes washer location (on Appliances tab of Project tabbed dialog)." )
									else  UNCHANGED  endif endif  }
	"Check for single family Clothes Dryer appliance location"
		Proj:Action		= {	if (IsMultiFamily > 0.5 .OR. IfValidAnd( Appl_HaveDryer[1] > 0.5 )==0 .OR. AnalysisType < 1) then  UNCHANGED
									else if (LocalCompAssigned( ApplDryerZone[1] ) < 0.5) 
									then  PostError( "Valid Zone must be selected for clothes dryer location (on Appliances tab of Project tabbed dialog)." )
									else  UNCHANGED  endif endif  }
	"Check for single family Cooking appliance location"
		Proj:Action		= {	if (IsMultiFamily > 0.5 .OR. IfValidAnd( Appl_HaveCook[1] > 0.5 )==0 .OR. AnalysisType < 1) then  UNCHANGED
									else if (LocalCompAssigned( ApplCookZone[1] ) < 0.5) 
									then  PostError( "Valid Zone must be selected for cooking appliances location (on Appliances tab of Project tabbed dialog)." )
									else  UNCHANGED  endif endif  }

END
;*************************************************************************


;*************************************************************************
RULELIST "Count_NumAlterations" 1 0 0 0
;   Generate estiamte of number of alteration categories present in building model
;*************************************************************************
	"alteration categ #1 - ceiling/wall/raised floor insulation"
		Proj:NumAlterations	= {	SumAcrossIf( ExtWall:IsAltered, ExtWall:Area > 1 ) +
											SumAcrossIf( ExteriorFloor:IsAltered, ExteriorFloor:Area > 1 ) +
											SumAcrossIf( CathedralCeiling:IsAltered, CathedralCeiling:Area > 1 ) +
											SumAcrossIf( CeilingBelowAttic:IsAltered, CeilingBelowAttic:Area > 1 ) +
											SumAcrossIf( FloorOverCrawl:IsAltered, FloorOverCrawl:Area > 1 ) +
											SumAcrossIf( IntWall:IsAltered, IntWall:IsDemising > 0.5 ) +
											SumAcrossIf( UndWall:IsAltered, UndWall:Area > 1 ) +
											SumAcrossIf( InteriorFloor:IsAltered, InteriorFloor:IsDemising > 0.5 ) +
											SumAcrossIf( InteriorCeiling:IsAltered, InteriorCeiling:IsDemising > 0.5 )  }

	"alteration categ #2/3 - fenestration OR window film"
		Proj:NumAlterations	= {	NumAlterations + SumAcrossIf( Window:IsAltered, Window:Area > 1 )  }

	"alteration categ #4 - space heating and/or cooling equip"
		Proj:NumAlterations	= {	NumAlterations + SumAcrossIf( HVACSys:IsAltered, HVACSys:FloorAreaSrvdInclV > 1 )  }

	"alteration categ #5/6 - duct sealing OR insulation"
		Proj:NumAlterations	= {	NumAlterations + SumAll( HVACDist:IsAltered )  }

	"alteration categ #7 - water heating systems"
		Proj:NumAlterations	= {	NumAlterations + SumAcrossIf( DHWSys:IsAltered, DHWSys:FloorAreaServed > 1 )  }

	"alteration categ #8 - roofing"
		Proj:NumAlterations	= {	NumAlterations + SumAcrossIf( Attic:IsAltered, Attic:FloorArea > 1 )  }

	"alteration categ #9 - all others"
		Proj:NumAlterations	= {	NumAlterations +	SumAcrossIf( UndFloor:IsAltered, UndFloor:Area > 1 ) +
																	SumAcrossIf( SlabFloor:IsAltered, SlabFloor:Area > 1 ) +
										;							SumAcrossIf( Door:IsAltered, Door:Area > 1 ) +
																	SumAcrossIf( Skylt:IsAltered, Skylt:Area > 1 ) +
																	SumAcrossIf( HVACFan:IsAltered, HVACFan:FloorAreaServed > 0.5 )  }
END
;*************************************************************************


;*************************************************************************
;*************************************************************************

ENDFILE
