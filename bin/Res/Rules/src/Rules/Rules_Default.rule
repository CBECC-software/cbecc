; -------------------------------------------------------------------------
; Rules pertaining to:   Defaulting the Proposed Building Model (excluding Constructions & HVAC)
; CEC Title-24 Residential Energy Code
; -------------------------------------------------------------------------
; Copyright (c) 2012-2014, California Energy Commission
; Copyright (c) 2012-2014, Wrightsoft Corporation
; All rights reserved.
; Redistribution and use in source and binary forms, with or without modification,
; are permitted provided that the following conditions are met:
; - Redistributions of source code must retain the above copyright notice, this
;   list of conditions and the following disclaimer.
; - Redistributions in binary form must reproduce the above copyright notice, this
;   list of conditions, the following disclaimer in the documentation and/or other
;   materials provided with the distribution.
; - Neither the name of the California Energy Commission nor the names of its
;   contributors may be used to endorse or promote products derived from this
;   software without specific prior written permission.
; DISCLAIMER: THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
; THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
; NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION,
; WRIGHTSOFT CORPORATION, ITRON, INC. OR ANY OTHER AUTHOR OR COPYRIGHT HOLDER OF
; THIS SOFTWARE (COLLECTIVELY, THE "AUTHORS") BE LIABLE FOR ANY DIRECT, INDIRECT,
; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
; OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
; LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
; OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  EACH LICENSEE AND SUBLICENSEE OF THE
; SOFTWARE AGREES NOT TO ASSERT ANY CLAIM AGAINST ANY OF THE AUTHORS RELATING TO
; THIS SOFTWARE, WHETHER DUE TO PERFORMANCE ISSUES, TITLE OR INFRINGEMENT ISSUES,
;STRICT LIABILITY OR OTHERWISE.
; -------------------------------------------------------------------------


;*************************************************************************
RULELIST "ProposedInput" 0 0 0 0
;*************************************************************************

   ;--------------------------------------------------------------------
   ; ProposedInput: Analysis and Site Rules
   ;--------------------------------------------------------------------

	"Set various Code & Program Version properties"		Proj:Action	= {	EvalRulelist( "Default_CodeVersion" )  }

   "Initialize Project Err** Code to 0"
     Proj:ErrorCode = { 0 }

	"Initialize Proj:EnableResearchMode"		Proj:EnableResearchMode	= {	if (LocalStatus( EnableResearchMode ) < 0.5) then  0  else  UNCHANGED  endif  }
	; no default of Proj:RetainRuleDefaults - Boolean (0/1) to override file save of all rule defaults as user inputs   ; SAC 2/4/16

	"Default Proj:ComplianceReportPDF"			Proj:ComplianceReportPDF	= {	0  }		; SAC 8/14/13
	"Default Proj:ComplianceReportXML"			Proj:ComplianceReportXML	= {	0  }

  ; SAC 8/29/13 - appended 'b' onto filenames, distinguishing this set (assembled in March 2012) from previous/bogus set
	"Set Proj:WeatherFileName"		Proj:WeatherFileName = {
				switch (Global( Proj:ClimateZone ))
					case   1 :	"CTZ01S13b.CSW"
					case   2 :	"CTZ02S13b.CSW"
					case   3 :	"CTZ03S13b.CSW"
					case   4 :	"CTZ04S13b.CSW"
					case   5 :	"CTZ05S13b.CSW"
					case   6 :	"CTZ06S13b.CSW"
					case   7 :	"CTZ07S13b.CSW"
					case   8 :	"CTZ08S13b.CSW"
					case   9 :	"CTZ09S13b.CSW"
					case  10 :	"CTZ10S13b.CSW"
					case  11 :	"CTZ11S13b.CSW"
					case  12 :	"CTZ12S13b.CSW"
					case  13 :	"CTZ13S13b.CSW"
					case  14 :	"CTZ14S13b.CSW"
					case  15 :	"CTZ15S13b.CSW"
					case  16 :	"CTZ16S13b.CSW"
					default :	Format( "<unknown wthr file mapping for Proj:ClimateZone = %.0f>", Global( Proj:ClimateZone ) )
				endswitch  }

	"Init Proj:DHWWthrFileName"		Proj:DHWWthrFileName	= {	UNDEFINED  }   ; not defined for CEC Title-24 analysis (DLL-based weather used)
	"Set Proj:DHWHour2to1Mult - based on weekday DHW usage profile hr2/hr1 from ACM ref manual"		Proj:DHWHour2to1Mult	= {	14/8  }		; SAC 4/17/15 - workaround for DHW DLL issue where prop & std results differ (GC 468)

	; defaulted via enumerations:  "StandardsVersion",  BEMP_Sym,  1,  0,  0, "",                 0,  0,                           1003, "determines which federal appliance efficiency requirements for cooling & heating equipment apply to this project"   
	"Set Proj:StandardsVerLabel"	Proj:StandardsVerLabel	= {
			switch (StandardsVersion)
				case 2014 :  if (StdDesignBase == 2014) then  " "  else  "valid through December 2014 (with current Federal Air Conditioning efficiency requirements)"  endif
				case 2015 :  "any time (with 2015 Federal Air Conditioning Requirements) and solar credit"
				default   :  " "  ; unrecognized
			endswitch  }

	"Set Proj:WinOvrhngGraphic"		Proj:WinOvrhngGraphic	= {	"WinOvrhng.jpg"  }
	"Set Proj:WinFinGraphic"			Proj:WinFinGraphic		= {	"WinFin.jpg"  }

	"Set Proj:RunNumber"					Proj:RunNumber				= {	0  }
	"Set Proj:RunID"						Proj:RunID					= {	"User"		}
	"Set Proj:RunIDProcFile"			Proj:RunIDProcFile		= {	" - User"	}
	"Set Proj:RunAbbrev"					Proj:RunAbbrev				= {	"u"			}

	; default to 'Compliance' - logic designed to facilitate setting/resetting this based on INI settings
	"Default Proj:SimSpeedOption"		Proj:SimSpeedOption		= {	if (LocalStatus( SimSpeedOption ) < 0.5) then  0  else  UNCHANGED  endif  }
	"Default SimSpeedOption-related properties enabling user customization"		Proj:Action	= {	EvalRulelist( "Default_SimSpeedOption" )  }

	; SAC 10/7/13 - added to INI-file enabled features
	"Default Proj:EnableRptIncFile"		Proj:EnableRptIncFile		= {	if (LocalStatus( EnableRptIncFile   ) < 0.5) then  0  else  UNCHANGED  endif  }
	"Default Proj:EnableVarFlowOAV"		Proj:EnableVarFlowOAV		= {	if (LocalStatus( EnableVarFlowOAV   ) < 0.5) then  1  else  UNCHANGED  endif  }		; SAC 8/7/14 - turn ON by default
	"Default Proj:EnableFixedFlowOAV"	Proj:EnableFixedFlowOAV		= {	if (LocalStatus( EnableFixedFlowOAV ) < 0.5) then  1  else  UNCHANGED  endif  }
	; SAC 6/2/14 - added BypassRuleLimits to properties that can be set from INI-file...
	"Default Proj:BypassRuleLimits"		Proj:BypassRuleLimits		= {	if (LocalStatus( BypassRuleLimits   ) < 0.5) then  0  else  UNCHANGED  endif  }

  ; SAC 11/3/15 - ensure DHWCalcMethod = "CSE" for all runs where BypassRuleLimits not activated
	"Hardwire Proj:DHWCalcMethod to 'CSE' if BypassRuleLimits missing or < 2"	Proj:Action		= {
											if (IfValidAnd( BypassRuleLimits > 1.1 ) .OR. IfValidAnd( DHWCalcMethod = 1 )) then  UNCHANGED
											else	EvalRulelist( "ForceDefault_DHWCalcMethod_CSE" )  endif  }

;	mjb 4/24/14	- Additions Alone params defaulted
	"Default Proj:IsAddAlone"			Proj:IsAddAlone			= {	0	}
	"Default Proj:AdditionCFAFrac"	Proj:AdditionCFAFrac		= {	1	}
	"Force resets for non-New Cons (necessary for third party analysis)"		Proj:Action	= {	if (RunScope == 1 .OR. (IsAddAlone == 0 .AND. AdditionCFAFrac == 1)) then  UNCHANGED
																															else	EvalRulelist( "ForceDefault_IsAddAlone_AddFrac" )  endif  }

  ; SAC 2/9/15 - flag documenting requirement of alterations including at least 2 categories of upgraded component(s)
	"Default Proj:AlterIncl2Categs"	Proj:AlterIncl2Categs	= {	0	}

	"Set Proj:ResultSummary[1] based on EUseSummary:ProjAssignFirst"		Proj:ResultSummary[1]	= {	if (LocalCompAssigned( ResultSummary[1] ) > 0) then  UNCHANGED
																																		else	MaxAllComp( EUseSummary:ProjAssignFirst )  endif  }		; SAC 3/3/16 - tic #609

; mjb 9/30/14 - Default HVACSysStatus for IsAddAlone = 1
	"Conditional Default Zone:HVACSysStatus"			Zone:HVACSysStatus			= {	if (Proj:IsAddAlone > 0.5) then 	3 else UNCHANGED endif	}		; HVACSysStatus set to NEW if IsAddAlone

   ;--------------------------------------------------------------------
   ; ProposedInput: Season Change Temperature & 
   ;--------------------------------------------------------------------

	"Default Proj:SeasonChangeSetpt"		Proj:SeasonChangeSetpt	= {	60  }		; SAC 4/3/14
	"Default Proj:FanVentLockoutTemp"	Proj:FanVentLockoutTemp	= {	68  }		; SAC 4/8/14	- SAC 4/23/14 - updated default from 66 -> 68 (per Bruce request)

   ;--------------------------------------------------------------------
	; SAC 3/23/15 - moved up here ABOVE DesignRating rules since this setting effects setting of AllowDesignRating
	"Default Proj:IsMultiFamily"			Proj:IsMultiFamily    	= {	0  }

; SAC 4/15/15 - added Proj:MultiFamilyType and related properties
	; Proj:MultiFamilyType - defaults to "Other" via Enums definitions
	"Blast Proj:MultiFamilyType if not set to 'Other' - pending final implementation plans/design"		; SAC 4/28/15 - disable initial duplex/townhome options (issue 508/365)
			Proj:Action		= {	if (MultiFamilyType != 3) then  EvalRulelist( "ForceReset_MultiFamilyType" )  else  UNCHANGED  endif  }

	"Set Proj:IsMFamDuplex"			Proj:IsMFamDuplex			= {	if (IsMultiFamily > 0.5 .AND.  MultiFamilyType == 1) then  1  else  0  endif  }
	"Set Proj:IsMFamTownhm"			Proj:IsMFamTownhm			= {	if (IsMultiFamily > 0.5 .AND.  MultiFamilyType == 2) then  1  else  0  endif  }  
	"Set Proj:IsMFamDupOrTownhm"	Proj:IsMFamDupOrTownhm	= {	if (IsMultiFamily > 0.5 .AND. (MultiFamilyType == 1 .OR. MultiFamilyType == 2)) then  1  else  0  endif  }  

	"Set Proj:BuildingTypeRpt"		Proj:BuildingTypeRpt		= {	if (IsMultiFamily < 0.5) then  "Single Family"
																					else	switch (MultiFamilyType)
																								case  1 :	"Duplex (multifamily)"
																								case  2 :	"Townhomes (multifamily)"
																								case  3 :	"Multifamily"
																								default :	UNDEFINED
																							endswitch  endif  }

   ;--------------------------------------------------------------------
   ; ProposedInput: Default for Standard Design Code Baseline
	; mjb 1/12/15 - needed for Design Rating calcs
   ;--------------------------------------------------------------------
; SAC 3/23/15 - removed default here, since we set 2013/2016 default via separate 2013/2016 Enum definitions
;	"Default Proj:StdDesignBase"			Proj:StdDesignBase		= {	2013  }		; ensures proper defaulting for ruleset-specific standard design

; SAC 11/17/15 - add rule to default Proj:StandardsVersion only in the case it is undefined, which can happen following a ruleset switch due to reset of Proj:StdDesignBase
	"Default Proj:StandardsVersion"		Proj:StandardsVersion	= {	if (LocalStatus( StandardsVersion ) < 1 .AND. LocalStatus( StdDesignBase ) > 0)
																							then	switch (StdDesignBase)
																										case  2013 :  2015		; T-24 2013
																										case  2016 :  2017		; T-24 2016
																										case  2008 :  2010		; T-24 2008
																										case  2006 :  2007		; IECC 2006
																										default :  UNCHANGED		; error
																									endswitch
																							else	UNCHANGED  endif  }

   ; SAC 3/23/15 - prevent design rating calcs for multi-family, additions/alterations or addition alone runs
	"Set Proj:CompCodeBase - keeps track of the initial StdDesignBase - not changed to design rating base during analysis"
			Proj:CompCodeBase	= {	if (RunNumber < 1) then  StdDesignBase  else  UNCHANGED  endif  }

	; SAC 4/13/16 - IntGainsMethod used to differentiate between 2013 & 2016 CA-24 internal gains
	"Set Proj:IntGainsMethod"	Proj:IntGainsMethod	= {	if (StdDesignBase < 2016 .OR. DRtgRefRunID == 2014) then  2013
																			else	2016  endif  }

;"store BEMProc details"		Proj:Action = {  StoreBEMProc( "PropInput", 0 )  }
;"debugging" Proj:Action = { MessageBox( "checking before setting Proj:AllowDesignRating:\n   IsMultiFamily = %g\n   RunScope = %g\n   IsAddAlone = %g\n   CompCodeBase = %g\n   BypassRuleLimits = %g", IsMultiFamily, RunScope, IsAddAlone, ValidOr( CompCodeBase, -1 ), ValidOr( BypassRuleLimits, -1 ) ) }
	"Set Proj:AllowDesignRating"			Proj:AllowDesignRating	= {	if (RunScope == 1 .AND. IsAddAlone < 0.5 .AND. IfValidAnd( CompCodeBase > 2015 ))
																							then  1  else  0  endif  }
	"Default Proj:DesignRatingCalcs"		Proj:DesignRatingCalcs	= {	0  }
	"Blast Proj:DesignRatingCalcs if not allowed"	Proj:Action	= {	if (AllowDesignRating < 0.5 .AND. DesignRatingCalcs > 0.5) then  EvalRulelist( "ForceDefault_DesignRatingCalcs" )  else  UNCHANGED  endif  }
	"Default Proj:DesignRatingBase"		Proj:DesignRatingBase	= {	2014  }		; default design rating base is 'IECC2006' / SAC 3/8/16 - updated default to 'RESNET2014'
	"Cal subordinate rulelsit to override Proj:DesignRatingBase when appropriate"		; SAC 3/21/16
				Proj:Action		= {	if (AllowDesignRating > 0.5 .AND. DesignRatingCalcs > 0.5 .AND. DesignRatingBase != 2014 .AND. IfValidAnd( BypassRuleLimits >= 3 )==0)
											then	EvalRulelist( "ForceDefault_DesignRatingBase_RESNET2014" )
											else	UNCHANGED  endif  }
	"Set Proj:DRtgResultsMsg"				Proj:DRtgResultsMsg		= {	     if (AllowDesignRating < 0.5) then  "Design Rating calcs currently available only for single family new construction analysis."
																							else if (DesignRatingCalcs < 0.5) then  "Design Rating calcs must be toggled on in Analysis tab of Project data to view results here."
																							else  UNDEFINED  endif endif  }
	"Set Proj:DRtgRefRunID"					Proj:DRtgRefRunID			= {	if (AllowDesignRating > 0.5 .AND. RunAbbrev == "dr") then  DesignRatingBase  else  0  endif  }		; SAC 3/9/16 - added to facilitate RESNET2014 rules

	"Default Proj:DRtgLtgCredit"			Proj:DRtgLtgCredit		= {	0  }
	"Default Proj:DRtgLtgReduction"		Proj:DRtgLtgReduction	= {	0  }
	"Blast Proj:DRtgLtg* if not allowed"	Proj:Action	= {	if ((AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( BypassRuleLimits >= 3 )==0) .AND.
																					 (DRtgLtgCredit > 0.5 .OR. DRtgLtgReduction > 0))			then  EvalRulelist( "ForceDefault_DRtgLighting" )
																				else if (DRtgLtgCredit < 0.5 .AND. DRtgLtgReduction > 0)		then  EvalRulelist( "ForceDefault_DRtgLightingReduction" )
																				else  UNCHANGED  endif endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: Building Rules
   ;--------------------------------------------------------------------

;   "Default Proj:BuildingType"			Proj:BuildingType    	= {	xx  }
	"Default Proj:ZonalControl"			Proj:ZonalControl    	= {	0  }
;   "Default Proj:Description"			Proj:Description     	= {	xx  }

	"Set Proj:ZoneLabel"				Proj:ZoneLabel			= {	if (ZonalControl > 0.5) then  "Living Zone & Area / Unit:"  else  "            Zone & Area / Unit:"  endif  }
;	"Set Proj:ZoneLabel"				Proj:ZoneLabel			= {	if (ZonalControl > 0.5) then  "Living Zone:"  else  "         Zone:"  endif  }
;	"Set Proj:FloorAreaLabel"		Proj:FloorAreaLabel	= {	if (ZonalControl > 0.5) then  "Living Area:"  else  "   Floor Area:"  endif  }

; SAC 1/7/13 - moved ACH50 defaulting down BELOW system duct rules, so that presence of ducts in unconditioned space is known
;   "Default Proj:ACH50"						Proj:ACH50           	= {	7.6  }

;   "Default Proj:InsulConsQuality"		Proj:InsulConsQuality	= {	xx  }  - defaulted via symbol definitions
   "Default Proj:NumBedrooms"				Proj:NumBedrooms     	= {	1  }   ; SAC 5/1/13 - added default since should require input for multifamily buildings
	"Default Proj:NumAddBedrooms"			Proj:NumAddBedrooms		= {	0  }	; SAC 12/28/15 - added
	"Set Proj:NumBedrmsLabel"				Proj:NumBedrmsLabel		= {	if (RunScope == 1 .AND. IsAddAlone > 0.5)
																							then	"Num of Existing Bedrooms:"
																							else	"Number of Bedrooms:"  endif  }
	"Set Proj:SimNumBedrooms"				Proj:SimNumBedrooms		= {	if (RunScope == 1 .AND. IsAddAlone > 0.5)
																							then	NumAddBedrooms
																							else	NumBedrooms  endif  }

; SAC 5/21/13 - moved down & revised to include sum of all MFam units...
;   "Default Proj:NumDwellingUnits"		Proj:NumDwellingUnits	= {	1  }
   "Default Proj:AllOrientations"		Proj:AllOrientations 	= {	0  }
   ; SAC 12/8/15 - tic 512 ensure wall orientations are reported as 0/90/180/270 for all orientation runs
   "Froce default of Proj:FrontOrientation"	Proj:Action			= {	if (AllOrientations > 0.5 .AND. IfValidAnd( FrontOrientation != 0 ) .AND. IfValidAnd( RunNumber > 0 )==0)
   																						then	EvalRulelist( "ForceDefault_FrontOrientation" )
   																						else  UNCHANGED  endif  }
   "Default Proj:FrontOrientation"		Proj:FrontOrientation	= {	0  }
	"Default Proj:NatGasAvailable"		Proj:NatGasAvailable		= {	1  }
; SAC 11/9/15 - added Proj:GasType - allow to default via enumerations
	"Default Proj:GasType"					Proj:GasType				= {	if (NatGasAvailable > 0.5) then  1  else  2  endif  }		; force default - relying exclusively on enumeration defaulting not working here

	"Set Proj:FuelTDVLabel"					Proj:FuelTDVLabel			= {	if (StandardsVersion > 2016)		; SAC 11/9/15
																							then	if (GasType == 1) then  "Natural Gas"  else  "Other"  endif
																							else if (NatGasAvailable > 0.5) then  "Natural Gas"  else  "Other"  endif endif  }
	; SAC 11/9/15 - moved setting of Proj:Fuel_Have* flags from CSE_Sim rulelsit to here and elsewhere (to support 2016 analysis)
	"Set flag - Proj:Fuel_HaveElec"		Proj:Fuel_HaveElec		= {	1 }
	"Set flag - Proj:Fuel_HaveNatGas"	Proj:Fuel_HaveNatGas		= {	if (StandardsVersion > 2016)		; SAC 11/9/15
																							then	if (GasType == 1) then  1  else  0  endif
																							else if (Proj:NatGasAvailable > 0.5) then  1  else  0  endif endif  }
	"Set flag - Proj:Fuel_HaveOther"		Proj:Fuel_HaveOther		= {	if (Fuel_HaveNatGas > 0.5) then  0  else  1  endif  }

   "Default Proj:HasGarage"				Proj:HasGarage				= {	0  }			; default to no attached garage" 
; SAC 9/9/12 - removed properties that are duplicated in the Attic object
;   "Default Proj:AtticVentFrac"			Proj:AtticVentFrac		= {	1/300  }		; ratio of free area of attic vents to attic floor area
;   "Default Proj:AtticVentFracHi"		Proj:AtticVentFracHi		= {	0.3  }		; fraction of the attic vent area located in the upper part of the attic
   "Default Proj:InsulRValPerInch[1] - blown"	Proj:InsulRValPerInch[1]	= {	2.6  }		; insulation R-value per inch, used to calculate blown ceiling insulation thickness within & above joists" 
   "Default Proj:InsulRValPerInch[2] - roof"		Proj:InsulRValPerInch[2]	= {	3.714  }		; insulation R-value per inch, used to calculate roof insulation thickness within & below joists" 

	; ICQEnclCavInsMult factors based on CavityIns2.xlsx from BW 7/16/12
	; SAC 1/13/13 - switched Improved multiplier from 0.9 to 1.0
	"Set Proj:ICQEnclCavInsMult"			Proj:ICQEnclCavInsMult	= {	switch (Local( InsulConsQuality ))		; Mulitplier used to adjust conduction of cavity insulation layer
																								case 2 :  1.0		; Improved
																								default:  0.7		; Standard (or other)
																							endswitch  }
   "Default Proj:ApplRefrigEffMethod[1]"		Proj:ApplRefrigEffMethod[1] 	= {	1  }
   "Default Proj:ApplDishUsageMethod[1]"		Proj:ApplDishUsageMethod[1] 	= {	1  }

	"Set Proj:Ltg_FracPort"		Proj:Ltg_FracPort		= {	if (Proj:DRtgRefRunID == 2014) then  1.0		; SAC 3/10/16 - RESNET
																			else  0.22  endif   }
	"Set Proj:Ltg_PwrAdjMult"	Proj:Ltg_PwrAdjMult	= {	0.625  }


   ;--------------------------------------------------------------------
   ; ProposedInput: CAHP Section within existing proposed input rulelist
   ;--------------------------------------------------------------------
	; "Default Proj:IsCAHPProj"        	Proj:IsCAHPProj			= {	0  }
	"CAHP program backward compatibility"		Proj:Action			= {	if (IfValidAnd( IsCAHPProj > 0.5 )) then  EvalRulelist( "BackwardCompat_IsCAHPProj" )
																							else  UNCHANGED  endif  }
			;	Proj:CAHPProgram, 0		- allow to default via symbol definitions
			;	             0,    "- none -"
			;	             1,    "California Advanced Homes Program Single Family (CAHP)"
			;	             2,    "California Advanced Homes Program MultiFamily (CAHP-MF)"
			;	             3,    "PG&E California MultiFamily New Homes (PG&E CMFNH)"

	"Default Proj:IsCAHPElecUtil"    	Proj:IsCAHPElecUtil		= {	1  }
	"Default Proj:IsCAHPNGasUtil"    	Proj:IsCAHPNGasUtil		= {	1  }
	"Default Proj:IsCAHPDOEChalHome" 	Proj:IsCAHPDOEChalHome	= {	0  }
	"Default Proj:IsCAHPFutureCode"  	Proj:IsCAHPFutureCode	= {	0  }
	"Default Proj:IsCAHPHELtg"       	Proj:IsCAHPHELtg			= {	0  }

	"Set Proj:CAHPMessage"		Proj:CAHPMessage		= {	if (DesignRatingCalcs > 0.5)
																			then  "To access CAHP inputs and results, you must first toggle off Design Rating Calcs on the Analysis tab."
																			else  " "  endif  }
	"Blast CAHPProgram if DesignRatingCalcs also specified"	Proj:Action	= {	if (DesignRatingCalcs < 0.5 .OR. CAHPProgram < 0.5) then  UNCHANGED
																										else  EvalRulelist( "ForceDefault_CAHPProgram" )  endif  }
	"Set Proj:CAHPResultsMsg"	Proj:CAHPResultsMsg	= {	switch (CAHPProgram)
																				case   1 :  "CAHP Results"
																				case  11 :  "CAHP-MF Results"
																				case  12 :  "PG&E CMFNH Results"
																				default  :  "Only populated when single or mulit-family CAHP program selected for Project"  endswitch  }
;	"Set Proj:CAHPResultsMsg"	Proj:CAHPResultsMsg	= {	if (CAHPProgram == 1 .OR. CAHPProgram ==11) then  "CAHP Results"
;																			else  "Only populated when single or mulit-family CAHP program selected for Project"  endif  }
	"Set Proj:CMFNHResultsMsg"	Proj:CMFNHResultsMsg	= {	if (CAHPProgram == 13) then  "PG&E CMFNH Results"
																			else  "Only populated when mulitfamily CMFNH program selected for Project"  endif  }
; moved down into result setting area where results are tagged as user input for storage in project file following analysis
;	"Set EUseSummary:CAHPKickDOE"			EUseSummary:CAHPKickDOE			= {	if (Proj:IsCAHPDOEChalHome < 0.5) then  0	else  3  endif  }																			
;	"Set EUseSummary:CAHPKickFutCode"	EUseSummary:CAHPKickFutCode	= {	if (Proj:IsCAHPFutureCode  < 0.5) then  0	else  5  endif  }
;	"Set EUseSummary:CAHPKickHELtg"		EUseSummary:CAHPKickHELtg		= {	if (Proj:IsCAHPHELtg       < 0.5) then  0	else  5  endif  }
	"Set Proj:CAHPIncMod"		Proj:CAHPIncMod		= {	if ( IsCAHPElecUtil < 0.5 .AND. IsCAHPNGasUtil < 0.5 ) then  0
																			else	if ( IsCAHPElecUtil > 0.5 .AND. IsCAHPNGasUtil < 0.5 ) then 0.65
																			else	if ( IsCAHPNGasUtil > 0.5 .AND. IsCAHPElecUtil < 0.5 ) then 0.35 
																			else	1 endif endif endif  }

	"Set Proj:CAHPReportID"		Proj:CAHPReportID		= {	switch (CAHPProgram)
																				case   1 :			; "California Advanced Homes Program Single Family (CAHP)"
																								if (AllOrientations < 1)	then  "CAHPSFSO"				; CAHP Single Family Single Orientation  
																																	else	"CAHPSFMO"  endif		; CAHP Single Family Multiple Orientation
																				case  11 :  		; "California Advanced Homes Program MultiFamily (CAHP-MF)"
																								if (AllOrientations < 1)	then  "CAHPMFSO"				; CAHP Multifamily Single Orientation  
																																	else	"CAHPMFMO"  endif		; CAHP Multifamily Multiple Orientation
																				case  12 :  		; "PG&E California MultiFamily New Homes (PG&E CMFNH)"
																								if (AllOrientations < 1)	then  "CMFNHSO"				; CMFNH Single Orientation  
																																	else	"CMFNHMO"  endif		; CMFNH Multiple Orientation
																				default  :  UNDEFINED  endswitch  }


   ;--------------------------------------------------------------------
   ; ProposedInput: DHW Rules
   ;--------------------------------------------------------------------

	"Default Proj:CSEDHWUseMethod"	Proj:CSEDHWUseMethod	= {	if (StandardsVersion > 2016 .OR. DRtgRefRunID == 2014)		; SAC 4/15/16 - ensure new DHWUseMethod for RESNET DRtg ref run
																					then	"New (via wsDayUse)"
																					else	"Old (via wsUse)"
																					endif  }

	; DHW use #define values - SAC 3/15/16
	"Default Proj:ShwrFLOWF"				Proj:ShwrFLOWF					= {	1.0  }
	"Default Proj:ShwrDRAINHREFF"			Proj:ShwrDRAINHREFF			= {	0    }
	"Default Proj:CwshHOTF"					Proj:CwshHOTF					= {	0.22 }
	"Default Proj:CwshUSEF"					Proj:CwshUSEF					= {	2.03 }
	"Default Proj:FaucHOTF"					Proj:FaucHOTF					= {	0.5  }
	"Default Proj:FaucFlowF"				Proj:FaucFlowF					= {	1    }
	"Default Proj:BathFLOWF"				Proj:BathFLOWF					= {	1    }
	"Default Proj:BathDRAINHREFF"			Proj:BathDRAINHREFF			= {	0    }
	"Default Proj:DwshFLOWF"				Proj:DwshFLOWF					= {	1    }
	"Default Proj:CSE_DHWUseIncFile"		Proj:CSE_DHWUseIncFile		= {	if (CSEDHWUseMethod == 1) then  UNDEFINED
																								else if (IsMultiFamily < 0.5) then  "DHWDUSF.txt" else  "DHWDUMF.txt"
																								endif endif  }
	"Default Proj:CSE_DHWUseIncFileHashID"	Proj:CSE_DHWUseIncFileHashID	= {	if (CSEDHWUseMethod == 1) then  UNDEFINED
																										else if (IsMultiFamily < 0.5) then  17 else  18
																										endif endif  }

	"Switch from 2013 to 2016 heat pump if not in research mode"	; SAC 6/2/16 - tic #660
			DHWHeater:Action	= {	if (Proj:CompCodeBase < 2016) then  UNCHANGED
											else if (HeaterElementType == 3 .AND. IfValidAnd( Proj:EnableResearchMode > 0 )==0)
											then	EvalRulelist( "ForceDefault_DHWHeater_ASHPType", 1 )
											else if (HeaterElementType == 5)		; = 'Heat Pump (2016)' from 2016 models or perhaps 'Heat Pump' from older 2013/16 or current models
											then	if (LocalStatus( HPWH_NEEARated ) > 0) then  UNCHANGED  ; no need for backward compat if HPWH_NEEARated already set
													else if (ASHPType == 1) then  EvalRulelist( "ForceDefault_DHWHeater_ASHPType", 1 )	; switch from 'Generic' to non-NEEA rated
													else if ((ASHPType >= 11 .AND. ASHPType <= 15) .OR. ASHPType == 19 .OR. 
																(ASHPType >= 16 .AND. ASHPType <= 17 .AND. IfValidAnd( Proj:EnableResearchMode > 0 )) .OR.
																(ASHPType >= 21 .AND. ASHPType <= 23)) then  EvalRulelist( "BackwardCompat_DHWHeater_ASHPType", 1 )
													else if (LocalStatus( ASHPType ) < 7 .AND. LocalStatus( EnergyFactor ) == 7)	; ASHPType not user-defined but EnergyFactor IS
													then	EvalRulelist( "ForceDefault_DHWHeater_ASHPType", 1 )
													else	UNCHANGED  endif endif endif endif
											else	UNCHANGED  endif endif endif  }

	"Default DHWHeater:HeaterElementType"		DHWHeater:HeaterElementType	= {	if (Proj:NatGasAvailable == 0)
																									then  0   ; Electric Resistance		- SAC 7/9/13 - updated default per MJB request
																									else	1   ; Natural Gas     - SAC 5/17/13 - Oil no longer grouped w/ NatGas here		; SAC 11/9/15 - now simply 'Gas'
																									endif  }

	"Default DHWHeater:HPWH_NEEARated"	DHWHeater:HPWH_NEEARated	= {	0  }	; SAC 6/1/16 - switched default to selected (tic #660)
		; default via enum definitions:    "ASHPType",           BEMP_Sym,  1,  0,  0, "",             0,  0,                        1003, "DHW ASHP (new model) type"     

	"Set DHWHeater:ShowTankLocation"			DHWHeater:ShowTankLocation	= {	if (Proj:StandardsVersion < 2017 .AND. Proj:DRtgRefRunID != 2014) then  0		; SAC 4/15/16 - added logic to allow *X CSE models in RESNET2014 dsgn rtg ref runs
																									else if ((HeaterElementType == 5 .AND. (HPWH_NEEARated < 0.5 .OR. ASHPType > 0)) .OR.
																												(HeaterElementType == 0 .AND. TankType == 6)) then  1  else  0  endif endif  }	; SAC 4/15/16 - use OLD Resistance CSE mechanism for TankTypes != SmallStor (tic #636)
	"Port DHWHeater:ASHPTankOutside -> TankOutside"		DHWHeater:Action	= {	if (LocalStatus( ASHPTankOutside ) > 6 .AND. LocalStatus( TankOutside ) < 7)		; SAC 4/14/16
																										then  EvalRulelist( "Force_ASHPTankOutside_to_TankOutside", 1 )  else  UNCHANGED  endif  }
	"Port DHWHeater:ASHPTankZone -> TankZone"				DHWHeater:Action	= {	if (LocalStatus( ASHPTankZone ) > 6 .AND. LocalStatus( TankZone ) < 7)
																										then  EvalRulelist( "Force_ASHPTankZone_to_TankZone", 1 )  else  UNCHANGED  endif  }

	"Default DHWHeater:TankOutside"		DHWHeater:TankOutside	= {	if (ShowTankLocation < 0.5) then  UNDEFINED
																							else if (ComponentCount( Garage ) < 1 .AND. ComponentCount( Zone ) < 1) then  1  else  0  endif endif  }
	"Default DHWHeater:TankZone"			DHWHeater:TankZone		= {	if (ShowTankLocation < 0.5 .OR. IfValidAnd( TankOutside > 0 )) then  UNDEFINED
																							else if (ComponentCount( Garage ) > 0) then  MaxAllComp( Garage:Area )
																							else if (GlobalCOmpAssigned( Proj:DfltMFamLaundryZn ) > 0) then  Proj:DfltMFamLaundryZn
																							else if (ComponentCount( CrawlSpace ) > 0) then  MaxAllComp( CrawlSpace:Area )
																							else if (ComponentCount( Attic ) > 0) then  MaxAllComp( Attic:FloorArea )
																							else  undefined  endif endif endif endif endif  }
	"Default DHWHeater:ASHPSplit"			DHWHeater:ASHPSplit		= {	if (HeaterElementType .NE. 5) then  UNDEFINED
																							else if (HPWH_NEEARated < 0.5) then  0
																							else	switch( ASHPType )
																										case 16 :  1		; "Sanden 40"
																										case 17 :  1		; "Sanden 80"
																										default :  0
																									endswitch  endif endif  }
	"Default DHWHeater:ASHPTSrcOutside"		DHWHeater:ASHPTSrcOutside	= {	if (HeaterElementType .NE. 5) then  UNDEFINED
																									else  1  endif  }
	"Default DHWHeater:ASHPTSrcZone"			DHWHeater:ASHPTSrcZone		= {	if (HeaterElementType .NE. 5 .OR. IfValidAnd( ASHPSplit > 0 )==0 .OR. 
																										 IfValidAnd( ASHPTSrcOutside > 0 )) then  UNDEFINED
																									else if (LocalCompAssigned( TankZone ) > 0) then  TankZone
																									else if (ComponentCount( Garage ) > 0) then  MaxAllComp( Garage:Area )
																									else if (GlobalCOmpAssigned( Proj:DfltMFamLaundryZn ) > 0) then  Proj:DfltMFamLaundryZn
																									else if (ComponentCount( CrawlSpace ) > 0) then  MaxAllComp( CrawlSpace:Area )
																									else if (ComponentCount( Attic ) > 0) then  MaxAllComp( Attic:FloorArea )
																									else  undefined  endif endif endif endif endif endif  }

; SAC 5/17/13 - Oil no longer grouped w/ NatGas here - rules updated to duplicate NatGas logic for new/separate Oil option
	"Default DHWHeater:InputRating"			DHWHeater:InputRating	= {	
															switch (HeaterElementType)
																case  0 :	 8000		; (watts)   "Electric Resistance" 
																case  1 :   			; (Btu/hr)  "Natural Gas"   
																				if (TankType == 5) then  195000		; "Small Tankless"
																				else	40000  endif							; "Small Storage"
																case  2 :   			; (Btu/hr)  "Propane"             
																				if (TankType == 5) then  195000		; "Small Tankless"
																				else	40000  endif							; "Small Storage"
																case  3 :    8000     ; (watts)   "Heat Pump"           
																case  4 :   			; (Btu/hr)  "Oil"   
																				if (TankType == 5) then  195000		; "Small Tankless"
																				else	40000  endif							; "Small Storage"
																default :	UNDEFINED
															endswitch  }
	"Set DHWHeater:InputRatingUnits"		DHWHeater:InputRatingUnits	= {
															switch (HeaterElementType)
																case  0 :	"watts"   ; "Electric Resistance" 
																case  1 :   "Btu/hr"  ; "Natural Gas"   
																case  2 :   "Btu/hr"  ; "Propane"             
																case  3 :   "watts"   ; "Heat Pump"           
																case  4 :   "Btu/hr"  ; "Oil"   
																default :	" "
															endswitch  }

   ; SAC 8/29/16 - moved TankVolume default up here, before EnergyFactor rule that may reference TankVolume (tic #725)
	"Default DHWHeater:TankVolume"		DHWHeater:TankVolume	= {
															if (HeaterElementType == 5 .AND. HPWH_NEEARated < 0.5) then  50		; SAC 5/17/16 - HP2016, Generic
															else	switch (TankType)
																		case  0 :	50			; "Boiler"        
																		case  1 :	50			; "Indirect"      
																		case  3 :	50			; "Large Storage" 
																		case  2 :	 0			; "Large Tankless"
																		case  6 :	50			; "Small Storage" 
																		case  5 :    0			; "Small Tankless"
																		case  7 :	50			; "Unfired Storage Tank"
																		case  8 :	 5 		; "Electric Mini Tank"
																		default :   50
																	endswitch  endif  }

   ; SAC 8/29/16 - updated 2016 T-24 default efficiencies for small storage & instantaneous heaters to properly reflect tank size adjustments present in federal standards (table F-3) (tic #725)
   ; SAC 8/31/16 - added logic to round efficiencies to nearest 1/1000 (tic #725)
   "Default DHWHeater:EnergyFactor"      DHWHeater:EnergyFactor   = {
      switch (HeaterElementType)
         case  0 :   switch (TankType)         ; "Electric Resistance" 
                        case  6 :   if (Proj:StandardsVersion < 2016) then  0.945      ; "Small Storage"        ; SAC 1/4/16 - .97 -> .945 (tic 547)
                                    else  if (IfValidAnd( TankVolume > 55 ))
                                          then  int( 1000 * ( 2.057 - (0.00113 * TankVolume               ) ) + 0.5 ) / 1000
                                          else  int( 1000 * ( 0.960 - (0.0003  * ValidOr( TankVolume, 50 )) ) + 0.5 ) / 1000  endif endif
                        case  5 :   if (Proj:StandardsVersion < 2016) then  0.93       ; "Small Tankless"
                                    else  int( 1000 * ( 0.93 - (0.00132 * ValidOr( TankVolume, 0 )) ) + 0.5 ) / 1000  endif
                        default :   0.93
                     endswitch
         case  1 :   switch (TankType)       ; "Natural Gas"   
                        case  6 :   if (Proj:StandardsVersion < 2015) then  0.575      ; "Small Storage" 
                                    else if (Proj:StandardsVersion < 2016) then  0.6
                                    else  if (IfValidAnd( TankVolume > 55 ))
                                          then  int( 1000 * ( 0.8012 - (0.00078 * TankVolume               ) ) + 0.5 ) / 1000
                                          else  int( 1000 * ( 0.675  - (0.0015  * ValidOr( TankVolume, 50 )) ) + 0.5 ) / 1000  endif endif endif
                        case  5 :   if (Proj:StandardsVersion < 2016) then  0.82       ; "Small Tankless"
                                    else  int( 1000 * ( 0.82 - (0.0019 * ValidOr( TankVolume, 0 )) ) + 0.5 ) / 1000  endif
                        default :   if (Proj:StandardsVersion < 2016) then  0.575  else  0.80  endif      ; SAC 11/10/15
                     endswitch
         case  2 :   switch (TankType)       ; "Propane"             
                        case  6 :   if (Proj:StandardsVersion < 2015) then  0.575      ; "Small Storage" 
                                    else if (Proj:StandardsVersion < 2016) then  0.60
                                    else  if (IfValidAnd( TankVolume > 55 ))
                                          then  int( 1000 * ( 0.8012 - (0.00078 * TankVolume               ) ) + 0.5 ) / 1000
                                          else  int( 1000 * ( 0.675  - (0.0015  * ValidOr( TankVolume, 50 )) ) + 0.5 ) / 1000  endif endif endif
                        case  5 :   if (Proj:StandardsVersion < 2016) then  0.82       ; "Small Tankless"
                                    else  int( 1000 * ( 0.82 - (0.0019 * ValidOr( TankVolume, 0 )) ) + 0.5 ) / 1000  endif
                        default :   if (Proj:StandardsVersion < 2016) then  0.575  else  0.80  endif      ; SAC 11/10/15
                     endswitch
         case  3 :   switch (TankType)       ; "Heat Pump"           
                        case  6 :   0.97               ; "Small Storage" 
                        case  5 :   0.97               ; "Small Tankless"
                        default :   0.97
                     endswitch
         case  4 :   switch (TankType)       ; "Oil"   
                        case  6 :                      ; "Small Storage" 
                                    if (Proj:StandardsVersion < 2015) then  0.575  else  0.60  endif
                        case  5 :   0.82               ; "Small Tankless"
                        default :   0.575
                     endswitch
         case  5 :   if (HPWH_NEEARated < 0.5)      ; SAC 5/17/16 - HP2016, Generic
                     then   2
                     else  0.59  endif
         default :   0.59
      endswitch  }

	"Set DHWHeater:EfficiencyUnits"		DHWHeater:EfficiencyUnits	= {
															if (HeaterElementType == 5) then  "EF"			; SAC 5/17/16 - HP2016, Generic
															else	switch (TankType)
																		case  0 :	"frac"	; "Boiler"        
																		case  1 :	" "		; "Indirect"      
																		case  3 :	"frac"	; "Large Storage" 
																		case  2 :	"EF"		; "Large Tankless"
																		case  6 :	"EF"		; "Small Storage" 
																		case  5 :   "EF"		; "Small Tankless"
																		case  7 :	" "		; "Unfired Storage Tank"
																		case  8 :	" "		; "Electric Mini Tank"
																		default :   "EF"	
																	endswitch  endif  }

	; SAC 6/27/16 - revised logic in the following rule to ensure TankVolumeRange not > 0 for HPWHs where HPWH_NEEARated is selected (tic #699)
	"Set DHWHeater:TankVolumeRange"		DHWHeater:TankVolumeRange	= {		; SAC 6/16/16 - added key to TankVolume range checks: 1=>SmallStor, 2=>LargeStor (tic #661)
															if (HeaterElementType == 5)
															then	if (HPWH_NEEARated < 0.5)
																	then  1
																	else  0  endif
															else	switch (TankType)
																		case  0 :	 0			; "Boiler"        
																		case  1 :	 0			; "Indirect"      
																		case  3 :	 2			; "Large Storage" 
																		case  2 :	 0			; "Large Tankless"
																		case  6 :	 1			; "Small Storage" 
																		case  5 :    0			; "Small Tankless"
																		case  7 :	 0			; "Unfired Storage Tank"
																		case  8 :	 0 		; "Electric Mini Tank"
																		default :    0
																	endswitch  endif  }

	"Default DHWHeater:IntInsulRVal"			DHWHeater:IntInsulRVal		= {	0  }
	"Default DHWHeater:ExtInsulRVal"			DHWHeater:ExtInsulRVal		= {	0  }

	; SAC 11/10/15 - add standby loss defaulting for large heaters based on fed appliance stds   - SAC 11/11/15 - added in elec storage losses + indirect fuel   - SAC 11/19/15 - added logic to set SBL to 0 for non-elec tanks < 10gal
	"Default DHWHeater:StandbyLossFrac"
				DHWHeater:StandbyLossFrac	= {	if (IfValidAnd( TankVolume > 0 )==0) then  UNDEFINED
															else if (HeaterElementType = 0 .OR. HeaterElementType = 3 .OR. HeaterElementType = 6)		; Electric
															then	if (TankType == 2 .OR. TankType == 0 .OR. TankType == 1)
																	then	((0.3 + (27 / TankVolume )) / 100) * (8.25 * TankVolume * 70) 		; Btuh
																	else if (TankType == 3)
																	then	 (0.3 + (27 / TankVolume )) / 100											; frac
																	else	UNDEFINED  endif endif
															else if (HeaterElementType != 0 .AND. HeaterElementType != 3 .AND. HeaterElementType != 6)	; NOT elec
															then	if (TankType == 2 .OR. TankType == 0 .OR. TankType == 1)
																	then	if (TankVolume < 10) then  0
																			else	 (ValidOr( InputRating, 0 ) / 800) + (110 * sqrt( TankVolume ))											; Btuh	
																			endif
																	else if (TankType == 3)
																	then	if (TankVolume < 10) then  0
																			else	((ValidOr( InputRating, 0 ) / 800) + (110 * sqrt( TankVolume ))) / (8.25 * TankVolume * 70)		; frac
																			endif
																	else	UNDEFINED  endif endif
															else	UNDEFINED  endif endif endif  }
; SAC 11/19/15 - removed following rule as it DUPLICATES logic already executed in the above rule
;	; adjust above StandbyLossFrac to transform from Btuh to fraction    - SAC 11/19/15 - fix bug where StandbyLossFrac is undefined
;	"Convert default DHWHeater:StandbyLossFrac to fraction"
;				DHWHeater:StandbyLossFrac	= {	if (IfValidAnd( StandbyLossFrac > 0 ) .AND. IfValidAnd( TankType == 3 ) .AND. IfValidAnd( TankVolume >= 10 ))
;															then	StandbyLossFrac / (8.25 * TankVolume * 70)
;															else	UNCHANGED  endif  }

	"Set flag (DHWHeater:CanBeCHWHeater) indicating whether or not this DHWHeater can be assigned to a combined hydronic heating system"	  ; SAC 7/8/13   
;	mjb-10/9/13	only type of water heater NOT available for combined hydronics is Heat Pump WH
;				DHWHeater:CanBeCHWHeater	= {	if (	HeaterElementType != 3   )	then  1  else  0  endif  }
; SAC 1/6/14 - mod to prevent Electric water heaters from being used in combined hydronic systems (question as to how to model standard design)
; SAC 1/6/16 - revised to enable Electric Resistance water heaters to be used in combined hydronic systms (tic 374)
; SAC 6/16/16 - revised logic to prevent NEW 'Heat Pump' selection (ASHPX) to be used in combined hydronic systems (tic #680)
				DHWHeater:CanBeCHWHeater	= {	if (	HeaterElementType != 3 .AND. HeaterElementType != 5 )	then  1  else  0  endif  }
;				DHWHeater:CanBeCHWHeater	= {	if (	HeaterElementType != 3 .AND. HeaterElementType != 0   )	then  1  else  0  endif  }
;				DHWHeater:CanBeCHWHeater	= {	if (	HeaterElementType == 1  .OR.   ; "Natural Gas"
;																	HeaterElementType == 2  .OR.   ; "Propane"    
;																	HeaterElementType == 4  )      ; "Oil"        
;															then  1  else  0  endif  }

;	mjb-10/7/13 default recovery efficiency as UNDEFINED so that it does not show up in compliance reports erroneously
;	"Default DHWHeater:RecovEff"			DHWHeater:RecovEff	= {	UNDEFINED  }
; SAC 1/6/14 - added RecovEff default back in (for non-electric water heaters) - this property not apparently reported any longer, so presence of default when heater not used in combined hydronic systems seems to no longer be a problem
	"Default DHWHeater:RecovEff"			DHWHeater:RecovEff	= {	if ( CanBeCHWHeater )	then  70  else  UNDEFINED  endif  }

	"Set DHWHeater:AllowElecMiniTank flag"		DHWHeater:AllowElecMiniTank	= {	if (TankType == 2 .OR. TankType == 5) then  1  else  0  endif  }
	"Default DHWHeater:HasElecMiniTank"			DHWHeater:HasElecMiniTank		= {	0  }
	"Default DHWHeater:ElecMiniTankPower"		DHWHeater:ElecMiniTankPower	= {	if (AllowElecMiniTank > 0 .AND. HasElecMiniTank > 0) then  100  else  0  endif  }

	"Set DHWHeater:HPWHEFRange"			DHWHeater:HPWHEFRange			= {	if (HeaterElementType == 5 .AND. HPWH_NEEARated < 0.5) then  1  else  0  endif  }	; SAC 6/15/16 - tic #679
	"Set DHWHeater:ShowEnergyFactor"		DHWHeater:ShowEnergyFactor		= {	if (HeaterElementType == 5 .AND. HPWH_NEEARated < 0.5) then  1		; SAC 5/17/16 - HP2016, Generic
																									else if (HeaterElementType != 5 .AND.
																												(TankType == 4 .OR. TankType == 5 .OR. TankType == 6)) then  1  else  0  endif endif  }

  ; SAC 5/21/13 - added a few basic DHWSys UI & defaulting rules
	"Set DHWSys:NumDHWHeaters"		DHWSys:NumDHWHeaters	= {	     if (LocalCompAssigned( DHWHeater[6] )) then  6
																				else if (LocalCompAssigned( DHWHeater[5] )) then  5
																				else if (LocalCompAssigned( DHWHeater[4] )) then  4
																				else if (LocalCompAssigned( DHWHeater[3] )) then  3
																				else if (LocalCompAssigned( DHWHeater[2] )) then  2
																				else if (LocalCompAssigned( DHWHeater[1] )) then  1  else  0  endif endif endif endif endif endif  }

	"Default DHWSys:HeaterMult[1]"		DHWSys:HeaterMult[1]		= {	if (LocalCompAssigned( DHWHeater[1] )) then  1  else  UNDEFINED  endif  }
	"Default DHWSys:HeaterMult[2]"		DHWSys:HeaterMult[2]		= {	if (LocalCompAssigned( DHWHeater[2] )) then  1  else  UNDEFINED  endif  }
	"Default DHWSys:HeaterMult[3]"		DHWSys:HeaterMult[3]		= {	if (LocalCompAssigned( DHWHeater[3] )) then  1  else  UNDEFINED  endif  }
	"Default DHWSys:HeaterMult[4]"		DHWSys:HeaterMult[4]		= {	if (LocalCompAssigned( DHWHeater[4] )) then  1  else  UNDEFINED  endif  }
	"Default DHWSys:HeaterMult[5]"		DHWSys:HeaterMult[5]		= {	if (LocalCompAssigned( DHWHeater[5] )) then  1  else  UNDEFINED  endif  }
	"Default DHWSys:HeaterMult[6]"		DHWSys:HeaterMult[6]		= {	if (LocalCompAssigned( DHWHeater[6] )) then  1  else  UNDEFINED  endif  }

	"Set DHWSys:FirstDHWHtrIndex"			DHWSys:FirstDHWHtrIndex	= {	     if (LocalCompAssigned( DHWHeater[1] ) .AND. IfValidAnd( HeaterMult[1] > 0.5 )) then  1
																							else if (LocalCompAssigned( DHWHeater[2] ) .AND. IfValidAnd( HeaterMult[2] > 0.5 )) then  2
																							else if (LocalCompAssigned( DHWHeater[3] ) .AND. IfValidAnd( HeaterMult[3] > 0.5 )) then  3
																							else if (LocalCompAssigned( DHWHeater[4] ) .AND. IfValidAnd( HeaterMult[4] > 0.5 )) then  4
																							else if (LocalCompAssigned( DHWHeater[5] ) .AND. IfValidAnd( HeaterMult[5] > 0.5 )) then  5
																							else if (LocalCompAssigned( DHWHeater[6] ) .AND. IfValidAnd( HeaterMult[6] > 0.5 )) then  6
																							else	0  endif endif endif endif endif endif  }

  ; SAC 8/6/13 - rules to set DHWSys:SolFracAnnRpt property
	"Set DHWSys:SolFracAnnRpt"		DHWSys:SolFracAnnRpt		= {	switch (SolFracType)
																						case  1 :	if (LocalStatus( SolFracAnn ) > 1) then  SolFracAnn  else  UNDEFINED  endif
																						case  2 :	if (	LocalStatus( SolFracMon[1]  ) > 1 .AND. LocalStatus( SolFracMon[2]  ) > 1 .AND. LocalStatus( SolFracMon[3]  ) > 1 .AND. 
																												LocalStatus( SolFracMon[4]  ) > 1 .AND. LocalStatus( SolFracMon[5]  ) > 1 .AND. LocalStatus( SolFracMon[6]  ) > 1 .AND. 
																												LocalStatus( SolFracMon[7]  ) > 1 .AND. LocalStatus( SolFracMon[8]  ) > 1 .AND. LocalStatus( SolFracMon[9]  ) > 1 .AND. 
																												LocalStatus( SolFracMon[10] ) > 1 .AND. LocalStatus( SolFracMon[11] ) > 1 .AND. LocalStatus( SolFracMon[12] ) > 1 )
																										then  ( (SolFracMon[1]  * 31) + (SolFracMon[2]  * 28) + (SolFracMon[3]  * 31) + (SolFracMon[4]  * 30) +
																												  (SolFracMon[5]  * 31) + (SolFracMon[6]  * 30) + (SolFracMon[7]  * 31) + (SolFracMon[8]  * 31) + 
																												  (SolFracMon[9]  * 30) + (SolFracMon[10] * 31) + (SolFracMon[11] * 30) + (SolFracMon[12] * 31) ) / 365
																										else  UNDEFINED  endif
																						default :	UNDEFINED
																					endswitch  }

; SAC 6/28/16 - new rule and subordinate rulelist to blast inputs to various recirculation loop inputs that are inconsistent w/ Proj:DHWCalcMethod of "CSE*"
	"Blast T24DHW recirc loop settings"		DHWSys:Action	= {
			if (Proj:DHWCalcMethod < 1) then  UNCHANGED
			else if (LocalStatus( UseDefaultLoops  ) > 5 .OR. LocalStatus( RecircXtraIns    ) > 5 .OR.
						LocalStatus( RecircPipeLen[1] ) > 5 .OR. LocalStatus( RecircPipeDia[1] ) > 5 .OR.
						LocalStatus( RecircPipeLen[2] ) > 5 .OR. LocalStatus( RecircPipeDia[2] ) > 5 .OR. LocalStatus( RecircPipeLoc[2] ) > 5 .OR. 
						LocalStatus( RecircPipeLen[3] ) > 5 .OR. LocalStatus( RecircPipeDia[3] ) > 5 .OR. LocalStatus( RecircPipeLoc[3] ) > 5 .OR. 
						LocalStatus( RecircPipeLen[4] ) > 5 .OR. LocalStatus( RecircPipeDia[4] ) > 5 .OR. LocalStatus( RecircPipeLoc[4] ) > 5 .OR. 
						LocalStatus( RecircPipeLen[5] ) > 5 .OR. LocalStatus( RecircPipeDia[5] ) > 5 .OR. LocalStatus( RecircPipeLoc[5] ) > 5 .OR. 
						LocalStatus( RecircPipeLen[6] ) > 5 .OR. LocalStatus( RecircPipeDia[6] ) > 5 .OR. LocalStatus( RecircPipeLoc[6] ) > 5 )
			then	EvalRulelist( "BlastInputs_CSEDHW_RecircLoops", 1 )
			else	UNCHANGED  endif endif  }

; MJB 8/12/13 - assign default for proper UI screen display
; SAC 6/28/16 - revise default of DHWSys:UseDefaultLoops to '1' for CSE DHWCalcMethod
	"Default DHWSys:UseDefaultLoops"		DHWSys:UseDefaultLoops	= {  if (Proj:DHWCalcMethod < 1) then  0  else  1  endif  }
	"Default DHWSys:NRecircLoops"			DHWSys:NRecircLoops	= {  1  }

	"Default DHWSys:CentralDHW"			DHWSys:CentralDHW		= {	0  }   ; SAC 12/23/13 - revised default which was previously:  Proj:IsMultiFamily  }	; SAC 12/10/13

	; SAC 10/8/15 - added defaults per BAW request
	"Default DHWSys:RecircPumpHP"			DHWSys:RecircPumpHP	= {	if (CentralDHW < 0.5 .OR. MFamDistType < 1) then  UNDEFINED
																						else	0.5  endif  }
	"Default DHWSys:RecircPumpEff"		DHWSys:RecircPumpEff	= {	if (CentralDHW < 0.5 .OR. MFamDistType < 1) then  UNDEFINED
																						else	0.6  endif  }		; 0.6 default based on MFam prototype input

   ;--------------------------------------------------------------------
   ; ProposedInput: CrawlSpace Rules
   ;--------------------------------------------------------------------

  ; SAC 2/10/13 - added rule to CREATE CrawlSpace object if one or more ExteriorFloors is specified as being above crawlspace (and if not CrawlSpaces exist thus far)
   "Create CrawlSpace if one needed and not already present"	Proj:Action		= {	if (ComponentCount( CrawlSpace ) > 0.5) then  UNCHANGED
;																												else if (SumAll( ExteriorFloor:AreaAboveCrawl ) < 0.5) then  UNCHANGED
																												else if (SumAll( FloorOverCrawl:Area ) < 0.5) then  UNCHANGED
																												else  EvalRulelist( "Create_CrawlSpace" )  endif endif  }

;	"Default CrawlSpace:Type"	

;	"Set CrawlSpace:Area"						CrawlSpace:Area				= {	SumAll( ExteriorFloor:AreaAboveCrawl )  }
	"Set CrawlSpace:Area"						CrawlSpace:Area				= {	SumAll( FloorOverCrawl:Area )  }

	"Default CrawlSpace:Perimeter"			CrawlSpace:Perimeter			= {	if (Area > 0) then  sqrt( Area ) * 4
																									else  0  endif  }
	"Default CrawlSpace:AvgWallHeight"		CrawlSpace:AvgWallHeight	= {	2  }

	"Set CrawlSpace:TreeDescrip"				CrawlSpace:TreeDescrip		= {	if (Area > 0.1)
																									then  Format( "%s SqFt", FltToStr( Local( Area ) ) )
																									else  "activate by creating a 'Floor Over Crawl Space' surface"  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: CeilingBelowAttic Rules
   ;--------------------------------------------------------------------
  ; SAC 5/22/14 - moved up above first references of CeilingBelowAttic properties in attic-related rules
    ;       CeilingBelowAttic:Area,              BEMP_Flt,  1, "ft2",              0, "",         0, "",             6010, "Ceiling area" 
    ;       CeilingBelowAttic:Construction,      BEMP_Obj,  1, "",                 0, "Cons",     3, "CanAssignTo",  6012, "Construction assembly" 
	"Default CeilingBelowAttic:WasCathCeil"		CeilingBelowAttic:WasCathCeil		= {	0  }		; mjb	2/20/14 needed later for Budget Conversion

	"Set CeilingBelowAttic:AreaOverCond"			CeilingBelowAttic:AreaOverCond	= {	if (ParentComponentType() == "Zone")
																													then	if (IfValidAnd( Zone:Type < 10 )) then  Area  else  0  endif
																													else	0  endif  }

	;EM 2/11/15
	"Set CeilingBelowAttic:AreaOverNewZone"			CeilingBelowAttic:AreaOverNewZone	= {	if (ParentComponentType() == "Zone")
																													then	if (Zone:Status == 3) then  Area  else  0  endif
																													else	0  endif  }

   "Create Attic if one needed but not already present (or assign existing Attic if only one present)"
   					CeilingBelowAttic:AtticZone	= {	if (LocalCompAssigned( AtticZone ) > 0.5) then  UNCHANGED
																		else if (ComponentCount( Attic ) < 0.5) then  CreateComp( Attic, "Attic" )
   																	else if (IfValidAnd( Area > 0.1 )==0) then  UNDEFINED
																		else  CompName( ComponentType( "Attic" ), 1 )		; assign FIRST Attic object
																		endif endif endif  }

  ; SAC 10/15/14 - added in the course of moving attic edge properties from Cons to CeilingBelowAttic (for multiple attics)
	"Set CeilingBelowAttic:AtcEdg_ClgCons"		CeilingBelowAttic:AtcEdg_ClgCons	= {	if (LocalCompAssigned( Construction ) > 0.5) then  Construction  else  UNDEFINED  endif  }
	"Set CeilingBelowAttic:AtcEdg_AtcCons"		CeilingBelowAttic:AtcEdg_AtcCons	= {	if (LocalCompAssigned( AtticZone ) > 0.5)
																												then  if (LocalCompAssigned( AtticZone:Construction ) > 0.5) then  AtticZone:Construction  else  UNDEFINED  endif
																												else  UNDEFINED  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: Surface Area Rules - mjb	8/21/14	needed for proper reporting of special features in conditioned zones only
   ;--------------------------------------------------------------------
	"Set ExtWall:ZoneArea"					ExtWall:ZoneArea				= {	if (ParentComponentType() == "Zone")
																								then	if (IfValidAnd( Zone:Type < 10 )) then  Area  else  0  endif
																								else	0  endif  }
	"Set UndWall:ZoneArea"					UndWall:ZoneArea				= {	if (ParentComponentType() == "Zone")
																								then	if (IfValidAnd( Zone:Type < 10 )) then  Area  else  0  endif
																								else	0  endif  }
	"Set ExteriorFloor:ZoneArea"			ExteriorFloor:ZoneArea		= {	if (ParentComponentType() == "Zone")
																								then	if (IfValidAnd( Zone:Type < 10 )) then  Area  else  0  endif
																								else	0  endif  }
	"Set InteriorFloor:ZoneArea"			InteriorFloor:ZoneArea		= {	if (ParentComponentType() == "Zone")
																								then	if (IfValidAnd( Zone:Type < 10 )) then  Area  else  0  endif
																								else	0  endif  }
	"Set FloorOverCrawl:ZoneArea"			FloorOverCrawl:ZoneArea		= {	if (ParentComponentType() == "Zone")
																								then	if (IfValidAnd( Zone:Type < 10 )) then  Area  else  0  endif
																								else	0  endif  }
	"Set CathedralCeiling:ZoneArea"		CathedralCeiling:ZoneArea	= {	if (ParentComponentType() == "Zone")
																								then	if (IfValidAnd( Zone:Type < 10 )) then  Area  else  0  endif
																								else	0  endif  }
	"Set CeilingBelowAttic:ZoneArea"		CeilingBelowAttic:ZoneArea	= {	if (ParentComponentType() == "Zone")
																								then	if (IfValidAnd( Zone:Type < 10 )) then  Area  else  0  endif
																								else	0  endif  }
	"Set InteriorCeiling:ZoneArea"		InteriorCeiling:ZoneArea	= {	if (ParentComponentType() == "Zone")
																								then	if (IfValidAnd( Zone:Type < 10 )) then  Area  else  0  endif
																								else	0  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: DwellUnitType (non-HVAC) Rules
   ;--------------------------------------------------------------------

	; DwellUnitType:CondFlrArea,      Compulsory, 

	"Default DwellUnitType:NumBedrooms"			DwellUnitType:NumBedrooms		= {	1  }  ; if (EZType == 3) then  0  else  1  endif  }

	"Default DwellUnitType:HaveRefrig"			DwellUnitType:HaveRefrig		= {	1  }  ; if (EZType != 3) then  1  else  0  endif  }
	; "Default DwellUnitType:RefrigEffMethod"	DwellUnitType:RefrigEffMethod	= {				-- defaulted via BEMEnums
	; SAC 4/15/16 - added logic to ensure that user-defined RefrigElecUsage is not retained when RefrigEffMethod is not set to '- specify -'
	"Blast user-input RefrigElecUsage if needed"		DwellUnitType:Action		= {	if (LocalStatus( RefrigElecUsage ) < 7 .OR. RefrigEffMethod == 2) then  UNCHANGED
																											else	EvalRulelist( "ForceDefault_DUT_RefrigElecUsage", 1 )  endif  }
; modified to match RESNET - mjb 11/09/15 // SAC 3/10/16 - revised to use # bedrooms for DwellUnitType
	; SAC 4/14/16 - added T24-2016 default
	"Default DwellUnitType:RefrigElecUsage"	DwellUnitType:RefrigElecUsage	= {	if (Proj:DRtgRefRunID == 2014) then  637 + 18 * NumBedrooms
																											else if (Proj:IntGainsMethod <= 2013) then  669
																											else	454 + (37 * NumBedrooms)  endif endif  }      ;  if (Local(ApplRefrigEffMethod[1]) == 1) then  669.  else UNCHANGED endif }

	"Default DwellUnitType:HaveDish"				DwellUnitType:HaveDish			= {	1  }  ; if (EZType != 3) then  1  else  0  endif  }
	; "Default DwellUnitType:DishUsageMethod"	DwellUnitType:DishUsageMethod	= {				-- defaulted via BEMEnums
	; SAC 4/15/16 - added logic to ensure that user-defined DishElecUsage is not retained when DishUsageMethod is not set to '- specify -'
	"Blast user-input DishElecUsage if needed"		DwellUnitType:Action		= {	if (LocalStatus( DishElecUsage ) < 7 .OR. DishUsageMethod == 2) then  UNCHANGED
																											else	EvalRulelist( "ForceDefault_DUT_DishElecUsage", 1 )  endif  }
; RESNET = 78 + 31*NumBedrooms
;  case 0: 78		case 1: 109		case 2: 140		case 3: 171		case 4: 202
;	case 5: 233		case 6: 264		case 7: 295		case 8: 326		case 9: 357
	; SAC 4/14/16 - revised for T24-2016 gains
	"Default DwellUnitType:DishElecUsage"		DwellUnitType:DishElecUsage	= {	; if (HaveDish > 0 .AND. DishUsageMethod == 1)		- include this defaulting even when DishUsageMethod != 1
																											if (HaveDish > 0)
																											then	if (Proj:DRtgRefRunID == 2014)
																													then	switch (NumBedrooms)
					                                                                                 case 0: 78		case 1: 109		case 2: 140		case 3: 171		case 4: 202
               					                                                               	case 5: 233		case 6: 264		case 7: 295		case 8: 326		case 9: 357
																																default: 109	endswitch
																													else if (Proj:IntGainsMethod <= 2013)
																													then	switch (NumBedrooms)
																																case 0: 90		case 1: 90		case 2: 126		case 3: 126		case 4: 126
																																case 5: 145		case 6: 145		case 7: 174		case 8: 174		case 9: 174
																																default: 203	endswitch
																													else	0.14507
																													endif endif
																											else  0  endif  }

	"Default DwellUnitType:HaveWasher"			DwellUnitType:HaveWasher		= {	1  }  ; if (EZType != 3) then  1  else  0  endif  }
	"Default DwellUnitType:HaveDryer"			DwellUnitType:HaveDryer			= {	1  }  ; if (EZType != 3) then  1  else  0  endif  }
	"Default DwellUnitType:DryerFuel"			DwellUnitType:DryerFuel			= {	if (Proj:Fuel_HaveNatGas == 0) then  1  else  2  endif  }	; SAC 11/9/15
	"Default DwellUnitType:HaveCook"				DwellUnitType:HaveCook			= {	1  }  ; if (EZType != 3) then  1  else  0  endif  }
	"Default DwellUnitType:CookFuel"				DwellUnitType:CookFuel			= {	if (Proj:Fuel_HaveNatGas == 0) then  1  else  2  endif  }

   "Set DwellUnitType:Description"				DwellUnitType:Description		= {	if (NumBedrooms > 1)
																											then	Format( "%.0f Bdrms / %s ft2",  NumBedrooms, FltToStr( CondFlrArea ) )
																											else	Format( "%.0f Bdrm / %s ft2",   NumBedrooms, FltToStr( CondFlrArea ) )  endif  }

	; SAC 7/29/15 - added properties to disable all IAQ ventilation
	"Default DwellUnitType:DisableIAQ flag"	DwellUnitType:DisableIAQ		= {	0  }		; option to toggle OFF all IAQ ventilation
	"Set DwellUnitType:IAQDisabled"				DwellUnitType:IAQDisabled		= {	if (Proj:BypassRuleLimits > 0 .AND. DisableIAQ > 0) then  1  else  0  endif  }		; Flag indicating that IAQ vent has been toggled OFF

   ; "Default DwellUnitType:IAQOption"			DwellUnitType:IAQOption			= {				-- defaulted via BEMEnums
; SAC 9/23/15 - TO DO - need to address EAA w/ < 1000 SF not requiring IAQ vent...
	"Set DwellUnitType:MinIAQCFM"					DwellUnitType:MinIAQCFM			= {	(0.03 * ValidOr( CondFlrArea, 0 )) + (7.5 * (Max( NumBedrooms, 1 ) + 1))  }
   ; "Default DwellUnitType:IAQFanRef[1-4]			- no default
   "Set DwellUnitType:IAQNumFanRefs"			DwellUnitType:IAQNumFanRefs	= {	if (IAQDisabled > 0 .OR. MinIAQCFM <= 0 .OR. IAQOption != 2) then  0
   																										else if (LocalCompAssigned( IAQFanRef[4]  )) then  4		else if (LocalCompAssigned( IAQFanRef[3]  )) then  3
   																										else if (LocalCompAssigned( IAQFanRef[2]  )) then  2		else if (LocalCompAssigned( IAQFanRef[1]  )) then  1
   																										else  0  endif endif endif endif endif  }

   "Default DwellUnitType:IAQFanCnt[1]"		DwellUnitType:IAQFanCnt[1]		= {	1  }
   "Default DwellUnitType:IAQFanCnt[2]"		DwellUnitType:IAQFanCnt[2]		= {	1  }
   "Default DwellUnitType:IAQFanCnt[3]"		DwellUnitType:IAQFanCnt[3]		= {	1  }
   "Default DwellUnitType:IAQFanCnt[4]"		DwellUnitType:IAQFanCnt[4]		= {	1  }

   "Set DwellUnitType:IAQCFM[1]"					DwellUnitType:IAQCFM[1]			= {	if (IAQDisabled > 0 .OR. IAQOption != 2 .OR. LocalCompAssigned( IAQFanRef[1] ) < 0.5) then  0  else  IAQFanRef[1]:IAQCFM * IAQFanCnt[1]   endif  }
   "Set DwellUnitType:IAQCFM[2]"					DwellUnitType:IAQCFM[2]			= {	if (IAQDisabled > 0 .OR. IAQOption != 2 .OR. LocalCompAssigned( IAQFanRef[2] ) < 0.5) then  0  else  IAQFanRef[2]:IAQCFM * IAQFanCnt[2]   endif  }
   "Set DwellUnitType:IAQCFM[3]"					DwellUnitType:IAQCFM[3]			= {	if (IAQDisabled > 0 .OR. IAQOption != 2 .OR. LocalCompAssigned( IAQFanRef[3] ) < 0.5) then  0  else  IAQFanRef[3]:IAQCFM * IAQFanCnt[3]   endif  }
   "Set DwellUnitType:IAQCFM[4]"					DwellUnitType:IAQCFM[4]			= {	if (IAQDisabled > 0 .OR. IAQOption != 2 .OR. LocalCompAssigned( IAQFanRef[4] ) < 0.5) then  0  else  IAQFanRef[4]:IAQCFM * IAQFanCnt[4]   endif  }

	"Set DwellUnitType:TotalIAQCFM"				DwellUnitType:TotalIAQCFM		= {	if (IAQOption != 2 .AND. IAQDisabled < 1) then  MinIAQCFM  else  IAQCFM[1] + IAQCFM[2] + IAQCFM[3] + IAQCFM[4]  endif  }
   "Set DwellUnitType:MinIAQCFMLbl"				DwellUnitType:MinIAQCFMLbl		= {	if (IAQDisabled > 0) then  Format( "IAQ Ventilation disabled (%s required but not met)", FltToStr( MinIAQCFM, 1 ) )
																											else if (MinIAQCFM < 0.05) then  " "  else if (IAQOption == 3) then  "CFI (Central Fan Integrated) IAQ  - NOT YET IMPLEMENTED -"
																											else if (TotalIAQCFM < MinIAQCFM) then	Format( "Min IAQ Vent -NOT MET-:  %s required, %s entered (CFM/unit)", FltToStr( MinIAQCFM, 1 ), FltToStr( TotalIAQCFM, 1 ) )
																											else if (IAQOption == 2) then  Format( "Minimum IAQ Ventilation:  %s CFM/unit  (%s entered)", FltToStr( MinIAQCFM, 1 ), FltToStr( TotalIAQCFM, 1 ) )
																											else  Format( "Minimum IAQ Ventilation:  %s CFM/unit", FltToStr( MinIAQCFM, 1 ) )  endif endif endif endif endif  }

	"Set DwellUnitType:IAQPwr_Exhaust - 1"		DwellUnitType:IAQPwr_Exhaust	= {	if (IAQDisabled > 0) then  0
																											else if (IAQOption == 1) then  MinIAQCFM * 0.25
																											else if (IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[1] ) > 0.5)
																											then	if (IAQFanRef[1]:IAQFanType == 1) then  IAQCFM[1] * IAQFanRef[1]:WperCFMIAQ  else  0  endif
																											else	0  endif endif endif  }
	"Set DwellUnitType:IAQPwr_Exhaust - 2"		DwellUnitType:IAQPwr_Exhaust	= {	if (IAQDisabled < 1 .AND. IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[2] ) > 0.5)
																											then	if (IAQFanRef[2]:IAQFanType == 1) then  IAQPwr_Exhaust + (IAQCFM[2] * IAQFanRef[2]:WperCFMIAQ)  else  UNCHANGED  endif
																											else	UNCHANGED  endif  }
	"Set DwellUnitType:IAQPwr_Exhaust - 3"		DwellUnitType:IAQPwr_Exhaust	= {	if (IAQDisabled < 1 .AND. IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[3] ) > 0.5)
																											then	if (IAQFanRef[3]:IAQFanType == 1) then  IAQPwr_Exhaust + (IAQCFM[3] * IAQFanRef[3]:WperCFMIAQ)  else  UNCHANGED  endif
																											else	UNCHANGED  endif  }
	"Set DwellUnitType:IAQPwr_Exhaust - 4"		DwellUnitType:IAQPwr_Exhaust	= {	if (IAQDisabled < 1 .AND. IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[4] ) > 0.5)
																											then	if (IAQFanRef[4]:IAQFanType == 1) then  IAQPwr_Exhaust + (IAQCFM[4] * IAQFanRef[4]:WperCFMIAQ)  else  UNCHANGED  endif
																											else	UNCHANGED  endif  }

	"Set DwellUnitType:IAQCFM_Supply - 1"		DwellUnitType:IAQCFM_Supply	= {	if (IAQDisabled > 0) then  0
																											else if (IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[1] ) > 0.5)
																											then	if (IAQFanRef[1]:IAQFanType == 2) then                  IAQCFM[1]  else      0      endif    else      0      endif endif  }
	"Set DwellUnitType:IAQCFM_Supply - 2"		DwellUnitType:IAQCFM_Supply	= {	if (IAQDisabled < 1 .AND. IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[2] ) > 0.5)
																											then	if (IAQFanRef[2]:IAQFanType == 2) then  IAQCFM_Supply + IAQCFM[2]  else  UNCHANGED  endif    else  UNCHANGED  endif  }
	"Set DwellUnitType:IAQCFM_Supply - 3"		DwellUnitType:IAQCFM_Supply	= {	if (IAQDisabled < 1 .AND. IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[3] ) > 0.5)
																											then	if (IAQFanRef[3]:IAQFanType == 2) then  IAQCFM_Supply + IAQCFM[3]  else  UNCHANGED  endif    else  UNCHANGED  endif  }
	"Set DwellUnitType:IAQCFM_Supply - 4"		DwellUnitType:IAQCFM_Supply	= {	if (IAQDisabled < 1 .AND. IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[4] ) > 0.5)
																											then	if (IAQFanRef[4]:IAQFanType == 2) then  IAQCFM_Supply + IAQCFM[4]  else  UNCHANGED  endif    else  UNCHANGED  endif  }

	"Set DwellUnitType:IAQPwr_Supply - 1"		DwellUnitType:IAQPwr_Supply	= {	if (IAQDisabled > 0) then  0
																											else if (IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[1] ) > 0.5)
																											then	if (IAQFanRef[1]:IAQFanType == 2) then                   IAQCFM[1] * IAQFanRef[1]:WperCFMIAQ   else      0      endif    else      0      endif endif  }
	"Set DwellUnitType:IAQPwr_Supply - 2"		DwellUnitType:IAQPwr_Supply	= {	if (IAQDisabled < 1 .AND. IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[2] ) > 0.5)
																											then	if (IAQFanRef[2]:IAQFanType == 2) then  IAQCFM_Supply + (IAQCFM[2] * IAQFanRef[2]:WperCFMIAQ)  else  UNCHANGED  endif    else  UNCHANGED  endif  }
	"Set DwellUnitType:IAQPwr_Supply - 3"		DwellUnitType:IAQPwr_Supply	= {	if (IAQDisabled < 1 .AND. IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[3] ) > 0.5)
																											then	if (IAQFanRef[3]:IAQFanType == 2) then  IAQCFM_Supply + (IAQCFM[3] * IAQFanRef[3]:WperCFMIAQ)  else  UNCHANGED  endif    else  UNCHANGED  endif  }
	"Set DwellUnitType:IAQPwr_Supply - 4"		DwellUnitType:IAQPwr_Supply	= {	if (IAQDisabled < 1 .AND. IAQOption == 2 .AND. LocalCompAssigned( IAQFanRef[4] ) > 0.5)
																											then	if (IAQFanRef[4]:IAQFanType == 2) then  IAQCFM_Supply + (IAQCFM[4] * IAQFanRef[4]:WperCFMIAQ)  else  UNCHANGED  endif    else  UNCHANGED  endif  }

	"Default DwellUnitType:NumDHWSysTypes"		DwellUnitType:NumDHWSysTypes	= {	1  }
	; SAC 10/6/15 - separate out rules to force reset of DHWSys assignments and set NumDHWSysAssigns, DHWSysAssignFrac & DHWSysFlrArea (to facilitate DHW BudgetConversion)
	"Set DwellUnitType DHWSys references and related properties"	DwellUnitType:Action		= {	EvalRulelist( "Default_DwellUnitType_DHWSysRefs", 1 )  }

	; HW consumption based on Res ACM, App E, Sec E3.1
	; SAC 10/26/15 - added '* DHWSysAssignFrac'
	"Set DwellUnitType:DHWDailyConsPerSys"			DwellUnitType:DHWDailyConsPerSys	= {	(21.4 + (0.00679 * min( CondFlrArea, 2500 ))) * ValidOr( DHWSysAssignFrac, 1 )  }

	"Set DwellUnitType:ServedByDHWSys"		; boolean (0/1) whether or not this DUT is served by one or more valid DHWSys objects"    
			DwellUnitType:ServedByDHWSys	= {	if (IfValidAnd( NumDHWSysAssigns > 0 )) then  1  else  0  endif  }
;	"Set DwellUnitType:ServedByDHWSys - 1"		; boolean (0/1) whether or not this DUT is served by one or more valid DHWSys objects"    
;			DwellUnitType:ServedByDHWSys	= {	if (NumDHWSysTypes > 0 .AND. LocalCompAssigned( DHWSysRef[1] ))
;															then	if (DHWSysRef[1]:NumDHWHeaters > 0.5) then  1  else  0  endif		else	0  endif  }
;	"Set DwellUnitType:ServedByDHWSys - 2"		DwellUnitType:ServedByDHWSys	= {	if (ServedByDHWSys < 0.5 .AND. NumDHWSysTypes > 1 .AND. LocalCompAssigned( DHWSysRef[2] ))
;																											then	if (DHWSysRef[2]:NumDHWHeaters > 0.5) then  1  else  UNCHANGED  endif	else	UNCHANGED  endif  }
;	"Set DwellUnitType:ServedByDHWSys - 3"		DwellUnitType:ServedByDHWSys	= {	if (ServedByDHWSys < 0.5 .AND. NumDHWSysTypes > 2 .AND. LocalCompAssigned( DHWSysRef[3] ))
;																											then	if (DHWSysRef[3]:NumDHWHeaters > 0.5) then  1  else  UNCHANGED  endif	else	UNCHANGED  endif  }
;	"Set DwellUnitType:ServedByDHWSys - 4"		DwellUnitType:ServedByDHWSys	= {	if (ServedByDHWSys < 0.5 .AND. NumDHWSysTypes > 3 .AND. LocalCompAssigned( DHWSysRef[4] ))
;																											then	if (DHWSysRef[4]:NumDHWHeaters > 0.5) then  1  else  UNCHANGED  endif	else	UNCHANGED  endif  }
;	"Set DwellUnitType:ServedByDHWSys - 5"		DwellUnitType:ServedByDHWSys	= {	if (ServedByDHWSys < 0.5 .AND. NumDHWSysTypes > 4 .AND. LocalCompAssigned( DHWSysRef[5] ))
;																											then	if (DHWSysRef[5]:NumDHWHeaters > 0.5) then  1  else  UNCHANGED  endif	else	UNCHANGED  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: DwellUnit Rules
   ;--------------------------------------------------------------------

	; "Default DwellUnit:DwellUnitTypeRef"		DwellUnit:DwellUnitTypeRef	= {				-- not defaulted
	"Default DwellUnit:Count"					DwellUnit:Count				= {	1  }
	"Default DwellUnit:CondFlrArea"			DwellUnit:CondFlrArea		= {	ValidOr( DwellUnitTypeRef:CondFlrArea, 0 )  }
	"Set DwellUnit:TotalCondFlrArea"			DwellUnit:TotalCondFlrArea	= {	if (ParentComponentType() == "Zone") then  CondFlrArea * Count  else  0  endif  }
	"Set DwellUnit:TotalNumBedrooms"			DwellUnit:TotalNumBedrooms	= {	if (ParentComponentType() == "Zone") then  ValidOr( DwellUnitTypeRef:NumBedrooms, 0 ) * Count  else  0  endif  }

	"Set DwellUnit:TotalLtgFlrArea"			DwellUnit:TotalLtgFlrArea	= {	if (ParentComponentType() == "Zone") then  min( CondFlrArea, 4150 ) * Count  else  0  endif  }		; SAC 4/13/16

	"Set DwellUnit:HaveWasher"					DwellUnit:HaveWasher			= {	ValidOr( DwellUnitTypeRef:HaveWasher, 0 )  }
	"Set DwellUnit:HaveDryer"					DwellUnit:HaveDryer			= {	ValidOr( DwellUnitTypeRef:HaveDryer,  0 )  }

	"Set DwellUnit:MinIAQCFM"					DwellUnit:MinIAQCFM			= {	if (LocalCompAssigned( DwellUnitTypeRef ) == 0 .OR. IfValidAnd( TotalCondFlrArea > 0.1 )==0) then  0
																									else	( (0.03 * ValidOr( CondFlrArea, 0 )) + (7.5 * (Max( DwellUnitTypeRef:NumBedrooms, 1 ) + 1)) ) * Count  endif  }

	"Set DwellUnit:TotalIAQCFM"				DwellUnit:TotalIAQCFM		= {	if (MinIAQCFM <= 0 .OR. IfValidAnd( DwellUnitTypeRef:IAQDisabled > 0.5 )) then  0
																									else if (DwellUnitTypeRef:IAQOption == 1) then  MinIAQCFM
																									else  ValidOr( DwellUnitTypeRef:TotalIAQCFM, 0 ) * Count  endif endif  }

	"Set DwellUnit:MinIAQCFMLbl"				DwellUnit:MinIAQCFMLbl		= {	if (LocalCompAssigned( DwellUnitTypeRef ) == 0) then  " "
																									else if (IfValidAnd( DwellUnitTypeRef:IAQDisabled > 0.5 )) then  Format( "IAQ Ventilation disabled (%s required but not met)", FltToStr( MinIAQCFM, 1 ) )
																									else if (MinIAQCFM < 0.05) then  " "  else if (DwellUnitTypeRef:IAQOption == 3) then  "CFI (Central Fan Integrated) IAQ  - NOT YET IMPLEMENTED -"
																									else if (TotalIAQCFM < MinIAQCFM) then	Format( "Min IAQ Vent -NOT MET-:  %s required, %s entered (CFM/unit)", FltToStr( MinIAQCFM, 1 ), FltToStr( TotalIAQCFM, 1 ) )
																									else if (DwellUnitTypeRef:IAQOption == 2) then  Format( "Minimum IAQ Ventilation:  %s CFM/unit  (%s entered)", FltToStr( MinIAQCFM, 1 ), FltToStr( TotalIAQCFM, 1 ) )
																									else  Format( "Minimum IAQ Ventilation:  %s CFM/unit", FltToStr( MinIAQCFM, 1 ) )  endif endif endif endif endif endif  }

	"Set DwellUnit:IAQPwr_Exhaust - 1"		DwellUnit:IAQPwr_Exhaust	= {	if (LocalCompAssigned( DwellUnitTypeRef ) == 0 .OR. IfValidAnd( TotalCondFlrArea > 0.1 )==0 .OR. IfValidAnd( DwellUnitTypeRef:IAQDisabled > 0.5 )) then  0
																									else if (DwellUnitTypeRef:IAQOption == 1) then  TotalIAQCFM * 0.25
																									else if (DwellUnitTypeRef:IAQOption == 2) then  DwellUnitTypeRef:IAQPwr_Exhaust * Count
																									else	0  endif endif endif  }

	"Set DwellUnit:IAQCFM_Supply - 1"		DwellUnit:IAQCFM_Supply		= {	if (LocalCompAssigned( DwellUnitTypeRef ) == 0 .OR. IfValidAnd( TotalCondFlrArea > 0.1 )==0 .OR. IfValidAnd( DwellUnitTypeRef:IAQDisabled > 0.5 )) then  0
																									else	DwellUnitTypeRef:IAQCFM_Supply * Count   endif  }

	"Set DwellUnit:IAQPwr_Supply - 1"		DwellUnit:IAQPwr_Supply		= {	if (LocalCompAssigned( DwellUnitTypeRef ) == 0 .OR. IfValidAnd( TotalCondFlrArea > 0.1 )==0 .OR. IfValidAnd( DwellUnitTypeRef:IAQDisabled > 0.5 )) then  0
																									else	DwellUnitTypeRef:IAQPwr_Supply * Count   endif  }


	"Set DwellUnit:TotalDHWFlrArea"			DwellUnit:TotalDHWFlrArea	= {	if (LocalCompAssigned( DwellUnitTypeRef ) == 0) then  0
																									else if (ParentComponentType() == "Zone" .AND. IfValidAnd( DwellUnitTypeRef:DHWSysAssignFrac > 0 ))
																									then  Count * DwellUnitTypeRef:DHWFlrAreaPerSys / DwellUnitTypeRef:DHWSysAssignFrac
																									else  0  endif endif  }
																					;				else if (IfValidAnd( DwellUnitTypeRef:ServedByDHWSys > 0.5 )) then  TotalCondFlrArea  else  0  endif endif  }


   "Set DwellUnit:Description"				DwellUnit:Description		= {	if (LocalCompAssigned( DwellUnitTypeRef ) == 0) then  "No DwellUnitType assigned"
																									else if (IfValidAnd( DwellUnitTypeRef:NumBedrooms > 1 ))
																									then	Format( "%.0f unit(s), %.0f Bdrms & %s ft2 per unit",  Count, ValidOr( DwellUnitTypeRef:NumBedrooms, 0 ), FltToStr( CondFlrArea ) )
																									else	Format( "%.0f unit(s), %.0f Bdrm & %s ft2 per unit",   Count, ValidOr( DwellUnitTypeRef:NumBedrooms, 0 ), FltToStr( CondFlrArea ) )  endif endif  }

	"Set DwellUnitType:AssignedDUFlrArea"	DwellUnitType:AssignedDUFlrArea	= {	SumRevRef( DwellUnit:DwellUnitTypeRef, DwellUnit:TotalCondFlrArea )  }

	"Set DwellUnitType:NumAssigningDUs"		DwellUnitType:NumAssigningDUs		= {	SumRevRef( DwellUnit:DwellUnitTypeRef, DwellUnit:Count )  }

; SAC 3/19/15 - added to enable Instantaneous standard design DHW for 2016 non-central DHW multifamily models
	"Set DwellUnitType:NumDUsCntrlDHW"		DwellUnitType:NumDUsCntrlDHW		= {	if (AssignedDUFlrArea < 1 .OR. ServedByDHWSys < 0.5) then  0
																											else if (IfValidAnd( DHWSysRef[1]:NumDHWHeaters > 0.5 ) .AND. IfValidAnd( DHWSysRef[1]:CentralDHW > 0.5 )) then  NumAssigningDUs
																											else if (IfValidAnd( DHWSysRef[2]:NumDHWHeaters > 0.5 ) .AND. IfValidAnd( DHWSysRef[2]:CentralDHW > 0.5 )) then  NumAssigningDUs
																											else if (IfValidAnd( DHWSysRef[3]:NumDHWHeaters > 0.5 ) .AND. IfValidAnd( DHWSysRef[3]:CentralDHW > 0.5 )) then  NumAssigningDUs
																											else if (IfValidAnd( DHWSysRef[4]:NumDHWHeaters > 0.5 ) .AND. IfValidAnd( DHWSysRef[4]:CentralDHW > 0.5 )) then  NumAssigningDUs
																											else if (IfValidAnd( DHWSysRef[5]:NumDHWHeaters > 0.5 ) .AND. IfValidAnd( DHWSysRef[5]:CentralDHW > 0.5 )) then  NumAssigningDUs
																											else  0  endif endif endif endif endif endif  }
	"Set DwellUnitType:NumDUsNonCntrlDHW"	DwellUnitType:NumDUsNonCntrlDHW	= {	if (AssignedDUFlrArea < 1 .OR. ServedByDHWSys < 0.5) then  0
																											else if (IfValidAnd( DHWSysRef[1]:NumDHWHeaters > 0.5 ) .AND. IfValidAnd( DHWSysRef[1]:CentralDHW < 0.5 )) then  NumAssigningDUs
																											else if (IfValidAnd( DHWSysRef[2]:NumDHWHeaters > 0.5 ) .AND. IfValidAnd( DHWSysRef[2]:CentralDHW < 0.5 )) then  NumAssigningDUs
																											else if (IfValidAnd( DHWSysRef[3]:NumDHWHeaters > 0.5 ) .AND. IfValidAnd( DHWSysRef[3]:CentralDHW < 0.5 )) then  NumAssigningDUs
																											else if (IfValidAnd( DHWSysRef[4]:NumDHWHeaters > 0.5 ) .AND. IfValidAnd( DHWSysRef[4]:CentralDHW < 0.5 )) then  NumAssigningDUs
																											else if (IfValidAnd( DHWSysRef[5]:NumDHWHeaters > 0.5 ) .AND. IfValidAnd( DHWSysRef[5]:CentralDHW < 0.5 )) then  NumAssigningDUs
																											else  0  endif endif endif endif endif endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: Zone Rules
   ;--------------------------------------------------------------------

	"Force re-default of Zone:Type (iff necessary)"		Zone:Action	= {
			if ( LocalStatus( Type ) > 5 .AND. ( (Proj:ZonalControl == 0 .AND. (Type == 2 .OR. Type == 3)) .OR.
															 (Proj:ZonalControl != 0 .AND.  Type == 1 ) ) )
			then	EvalRulelist( "ForceDefault_Zone_Type", 1 )		else  UNCHANGED  endif  }
	"Default Zone:Type"		Zone:Type	= {	switch (Proj:ZonalControl)
																case  0 :  1		; Conditioned
																default :  2		; Living
															endswitch  }

  ; SAC 6/25/14 - sum child dwelling unit area into DwellingUnitArea_Cond
	"Set Zone:DwellingUnitArea_Cond-1"		Zone:DwellingUnitArea_Cond		= {	SumChildren( DwellUnit:TotalCondFlrArea )  }

	"Set Zone:NumDwellingUnits"		Zone:NumDwellingUnits	= {	if (Proj:IsMultiFamily < 0.5) then  0  else  SumChildren( DwellUnit:Count )  endif  }
	"Set Proj:NumDwellingUnits"		Proj:NumDwellingUnits	= {	if (Proj:IsMultiFamily < 0.5) then  1  else  SumAll( Zone:NumDwellingUnits )  endif  }

  ; SAC 6/25/14 - allow for defaulting of FloorArea for multifamily projects
	"Default Zone:FloorArea"	Zone:FloorArea	= {	if (Proj:IsMultiFamily > 0.5 .AND. LocalStatus( FloorArea ) < 5)	then   DwellingUnitArea_Cond   else  UNCHANGED  endif  }

	; Zone:CeilingHeight,         Required,   0,    1,   1,    1,  1,  1 - no default

	"Default Zone:Volume"			Zone:Volume			= {	if (LocalStatus( CeilingHeight ) < 1 .OR. LocalStatus( FloorArea ) < 1) then  UNDEFINED
																			else  CeilingHeight * FloorArea  endif  }

; SAC 9/12/12 - migrated old (bogus) WinHHTop default to WinHeadHeight
;	"Zone:WinHHTop"					Zone:WinHHTop		= {	if (LocalStatus( CeilingHeight ) < 1) then  7.67
;																			else  max( 1, Local( CeilingHeight ) - 0.33 )  endif  }
	"Default Zone:WinHeadHeight"	Zone:WinHeadHeight	= {	if (LocalStatus( CeilingHeight ) < 1) then  7.67
																				else  max( 1, Local( CeilingHeight ) - 1.33 )  endif  }
; SAC 6/17/14 - switched to array of 3 for nat vent testing
;	"Set Zone:WinVentHtDiff"		Zone:WinVentHtDiff 	= {	2.0  }
	"Set Zone:WinVentHtDiff[1]"		Zone:WinVentHtDiff[1] 	= {	-999.0  }
	"Set Zone:WinVentHtDiff[2]"		Zone:WinVentHtDiff[2] 	= {	-999.0  }
	"Set Zone:WinVentHtDiff[3]"		Zone:WinVentHtDiff[3] 	= {	-999.0  }

	"Zone:FloorHeight default"		Zone:FloorHeight	= {	max( Local(CeilingHeight)+1, 9 )  }

	; SAC 3/28/13 - expanded default logic
	"Zone:Bottom default"			Zone:Bottom			= {	if (ChildCount( SlabFloor ) > 0) then  0.67
																			else if (ChildCount( FloorOverCrawl ) > 0) then  max( 0, (Global( CrawlSpace:AvgWallHeight ) - 0.67) )
																			else if (ChildCount( ExteriorFloor  ) > 0) then  max( 0, MinChild( ExteriorFloor:FloorZ ) )
																			else if (ChildCount( InteriorFloor  ) > 0) then  max( 0, MinChild( InteriorFloor:FloorZ ) )
																			else  0  endif endif endif endif  }

	"Zone:NumStories default"		Zone:NumStories	= {	1  }

	"Set Zone:GrndFlrClgHeight"	Zone:GrndFlrClgHeight	= {	if (Bottom > -4 .AND. Bottom < 4)
																					then  CeilingHeight  else  UNDEFINED  endif  }	; SAC 2/4/13 - help to specify Garage EaveZ

	"Set Zone:TreeDescrip"			Zone:TreeDescrip	= {	if (Local( FloorArea ) > 0.1)
																			then  Format( "%s SqFt", FltToStr( Local( FloorArea ) ) )
																			else  "no floor area specified"  endif  }

	"Set Zone:ZnModel"			Zone:ZnModel	= {	switch( Local( Type ) )
																		case  1 :	3	; "Conditioned"   -> "CZM"
																		case  2 :	3	; "Living"        -> "CZM"
																		case  3 :	3	; "Sleeping"      -> "CZM"
																		case 10 :	4	; "Unconditioned" -> "UZM"
																		default :   3
																	endswitch  }	; 1-"CNE", 2-"CSE", 3-"CZM", 4-"UZM", 5-"UZX"
	"Default Zone:InfAC"       Zone:InfAC  	= {	0  }	; 0s defaults of old infiltration models
	"Default Zone:InfELA"      Zone:InfELA 	= {	0  }
	"Default Zone:InfShld"     Zone:InfShld	= {	4  }	; 0s defaults of old infiltration models
	
	"Set Zone:CondFloorArea"		Zone:CondFloorArea		= {	if (Local( Type ) <  10) then  Local( FloorArea )  else  0  endif  }
	"Set Zone:UncondFloorArea"		Zone:UncondFloorArea		= {	if (Local( Type ) == 10) then  Local( FloorArea )  else  0  endif  }
   "Set Zone:LvgCondFloorArea"	Zone:LvgCondFloorArea   = {   if (Local( Type ) ==  2) then  Local( FloorArea )  else  0  endif  }
   "Set Zone:SlpCondFloorArea"	Zone:SlpCondFloorArea   = {   if (Local( Type ) ==  3) then  Local( FloorArea )  else  0  endif  }
; SAC 4/8/15 - moved up again to set prior to Proj:PVDwellUnitSize
;	mjb	4/14/14	moved CondFloorArea rule up - needed for CoolVent rules
	"Set Proj:CondFloorArea"		Proj:CondFloorArea		= {	SumAll( Zone:CondFloorArea   )  }

; mjb	4/28/14	added Conditioned Volume at Zone level to be summed for Project - needed to convert ACH50 to CFM50, to be in correct reporting units
	"Default Zone:CondVolume"		Zone:CondVolume	=	{	CondFloorArea * CeilingHeight	}
	"Default Proj:CondVolume"		Proj:CondVolume	=	{	SumChildren( Zone:CondVolume )	}

; SAC 12/28/15 - replacement inputs for AdditionCFAFrac
	"Force swap of old AdditionCFAFrac -> w/ new AddAloneExistArea & AddAloneAddedArea"		Proj:Action	= {	if (RunScope == 1 .AND. IsAddAlone == 1 .AND. LocalStatus( AdditionCFAFrac ) > 6)
																																				then	EvalRulelist( "Replace_AdditionCFAFrac_with_AddAloneAreas" )
																																				else if ((RunScope != 1 .OR. IsAddAlone != 1) .AND.
																																							(LocalStatus( AddAloneAddedArea ) > 6 .OR. LocalStatus( AddAloneExistArea ) > 6))
																																				then	EvalRulelist( "ForceReset_AddAloneAreas" )
																																				else	UNCHANGED  endif endif  }
	"Default Proj:AddAloneAddedArea"		Proj:AddAloneAddedArea	= {	if (RunScope == 1 .AND. IsAddAlone == 1) then	SumAll( Zone:FloorArea )  else  UNDEFINED  endif  }
	"Default Proj:AddAloneExistArea"		Proj:AddAloneExistArea	= {	if (RunScope == 1 .AND. IsAddAlone == 1) then	0                         else  UNDEFINED  endif  }
	"Default Proj:AddAloneTotalArea"		Proj:AddAloneTotalArea	= {	if (RunScope == 1 .AND. IsAddAlone == 1) then	AddAloneAddedArea + AddAloneExistArea  else  UNDEFINED  endif  }
	"Default Proj:AdditionCFAFrac"		Proj:AdditionCFAFrac		= {	if (RunScope == 1 .AND. IsAddAlone == 1)
																							then	if (IfValidAnd( AddAloneTotalArea > 0 )) then  ValidOr( AddAloneAddedArea, 0 ) / AddAloneTotalArea
																									else  1  endif
																							else  1  endif  }

;	E+A+A	mjb	2/13/14
; mjb 4/24/14	- Additions Alone added
	"Set Zone:AdditionCFA"			Zone:AdditionCFA			= {	if (( Proj:RunScope == 2 .AND. Status = 3) .OR. (Proj:RunScope == 1 .AND. Proj:IsAddAlone > 0.5) ) then  CondFloorArea  
																						else  0  endif  }
	"Set Proj:AdditionCFA"			Proj:AdditionCFA			= {	SumChildren( Zone:AdditionCFA )  }

	; SAC 2/20/15 - for EAA addition window areas
	"Set Zone:IsEAAAdditionZone"	Zone:IsEAAAdditionZone	= {	if (Proj:RunScope == 2 .AND. Status = 3) then  1  else  0  endif  }

;EM 2/19/15
	; SAC 9/16/15 - NOTE: (from DeeAnne @ CEC) - RunScope = New & AdditionAlone checked does NOT get accumulated into *AdditionSize - those models are treated like New Cons, not E+A+A
	"Set Proj:AdditionSize"			Proj:AdditionSize			= {	if (RunScope == 2) then  SumAcrossIf( Zone:FloorArea,     Zone:Status = 3 )  else  -1  endif  }
	"Set Proj:CondAdditionSize"	Proj:CondAdditionSize	= {	if (RunScope == 2) then  SumAcrossIf( Zone:CondFloorArea, Zone:Status = 3 )  else   0  endif  }

  ; SAC 12/5/13 - added to facilitate HVACSys:FloorAreaServed defaulting
	"Set Zone:HVACNewCondFloorArea"		Zone:HVACNewCondFloorArea	= {	if (Proj:RunScope == 2)
																								then	if (HVACSysStatus == 3) then  CondFloorArea  else  0  endif
																								else	CondFloorArea  endif  }
	"Set Zone:HVACAltCondFloorArea"		Zone:HVACAltCondFloorArea	= {	if (Proj:RunScope == 2 .AND. HVACSysStatus == 2) then  CondFloorArea  else  0  endif  }
	"Set Zone:HVACExCondFloorArea"		Zone:HVACExCondFloorArea	= {	if (Proj:RunScope == 2 .AND. HVACSysStatus == 1) then  CondFloorArea  else  0  endif  }
	"Set Zone:HVACExVCondFloorArea"		Zone:HVACExVCondFloorArea	= {	if (Proj:RunScope == 2 .AND. HVACSysStatus == 2 .AND. HVACSysVerified) then  CondFloorArea  else  0  endif  }
  ; SAC 12/19/13 - added new property to help facilitate checks to determine if there is a valid (new/alt/ex-specific) HVAC system assigned
;	"Set Zone:ActiveHVACSystem"			Zone:ActiveHVACSystem		= {	if (Proj:RunScope != 2 .OR. HVACSysStatus == 3) then  HVACSystem
;																								else if (Proj:RunScope == 2 .AND. HVACSysStatus == 2) then  AltHVACSystem
;																								else if (Proj:RunScope == 2 .AND. HVACSysStatus == 1) then  exHVACSystem
;																								else  UNDEFINED  endif endif endif  }
;	mjb	10/7/14	- modified to work with IsAddAlone and Existing HVAC
	"Set Zone:ActiveHVACSystem"			Zone:ActiveHVACSystem		= {	if ((Proj:RunScope != 2 .AND. Proj:IsAddAlone < 0.5) .OR. HVACSysStatus == 3) then  HVACSystem
																								else if (Proj:RunScope == 2 .AND. HVACSysStatus == 2) then  AltHVACSystem
																								else if ((Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0.5) .AND. HVACSysStatus == 1) then  exHVACSystem
																								else  UNDEFINED  endif endif endif  }

;	mjb	4/18/14	- added to keep track of existing floor area based on Zone Status
	"Set Zone:exCondFloorArea"			Zone:exCondFloorArea		= {	if (Status == 1) then CondFloorArea else 0 endif	}

  ; SAC 4/13/16 - set Zone:LtgCondFloorArea used in setting T24-2016 lighting gains
	"Set Proj:LtgCondFloorArea"		Proj:LtgCondFloorArea	= {	if (Proj:IsMultiFamily > 0.5) then  SumChildren( DwellUnit:TotalLtgFlrArea )
																						else if (Proj:RunScope == 1 .AND. Proj:IsAddAlone > 0.5)
																						then	min( 4150, (ValidOr( AddAloneExistArea, 0 ) + ValidOr( AddAloneAddedArea, 0 )) )
																						else	min( 4150, CondFloorArea )
																						endif endif  }
;	"Set Zone:LtgCondFloorArea"		Zone:LtgCondFloorArea	= {	
;					if (Proj:IsMultiFamily < 0.5)
;					then	; SINGLE FAMILY
;							if (Proj:RunScope == 1 .AND. Proj:IsAddAlone > 0.5)
;							then	; New Cons, Addition Alone
;									if (ValidOr( Proj:AddAloneExistArea, 0 ) + ValidOr( Proj:AddAloneAddedArea, 0 ) > 0)
;									then	CondFloorArea * min( 4150, (ValidOr( Proj:AddAloneExistArea, 0 ) + ValidOr( Proj:AddAloneAddedArea, 0 )) ) /
;																				(ValidOr( Proj:AddAloneExistArea, 0 ) + ValidOr( Proj:AddAloneAddedArea, 0 )) 
;									else	CondFloorArea		; ERROR - addition alone project areas bogus
;									endif
;							else	; EAA or New Cons NOT Addition Alone
;									if (IfValidAnd( Proj:CondFloorArea > 0 ))
;									then	CondFloorArea * min( 4150, Proj:CondFloorArea ) / Proj:CondFloorArea
;									else	CondFloorArea		; ERROR - Proj:CondFloorArea bogus
;									endif
;							endif
;					else	SumChildren( DwellUnit:TotalLtgFlrArea )
;					endif  }
	"Init Zone:GainNumBedrooms - Number of bedrooms used to scale internal gians for this Zone"	Zone:GainNumBedrooms	= {
					if (Proj:IsMultiFamily < 0.5)
					then	if (Proj:RunScope == 1 .AND. Proj:IsAddAlone > 0.5)	; SINGLE FAMILY
							then	Proj:NumAddBedrooms		; New Cons, Addition Alone
							else	Proj:NumBedrooms			; EAA or New Cons NOT Addition Alone
							endif
					else	SumChildren( DwellUnit:TotalLtgFlrArea )
					endif  }
	"Scale Zone:GainNumBedrooms for SFam Zone area"	Zone:GainNumBedrooms	= {
					if (Proj:IsMultiFamily > 0.5) then  UNCHANGED
					else if (IfValidAnd( Proj:CondFloorArea > 0 ))
					then	GainNumBedrooms * CondFloorArea / Proj:CondFloorArea
					else	GainNumBedrooms / ComponentCount( Zone )		; ERROR - Proj:CondFloorArea bogus
					endif endif  }

; SAC 9/6/12 - moved up from below - also added logic to ensure it gets set only for Conditioned zones
		; (#3a in Internal Mass write-up) create & assign SURFACE objects (to Conditioned zones only)...
	"Set Zone:znCAir"				Zone:znCAir = {	if (Type < 10) then  Local(CondFloorArea) * 2.
																else  UNDEFINED  endif	}

	"Set Zone:ClgBlwAtticArea"			Zone:ClgBlwAtticArea		= {	SumChildren( CeilingBelowAttic:Area )  }
	"Set Zone:CondClgBlwAtticArea"	Zone:CondClgBlwAtticArea ={	if (Type < 10) then  ClgBlwAtticArea  else  0  endif  }
	"Set Zone:HasCondClgBlwAttic"		Zone:HasCondClgBlwAttic	= {	if (CondClgBlwAtticArea > 0.1) then  1  else  0  endif  }

; SAC 12/1/13 - moved setting of Zone:HVACSysAssigned up HERE into ProposedInput rulelist to use in UI
;	mjb	4/18/14 - changed HVACSystem to ActiveHVACSystem in next rule, to work with E+A+A too
	"Set Zone:HVACSysAssigned"			Zone:HVACSysAssigned		= {	if (Type < 10 .AND. LocalCompAssigned( ActiveHVACSystem ) > 0) then  1  else  0  endif  }

; SAC 10/6/15 - moved rules setting DHWHeater floor area served & hydronic heating-related properties to subordinate rulelist, to facilitate their evaluation during BudgetConversion
	"Set DHWHeater floor area served properties"		Proj:Action		= {	EvalRulelist( "Default_DHWHeater_AreaServedAndHydronic" )  }


; PVWatts calc inputs - SAC 1/25/16
   ;--------------------------------------------------------------------
   ; ProposedInput: Photovoltaic System DESIGN RATING Defaulting Rules
   ;--------------------------------------------------------------------

	"Default Proj:UsePVWattsDLL"		Proj:UsePVWattsDLL			= {	0  }		; SAC 2/25/16
	"Set Proj:AllowPVWModTypeCust"	Proj:AllowPVWModTypeCust	= {	if (Proj:BypassRuleLimits > 1.5) then  1  else  0  endif  }

	; allow to default via enumerations:
	;	Proj:PVWInputs

	"Blast any user input that should be overridden when PVWInputs = Simplified"
													Proj:Action						= {	if (PVWInputs > 0) then  UNCHANGED
																								else if (LocalStatus( PVWInverterEff[1] ) > 4 .OR. LocalStatus( PVWArrayType[1] ) > 4 .OR.
																											LocalStatus( PVWInverterEff[2] ) > 4 .OR. LocalStatus( PVWArrayType[2] ) > 4 .OR.
																											LocalStatus( PVWInverterEff[3] ) > 4 .OR. LocalStatus( PVWArrayType[3] ) > 4 .OR.
																											LocalStatus( PVWInverterEff[4] ) > 4 .OR. LocalStatus( PVWArrayType[4] ) > 4 .OR.
																											LocalStatus( PVWInverterEff[5] ) > 4 .OR. LocalStatus( PVWArrayType[5] ) > 4 )
																								then	EvalRulelist( "BlastInputs_PVWInputs_Simplified" )  else  UNCHANGED  endif endif  }

	"Ensure PVWArrayType[*] = 'Fixed (open rack)' (ticket #609)"
													Proj:Action		= {	if (Proj:BypassRuleLimits < 1 .AND.		; SAC 2/21/16 - allow user-defined inputs if BRL > 0
																						(PVWArrayType[1] > 1 .OR. PVWArrayType[2] > 1 .OR. PVWArrayType[3] > 1 .OR. PVWArrayType[4] > 1 .OR. PVWArrayType[5] > 1))
																				then	EvalRulelist( "Force_PVWArrayType_to_FixedOpenRack" )
																				else	UNCHANGED  endif  }

	"Set Proj:PVWLastRow"					Proj:PVWLastRow			= {	if (PVWInputs < 1 .AND. IfValidAnd( PVWDCSysSize[1] > 0 )) then  1
																							else if (IfValidAnd( PVWDCSysSize[5] > 0 )) then  5
																							else if (IfValidAnd( PVWDCSysSize[4] > 0 )) then  4
																							else if (IfValidAnd( PVWDCSysSize[3] > 0 )) then  3
																							else if (IfValidAnd( PVWDCSysSize[2] > 0 )) then  2
																							else if (IfValidAnd( PVWDCSysSize[1] > 0 )) then  1  else  0  endif endif endif endif endif endif  }

	"Set Proj:HavePVWModTypeCust"	Proj:HavePVWModTypeCust	= {	if (Proj:AllowPVWModTypeCust < 0.5) then  0
																					else if (PVWLastRow >= 1 .AND. PVWModuleType[1] == 4) then  1
																					else if (PVWLastRow >= 2 .AND. PVWModuleType[2] == 4) then  1
																					else if (PVWLastRow >= 3 .AND. PVWModuleType[3] == 4) then  1
																					else if (PVWLastRow >= 4 .AND. PVWModuleType[4] == 4) then  1
																					else if (PVWLastRow >= 5 .AND. PVWModuleType[5] == 4) then  1
																					else	0  endif endif endif endif endif endif  }

	; allow to default via enumerations:
	;	Proj:PVWModuleType[ALL]
	;	Proj:PVWArrayTiltInput[ALL]  -  0-"Degrees"  1-"Pitch"
	;	Proj:PVWArrayType[ALL]

	"Default Proj:PVWDCSysSize[1]"		Proj:PVWDCSysSize[1]			= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5) then  UNDEFINED  else  0  endif  }
	"Default Proj:PVWDCSysSize[2]"		Proj:PVWDCSysSize[2]			= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5) then  UNDEFINED  else  0  endif  }
	"Default Proj:PVWDCSysSize[3]"		Proj:PVWDCSysSize[3]			= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5) then  UNDEFINED  else  0  endif  }
	"Default Proj:PVWDCSysSize[4]"		Proj:PVWDCSysSize[4]			= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5) then  UNDEFINED  else  0  endif  }
	"Default Proj:PVWDCSysSize[5]"		Proj:PVWDCSysSize[5]			= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5) then  UNDEFINED  else  0  endif  }

	"Default Proj:PVWCalFlexInstall[1]"	Proj:PVWCalFlexInstall[1]	= {	1  }	
	"Default Proj:PVWCalFlexInstall[2]"	Proj:PVWCalFlexInstall[2]	= {	1  }	
	"Default Proj:PVWCalFlexInstall[3]"	Proj:PVWCalFlexInstall[3]	= {	1  }	
	"Default Proj:PVWCalFlexInstall[4]"	Proj:PVWCalFlexInstall[4]	= {	1  }	
	"Default Proj:PVWCalFlexInstall[5]"	Proj:PVWCalFlexInstall[5]	= {	1  }	

	"Blast any user input that should be overridden by PVWCalFlexInstall[1]"
													Proj:Action						= {	if (PVWCalFlexInstall[1] < 1) then  UNCHANGED
																								else if (LocalStatus( PVWArrayTiltInput[1] ) > 4 .OR. LocalStatus( PVWArrayTiltPitch[1] ) > 4 .OR.
																											LocalStatus( PVWArrayTiltDeg[1]   ) > 4 .OR. LocalStatus( PVWAzm[1]            ) > 4 )
																								then	EvalRulelist( "BlastInputs_PVWCalFlexInstall_1" )  else  UNCHANGED  endif endif  }
	"Blast any user input that should be overridden by PVWCalFlexInstall[1]"
													Proj:Action						= {	if (PVWCalFlexInstall[1] < 1) then  UNCHANGED
																								else if (LocalStatus( PVWArrayTiltInput[1] ) > 4 .OR. LocalStatus( PVWArrayTiltPitch[1] ) > 4 .OR.
																											LocalStatus( PVWArrayTiltDeg[1]   ) > 4 .OR. LocalStatus( PVWAzm[1]            ) > 4 )
																								then	EvalRulelist( "BlastInputs_PVWCalFlexInstall_1" )  else  UNCHANGED  endif endif  }
	"Blast any user input that should be overridden by PVWCalFlexInstall[2]"
													Proj:Action						= {	if (PVWCalFlexInstall[2] < 1) then  UNCHANGED
																								else if (LocalStatus( PVWArrayTiltInput[2] ) > 4 .OR. LocalStatus( PVWArrayTiltPitch[2] ) > 4 .OR.
																											LocalStatus( PVWArrayTiltDeg[2]   ) > 4 .OR. LocalStatus( PVWAzm[2]            ) > 4 )
																								then	EvalRulelist( "BlastInputs_PVWCalFlexInstall_2" )  else  UNCHANGED  endif endif  }
	"Blast any user input that should be overridden by PVWCalFlexInstall[3]"
													Proj:Action						= {	if (PVWCalFlexInstall[3] < 1) then  UNCHANGED
																								else if (LocalStatus( PVWArrayTiltInput[3] ) > 4 .OR. LocalStatus( PVWArrayTiltPitch[3] ) > 4 .OR.
																											LocalStatus( PVWArrayTiltDeg[3]   ) > 4 .OR. LocalStatus( PVWAzm[3]            ) > 4 )
																								then	EvalRulelist( "BlastInputs_PVWCalFlexInstall_3" )  else  UNCHANGED  endif endif  }
	"Blast any user input that should be overridden by PVWCalFlexInstall[4]"
													Proj:Action						= {	if (PVWCalFlexInstall[4] < 1) then  UNCHANGED
																								else if (LocalStatus( PVWArrayTiltInput[4] ) > 4 .OR. LocalStatus( PVWArrayTiltPitch[4] ) > 4 .OR.
																											LocalStatus( PVWArrayTiltDeg[4]   ) > 4 .OR. LocalStatus( PVWAzm[4]            ) > 4 )
																								then	EvalRulelist( "BlastInputs_PVWCalFlexInstall_4" )  else  UNCHANGED  endif endif  }
	"Blast any user input that should be overridden by PVWCalFlexInstall[5]"
													Proj:Action						= {	if (PVWCalFlexInstall[5] < 1) then  UNCHANGED
																								else if (LocalStatus( PVWArrayTiltInput[5] ) > 4 .OR. LocalStatus( PVWArrayTiltPitch[5] ) > 4 .OR.
																											LocalStatus( PVWArrayTiltDeg[5]   ) > 4 .OR. LocalStatus( PVWAzm[5]            ) > 4 )
																								then	EvalRulelist( "BlastInputs_PVWCalFlexInstall_5" )  else  UNCHANGED  endif endif  }

	"Default Proj:PVWAzm[1]"				Proj:PVWAzm[1]					= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[1] > 0 )==0) then  UNDEFINED  else  170  endif  }
	"Default Proj:PVWAzm[2]"				Proj:PVWAzm[2]					= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[2] > 0 )==0) then  UNDEFINED  else  170  endif  }
	"Default Proj:PVWAzm[3]"				Proj:PVWAzm[3]					= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[3] > 0 )==0) then  UNDEFINED  else  170  endif  }
	"Default Proj:PVWAzm[4]"				Proj:PVWAzm[4]					= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[4] > 0 )==0) then  UNDEFINED  else  170  endif  }
	"Default Proj:PVWAzm[5]"				Proj:PVWAzm[5]					= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[5] > 0 )==0) then  UNDEFINED  else  170  endif  }

; Proj:PVWAzmMsg[ALL],        NotInput,   0,    0,   0,    1,  1,  1

	;	Proj:PVWArrayTiltInput[ALL]  -  0-"Degrees"  1-"Pitch"
	"Blast PVWArrayTiltPitch[1] if PVWArrayTiltInput = deg"		Proj:Action		= {	if (PVWArrayTiltInput[1] == 0 .AND. LocalStatus( PVWArrayTiltPitch[1] ) > 4)
																												then	EvalRulelist( "BlastInputs_PVWArrayTiltPitch_1" )  else  UNCHANGED  endif  }
	"Blast PVWArrayTiltPitch[2] if PVWArrayTiltInput = deg"		Proj:Action		= {	if (PVWArrayTiltInput[2] == 0 .AND. LocalStatus( PVWArrayTiltPitch[2] ) > 4)
																												then	EvalRulelist( "BlastInputs_PVWArrayTiltPitch_2" )  else  UNCHANGED  endif  }
	"Blast PVWArrayTiltPitch[3] if PVWArrayTiltInput = deg"		Proj:Action		= {	if (PVWArrayTiltInput[3] == 0 .AND. LocalStatus( PVWArrayTiltPitch[3] ) > 4)
																												then	EvalRulelist( "BlastInputs_PVWArrayTiltPitch_3" )  else  UNCHANGED  endif  }
	"Blast PVWArrayTiltPitch[4] if PVWArrayTiltInput = deg"		Proj:Action		= {	if (PVWArrayTiltInput[4] == 0 .AND. LocalStatus( PVWArrayTiltPitch[4] ) > 4)
																												then	EvalRulelist( "BlastInputs_PVWArrayTiltPitch_4" )  else  UNCHANGED  endif  }
	"Blast PVWArrayTiltPitch[5] if PVWArrayTiltInput = deg"		Proj:Action		= {	if (PVWArrayTiltInput[5] == 0 .AND. LocalStatus( PVWArrayTiltPitch[5] ) > 4)
																												then	EvalRulelist( "BlastInputs_PVWArrayTiltPitch_5" )  else  UNCHANGED  endif  }

	"Blast PVWArrayTiltDeg[1] if PVWArrayTiltInput = pitch"		Proj:Action		= {	if (PVWArrayTiltInput[1] == 1 .AND. LocalStatus( PVWArrayTiltDeg[1] ) > 4)
																												then	EvalRulelist( "BlastInputs_PVWArrayTiltDeg_1" )  else  UNCHANGED  endif  }
	"Blast PVWArrayTiltDeg[2] if PVWArrayTiltInput = pitch"		Proj:Action		= {	if (PVWArrayTiltInput[2] == 1 .AND. LocalStatus( PVWArrayTiltDeg[2] ) > 4)
																												then	EvalRulelist( "BlastInputs_PVWArrayTiltDeg_2" )  else  UNCHANGED  endif  }
	"Blast PVWArrayTiltDeg[3] if PVWArrayTiltInput = pitch"		Proj:Action		= {	if (PVWArrayTiltInput[3] == 1 .AND. LocalStatus( PVWArrayTiltDeg[3] ) > 4)
																												then	EvalRulelist( "BlastInputs_PVWArrayTiltDeg_3" )  else  UNCHANGED  endif  }
	"Blast PVWArrayTiltDeg[4] if PVWArrayTiltInput = pitch"		Proj:Action		= {	if (PVWArrayTiltInput[4] == 1 .AND. LocalStatus( PVWArrayTiltDeg[4] ) > 4)
																												then	EvalRulelist( "BlastInputs_PVWArrayTiltDeg_4" )  else  UNCHANGED  endif  }
	"Blast PVWArrayTiltDeg[5] if PVWArrayTiltInput = pitch"		Proj:Action		= {	if (PVWArrayTiltInput[5] == 1 .AND. LocalStatus( PVWArrayTiltDeg[5] ) > 4)
																												then	EvalRulelist( "BlastInputs_PVWArrayTiltDeg_5" )  else  UNCHANGED  endif  }

	"Default Proj:PVWArrayTiltPitch[1]"	Proj:PVWArrayTiltPitch[1]	= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[1] > 0 )==0) then  UNDEFINED
																								else if (PVWArrayTiltInput[1] == 0 .AND. LocalStatus( PVWArrayTiltDeg[1] ) > 4)
																								then  if (PVWArrayTiltDeg[1] == 0) then  0  else  12 * tan( (PVWArrayTiltDeg[1]/180)*3.14159 )  endif
																								else	5  endif endif  }
	"Default Proj:PVWArrayTiltPitch[2]"	Proj:PVWArrayTiltPitch[2]	= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[2] > 0 )==0) then  UNDEFINED
																								else if (PVWArrayTiltInput[2] == 0 .AND. LocalStatus( PVWArrayTiltDeg[2] ) > 4)
																								then  if (PVWArrayTiltDeg[2] == 0) then  0  else  12 * tan( (PVWArrayTiltDeg[2]/180)*3.14159 )  endif
																								else	5  endif endif  }
	"Default Proj:PVWArrayTiltPitch[3]"	Proj:PVWArrayTiltPitch[3]	= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[3] > 0 )==0) then  UNDEFINED
																								else if (PVWArrayTiltInput[3] == 0 .AND. LocalStatus( PVWArrayTiltDeg[3] ) > 4)
																								then  if (PVWArrayTiltDeg[3] == 0) then  0  else  12 * tan( (PVWArrayTiltDeg[3]/180)*3.14159 )  endif
																								else	5  endif endif  }
	"Default Proj:PVWArrayTiltPitch[4]"	Proj:PVWArrayTiltPitch[4]	= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[4] > 0 )==0) then  UNDEFINED
																								else if (PVWArrayTiltInput[4] == 0 .AND. LocalStatus( PVWArrayTiltDeg[4] ) > 4)
																								then  if (PVWArrayTiltDeg[4] == 0) then  0  else  12 * tan( (PVWArrayTiltDeg[4]/180)*3.14159 )  endif
																								else	5  endif endif  }
	"Default Proj:PVWArrayTiltPitch[5]"	Proj:PVWArrayTiltPitch[5]	= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[5] > 0 )==0) then  UNDEFINED
																								else if (PVWArrayTiltInput[5] == 0 .AND. LocalStatus( PVWArrayTiltDeg[5] ) > 4)
																								then  if (PVWArrayTiltDeg[5] == 0) then  0  else  12 * tan( (PVWArrayTiltDeg[5]/180)*3.14159 )  endif
																								else	5  endif endif  }

	"Default Proj:PVWArrayTiltDeg[1]"	Proj:PVWArrayTiltDeg[1]		= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[1] > 0 )==0) then  UNDEFINED
																								else if (PVWArrayTiltInput[1] == 1 .AND. LocalStatus( PVWArrayTiltPitch[1] ) > 4)
																								then  (atan( PVWArrayTiltPitch[1] / 12 ) / 3.14159) * 180
																								else	(atan( 5 / 12 ) / 3.14159) * 180  endif endif  }
	"Default Proj:PVWArrayTiltDeg[2]"	Proj:PVWArrayTiltDeg[2]		= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[2] > 0 )==0) then  UNDEFINED
																								else if (PVWArrayTiltInput[2] == 1 .AND. LocalStatus( PVWArrayTiltPitch[2] ) > 4)
																								then  (atan( PVWArrayTiltPitch[2] / 12 ) / 3.14159) * 180 
																								else	(atan( 5 / 12 ) / 3.14159) * 180  endif endif  }
	"Default Proj:PVWArrayTiltDeg[3]"	Proj:PVWArrayTiltDeg[3]		= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[3] > 0 )==0) then  UNDEFINED
																								else if (PVWArrayTiltInput[3] == 1 .AND. LocalStatus( PVWArrayTiltPitch[3] ) > 4)
																								then  (atan( PVWArrayTiltPitch[3] / 12 ) / 3.14159) * 180 
																								else	(atan( 5 / 12 ) / 3.14159) * 180  endif endif  }
	"Default Proj:PVWArrayTiltDeg[4]"	Proj:PVWArrayTiltDeg[4]		= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[4] > 0 )==0) then  UNDEFINED
																								else if (PVWArrayTiltInput[4] == 1 .AND. LocalStatus( PVWArrayTiltPitch[4] ) > 4)
																								then  (atan( PVWArrayTiltPitch[4] / 12 ) / 3.14159) * 180 
																								else	(atan( 5 / 12 ) / 3.14159) * 180  endif endif  }
	"Default Proj:PVWArrayTiltDeg[5]"	Proj:PVWArrayTiltDeg[5]		= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[5] > 0 )==0) then  UNDEFINED
																								else if (PVWArrayTiltInput[5] == 1 .AND. LocalStatus( PVWArrayTiltPitch[5] ) > 4)
																								then  (atan( PVWArrayTiltPitch[5] / 12 ) / 3.14159) * 180 
																								else	(atan( 5 / 12 ) / 3.14159) * 180  endif endif  }

	"Default Proj:PVWInverterEff[1]"		Proj:PVWInverterEff[1]	= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[1] > 0 )==0) then  UNDEFINED  else  96  endif  }
	"Default Proj:PVWInverterEff[2]"		Proj:PVWInverterEff[2]	= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[2] > 0 )==0) then  UNDEFINED  else  96  endif  }
	"Default Proj:PVWInverterEff[3]"		Proj:PVWInverterEff[3]	= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[3] > 0 )==0) then  UNDEFINED  else  96  endif  }
	"Default Proj:PVWInverterEff[4]"		Proj:PVWInverterEff[4]	= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[4] > 0 )==0) then  UNDEFINED  else  96  endif  }
	"Default Proj:PVWInverterEff[5]"		Proj:PVWInverterEff[5]	= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[5] > 0 )==0) then  UNDEFINED  else  96  endif  }

	; not inputable (yet?)
	;	Proj:PVWSysLosses[ALL]
	;	Proj:PVWDCtoACRatio[ALL]
	;	Proj:PVWGCR[ALL]

  ; SAC 2/25/16
	"Default Proj:PVWCoverRefrInd[1]"	Proj:PVWCoverRefrInd[1]		= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[1] > 0 )==0 .OR.
																										AllowPVWModTypeCust < 0.5 .OR. PVWModuleType[1] < 4) then  UNDEFINED  else  1.0  endif  }
	"Default Proj:PVWCoverRefrInd[2]"	Proj:PVWCoverRefrInd[2]		= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[2] > 0 )==0 .OR.
																										AllowPVWModTypeCust < 0.5 .OR. PVWModuleType[2] < 4) then  UNDEFINED  else  1.0  endif  }
	"Default Proj:PVWCoverRefrInd[3]"	Proj:PVWCoverRefrInd[3]		= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[3] > 0 )==0 .OR.
																										AllowPVWModTypeCust < 0.5 .OR. PVWModuleType[3] < 4) then  UNDEFINED  else  1.0  endif  }
	"Default Proj:PVWCoverRefrInd[4]"	Proj:PVWCoverRefrInd[4]		= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[4] > 0 )==0 .OR.
																										AllowPVWModTypeCust < 0.5 .OR. PVWModuleType[4] < 4) then  UNDEFINED  else  1.0  endif  }
	"Default Proj:PVWCoverRefrInd[5]"	Proj:PVWCoverRefrInd[5]		= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[5] > 0 )==0 .OR.
																										AllowPVWModTypeCust < 0.5 .OR. PVWModuleType[5] < 4) then  UNDEFINED  else  1.0  endif  }
  ; SAC 2/25/16
	"Default Proj:PVWTempCoeff[1]"		Proj:PVWTempCoeff[1]			= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[1] > 0 )==0 .OR.
																										AllowPVWModTypeCust < 0.5 .OR. PVWModuleType[1] < 4) then  UNDEFINED  else  -0.0026  endif  }
	"Default Proj:PVWTempCoeff[2]"		Proj:PVWTempCoeff[2]			= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[2] > 0 )==0 .OR.
																										AllowPVWModTypeCust < 0.5 .OR. PVWModuleType[2] < 4) then  UNDEFINED  else  -0.0026  endif  }
	"Default Proj:PVWTempCoeff[3]"		Proj:PVWTempCoeff[3]			= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[3] > 0 )==0 .OR.
																										AllowPVWModTypeCust < 0.5 .OR. PVWModuleType[3] < 4) then  UNDEFINED  else  -0.0026  endif  }
	"Default Proj:PVWTempCoeff[4]"		Proj:PVWTempCoeff[4]			= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[4] > 0 )==0 .OR.
																										AllowPVWModTypeCust < 0.5 .OR. PVWModuleType[4] < 4) then  UNDEFINED  else  -0.0026  endif  }
	"Default Proj:PVWTempCoeff[5]"		Proj:PVWTempCoeff[5]			= {	if (AllowDesignRating < 0.5 .OR. DesignRatingCalcs < 0.5 .OR. IfValidAnd( PVWDCSysSize[5] > 0 )==0 .OR.
																										AllowPVWModTypeCust < 0.5 .OR. PVWModuleType[5] < 4) then  UNDEFINED  else  -0.0026  endif  }

	"Set Proj:PVWShowCFILabels"	Proj:PVWShowCFILabels	= {	if (IfValidAnd( PVWDCSysSize[1] > 0 ) .AND. PVWCalFlexInstall[1] < 1) then  1
																					else if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[2] > 0 ) .AND. PVWCalFlexInstall[2] < 1) then  1
																					else if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[3] > 0 ) .AND. PVWCalFlexInstall[3] < 1) then  1
																					else if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[4] > 0 ) .AND. PVWCalFlexInstall[4] < 1) then  1
																					else if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[5] > 0 ) .AND. PVWCalFlexInstall[5] < 1) then  1  else  0  endif endif endif endif endif  }

	"Set Proj:PVWDCSysTotal-1"		Proj:PVWDCSysTotal	= {	if (IfValidAnd( PVWDCSysSize[1] > 0 )) then  PVWDCSysSize[1]  else  0  endif  }
	"Set Proj:PVWDCSysTotal-2"		Proj:PVWDCSysTotal	= {	if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[2] > 0 )) then  PVWDCSysTotal + PVWDCSysSize[2]  else  UNCHANGED  endif  }
	"Set Proj:PVWDCSysTotal-3"		Proj:PVWDCSysTotal	= {	if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[3] > 0 )) then  PVWDCSysTotal + PVWDCSysSize[3]  else  UNCHANGED  endif  }
	"Set Proj:PVWDCSysTotal-4"		Proj:PVWDCSysTotal	= {	if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[4] > 0 )) then  PVWDCSysTotal + PVWDCSysSize[4]  else  UNCHANGED  endif  }
	"Set Proj:PVWDCSysTotal-5"		Proj:PVWDCSysTotal	= {	if (PVWInputs > 0 .AND. IfValidAnd( PVWDCSysSize[5] > 0 )) then  PVWDCSysTotal + PVWDCSysSize[5]  else  UNCHANGED  endif  }

  ; SAC 3/4/16 - added logic to PREVENT rule override of PVRatedPower for 2016+ rulesets (since this no longer input, but simply toggled on/off) (tic #609)
  ; SAC 4/15/16 - further modified rule to blast user input PVRatedPower for any 2016+ model (as this is no longer an input and its presence screws up PV compliance credit) 
  ; LDH 8/22/16 - disabled blasting of PVRatedPwr as it is done under RULELIST "Force_2016PVCreditOn"
	"Force PVRatedPower to (sum of PVWatts inputs) when necessary to PVWDCSysTotal"  Proj:Action		= {	
;    if (IfValidAnd(StandardsVersion >= 2017) .AND. LocalStatus( PVRatedPower ) > 6)  
;    then	EvalRulelist( "ForceDefault_PVRatedPower" )  
;    else 
    if( IfValidAnd( StandardsVersion < 2017 ) .AND. 
        IfValidAnd( AllowDesignRating > 0.5 ) .AND. 
        IfValidAnd( DesignRatingCalcs > 0.5 ) )
    then	EvalRulelist( "Force_PVRatedPower_to_PVWDCSysTotal" )
    else	UNCHANGED  
;    endif 
    endif  }

;	"Set Proj:PVTabMsg"		Proj:PVTabMsg		= {	; if (IfValidAnd( AllowDesignRating < 0.5 )) then  "Compliance PV inputs available on the Analysis tab"
;																	; else if (IfValidAnd( DesignRatingCalcs < 0.5 )) then  "Additional PV inputs available here when Design Rating Calcs selected on the Analysis tab"
;																	if (IfValidAnd( AllowDesignRating > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs < 0.5 )) then  "Additional PV inputs available here when Design Rating Calcs selected on the Analysis tab"
;																	else  "  "  endif  } 


; SAC 4/2/15 - moved PV credit rules down here to evaluate AFTER the Proj:NumDwellingUnits dependency
   ;--------------------------------------------------------------------
   ; ProposedInput: Photovoltaic System Credit Rules
   ;--------------------------------------------------------------------
; mjb 1/12/15 - use lew CAClimateZoneCodeBase table for lookups
;	"Set Proj:PVGenerationRate (based on climate zone)"	Proj:PVGenerationRate	= {	if (ClimateZone > 0) then  CA13ClimateZoneDesignDay:PVRate( "ClimateZone", Proj:ClimateZone )  else  0  endif  }
;	"Set Proj:MaxPVPrelimCredit (based on climate zone)"	Proj:MaxPVPrelimCredit	= {	if (ClimateZone > 0) then  CA13ClimateZoneDesignDay:PVMax(  "ClimateZone", Proj:ClimateZone )  else  0  endif  }
	"Set Proj:PVGenerationRate (based on climate zone)"	Proj:PVGenerationRate	= {	if (ClimateZone > 0) then  CAClimateZoneCodeBase:PVRate( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:CompCodeBase )  else  0  endif  }
; KN 03/25/2015 Changed variable to sfPVMax in prep for expanding to MF with 2016 runs. Calcs still need to be redone to be % of total plus threshold values
	"Set Proj:MaxPVPrelimCredit (based on climate zone)"	Proj:MaxPVPrelimCredit	= {	if (ClimateZone > 0) then
																														if (IsMultiFamily < 0.5)
																														then  CAClimateZoneCodeBase:sfPVMax(  "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:CompCodeBase )
																														else  CAClimateZoneCodeBase:mfPVMax(  "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:CompCodeBase )  endif
																													else  0  endif  }

	"Set Proj:EnablePVCredit flag - whether or not a PV credit is available for this project"		; SAC 10/5/15		; SAC 12/18/15 - added logic to ignore StandardsVersion when RunID == DesignRating
				Proj:EnablePVCredit	= {	if (IfValidAnd( PVGenerationRate > 1 ) .AND. (IfValidAnd( StandardsVersion > 2014 ) .OR. IfValidAnd( RunID == "DesignRating" )) .AND.
															(Proj:RunScope == 1 .AND. Proj:IsAddAlone < 1)) then  1  else  0  endif  }

; SAC 3/2/16 - (tic #609)
; LDH 8/20/16 - (tic # 609)  added functionality to set PVCompCredit to 1 for 2013 if PV Rated power is >0.  This enables special feature reporting.  See 'SpeclFeatrs:PVSysCredit' 
	"Default Proj:PVCompCredit"	Proj:PVCompCredit		= {
    if ( IfValidAnd( StandardsVersion <= 2015 ) .AND. 
         EnablePVCredit > 0 .AND. 
         IfValidAnd( PVRatedPower > 0 ) )
    then 1
    else 0
    endif }


; LDH 8/2/16 - MOVED EnablePVCredit and PVRatedPower > 0 checks inside of Force_2016PVCreditOn Rules
	"Swap PV Credit inputs from PVRatedPower (kW dc) to PVCompCredit (toggle) (for 2016-)"  Proj:Action	= {	
    if( IfValidAnd(StandardsVersion >= 2017 ) .AND. 
        LocalStatus( PVRatedPower ) >= 6 )  
    then	EvalRulelist( "Force_2016PVCreditOn" )  
    else  UNCHANGED  
    endif  }

	"Default PVRatedPower to a high value ensuring PVCredit, when selected in 2016+"		; SAC 3/2/16 - (tic #609)
				Proj:PVRatedPower		= {	if (EnablePVCredit < 0.5 .OR. PVCompCredit < 0.5) then  0		; SAC 3/24/16 - added new logic to set to 0 when appropriate
													else if (IfValidAnd(StandardsVersion >= 2017) .AND. EnablePVCredit > 0 .AND. PVCompCredit > 0)
													then	1000  else  UNCHANGED  endif endif  }

	"Set Proj:PVDwellUnitSize"		Proj:PVDwellUnitSize		= {	if (IsMultiFamily < 0.5)  then  CondFloorArea
																					else if (IsMultiFamily > 0.5 .AND. IfValidAnd( NumDwellingUnits > 0.5 )) then  CondFloorArea / NumDwellingUnits
																					else  0  endif endif  }
	"Set Proj:PVDUSizeThreshold"	Proj:PVDUSizeThreshold	= {	if (IfValidAnd( CompCodeBase < 2016 )) then  1000000
																					else if (IsMultiFamily < 0.5)  then  2000  else  1000  endif endif  }
	"Set Proj:PVMinRatedPower[1]"	Proj:PVMinRatedPower[1]	= {	if (IfValidAnd( CompCodeBase < 2016 )) then  2
																					else	if (IsMultiFamily < 0.5)
																							then	2
																							else	1 * ValidOr( NumDwellingUnits, 1 )
																							endif  endif  }

	"Set Proj:PVMessage"			Proj:PVMessage		= {	if (EnablePVCredit > 0.5 .AND. AllowDesignRating > 0.5 .AND. DesignRatingCalcs > 0.5) then  " "  ; SAC 3/2/16 - PV pwr no longer listed here (tic #609), was: "(specify PV power on 'EDR' tab)"
																		else if (IfValidAnd(StandardsVersion < 2015))
																		then  "PV credit only available for 'Compliance 2015' (and later) projects."
																		else if (Proj:RunScope != 1 .OR. Proj:IsAddAlone > 0)
																		then	"PV system credit available only for New Construction projects."
																		else if (IfValidAnd(MaxPVPrelimCredit < 0.01))
																		then  "PV system credit not available for the selected building location."
																		else if (IfValidAnd( EnablePVCredit > 0 )==0)
																		then	"PV credit not available for this project."
																		else	" "  endif endif endif endif endif  }

	; SAC 3/24/16 - added to simplify PVRtdValMsg logic and also use in setting PVSysCreditMsg
	"Set Proj:PVMinRatedPwrRpt"	Proj:PVMinRatedPwrRpt	= {	if (EnablePVCredit < 0.5 .OR. PVCompCredit < 0.5 .OR. PVRatedPower <= 0) then  0
																					else if (IfValidAnd( ResultSummary[1]:PVMinRatedPower > 0 )) then   ResultSummary[1]:PVMinRatedPower
																					else if (IfValidAnd( PVMinRatedPower[2] > 0 )) then   PVMinRatedPower[2]		; PVMinRatedPower[2] calced DURING analysis
																					else if (IfValidAnd( PVMinRatedPower[1] > 0 )) then   PVMinRatedPower[1]		; generic, pre-analysis PVMinRatedPower
																					else  0  endif endif endif endif  }

	"Set Proj:PVRtdValMsg"		Proj:PVRtdValMsg	= {	if (IfValidAnd(StandardsVersion < 2017) .AND. IfValidAnd(EnablePVCredit > 0) .AND. IfValidAnd(StandardsVersion > 2014) .AND. IfValidAnd(PVRatedPower > 0) .AND. IfValidAnd(PVRatedPower < PVMinRatedPower[1]))
																		then  Format( "PV system credit offered only for systems w/ rated power >= %g kWdc.", PVMinRatedPower[1] )
																		else if (IfValidAnd(StandardsVersion >= 2017) .AND. IfValidAnd(EnablePVCredit > 0) .AND. IfValidAnd(PVCompCredit > 0))		; SAC 3/2/16 - (tic #609)
																		then	if (PVMinRatedPwrRpt > 0)
																				then	if (IfValidAnd( AllowDesignRating > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs > 0.5 ) .AND. PVWDCSysTotal > 0)
																						then	if (PVWDCSysTotal < PVMinRatedPwrRpt)
																								then	Format( "PV system entered on EDR tab (%g kWdc) must be increased to %g kWdc in order to qualify.", PVWDCSysTotal, PVMinRatedPwrRpt )
																								else	Format( "PV system entered on EDR tab (%g kWdc) is sufficient to qualify (minimum %g kWdc).", PVWDCSysTotal, PVMinRatedPwrRpt )
																								endif
																						else	Format( "Required minimum PV system size is %.1f kWdc.", PVMinRatedPwrRpt )
																						endif
																				else	" "  endif
																		else	" "  endif endif  }
												;						then	if (IfValidAnd( ResultSummary[1]:PVMinRatedPower > 0 ))
												;								then	if (IfValidAnd( AllowDesignRating > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs > 0.5 ) .AND. PVWDCSysTotal > 0)
												;										then	if (PVWDCSysTotal < ResultSummary[1]:PVMinRatedPower)
												;												then	Format( "PV system entered on EDR tab (%g kWdc) must be increased to %g kWdc in order to qualify.", PVWDCSysTotal, ResultSummary[1]:PVMinRatedPower )
												;												else	Format( "PV system entered on EDR tab (%g kWdc) is sufficient to qualify (minimum %g kWdc).", PVWDCSysTotal, ResultSummary[1]:PVMinRatedPower )
												;												endif
												;										else	Format( "Required minimum PV system size is %.1f kWdc.", ResultSummary[1]:PVMinRatedPower )
												;										endif
												;								else if (IfValidAnd( PVMinRatedPower[2] > 0 ))		; PVMinRatedPower[2] calced DURING analysis
												;								then  if (IfValidAnd( AllowDesignRating > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs > 0.5 ) .AND. PVWDCSysTotal > 0)
												;										then	if (PVWDCSysTotal < PVMinRatedPower[2])
												;												then	Format( "PV system entered on EDR tab (%g kWdc) must be increased to %g kWdc in order to qualify.", PVWDCSysTotal, PVMinRatedPower[2] )
												;												else	Format( "PV system entered on EDR tab (%g kWdc) is sufficient to qualify (minimum %g kWdc).", PVWDCSysTotal, PVMinRatedPower[2] )
												;												endif
												;										else	Format( "Required minimum PV system size = %g kWdc.", PVMinRatedPower[2] )
												;										endif
												;								else if (IfValidAnd( PVMinRatedPower[1] > 0 ))		; generic, pre-analysis PVMinRatedPower
												;								then  if (IfValidAnd( AllowDesignRating > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs > 0.5 ) .AND. PVWDCSysTotal > 0)
												;										then	if (PVWDCSysTotal < PVMinRatedPower[1])
												;												then	Format( "PV system entered on EDR tab (%g kWdc) must be increased to %g kWdc in order to qualify.", PVWDCSysTotal, PVMinRatedPower[1] )
												;												else	Format( "PV system entered on EDR tab (%g kWdc) is sufficient to qualify (minimum %g kWdc).", PVWDCSysTotal, PVMinRatedPower[1] )
												;												endif
												;										else	Format( "Required minimum PV system size = %g kWdc.", PVMinRatedPower[1] )
												;										endif
												;								else	" "  endif endif endif
												;						else	" "  endif endif  }

	"Set Proj:PVGenCredit"		Proj:PVGenCredit	= {	if (IfValidAnd(EnablePVCredit > 0) .AND. LocalStatus( PVRatedPower ) > 0)
																		then	if (IfValidAnd(PVRatedPower >= PVMinRatedPower[1])) then  PVGenerationRate * PVRatedPower
																				else  0  endif
																		else  0  endif  }
	"Init Proj:PVPrelimCredit"	Proj:PVPrelimCredit	= {	if (RunAbbrev .NE. "dr") then  0  else  UNCHANGED  endif  }
	"Init Proj:PVCredit[1]"		Proj:PVCredit[1]		= {	if (RunAbbrev .NE. "dr") then  0  else  UNCHANGED  endif  }
;  "debug PV credit 2"		Proj:Action = { PostWarning( "Initializing PV credit 2 in rulelist: ProposedInput...  --  for RunID: %s / RunAbbrev: %s", RunID, RunAbbrev )  }
	"Init Proj:PVCredit[2]"		Proj:PVCredit[2]		= {	if (RunAbbrev .NE. "dr") then  0  else  UNCHANGED  endif  }

	; SAC 5/23/16 - set /default EDRPVVerified flag (tic #671)
	"Set Proj:EDRPVVerified"	Proj:EDRPVVerified	= {	if (RunAbbrev == "dr") then  UNCHANGED		; do not reset during DRtg run
																			else if (IfValidAnd( StandardsVersion >= 2017 ) .AND. IfValidAnd( AllowDesignRating > 0.5 ) .AND.
																						IfValidAnd( DesignRatingCalcs > 0.5 ) .AND. IfValidAnd( PVWDCSysTotal >= PVMinRatedPwrRpt )) then  1  else  0  endif endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: Attic Rules (early subset)
   ;--------------------------------------------------------------------
; SAC 10/14/14 - now done as part of CeilingBelowAttic defaulting (above)
;   "Create Attic if one needed but not already present"		Proj:Action		= {	if (ComponentCount( Attic ) > 0.5) then  UNCHANGED
;																											else if (SumAll( CeilingBelowAttic:Area ) < 0.1) then  UNCHANGED
;																											else  EvalRulelist( "Create_Attic" )  endif endif  }

; SAC 11/3/14 - moved down below into 'Default_AtticAreas' rulelist
;	"Set Attic:FloorArea"				Attic:FloorArea			= {	SumRevRef( CeilingBelowAt;	"Set Attic:FloorAreaOverCond"		Attic:FloorAreaOverCond	= {	SumRevRef( CeilingBelowAttic:AtticZone, CeilingBelowAttic:AreaOverCond )  }

; SAC 4/14/15 - call subordinate rulelist to evaluate ALL Attic defaulting
	"Perform Attic defaulting"		Attic:Action	= {	EvalRulelist( "Default_Attic", 1 )  }

	
   ;--------------------------------------------------------------------
   ; ProposedInput: Dwelling Unit (incl. dwelling unit internal gain) Rules
   ;--------------------------------------------------------------------
	"Set Proj:AppliancesMsg"		Proj:AppliancesMsg	= {	if (IsMultiFamily < 0.5) then  " "
																				else  "Appliance fuel & usage data entered via buttons on Dwelling Units tab"  endif  }
	"Set Proj:IAQMsg"					Proj:IAQMsg				= {	if (IsMultiFamily < 0.5) then  " "
																				else  "IAQ (indoor air quality) data entered via buttons on Dwelling Units tab"  endif  }
; SAC 8/27/13 - added logic to ensure that we have VENTILATED attic space before allowing Cool Vent
;	"Set Proj:EnableClVent"			Proj:EnableClVent		= {	if (IsMultiFamily < 0.5 .AND. ComponentCount( Zone ) > 0.5 .AND. SumAll( Zone:CondClgBlwAtticArea ) > 0.1) then  1  else  0  endif  }
;	mjb	4/14/14	only add Cool Vent if floor area > 1000
; mjb 7/9/14   removed floor area limit since we want users to add a WHF in their design if they want to (just not in Std Design)
; SAC 7/11/14 - restored logic to ensure that there is at least SOME Zone:CondClgBlwAtticArea before enabling ClVent
	"Set Proj:EnableClVent"			Proj:EnableClVent		= {	if (IsMultiFamily < 0.5 .AND. ComponentCount( Zone ) > 0.5 .AND. ComponentCount( Attic ) > 0 .AND.
																						SumAll( Zone:CondClgBlwAtticArea ) > 0.1 .AND. SumAll( Attic:ClVentableArea ) > 0.1)
																				then  1  else  0  endif  }
;	"Set Zone:NeedStdClVent"		Zone:NeedStdClVent		= {	if (( Proj:RunScope == 2 .AND. Status = 3) .OR. (Proj:RunScope == 1 .AND. Proj:IsAddAlone > 0.5) ) then
;																							if (AdditionCFA > 1000) then 1 else 0 endif  
;																						else  0  endif   }

	"Check NeedStdClVent"			Proj:EnableClVent		= {	if ( IfValidAnd(MaxChild(Zone:NeedStdClVent) > 0.5)) then 1 else UNCHANGED endif	}
;	"debug"		Proj:Action	= {	PostWarning( "Proposed Input -- WHF:  EnableClVent = %g", EnableClVent )  }
 	"Set Proj:CoolVentMsg"			Proj:CoolVentMsg		= {	if (IsMultiFamily > 0.5) then  "Cooling ventilation (whole house fan) is not implemented for multi-family buildings"
																				else if (ComponentCount( Zone ) < 0.5 .OR. SumAll( Zone:CondClgBlwAtticArea ) < 0.1)
																				then  "One or more conditioned Zones with ceilings below attic must be defined to enable Cooling Ventilation"
																				else if (SumAll( Attic:ClVentableArea ) < 0.1)
																				then  "One or more ventilated Attics must be present to enable Cooling Ventilation"
																				else  " "  endif endif endif  }

  ; SAC 12/31/15 - new properties added to enable user specification of reduced attic relief free vent area (tic 596) - not used for ClVentOption = CFI (HVACSys)
	"Default Proj:UnitClVentLowArea"		Proj:UnitClVentLowArea	= {	0  }		; Whether or not there is reduced attic relief vent free area
	"Set Proj:UnitClVentAreaMult"			Proj:UnitClVentAreaMult	= {	if (EnableClVent > 0.5 .AND. StandardsVersion < 2017 .AND. 
																								 UnitClVentLowArea > 0.5 .AND. (UnitClVentOption == 1 .OR. UnitClVentOption == 2)) then  0.5  else  1  endif  }
	"Set Proj:ClVentAirFlowMult"			Proj:ClVentAirFlowMult	= {	if (UnitClVentAreaMult == 0.5) then  0.93  else  1  endif  }

	; SAC 4/15/16 - added logic to ensure that user-defined Appl_RefrigUsage[1] is not retained when ApplRefrigEffMethod[1] is not set to '- specify -'
	"Blast user-input Appl_RefrigUsage[1] if needed"	Proj:Action	= {	if (LocalStatus( Appl_RefrigUsage[1] ) < 7 .OR. ApplRefrigEffMethod[1] == 2) then  UNCHANGED
																								else	EvalRulelist( "ForceDefault_Proj_RefrigUsage", 1 )  endif  }
; modified to match RESNET - mjb 11/09/15
	; SAC 4/14/16 - added T24-2016 default
	"Default Proj:Appl_RefrigUsage[1]"	Proj:Appl_RefrigUsage[1]	= {	if (Proj:DRtgRefRunID == 2014) then  637 + 18 * SimNumBedrooms
																								else if (Proj:IntGainsMethod <= 2013) then  669
																								else	454 + (37 * SimNumBedrooms)  endif endif  }		;	if (Local(ApplRefrigEffMethod[1]) == 1) then  669.  else UNCHANGED endif }

	"Default Proj:ExtLtg_PwrAdjMult"		Proj:ExtLtg_PwrAdjMult		= {	if (Proj:DRtgRefRunID == 2014) then  1.0
																								else	0.49  endif  }

	"Init Zone:Appl_RefrigGain"		Zone:Appl_RefrigGain		= {    0  }
	"Init Zone:Appl_DishGain"			Zone:Appl_DishGain		= {    0  }
	"Init Zone:Appl_CookGain[1]"		Zone:Appl_CookGain[1]	= {    0  }
	"Init Zone:Appl_CookGain[2]"		Zone:Appl_CookGain[2]	= {    0  }
	"Init Zone:Appl_CookGain[3]"		Zone:Appl_CookGain[3]	= {    0  }
	"Init Zone:Appl_WasherGain"		Zone:Appl_WasherGain		= {    0  }
	"Init Zone:ApplDryerGain[1]"		Zone:Appl_DryerGain[1]	= {    0  }
	"Init Zone:ApplDryerGain[2]"		Zone:Appl_DryerGain[2]	= {    0  }
	"Init Zone:ApplDryerGain[3]"		Zone:Appl_DryerGain[3]	= {    0  }
	"Init Zone:ExtLtg_Gain"				Zone:ExtLtg_Gain			= {    0  }

	"Set Zone:CondApplArea"				Zone:CondApplArea			= {	if (Local(Type) == 1 .OR. Local(Type) == 2) then  Local(FloorArea)  else  0  endif  }
	"Set Proj:ApplRefrigZone[1]"		Proj:ApplRefrigZone[1]	= {	if (ComponentCount( Zone ) > 0) then  MaxAllComp( Zone:CondApplArea )  else  UNDEFINED  endif }
	"Set Proj:ApplDishZone[1]"			Proj:ApplDishZone[1]		= {	if (ComponentCount( Zone ) > 0) then  MaxAllComp( Zone:CondApplArea )  else  UNDEFINED  endif }
	"Set Proj:ApplCookZone[1]"			Proj:ApplCookZone[1]		= {	if (ComponentCount( Zone ) > 0) then  MaxAllComp( Zone:CondApplArea )  else  UNDEFINED  endif }
	"Set Proj:ApplWasherZone[1]"		Proj:ApplWasherZone[1]	= {	if (ComponentCount( Zone ) > 0) then  MaxAllComp( Zone:FloorArea )     else  UNDEFINED  endif }
	"Set Proj:ApplDryerZone[1]"		Proj:ApplDryerZone[1]	= {	if (ComponentCount( Zone ) > 0) then  MaxAllComp( Zone:FloorArea )     else  UNDEFINED  endif }
	"Set Proj:ExtGainZone"				Proj:ExtGainZone   		= {	if (ComponentCount( Zone ) > 0) then  MaxAllComp( Zone:FloorArea )     else  UNDEFINED  endif }

	;	1 = electricity, 2 = gas, 3 = other
	"Set Proj:ApplCookFuel[1]"			Proj:ApplCookFuel[1]		= { if (Local(Fuel_HaveNatGas) == 0) then 1 else 2 endif }	; SAC 11/9/15
	"Set Proj:ApplDryerFuel[1]"		Proj:ApplDryerFuel[1]	= { if (Local(Fuel_HaveNatGas) == 0) then 1 else 2 endif }
	"Set Proj:Appl_HaveRefrig[1]"		Proj:Appl_HaveRefrig[1]	= { 1 }
	"Set Proj:Appl_HaveDish[1]"		Proj:Appl_HaveDish[1]	= { 1 }
	"Set Proj:Appl_HaveCook[1]"		Proj:Appl_HaveCook[1]	= { 1 }
	"Set Proj:Appl_HaveWasher[1]"		Proj:Appl_HaveWasher[1]	= { 1 }
	"Set Proj:Appl_HaveDryer[1]"		Proj:Appl_HaveDryer[1]	= { 1 }

	"Default Dwelling Unit Data"		Proj:Action	= {	if (IsMultiFamily < 0.5)
																		then  EvalRulelist( "Default_DwellingUnitData_SFam" )
																		else	EvalRulelist( "Default_DwellingUnitData" )  endif  }

	; SAC 4/15/16 - added logic to ensure that user-defined Appl_DishUsage[1] is not retained when ApplDishUsageMethod[1] is not set to '- specify -'
	"Blast user-input Appl_DishUsage[1] if needed"		Proj:Action	= {	if (LocalStatus( Appl_DishUsage[1] ) < 7 .OR. ApplDishUsageMethod[1] == 2) then  UNCHANGED
																								else	EvalRulelist( "ForceDefault_Proj_DishUsage", 1 )  endif  }
; SAC 12/28/15 - revised logic to use SimNumBedrooms in place of NumBedrooms to prevent use of existing bedroom counts in Addition Alone analyses
; modified to match RESNET - mjb 11/09/15
	; SAC 4/13/16 - modified for T24-2016
	"Default Proj:Appl_DishUsage[1]"		Proj:Appl_DishUsage[1]		= {	if (IsMultiFamily > 0.5 .OR. Appl_HaveDish[1] < 0.5) then  0
																					;			else if (ApplDishUsageMethod[1] == 1 .AND. NumDwellingUnits[1] > 0) then		- default using this logic even if ApplDishUsageMethod[1] != 1
																								else if (NumDwellingUnits[1] > 0)
																								then	if (Proj:DRtgRefRunID == 2014)
																										then  switch (SimNumBedrooms / NumDwellingUnits[1])
			                                                                              case 0: 78		case 1: 109		case 2: 140		case 3: 171		case 4: 202
         			                                                                   	case 5: 233		case 6: 264		case 7: 295		case 8: 326		case 9: 357
																													default: 109	endswitch
																										else if (Proj:IntGainsMethod <= 2013)
																										then	switch (SimNumBedrooms / NumDwellingUnits[1])
																													case 0: 90		case 1: 90		case 2: 126		case 3: 126		case 4: 126
																													case 5: 145		case 6: 145		case 7: 174		case 8: 174		case 9: 174
																													default: 203	endswitch
																										else	0.14507		; kWh/gal (for T24-2016 gains)
																										endif endif
																								else  0  endif endif  }
	"Set Proj:Appl_DishUsageUnits"	Proj:Appl_DishUsageUnits	= {	if (Proj:IntGainsMethod > 2013) then  "kWh/gal"  else  "kWh/yr"  endif  }

; modified to match RESNET - mjb 11/09/15
	; SAC 4/13/16 - modified for T24-2016
	"Set Proj:AvgLtgGainPerCFA (non-dwelling unit)"		Proj:AvgLtgGainPerCFA	= {
						if (IsMultiFamily > 0.5) then  UNCHANGED
						else if (CondFloorArea < 0.1) then  0
						else if (Proj:DRtgRefRunID == 2014)
						then	(455. + 0.8   * CondFloorArea) * (Ltg_FracPort + ((1-Ltg_FracPort) * Ltg_PwrAdjMult)) / 365 / CondFloorArea
						else if (Proj:IntGainsMethod <= 2013)
						then	(214. + 0.601 * CondFloorArea) * (Ltg_FracPort + ((1-Ltg_FracPort) * Ltg_PwrAdjMult)) / 365 / CondFloorArea
						else	; T24-2016
								if (Proj:RunScope == 1 .AND. Proj:IsAddAlone > 0.5)
								then	; New Cons, Addition Alone
										if (IfValidAnd( LtgCondFloorArea > 0 ))
										then	(100 + (0.1775 * LtgCondFloorArea)) * 3412/365 /
													(ValidOr( AddAloneExistArea, 0 ) + ValidOr( AddAloneAddedArea, 0 )) 
										else	0		; ERROR - addition alone project areas bogus
										endif
								else	; EAA or New Cons NOT Addition Alone
										if (IfValidAnd( CondFloorArea > 0 ))
										then	(100 + (0.1775 * LtgCondFloorArea)) * 3412/365 / CondFloorArea
										else	0		; ERROR - Proj:CondFloorArea bogus
										endif
								endif
						endif endif endif endif  }

; SAC 12/28/15 - revised logic to use SimNumBedrooms in place of NumBedrooms to prevent use of existing bedroom counts in Addition Alone analyses
	"Set Proj:AvgPplGainPerCFA (non-dwelling unit)"		Proj:AvgPplGainPerCFA	= {
						if (IsMultiFamily > 0.5) then  UNCHANGED
						else if (CondFloorArea < 0.1) then  0
						else	int( (1.75 + (0.4 * SimNumBedrooms) + 0.5) ) * (3900/0.573) / CondFloorArea  endif endif  }

; modified to match RESNET - mjb 11/09/15
	"Set Proj:AvgMscEGainPerCFA (non-dwelling unit)"		Proj:AvgMscEGainPerCFA	= {
						if (IsMultiFamily > 0.5) then  UNCHANGED
						else if (CondFloorArea < 0.1) then  0
						else if (Proj:DRtgRefRunID == 2014)
						then	(413. + (0.91  * CondFloorArea) + (69 * SimNumBedrooms)) / 365 / CondFloorArea
						else	(723. + (0.706 * CondFloorArea)) / 365 / CondFloorArea  endif endif endif  }

; adds in electricity component of Dryer and Cook when these are fueled by gas - mjb 11/10/15
	"Set Proj:AvgMscEGainPerCFA (non-dwelling unit)"		Proj:AvgMscEGainPerCFA	= {
						if (Proj:DRtgRefRunID != 2014 .OR. IsMultiFamily > 0.5) then  UNCHANGED
						else if (ApplDryerFuel[1] != 2) then UNCHANGED
						   else AvgMscEGainPerCFA + (41. + (11.7 * SimNumBedrooms)) / 365 / CondFloorArea  endif endif  }
	"Set Proj:AvgMscEGainPerCFA (non-dwelling unit)"		Proj:AvgMscEGainPerCFA	= {
						if (Proj:DRtgRefRunID != 2014 .OR. IsMultiFamily > 0.5) then  UNCHANGED
						else if (ApplCookFuel[1] != 2) then UNCHANGED
						   else AvgMscEGainPerCFA + (22.6 + (2.7 * SimNumBedrooms)) / 365 / CondFloorArea  endif endif  }

  ; refigerators - handled by assignment of zones, not 
	; modified to match RESNET - mjb 11/09/15
	; SAC 4/14/16 - revised for T24-2016
	"Set Zone:Appl_RefrigGain (non-dwelling unit)"		Proj:ApplRefrigZone[1]:Appl_RefrigGain	= {	if (IsMultiFamily > 0.5 .OR. Appl_HaveRefrig[1] < 0.5) then  UNCHANGED
																																	else	Appl_RefrigUsage[1] / 365  endif  }
	"Set Zone:Appl_DishGain (non-dwelling unit)"			Proj:ApplDishZone[1]:Appl_DishGain		= {	if (IsMultiFamily > 0.5 .OR. Appl_HaveDish[1]   < 0.5) then  UNCHANGED
																																	else if (Proj:IntGainsMethod <= 2013)
																																	then	Appl_DishUsage[1]   / 365.
																																	else	Appl_DishUsage[1]  endif endif  }
	"Set Zone:Appl_CookGain (non-dwelling unit)-Elec"	Proj:ApplCookZone[1]:Appl_CookGain[1]	= {	if (IsMultiFamily > 0.5 .OR. Appl_HaveCook[1]   < 0.5) then  UNCHANGED
																																	else if (Proj:DRtgRefRunID == 2014 .AND. ApplCookFuel[1] == 1)
																																	then	((331 + 39 * SimNumBedrooms))                 * 3413.   / 365.
																																	else if (Proj:IntGainsMethod <= 2013 .AND. ApplCookFuel[1] == 1)
																																	then	((31. + (.008 * CondFloorArea)) * 0.43 * 0.9) * 100000. / 365.
																																	else if (Proj:IntGainsMethod > 2013)
																																	then	if (ApplCookFuel[1] == 1)
																																			then	(213  + (26.3 * Proj:SimNumBedrooms)) * 3412 / 365		; elec cooking
																																			else	( 16  + ( 1.9 * Proj:SimNumBedrooms)) * 3412 / 365		; elec aux for gas cooking
																																			endif
																																	else	0  endif endif endif endif  }
	"Set Zone:Appl_CookGain (non-dwelling unit)-NGas"	Proj:ApplCookZone[1]:Appl_CookGain[2]	= {	if (IsMultiFamily > 0.5 .OR. Appl_HaveCook[1]   < 0.5 .OR. ApplCookFuel[1] != 2) then  UNCHANGED
																																	else if (Proj:DRtgRefRunID == 2014)
																																	then	((22.6 + 2.7 * SimNumBedrooms))               * 100000. / 365.
																																	else if (Proj:IntGainsMethod <= 2013)
																																	then	((31. + (.008 * CondFloorArea)) * 0.43 * 0.9) * 100000. / 365.
																																	else	(10 + (1.3 * Proj:SimNumBedrooms)) * 100000 / 365
																																	endif endif endif  }
	"Set Zone:Appl_CookGain (non-dwelling unit)-Othr"	Proj:ApplCookZone[1]:Appl_CookGain[3]	= {	if (IsMultiFamily > 0.5 .OR. Appl_HaveCook[1]   < 0.5 .OR. ApplCookFuel[1] != 3) then  UNCHANGED
																																	else if (Proj:DRtgRefRunID == 2014)
																																	then	((22.6 + 2.7 * SimNumBedrooms))               * 100000. / 365.
																																	else if (Proj:IntGainsMethod <= 2013)
																																	then	((31. + (.008 * CondFloorArea)) * 0.43 * 0.9) * 100000. / 365.
																																	else	0  endif endif endif  }
	"Set Zone:Appl_WasherGain (non-dwelling unit)"		Proj:ApplWasherZone[1]:Appl_WasherGain	= {	if (IsMultiFamily > 0.5 .OR. Appl_HaveWasher[1] < 0.5) then  UNCHANGED
																																	else if (Proj:DRtgRefRunID == 2014)
																																	then	(38 + 10 * SimNumBedrooms)       / 365.
																																	else if (Proj:IntGainsMethod <= 2013)
																																	then	(-64 + (0.108 * CondFloorArea))  / 365. 
																																	else	0.010067		; SAC 4/15/16 - T24-2016 washer gain
																																	endif endif endif  }
	; SAC 4/15/16 - revised for T24-2016 gains
	"Set Zone:Appl_DryerGain (non-dwelling unit)-Elc"	Proj:ApplDryerZone[1]:Appl_DryerGain[1] ={	if (IsMultiFamily > 0.5 .OR. Appl_HaveDryer[1]  < 0.5 .OR. (Proj:IntGainsMethod <= 2013 .AND. ApplDryerFuel[1] != 1)) then  UNCHANGED
																																	else if (Proj:DRtgRefRunID == 2014)
																																	then	(524 + 149 * SimNumBedrooms)    * 3413    / 365.
																																	else if (Proj:IntGainsMethod <= 2013)
																																	then	(13. + (0.01  * CondFloorArea)) * 100000. / 365.
																																	else	if (ApplDryerFuel[1] == 1) then  0.08509  else  0.004252  endif	; T24-2016
																																	endif endif endif  }
	"Set Zone:Appl_DryerGain (non-dwelling unit)-NGs"	Proj:ApplDryerZone[1]:Appl_DryerGain[2] ={	if (IsMultiFamily > 0.5 .OR. Appl_HaveDryer[1]  < 0.5 .OR. ApplDryerFuel[1] != 2) then  UNCHANGED
																																	else if (Proj:DRtgRefRunID == 2014)
																																	then	(18.8 + 5.3 * SimNumBedrooms)   * 100000. / 365.
																																	else if (Proj:IntGainsMethod <= 2013)
																																	then	(13. + (0.01  * CondFloorArea)) * 100000. / 365.
																																	else	299.91		; T24-2016
																																	endif endif endif  }
	"Set Zone:Appl_DryerGain (non-dwelling unit)-Oth"	Proj:ApplDryerZone[1]:Appl_DryerGain[3] ={	if (IsMultiFamily > 0.5 .OR. Appl_HaveDryer[1]  < 0.5 .OR. ApplDryerFuel[1] != 3) then  UNCHANGED
																																	else if (Proj:DRtgRefRunID == 2014)
																																	then	(18.8 + 5.3 * SimNumBedrooms)   * 100000. / 365.
																																	else if (Proj:IntGainsMethod <= 2013)
																																	then	(13. + (0.01  * CondFloorArea)) * 100000. / 365.
																																	else	UNCHANGED
																																	endif endif endif  }

	"Set Proj:ExtGainZone:ExtLtg_Gain"		Proj:ExtGainZone:ExtLtg_Gain	= {	if (Proj:DRtgRefRunID == 2014)
																										then	((192.5 + (0.05 * Proj:CondFloorArea)) * Proj:ExtLtg_PwrAdjMult) / 365
																										else	((-81. + (0.152 * Proj:CondFloorArea)) * Proj:ExtLtg_PwrAdjMult) / 365  endif  }


;	"Set Proj:AvgDwellingUnitCFA"		Proj:AvgDwellingUnitCFA		= {	if (IsMultiFamily > 0.5 .AND. NumDwellingUnits > 1.1) then  CondFloorArea / NumDwellingUnits
;																							else  CondFloorArea  endif  }
; ; SAC 4/15/13 - IN FUTURE?? perhaps map individual dwelling unit data entered @ Project level to individual Zones - in which case the following dwelling unti area would be customized
;	"Set Zone:DwellingUnitCFA"			Zone:DwellingUnitCFA			= {	Proj:AvgDwellingUnitCFA  }


   ;--------------------------------------------------------------------
   ; ProposedInput: Internal Gain Rules
   ;--------------------------------------------------------------------

; SAC 3/10/16 - apply RESNET mods from MJB
	"Set Proj:IntGain_MoMult[1] - Jan"		Proj:IntGain_MoMult[1]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	1.19 * AdditionCFAFrac  endif  }
	"Set Proj:IntGain_MoMult[2] - Feb"		Proj:IntGain_MoMult[2]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	1.11 * AdditionCFAFrac  endif  }
	"Set Proj:IntGain_MoMult[3] - Mar"		Proj:IntGain_MoMult[3]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	1.02 * AdditionCFAFrac  endif  }
	"Set Proj:IntGain_MoMult[4] - Apr"		Proj:IntGain_MoMult[4]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	0.93 * AdditionCFAFrac  endif  }
	"Set Proj:IntGain_MoMult[5] - May"		Proj:IntGain_MoMult[5]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	0.84 * AdditionCFAFrac  endif  }
	"Set Proj:IntGain_MoMult[6] - Jun"		Proj:IntGain_MoMult[6]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	0.80 * AdditionCFAFrac  endif  }
	"Set Proj:IntGain_MoMult[7] - Jul"		Proj:IntGain_MoMult[7]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	0.82 * AdditionCFAFrac  endif  }
	"Set Proj:IntGain_MoMult[8] - Aug"		Proj:IntGain_MoMult[8]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	0.88 * AdditionCFAFrac  endif  }
	"Set Proj:IntGain_MoMult[9] - Sep"		Proj:IntGain_MoMult[9]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	0.98 * AdditionCFAFrac  endif  }
	"Set Proj:IntGain_MoMult[10] - Oct"		Proj:IntGain_MoMult[10]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	1.07 * AdditionCFAFrac  endif  }
	"Set Proj:IntGain_MoMult[11] - Nov"		Proj:IntGain_MoMult[11]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	1.16 * AdditionCFAFrac  endif  }
	"Set Proj:IntGain_MoMult[12] - Dec"		Proj:IntGain_MoMult[12]	= {	if (Proj:DRtgRefRunID == 2014)
																								then	1.0  * AdditionCFAFrac
																								else	1.21 * AdditionCFAFrac  endif  } 

	"Default Proj:Ltg_DefaultDaySch based on library entry (if not already defined)"
			Proj:Ltg_DefaultDaySch	= {	if (LocalStatus( Ltg_DefaultDaySch ) > 0) then  UNCHANGED
													else  RuleLibrary( SchDay, "CARes2013 InsLighting Hrly" )  endif  }
	"Default Proj:Ppl_DefaultDaySch based on library entry (if not already defined)"
				Proj:Ppl_DefaultDaySch	= {	if (LocalStatus( Ppl_DefaultDaySch ) > 0) then  UNCHANGED
										else RuleLibrary( SchDay, "CARes2013 Occupancy Hrly" ) endif	}
	"Default Proj:Eqp_DefaultDaySch based on library entry (if not already defined)"
				Proj:Eqp_DefaultDaySch	= {	if (LocalStatus( Eqp_DefaultDaySch ) > 0) then  UNCHANGED
										else RuleLibrary( SchDay, "CARes2013 Equipment Hrly" ) endif	}
	"Default Proj:ExtLtg_DefaultDaySch based on library entry (if not already defined)"
			Proj:ExtLtg_DefaultDaySch	= {	if (LocalStatus( ExtLtg_DefaultDaySch ) > 0) then  UNCHANGED
													else  RuleLibrary( SchDay, "CARes2013 ExtLighting Hrly" )  endif  }

	"Set Zone:Ltg_Gain"		Zone:Ltg_Gain		= {	if (Proj:IntGainsMethod <= 2013) then  Proj:AvgLtgGainPerCFA
																	else if (IfValidAnd( CondFloorArea > 0 )==0) then  0
																	else if (Proj:IsMultiFamily > 0.5) then  SumChildren( DwellUnit:TotalLtgGain ) / CondFloorArea
																	else  ((100 + (0.1775 * Proj:LtgCondFloorArea)) * 3412/365) / Proj:CondFloorArea
																	endif endif endif  }
;	"Set Zone:Ltg_Gain"		Zone:Ltg_Gain		= {	if (Global( Proj:CondFloorArea ) > 0.1) then
;																		(((214. + 0.601 * DwellingUnitCFA) * 
;																		(Global( Proj:Ltg_FracPort ) + ((1-Global( Proj:Ltg_FracPort )) * Global( Proj:Ltg_PwrAdjMult ))) / 365) * 
;																		Global( Proj:NumDwellingUnits ) / Global( Proj:CondFloorArea ))
;																	else  0  endif  }

	"Default lighting profile (Zone:LtgDaySched)"
				Zone:LtgDaySched	= {	if (GlobalStatus( Proj:Ltg_DefaultDaySch ) > 0) then  Global( Proj:Ltg_DefaultDaySch )
												else  UNCHANGED  endif  }
	"Default people profile (Zone:PplDaySched)"
				Zone:PplDaySched	= {	if (GlobalStatus( Proj:Ppl_DefaultDaySch ) > 0) then  Global( Proj:Ppl_DefaultDaySch )
												else  UNCHANGED  endif  }
	"Default equipment profile (Zone:EqpDaySched)"
				Zone:EqpDaySched	= {	if (GlobalStatus( Proj:Eqp_DefaultDaySch ) > 0) then  Global( Proj:Eqp_DefaultDaySch )
												else  UNCHANGED  endif  }
	"Default exterior lighting profile (Zone:ExtLtgDaySched)"
				Zone:ExtLtgDaySched	= {	if (GlobalStatus( Proj:ExtLtg_DefaultDaySch ) > 0) then  Global( Proj:ExtLtg_DefaultDaySch )
												else  UNCHANGED  endif  }

;	"Set Zone:Ppl_PeoplePerUnit"	Zone:Ppl_PeoplePerUnit	= {	if ( Global( Proj:NumDwellingUnits) > 0) then
;																	1.75 + 0.4 * (Global( Proj:NumBedrooms ) / Global( Proj:NumDwellingUnits ))
;																else 0 endif }
;	"Set Zone:Ppl_GainPerCFA"		Zone:Ppl_GainPerCFA		= {	if (Global( Proj:CondFloorArea ) > 0.1) then
;																	((3900/0.573) * Local( Ppl_PeoplePerUnit ) * Global( Proj:NumDwellingUnits ) / Global( Proj:CondFloorArea))
;																else 0 endif }
	"Set Zone:Ppl_GainPerCFA"		Zone:Ppl_GainPerCFA		= {	Proj:AvgPplGainPerCFA  }

	"Default people profile (Zone:PplDaySched)"
				Zone:PplDaySched	= {	if (GlobalStatus( Proj:Ppl_DefaultDaySch ) > 0) then  Global( Proj:Ppl_DefaultDaySch )
												else  UNCHANGED  endif  }

	"Set Zone:Msc_GainPerCFA"		Zone:Msc_GainPerCFA		= { Proj:AvgMscEGainPerCFA  }
;	"Set Zone:Msc_GainPerCFA"		Zone:Msc_GainPerCFA		= { if (Global( Proj:CondFloorArea ) > 0.1) then
;																	((723. + (0.706 * Local( CondFloorArea )) * Global( Proj:NumDwellingUnits )) / 365.) / Global( Proj:CondFloorArea )
;																else 0 endif }

			;	Appliances
;	"Set Zone:HasApplRefrig"		Zone:HasApplRefrig		= { 0 }
;	"Set Zone:HasApplWasher"		Zone:HasApplWasher		= { 0 }
;	"Set Proj:ApplRefrigZone:HasApplRefrig"	Proj:ApplRefrigZone:HasApplRefrig = { if (LocalCompAssigned( ApplRefrigZone )) then 1
;																					else UNCHANGED endif }
;	"Set Proj:ApplWasherZone:HasApplWasher"	Proj:ApplWasherZone:HasApplWasher = { if (LocalCompAssigned( ApplWasherZone )) then 1
;																					else UNCHANGED endif }
;	"Set Proj:ExtGainZone:HasExtGain"	Proj:ExtGainZone:HasExtGain = { if (LocalCompAssigned( ExtGainZone )) then 1
;																								else UNCHANGED endif }

;	"Set Zone:Appl_DishGain"		Zone:Appl_DishGain		= { Global( Proj:Appl_DishUsage) * Global(Proj:NumDwellingUnits) / 365. }
;	"Set Zone:Appl_CookGain"		Zone:Appl_CookGain		= { ((31. + (.008 * Local(CondFloorArea))) * 0.43 * 0.9) * Global(Proj:NumDwellingUnits) * 100000. / 365. }
;	"Set Zone:Appl_WasherGain"		Zone:Appl_WasherGain	= { (-64 + 0.108 * Local(CondFloorArea)) * Global(Proj:NumDwellingUnits) / 365. }
;	"Set Zone:ApplDryerGain"		Zone:Appl_DryerGain		= { (13. + .01 * Local(CondFloorArea)) * Global(Proj:NumDwellingUnits) * 100000. / 365. }
	"Default equipment profile (Zone:EqpDaySched)"
				Zone:EqpDaySched	= {	if (GlobalStatus( Proj:Eqp_DefaultDaySch ) > 0) then  Global( Proj:Eqp_DefaultDaySch )
												else  UNCHANGED  endif  }

; SAC 5/13/13 - moved down below HVAC defaulting to access HVACHeat:ConstHtgSetpt
;   ;--------------------------------------------------------------------
;   ; ProposedInput: Thermostat Setpoint Rules
;   ;--------------------------------------------------------------------


   ;--------------------------------------------------------------------
   ; ProposedInput: Garage Rules
   ;--------------------------------------------------------------------
   "Create Garage if one not already present"		Proj:Action		= {	if (Local( HasGarage ) < 0.1 .OR. ComponentCount( Garage ) > 0.5) then  UNCHANGED
																								else  EvalRulelist( "Create_Garage" )  endif  }

	"Set Garage:Area"					Garage:Area				= {	if (Global( Proj:HasGarage ) > 0.1)	then  400		; based on wiki.answers.com
																				else  0  endif  }
	"Set Garage:Volume"				Garage:Volume			= {	if (Global( Proj:HasGarage ) > 0.1)	then  Local( Area ) * 10
																				else  0  endif  }
	; SAC 3/28/13 - expanded default logic
	"Default Garage:Bottom"			Garage:Bottom		= {	if (ChildCount( SlabFloor ) > 0) then  0.67
																			else if (ChildCount( FloorOverCrawl ) > 0) then  max( 0, (Global( CrawlSpace:AvgWallHeight ) - 0.67) )
																			else if (ChildCount( ExteriorFloor  ) > 0) then  max( 0, MinChild( ExteriorFloor:FloorZ ) )
																			else  0  endif endif endif  }

	; SAC 2/20/15 - for EAA addition window areas
	"Set Garage:IsEAAAdditionZone"	Garage:IsEAAAdditionZone	= {	0  }

	"Set Garage:TreeDescrip"		Garage:TreeDescrip	= {	if (Global( Proj:HasGarage ) > 0.1)
																				then  Format( "%s SqFt", FltToStr( Local( Area ) ) )
																				else  "activate on Project dialog, Building tab"  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: Construction Rules
   ;--------------------------------------------------------------------
	"Default Cons:Type"		Cons:Type = {	switch( Local( CanAssignTo ) )
															case  0 :	 0		; Exterior Walls -> Wood Framed Wall
															case 10 :	 0		; Interior Walls -> Wood Framed Wall
															case 20 :	 2		; Underground Walls -> Concrete / ICF / Brick
															case  1 :	10		; Attic Roofs
															case  2 :	10		; Cathedral Ceilings
															case  3 :	10		; Ceiling (blw attc)
															case  4 :	20		; Interior Floors
															case  5 :	20		; Exterior Floors
															case  6 :	10		; Interior Ceilings
															case  9 :	20		; Flrs over Crawlspc
															default : -1
														endswitch  }

	"Set Cons:LayerOrderLabel"		Cons:LayerOrderLabel = {	switch ( Local( CanAssignTo ) )
																					case  0 :  "(inside to outside)"		; Exterior Walls
																					case 10 :  "(inside to outside)" 	  ; Interior Walls
																					case 20 :  "(inside to outside)" 	  ; Underground Walls
																					default :  "(topmost to bottom)"
																;					default :  "(vertically top to bottom)"
																				endswitch  }

	"Set Cons:SecTypeLabel"		Cons:SecTypeLabel	  = {	switch( Local( CanAssignTo ) )
																			case  0 :	" "					; Exterior Walls
																			case 10 :	" "					; Interior Walls
																			case  1 :	"Roofing Type:"	; Attic Roofs
																			case  2 :	"Roofing Type:"	; Cathedral Ceilings
																			case  3 :	" "					; Ceiling (blw attc)
																			case  4 :	" "					; Interior Floors
																			case  5 :	" "		; Above:"				; Exterior Floors
																			case  6 :	" "					; Interior Ceilings
																			case  9 :	" "		; Above:"				; Flrs over Crawlspc
																			default : " "
																		endswitch  }
	"Set Cons:LayerLabels[1]"	Cons:LayerLabels[1] = {	switch( Local( CanAssignTo ) ) ; DD 2/12/14 - Allow for changing labels based upon construction type
																			case  0 :	"Inside Finish:"		; Exterior Walls
																			case 10 :	"Inside Finish:"		; Interior Walls
																			case 20 :	"Inside Finish:"		; Underground Walls
																			case  1 :	"Roofing:"				; Attic Roofs
																			case  2 :	"Roofing:"				; Cathedral Ceilings
																			case  3 :	"Attic Floor:"			; Ceiling (blw attc)
																			case  4 :	"Floor Surface:"		; Interior Floors
																			case  5 :	"Floor Surface:"		; Exterior Floors
																			case  6 :	"Floor Surface:"		; Interior Ceilings
																			case  9 :	"Floor Surface:"		; Flrs over Crawlspc
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[1]"		Cons:LayerVar[1] = {		switch( Local( CanAssignTo ) )
																			case  0 :	0		; Exterior Walls		-> InsideFinishLayer 
																			case 10 :	0		; Interior Walls		-> InsideFinishLayer
																			case 20 :	0		; Underground Walls	-> InsideFinishLayer
																			case  1 :	1		; Attic Roofs			-> RoofingLayer
																			case  2 :	1		; Cathedral Ceilings	-> RoofingLayer
																			case  3 :	2		; Ceiling (blw attc)	-> AtticFloorLayer
																			case  4 :	3		; Interior Floors		-> FloorSurfaceLayer
																			case  5 :	3		; Exterior Floors		-> FloorSurfaceLayer
																			case  6 :	3		; Interior Ceilings	-> FloorSurfaceLayer
																			case  9 :	3		; Flrs over Crawlspc -> FloorSurfaceLayer
																			default : -1
																		endswitch  }

	"Set Cons:LayerLabels[2]"	Cons:LayerLabels[2] = {	switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case  1 :	"Above Deck Insulation:"	; Attic Roofs
																			case  2 :	"Above Deck Insulation:"	; Cathedral Ceilings
																			case  3 :	"Cavity / Frame:"				; Ceiling (blw attc)
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25: "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default: "Concrete Fill:"			; Any Other
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25: "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default: "Concrete Fill:"			; Any Other
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25: "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default: "Concrete Fill:"			; Any Other
																							endswitch
																			case  9 :	switch( Type ) ; Flrs over Crawlspc
																								case 25: "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default: "Concrete Fill:"			; Any Other
																							endswitch
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[2]"		Cons:LayerVar[2] = {		switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsul2Layer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsul2Layer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsul2Layer
																								default: 0		; Any Other  -> SheathInsul2Layer
																							endswitch  
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsul2Layer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsul2Layer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsul2Layer
																								default: 0		; Any Other  -> SheathInsul2Layer
																							endswitch  
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsul2Layer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsul2Layer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsul2Layer
																								default: 0		; Any Other  -> SheathInsul2Layer
																							endswitch  
																			case  1 :	1		; Attic Roofs        -> AbvDeckInsulLayer
																			case  2 :	1		; Cathedral Ceilings -> AbvDeckInsulLayer
																			case  3 :	2		; Ceiling (blw attc) -> CavityLayer / FrameLayer
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25: 4	; Concrete/ICF/ Brick -> FurringInsul2Layer
																								default: 3	; Any Other				 -> FlrConcreteFillLayer
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25: 4	; Concrete/ICF/ Brick -> FurringInsul2Layer
																								default: 3	; Any Other				 -> FlrConcreteFillLayer
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25: 4	; Concrete/ICF/ Brick -> FurringInsul2Layer
																								default: 3	; Any Other				 -> FlrConcreteFillLayer
																							endswitch
																			case  9 :	switch( Type ) ; Flrs over Crawlspc
																								case 25: 4	; Concrete/ICF/ Brick -> FurringInsul2Layer
																								default: 3	; Any Other				 -> FlrConcreteFillLayer
																							endswitch
																			default : -1
																		endswitch  }

	"Set Cons:LayerLabels[3]"	Cons:LayerLabels[3] = {	switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: "Mass Layer:" ; Concrete/ ICF / Brick
																								case 3: "Mass Layer:" ; Hollow Unit Masonry
																								case 4: "Mass Layer:" ; Adobe / Strawbale / Log
																								case 5: "Panel Rated R (@ 75 F):" ; SIPS Wall
																								default: "Cavity / Frame:"	; Any Other
																							endswitch
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: "Mass Layer:" ; Concrete/ ICF / Brick
																								case 3: "Mass Layer:" ; Hollow Unit Masonry
																								case 4: "Mass Layer:" ; Adobe / Strawbale / Log
																								case 5: "Panel Rated R(@ 75 F):" ; SIPS Wall
																								default: "Cavity / Frame:"	; Any Other
																							endswitch
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: "Mass Layer:" ; Concrete/ ICF / Brick
																								case 3: "Mass Layer:" ; Hollow Unit Masonry
																								case 4: "Mass Layer:" ; Adobe / Strawbale / Log
																								case 5: "Panel Rated R(@ 75 F):" ; SIPS Wall
																								default: "Cavity / Frame:"	; Any Other
																							endswitch
																			case  1 :	"Roof Deck:"               ; Attic Roofs
																			case  2 :	"Roof Deck:"               ; Cathedral Ceilings
																			case  3 :	"Sheathing / Insulation:"	; Ceiling (blw attc)
																			case  4 :	switch( Type ) ; Interior Floors
																								case 24 : "" ; "SIPS Floor"
																								case 25 : "Mass Layer:" ; Concrete/ ICF / Brick
																								default : "Floor Deck:"					; all others
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 24 : "" ; "SIPS Floor"
																								case 25 : "Mass Layer:" ; Concrete/ ICF / Brick
																								default : "Floor Deck:"					; all others
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 24 : "" ; "SIPS Floor"
																								case 25 : "Mass Layer:" ; Concrete/ ICF / Brick
																								default : "Floor Deck:"					; all others
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 24 : "" ; "SIPS Floor"
																								case 25 : "Mass Layer:" ; Concrete/ ICF / Brick
																								default : "Floor Deck:"					; all others
																							endswitch
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[3]"		Cons:LayerVar[3] = {		switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> MassLayer
																								case 3: 4 ; Hollow Unit Masonry -> MassLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> MassLayer
																								default: 0		; Any Other  -> CavityLayer / FrameLayer
																							endswitch   
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> MassLayer
																								case 3: 4 ; Hollow Unit Masonry -> MassLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> MassLayer
																								default: 0		; Any Other  -> CavityLayer / FrameLayer
																							endswitch 
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> MassLayer
																								case 3: 4 ; Hollow Unit Masonry -> MassLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> MassLayer
																								default: 0		; Any Other  -> CavityLayer / FrameLayer
																							endswitch 
																			case  1 :	1		; Attic Roofs        -> RoofDeckLayer
																			case  2 :	1		; Cathedral Ceilings -> RoofDeckLayer
																			case  3 :	2		; Ceiling (blw attc) -> SheathInsulLayer
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : 4		; Concrete/ICF/ Brick -> MassLayer
																								default : 3		; Any Other				 -> FloorDeckLayer
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : 4		; Concrete/ICF/ Brick -> MassLayer
																								default : 3		; Any Other				 -> FloorDeckLayer
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : 4		; Concrete/ICF/ Brick -> MassLayer
																								default : 3		; Any Other				 -> FloorDeckLayer
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : 4		; Concrete/ICF/ Brick -> MassLayer
																								default : 3		; Any Other				 -> FloorDeckLayer
																							endswitch
																			default : -1
																		endswitch  }

	"Set Cons:LayerLabels[4]"	Cons:LayerLabels[4] = {	switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: "Insulation/Furring:" ; Concrete/ICF/ Brick
																								case 3: "Insulation/Furring:" ; Hollow Unit Masonry
																								case 4: "Insulation/Furring:" ; Adobe/Strawbale/Log
																								default: "Sheathing / Insulation:"	; Any Other
																							endswitch
																			case  1 :	"Cavity / Frame:"          ; Attic Roofs
																			case  2 :	"Cavity / Frame:"          ; Cathedral Ceilings
																			case  3 :	"Inside Finish:"				; Ceiling (blw attc)
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default : "Cavity / Frame:"		; Any Other
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default : "Cavity / Frame:"		; Any Other
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default : "Cavity / Frame:"		; Any Other
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : "Insulation/Furring:"	; Concrete/ICF/ Brick
																								default : "Cavity / Frame:"		; Any Other
																							endswitch
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[4]"		Cons:LayerVar[4] = {		switch( Local( CanAssignTo ) )
																			case  0 :	switch( Type ) ; Exterior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsulLayer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsulLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsulLayer
																								default: 0		; Any Other  -> SheathInsulLayer
																							endswitch  
																			case 10 :	switch( Type ) ; Interior Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsulLayer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsulLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsulLayer
																								default: 0		; Any Other  -> SheathInsulLayer
																							endswitch  
																			case 20 :	switch( Type ) ; Underground Walls 
																								case 2: 4 ; Concrete/ICF/ Brick -> FurringInsulLayer
																								case 3: 4 ; Hollow Unit Masonry -> FurringInsulLayer
																								case 4: 4 ; Adobe/Strawbale/Log -> FurringInsulLayer
																								default: 0		; Any Other  -> SheathInsulLayer
																							endswitch  
																			case  1 :	1		; Attic Roofs        -> CavityLayer / FrameLayer
																			case  2 :	1		; Cathedral Ceilings -> CavityLayer / FrameLayer
																			case  3 :	2		; Ceiling (blw attc) -> InsideFinishLayer
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : 4		; Concrete/ICF/ Brick -> FurringInsulLayer
																								default : 1		; Any Other				 -> CavityLayer / FrameLayer
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : 4		; Concrete/ICF/ Brick -> FurringInsulLayer
																								default : 1		; Any Other				 -> CavityLayer / FrameLayer
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : 4		; Concrete/ICF/ Brick -> FurringInsulLayer
																								default : 1		; Any Other				 -> CavityLayer / FrameLayer
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : 4		; Concrete/ICF/ Brick -> FurringInsulLayer
																								default : 1		; Any Other				 -> CavityLayer / FrameLayer
																							endswitch
																			default : -1
																		endswitch  }

	"Set Cons:LayerLabels[5]"	Cons:LayerLabels[5] = {	switch( Local( CanAssignTo ) )
																			case  0 :	"Exterior Finish:"			; Exterior Walls
																			case 10 :	"Other Side Finish:"			; Interior Walls
																			case 20 :	" "			         	   ; Underground Walls
																			case  1 :	"Inside Finish:"           ; Attic Roofs
																			case  2 :	"Sheathing / Insulation:"  ; Cathedral Ceilings
																			case  3 :	"none"							; Ceiling (blw attc)
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : "Ceiling Below Finish:"		; Concrete/ICF/ Brick
																								default : "Sheathing / Insulation:"		; Any Other
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : "Exterior Finish:"				; Concrete/ICF/ Brick
																								default : "Sheathing / Insulation:"		; Any Other
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : "Ceiling Below Finish:"		; Concrete/ICF/ Brick
																								default : "Sheathing / Insulation:"		; Any Other
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : "Exterior Finish:"				; Concrete/ICF/ Brick
																								default : "Sheathing / Insulation:"		; Any Other
																							endswitch
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[5]"		Cons:LayerVar[5] = {		switch( Local( CanAssignTo ) )
																			case  0 :	0		  ; Exterior Walls     -> WallExtFinishLayer
																			case 10 :	1	  	; Interior Walls     -> OtherSideFinishLayer
																			case 20 :	 -1		; Underground Walls  -> n/a
																			case  1 :   2		; Attic Roofs        -> InsideFinishLayer
																			case  2 :	3		; Cathedral Ceilings -> SheathInsulLayer
																			case  3 :  -1		; Ceiling (blw attc) -> 
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : 2		; Concrete/ICF/ Brick	-> InsideFinishLayer
																								default : 3		; Any Other					-> SheathInsulLayer
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : 4		; Concrete/ICF/ Brick	-> FlrExtFinishLayer
																								default : 3		; Any Other					-> SheathInsulLayer
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : 2		; Concrete/ICF/ Brick	-> InsideFinishLayer
																								default : 3		; Any Other					-> SheathInsulLayer
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : 4		; Concrete/ICF/ Brick	-> FlrExtFinishLayer
																								default : 3		; Any Other					-> SheathInsulLayer
																							endswitch
																			default : -1
																		endswitch  }

	"Set Cons:LayerLabels[6]"	Cons:LayerLabels[6] = {	switch( Local( CanAssignTo ) )
																			case  0 :	"none"                  	; Exterior Walls
																			case 10 :	"none"                  	; Interior Walls
																			case 20 :	"none"			              ; Underground Walls
																			case  1 :	"none"                  	; Attic Roofs
																			case  2 :	"Inside Finish:"         	; Cathedral Ceilings
																			case  3 :	"none"                  	; Ceiling (blw attc)
																			case  4 :	switch( Type ) ; Interior Floors
																								case 25 : "none"							; Concrete/ICF/ Brick
																								default : "Ceiling Below Finish:"	; Any Other
																							endswitch
																			case  5 :	switch( Type ) ; Exterior Floors
																								case 25 : "none"							; Concrete/ICF/ Brick
																								default : "Exterior Finish:"			; Any Other
																							endswitch
																			case  6 :	switch( Type ) ; Interior Ceilings
																								case 25 : "none"							; Concrete/ICF/ Brick
																								default : "Ceiling Below Finish:"	; Any Other
																							endswitch
																			case  9 :	switch( Type ) ; Floors Over Crawlspace
																								case 25 : "none"							; Concrete/ICF/ Brick
																								default : "Exterior Finish:"			; Any Other
																							endswitch
																			default : " "
																		endswitch  }
	"Set Cons:LayerVar[6]"		Cons:LayerVar[6] = {		switch( Local( CanAssignTo ) )
																			case  0 :  -1		; Exterior Walls     ->
																			case 10 :  -1		; Interior Walls     ->
																			case 20 :	 -1		; Underground Walls  -> n/a
																			case  1 :  -1		; Attic Roofs        -> 
																			case  2 :   0		; Cathedral Ceilings -> InsideFinishLayer
																			case  3 :  -1		; Ceiling (blw attc) -> 
																			case  4 :  switch( Type ) ; Interior Floors
																								case 25 : -1		; Concrete/ICF/ Brick
																								default :  0		; Any Other		-> InsideFinishLayer
																							endswitch
																			case  5 :  switch( Type ) ; Exterior Floors
																								case 25 : -1		; Concrete/ICF/ Brick
																								default :  1		; Any Other		-> FlrExtFinishLayer
																							endswitch
																			case  6 :  switch( Type ) ; Interior Ceilings
																								case 25 : -1		; Concrete/ICF/ Brick
																								default :  0		; Any Other		-> InsideFinishLayer
																							endswitch
																			case  9 :  switch( Type ) ; Floors Over Crawlspace
																								case 25 : -1		; Concrete/ICF/ Brick
																								default :  1		; Any Other		-> FlrExtFinishLayer
																							endswitch
																			default : -1
																		endswitch  }

; SAC 3/11/14 - moved these Mat assignments UP HERE from below since properties of these Mats are now referenced during defaulting
	"Import SoftWood Mat from library (if needed)"		Proj:LibMat_SoftWood		= {	if (LocalCompAssigned( LibMat_SoftWood )) then  UNCHANGED
																												else  RuleLibrary( Mat, "SoftWood" )  endif  }
	"Import Steel Mat from library (if needed)"			Proj:LibMat_Steel			= {	if (LocalCompAssigned( LibMat_Steel )) then  UNCHANGED
																												else  RuleLibrary( Mat, "Steel" )  endif  }
	"Import SIPSskin Mat from library (if needed)"		Proj:LibMat_SIPSskin		= {	if (LocalCompAssigned( LibMat_SIPSskin )) then  UNCHANGED
																												else  RuleLibrary( Mat, "SIPSskin" )  endif  }
	"Import Ceiling Ins Mat from library (if needed)"	Proj:LibMat_CeilingIns	= {	if (LocalCompAssigned( LibMat_CeilingIns )) then  UNCHANGED
																												else  RuleLibrary( Mat, "Ceiling Insul" )  endif  }
	"Import Other Ins Mat from library (if needed)"		Proj:LibMat_OtherIns		= {	if (LocalCompAssigned( LibMat_OtherIns )) then  UNCHANGED
																												else  RuleLibrary( Mat, "Other Insul" )  endif  }

	"Default Mat ConductivityQII"	Proj:Action	= {	EvalRulelist( "DefaultMatCondQII" )  }		; SAC 3/18/14
  ; SAC 5/7/12 - moved remaining Cons defaulting to separate rulelist to facilitate defaulting of Budget (and potentially other) models
	"Default Cons properties"		Cons:Action = {	EvalRulelist( "DefaultConsObject", 1 )  }
	; SAC 3/12/14 - consolidate rules to setup final cavity materials, LayerParams objects and call to ConsUFactoRes() call
	"Perform final Ufactor prep and call ConsUFactoRes()"		Proj:Action	= {	EvalRulelist( "SetupCons_UValue_All" )  }

;  ; SAC 11/1/12 - added rulelists to initialize & set Attic Edge properties
;  ; SAC 5/22/14 - revised rule to prevent attic edge modeling when RoofRise < 2/12
;	"Setup Cons Attic Edge properties"		Cons:Action = {	if (CanAssignTo == 3 .AND. ComponentCount( Attic ) > 0.5)		; Ceiling (blw attc)
;																	;			then  if (Attic:RoofPitch > 0.01)
;																				then  if (Attic:RoofPitch > 1.999/12)
;																						then	EvalRulelist( "SetupCons_AtticEdge_Set" , 1 )
;																						else	EvalRulelist( "SetupCons_AtticEdge_Init", 1 )  endif
;																				else			EvalRulelist( "SetupCons_AtticEdge_Init", 1 )  endif  }
; SAC 10/15/14 - mods moving attic edge properties to CeilingBelowAttic (to support multiple attics)
	"Setup Cons Attic Edge properties"		CeilingBelowAttic:Action = {	if (IfValidAnd( AtticZone:RoofPitch > 1.999/12 ))
																								then	EvalRulelist( "SetupCons_AtticEdge_Set" , 1 )
																								else	EvalRulelist( "SetupCons_AtticEdge_Init", 1 )  endif  }


; SAC 2/17/15 - revised logic and moved up here to enable access when implementing Cons error messaging
	"Sum Cons Surface Areas"	Cons:AssignedSurfaceArea = { switch ( CanAssignTo )
											case  0: SumRevRef( ExtWall:Construction, ExtWall:Area ) + SumRevRef( ExtWall:exConstruction, ExtWall:Area )
											case 10: SumRevRef( IntWall:Construction, IntWall:Area ) + SumRevRef( IntWall:exConstruction, IntWall:Area )
											case 20: SumRevRef( UndWall:Construction, UndWall:Area ) + SumRevRef( UndWall:exConstruction, UndWall:Area )
											case  1: SumRevRef( Attic:Construction, Attic:FloorArea ) + SumRevRef( Attic:exConstruction, Attic:FloorArea )
											case  2: SumRevRef( CathedralCeiling:Construction, CathedralCeiling:Area ) + SumRevRef( CathedralCeiling:exConstruction, CathedralCeiling:Area )
											case  3: SumRevRef( CeilingBelowAttic:Construction, CeilingBelowAttic:Area ) + SumRevRef( CeilingBelowAttic:exConstruction, CeilingBelowAttic:Area )
											case  6: SumRevRef( InteriorCeiling:Construction, InteriorCeiling:Area ) + SumRevRef( InteriorCeiling:exConstruction, InteriorCeiling:Area )
											case  4: SumRevRef( InteriorFloor:Construction, InteriorFloor:Area ) + SumRevRef( InteriorFloor:exConstruction, InteriorFloor:Area )
											case  5: SumRevRef( ExteriorFloor:Construction, ExteriorFloor:Area ) + SumRevRef( ExteriorFloor:exConstruction, ExteriorFloor:Area )
											case  9: SumRevRef( FloorOverCrawl:Construction, FloorOverCrawl:Area ) + SumRevRef( FloorOverCrawl:exConstruction, FloorOverCrawl:Area )
											default: 0
								     endswitch }

; SAC 2/17/15 - new error checking/reporting to catch scenarios where construction inputs cannot be simulated
	"Check for minimal Cons inputs"		Cons:InputErrMsg = { if (IfValidAnd( AssignedSurfaceArea > 1 )==0) then  UNDEFINED  else
				switch ( CanAssignTo )
					case  0: ; ExtWall
										if (Type == 0 .AND. InsideFinishLayer < 1 .AND. SheathInsul2Layer < 1 .AND. SheathInsulLayer < 1 .AND. WallExtFinishLayer < 1)
										then	"Cons invalid due to lack of wall inside or exterior finish layer."
										else	UNDEFINED  endif
					case 10: ; IntWall
										if (Type == 0 .AND. InsideFinishLayer < 1 .AND. SheathInsul2Layer < 1 .AND. SheathInsulLayer < 1 .AND. OtherSideFinishLayer < 1)
										then	"Cons invalid due to lack of wall inside or exterior finish layer."
										else	UNDEFINED  endif
					case 20: ; UndWall
										UNDEFINED
					case  1: ; Attic
										UNDEFINED
					case  2: ; CathedralCeiling
										UNDEFINED
					case  3: ; CeilingBelowAttic
										if (Type == 10 .AND. AtticFloorLayer < 1 .AND. SheathInsulLayer < 1 .AND. InsideFinishLayer < 1)
										then	"Cons invalid due to lack of inside finish or attic floor layer."
										else	UNDEFINED  endif
					case  6: ; InteriorCeiling
										if (Type == 10 .AND. FloorSurfaceLayer < 1 .AND. FloorDeckLayer < 1 .AND. SheathInsulLayer < 1 .AND. InsideFinishLayer < 1)
										then	"Cons invalid due to lack of ceiling inside finish, or floor deck or surface layer."
										else	UNDEFINED  endif
					case  4: ; InteriorFloor
										if (Type == 20 .AND. FloorSurfaceLayer < 1 .AND. FlrConcreteFillLayer < 1 .AND. FloorDeckLayer < 1 .AND. SheathInsulLayer < 1 .AND. InsideFinishLayer < 1)
										then	"Cons invalid due to lack of floor surface, fill, deck or finish layer."
										else	UNDEFINED  endif
					case  5: ; ExteriorFloor
										UNDEFINED
					case  9: ; FloorOverCrawl
										if (Type == 20 .AND. FloorSurfaceLayer < 1 .AND. FlrConcreteFillLayer < 1 .AND. FloorDeckLayer < 1 .AND. SheathInsulLayer < 1 .AND. FlrExtFinishLayer < 1)
										then	"Cons invalid due to lack of floor surface, fill, deck or finish layer."
										else	UNDEFINED  endif
					default:	UNDEFINED
				endswitch  endif  }
	"Set flag for displaying Cons InputErrMsg"	Cons:DisplayInpErrMsg = {	if (LocalStatus( InputErrMsg ) > 0)
																									then	if (strlen( InputErrMsg ) > 1) then  1
																											else  0  endif
																									else  0  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: ExtWall Rules
   ;--------------------------------------------------------------------

			;  ExtWall:Orientation,       BEMP_Sym,  - defaulted vis Symbol definitions
	"Default ExtWall:OrientationValue"
		ExtWall:OrientationValue 	= {	switch (Local( Orientation ))
														case  2 :   90  ; "Left"
														case  3 :  270  ; "Right"
														case  4 :  180  ; "Back"
														default :    0  ; Front or -specify-
													endswitch  }

			;  ExtWall:Area,              BEMP_Flt,  1, "ft2",  - no default

;	"Default ExtWall:CavityRValue from CTZ-based code requirements"
;		ExtWall:CavityRValue			= {	if (Global( Proj:ClimateZone ) < 0.5) then  UNDEFINED
;													else  ClimateZoneTable( Global( Proj:ClimateZone ), 3 )  endif  }

			;  ExtWall:SheathingVRValue,  BEMP_Sym,  - symbol defaulted
			;  ExtWall:FrameType,         BEMP_Sym,  - symbol defaulted
			;  ExtWall:FrameSpacing,      BEMP_Sym,  - symbol defaulted

	"Default ExtWall:Tilt (60 < wall < 180, 90-vertical, 180-floor, 0-ceiling)"
		ExtWall:Tilt 					= {	90  }

	"Default ExtWall:Absorptivity"		ExtWall:Absorptivity	= {	0.5  }	; SAC 1/15/13 - added default of 0.5 per GC issue #19

	"Set ExtWall:ParentType"				ExtWall:ParentType	= {	if (ParentComponentType() == "Zone")
																						then	if (Parent( Type ) < 10) then  1  else  0  endif
																						else if (ParentComponentType() == "Garage") then  2
																						else  0  endif endif  }

	"Default IsStdCondZoneWall" 	ExtWall:IsStdCondZoneWall	= {	0  }		; SAC 2/11/14

	; SAC 2/20/15 - for EAA addition window areas
	"Set ExtWall:IsEAAAddZoneChild"	ExtWall:IsEAAAddZoneChild	= {	Parent( IsEAAAdditionZone )  }	; parent could be Zone or Garage


   ;--------------------------------------------------------------------
   ; ProposedInput: IntWall Rules
   ;--------------------------------------------------------------------

			;  IntWall:Area,              BEMP_Flt,  1, "ft2",  - no default

;	"Default IntWall:Construction"
;		IntWall:Construction 	= {	RuleLibrary( Cons, "Interior Wall Cons (BT95)" )  }

	; SAC 10/1/13 - address backward compatibility for OutsideDiffUnit property - take its value and set corresponding properties for its replacement, then flag this property as undefined
	"Backward compat for IntWall:OutsideDiffUnit"	IntWall:Action	= {	if (LocalStatus( OutsideDiffUnit ) < 5) then  UNCHANGED		; do nothing if user did NOT define this property
																								else	EvalRulelist( "BackwardCompat_IntWall_OutsideDiffUnit", 1 )  endif  }
	; SAC 10/1/13 - default new properties related to what is on the other side of this surface
	"Default IntWall:IsPartySurface"			IntWall:IsPartySurface		= {	0  }
	"Default IntWall:OtherSideModeled"		IntWall:OtherSideModeled	= {	if (Proj:IsMultiFamily > 0.5) then  1  else  0  endif  }		; SAC 10/9/13 - prevent selection of OtherSideModeled for SFam models
	"Set IntWall:PartyEdgeArea"				IntWall:PartyEdgeArea		= {	if (IsPartySurface > 0.5) then  Area  else  0  endif  }

	"Set IntWall:ParCndZnAdjGarArea"		IntWall:ParCndZnAdjGarArea	= {	if (Proj:HasGarage < 0.1 .OR. Area < 0.1) then  0
																								else if (ParentComponentType() == "Zone")
																								then	if (Parent( Type ) == 1 .AND. LocalCompAssigned( Outside ) == ComponentType( "Garage" ))
																										then  Area
																										else  0  endif
																								else  0  endif endif  }
	"Set IntWall:ParGarAdjCndZnArea"		IntWall:ParGarAdjCndZnArea	= {	if (Proj:HasGarage < 0.1 .OR. Area < 0.1) then  0
																								else if (ParentComponentType() == "Garage")
																								then	if (LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
																										then	if (Outside:Type < 10)		; => Type = conditioned, sleeping or living (NOT unconditioned)
																												then  Area
																												else  0  endif
																										else  0  endif
																								else  0  endif endif  }

; SAC 9/10/13 - added logic to ensure that walls between Cond Zones & Attic are properly designated as demising
	"Set IntWall:IsDemising"		IntWall:IsDemising	= {	if (LocalCompAssigned( Outside ) == 0) then  0
																				else if (ParentComponentType() == "Zone")
																				then	if (	LocalCompAssigned( Outside ) == ComponentType( "Garage" ) .AND.
																								Parent( Type ) < 10 ) then  1
																						else if (LocalCompAssigned( Outside ) == ComponentType( "Attic" ))
																						then	if (	(Parent( Type ) < 10 .AND. Outside:Type != 1 ) .OR.       ; conditioned zone / ventilated attic
																										(Parent( Type ) > 9  .AND. Outside:Type == 1) ) then  1   ; unconditioned zone / conditioned attic
																								else  0  endif
																						else if (LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
																						then	if (	(Parent( Type ) < 10 .AND. Outside:Type > 9 ) .OR.
																										(Parent( Type ) > 9  .AND. Outside:Type < 10) ) then  1
																								else  0  endif
																						else  0  endif endif endif
																				else if (ParentComponentType() == "Garage")
																				then	if (LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
																						then	if (Outside:Type < 10 ) then  1
																								else  0  endif
																						else  0  endif
																				else if (ParentComponentType() == "Attic")
																				then	if (	LocalCompAssigned( Outside ) == ComponentType( "Garage" ) .AND.  ; conditioned attic / garage
																								Parent( Type ) == 1 ) then  1
																						else if (LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
																						then	if (	(Parent( Type ) != 1 .AND. Outside:Type < 10) .OR.         ; ventilated attic / conditioned zone
																										(Parent( Type ) == 1 .AND. Outside:Type > 9 ) ) then  1    ; conditioned attic / unconditioned zone
																								else  0  endif
																						else if (LocalCompAssigned( Outside ) == ComponentType( "Attic" ))
																						then	if (	(Parent( Type ) != 1 .AND. Outside:Type == 1) .OR.         ; ventilated attic / conditioned attic
																										(Parent( Type ) == 1 .AND. Outside:Type != 1) ) then  1    ; conditioned attic / ventilated attic
																								else  0  endif
																						else  0  endif endif endif
																				else  0  endif endif endif endif  }
	"Set IntWall:DemisingArea"		IntWall:DemisingArea	= {	if (IsDemising < 0.5) then  0  else  Area  endif  }		; SAC 9/10/13


   ;--------------------------------------------------------------------
   ; ProposedInput: UndWall Rules
   ;--------------------------------------------------------------------

		;	UndWall:DepthBelowGrade    BEMP_Flt,  "Depth of bottom of wall below grade" 
		;  UndWall:Area               BEMP_Flt,  1, "ft2",  - no default

		;	UndWall:Orientation        BEMP_Sym,  - defaulted vis Symbol definitions
		;	UndWall:OrientationValue
		;	UndWall:Tilt


;   ;--------------------------------------------------------------------
;   ; ProposedInput: AtticRoof Rules
;   ;--------------------------------------------------------------------
;	
;			;  AtticRoof:Orientation,       BEMP_Sym,  - defaulted vis Symbol definitions
;	"Default AtticRoof:OrientationValue"
;		AtticRoof:OrientationValue 	= {	switch (Local( Orientation ))
;														case  2 :   90  ; "Left"
;														case  3 :  270  ; "Right"
;														case  4 :  180  ; "Back"
;														default :    0  ; Front or -specify-
;													endswitch  }
;
;			;  AtticRoof:Area,              BEMP_Flt,  1, "ft2",  - no default
;
;;	"Default AtticRoof:CavityRValue from CTZ-based code requirements"
;;		AtticRoof:CavityRValue			= {	if (Global( Proj:ClimateZone ) < 0.5) then  UNDEFINED
;;													else  ClimateZoneTable( Global( Proj:ClimateZone ), 3 )  endif  }
;
;			;  AtticRoof:SheathingVRValue,  BEMP_Sym,  - symbol defaulted
;			;  AtticRoof:FrameType,         BEMP_Sym,  - symbol defaulted
;			;  AtticRoof:FrameSpacing,      BEMP_Sym,  - symbol defaulted
;
;	"Default AtticRoof:Tilt (ceiling <= 60, 90-vertical (60<wall<180), 180-floor)"
;		AtticRoof:Tilt 					= {	0  }
;
;			;  AtticRoof:Absorptivity,      BEMP_Flt,  - no default ?


   ;--------------------------------------------------------------------
   ; ProposedInput: CathedralCeiling Rules
   ;--------------------------------------------------------------------
    ;       CathedralCeiling:Area,              BEMP_Flt,  1, "ft2",              0, "",         0, "",             6010, "Ceiling area" 
    ;       CathedralCeiling:Construction,      BEMP_Obj,  1, "",                 0, "Cons",     2, "CanAssignTo",  6012, "Construction assembly" 
	"Default CathedralCeiling:RoofRise"		CathedralCeiling:RoofRise	= {	5 }
	"Set CathedralCeiling:RoofPitch"		CathedralCeiling:RoofPitch	= {	RoofRise / 12  }
	"Set CathedralCeiling:RoofTilt"			CathedralCeiling:RoofTilt	= {	if (RoofPitch == 0) then  0
																			else  atan( RoofPitch ) * 180 / 3.14159265  endif  }
	"Set CathedralCeiling:SteepSlope"		CathedralCeiling:SteepSlope	= {	if (RoofRise > 2) then  1  else  0  endif  }

	; SAC 9/23/15 - properties used to setup 2016 standard design roof constructions based on roof pitch
	"Set CathedralCeiling:SteepRoofArea"	CathedralCeiling:SteepRoofArea	= {	if (IfValidAnd( Area > 0.1 ) .AND. IfValidAnd( SteepSlope > 0.5 )) then  Area  else  0  endif  }
	"Set CathedralCeiling:FlatRoofArea"		CathedralCeiling:FlatRoofArea		= {	if (IfValidAnd( Area > 0.1 ) .AND. IfValidAnd( SteepSlope < 0.5 )) then  Area  else  0  endif  }

			;  CathedralCeiling:Orientation,       BEMP_Sym,  - defaulted vis Symbol definitions
	"Default CathedralCeiling:OrientationValue"
		CathedralCeiling:OrientationValue 	= {	switch (Local( Orientation ))
														case  2 :   90  ; "Left"
														case  3 :  270  ; "Right"
														case  4 :  180  ; "Back"
														default :    0  ; Front or -specify-
													endswitch  }

  ; SAC 1/11/13 - revised RoofSolReflect defaulting
	"Default CathedralCeiling:RoofSolReflect"		CathedralCeiling:RoofSolReflect	= {	0.1  }
	"Default CathedralCeiling:RoofEmiss"			CathedralCeiling:RoofEmiss			= {	0.85  }

	; SAC 2/20/15 - for EAA addition window areas
	"Set CathedralCeiling:IsEAAAddZoneChild"	CathedralCeiling:IsEAAAddZoneChild	= {	Parent( IsEAAAdditionZone )  }	; parent could be Zone or Garage


   ;--------------------------------------------------------------------
   ; ProposedInput: InteriorCeiling Rules
   ;--------------------------------------------------------------------
    ;       InteriorCeiling:Area,                BEMP_Flt,  1, "ft2",              0, "",         0, "",             6010, "Ceiling area" 
    ;       InteriorCeiling:Construction,        BEMP_Obj,  1, "",                 0, "Cons",     6, "CanAssignTo",  6012, "Construction assembly" 

	; SAC 4/28/15 - address backward compatibility for OutsideDiffUnit property - take its value and set corresponding properties for its replacement, then flag this property as undefined
	"Backward compat for InteriorCeiling:OutsideDiffUnit"	InteriorCeiling:Action	= {	if (LocalStatus( OutsideDiffUnit ) < 5) then  UNCHANGED		; do nothing if user did NOT define this property
																													else	EvalRulelist( "BackwardCompat_InteriorCeiling_OutsideDiffUnit", 1 )  endif  }
   ;	EM 4/9/15 
    "Default InteriorCeiling:IsPartySurface"			InteriorCeiling:IsPartySurface		= {	0  }
	"Default InteriorCeiling:OtherSideModeled"		InteriorCeiling:OtherSideModeled	= {	if (Proj:IsMultiFamily > 0.5) then  1  else  0  endif  }		; prevent selection of OtherSideModeled for SFam models
	"Set InteriorCeiling:PartyEdgeArea"				InteriorCeiling:PartyEdgeArea		= {	if (IsPartySurface > 0.5) then  Area  else  0  endif  }


	"Set InteriorCeiling:ParGarAdjCndZnArea"	InteriorCeiling:ParGarAdjCndZnArea	= {	if (Proj:HasGarage < 0.1 .OR. Area < 0.1) then  0
																													else if (ParentComponentType() == "Garage")
																													then	if (LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
																															then	if (Outside:Type < 10)		; => Type = conditioned, sleeping or living (NOT unconditioned)
																																	then  Area
																																	else  0  endif
																															else  0  endif
																													else  0  endif endif  }

; SAC 11/21/14 - added logic to ensure that ceilings between Cond Zones & Attic are properly designated as demising
	"Set InteriorCeiling:IsDemising"		InteriorCeiling:IsDemising	= {
								if (LocalCompAssigned( Outside ) == 0) then  0
								else if (ParentComponentType() == "Zone")
								then	if (	LocalCompAssigned( Outside ) == ComponentType( "Garage" ) .AND.
												Parent( Type ) < 10 ) then  1
										else if (LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
										then	if (	(Parent( Type ) < 10 .AND. Outside:Type > 9 ) .OR.
														(Parent( Type ) > 9  .AND. Outside:Type < 10) ) then  1
												else  0  endif
										else  0  endif endif
								else if (ParentComponentType() == "Garage")
								then	if (LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
										then	if (Outside:Type < 10 ) then  1
												else  0  endif
										else  0  endif
								else  0  endif endif endif  }
	"Set InteriorCeiling:DemisingArea"		InteriorCeiling:DemisingArea	= {	if (IsDemising < 0.5) then  0  else  Area  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: SlabFloor Rules
   ;--------------------------------------------------------------------
    ;       SlabFloor:Area                BEMP_Flt,  1, "ft2",              0, "",         0, "",             6010, "Floor area" 
    ;       SlabFloor:Perimeter           BEMP_Flt,  1, "ft",               0, "",         0, "",             6012, "Length of the slab perimeter measured at the outside of the plan edge" 

	"Default SlabFloor:Surface"				SlabFloor:Surface				= {	if (ParentComponentType() == "Garage") then  2   ; Exposed
																									else  0  endif  }		; "Default (80% carpeted/covered, 20% exposed)"

; SAC 10/23/14 - moved here from CSE sim prep rulelist to be accessible for Proposed reporting
   "Set SlabFloor:CarpetedFrac"			SlabFloor:CarpetedFrac	= {	switch ( Surface )
																								case  1 :	1.0    ; "Carpeted"                                    
																								case  2 :	0.0    ; "Exposed"                                     
																								default :	0.8	 ; "Default (80% carpeted/covered, 20% exposed)" 
																							endswitch  }

  ; SAC 6/6/13 - added HeatedSlab property (default to 0) and ALSO modified the EdgeInsulation default to be whatever HeatedSlab is set to
	"Default SlabFloor:HeatedSlab"			SlabFloor:HeatedSlab			= {	0  }
	"Default SlabFloor:EdgeInsulation"		SlabFloor:EdgeInsulation	= {	HeatedSlab  }	; was: 0  }
;	"Default SlabFloor:EdgeInsulRValue"		SlabFloor:EdgeInsulRValue  = {	0  }
;	"Default SlabFloor:EdgeInsulDepth"		SlabFloor:EdgeInsulDepth 	= {   0  }

	; SAC 1/8/13 - added defaulting of EdgeInsulOption based on user-defined EdgeInsulRValue and/or EdgeInsulDepth
	"Default SlabFloor:EdgeInsulOption"
		SlabFloor:EdgeInsulOption	= {	if (LocalStatus( EdgeInsulDepth ) < 7 .AND. LocalStatus( EdgeInsulRValue ) < 7)
													then	if (HeatedSlab > 0.5) then		5016     		; Std selection for heat slab is "R-5, 16 inches" - per GC issue #98
															else									5008  endif		; most generic default of "R-5, 8 inches"
													else if (LocalStatus( EdgeInsulDepth ) == 7 .AND. LocalStatus( EdgeInsulRValue ) == 7)
													then	if (EdgeInsulDepth >= 48)
															then	if (     EdgeInsulRValue >= 20) then  20048	; "R-20, 4 feet"
																	else if (EdgeInsulRValue >= 15) then  15048	; "R-15, 4 feet"
																	else if (EdgeInsulRValue >= 10) then  10048	; "R-10, 4 feet"
																	else if (EdgeInsulRValue >=  7) then   7048	; "R-7, 4 feet" 
																	else                                   5048	; "R-5, 4 feet" 
																	endif endif endif endif 
															else if (EdgeInsulDepth >= 24)
															then	if (     EdgeInsulRValue >= 10) then  10024	; "R-10, 2 feet"
																	else if (EdgeInsulRValue >=  7) then   7024	; "R-7, 2 feet" 
																	else                                   5024	; "R-5, 2 feet" 
																	endif endif 
															else if (EdgeInsulDepth >= 16)
															then	if (     EdgeInsulRValue >= 10) then  10016	; "R-10, 16 inches"
																	else if (EdgeInsulRValue >=  7) then   7016	; "R-7, 16 inches" 
																	else                                   5016	; "R-5, 16 inches" 
																	endif endif 
															else	if (     EdgeInsulRValue >= 10) then  10008	; "R-10, 8 inches"
																	else if (EdgeInsulRValue >=  7) then   7008	; "R-7, 8 inches" 
																	else                                   5008	; "R-5, 8 inches" 
																	endif endif
															endif endif endif
													else if (LocalStatus( EdgeInsulDepth ) == 7)
													then	if (     EdgeInsulDepth >= 48) then			 5048		; "R-5, 4 feet" 
															else if (EdgeInsulDepth >= 24) then			 5024		; "R-5, 2 feet" 
															else if (EdgeInsulDepth >= 16) then			 5016		; "R-5, 16 inches" 
															else													 5008		; "R-5, 8 inches" 
															endif endif endif
													else if (LocalStatus( EdgeInsulRValue ) == 7)
													then	if (     EdgeInsulRValue >= 20) then		20048		; "R-20, 4 feet"
															else if (EdgeInsulRValue >= 15) then		15048		; "R-15, 4 feet"
															else if (EdgeInsulRValue >= 10) then		10008 	; "R-10, 8 inches"
															else if (EdgeInsulRValue >=  7) then		 7008 	; "R-7, 8 inches" 
															else                                		 5008 	; "R-5, 8 inches" 
															endif endif endif endif
													else  5008      ; most generic default of "R-5, 8 inches"
													endif endif endif endif  }

	"Set SlabFloor:HasEdgeInsul"		SlabFloor:HasEdgeInsul	= {	if (EdgeInsulation > 0.1 .AND. EdgeInsulOption > 0) then  1  else  0  endif  }	; SAC 6/2/16 - tic #678

  ; SAC 6/7/13 - default EdgeInsulRValue & EdgeInsulDepth based on EdgeInsulation & EdgeInsulOption selections to facilitate HeatedSlab checks
	"Default SlabFloor:EdgeInsulDepth"		SlabFloor:EdgeInsulDepth	= {	if (EdgeInsulation < 0.5) then  0
																									else if (EdgeInsulOption > 0) then  mod( Local( EdgeInsulOption ), 1000 )
																									else  0   ; ???
																									endif endif  }
	"Default SlabFloor:EdgeInsulRValue"		SlabFloor:EdgeInsulRValue	= {	if (EdgeInsulation < 0.5 .OR. EdgeInsulDepth < 0.1) then  0
																									else if (EdgeInsulOption > 0) then  (EdgeInsulOption - EdgeInsulDepth) / 1000
																									else  0   ; ???
																									endif endif  }

	"Set SlabFloor:CarpetedArea"		SlabFloor:CarpetedArea	= {	switch (Surface)
																							case  0 :	Area * 0.8		; "Default (80% carpeted/covered, 20% exposed)"
																							case  1 :	Area				; "Carpeted"
																							case  2 :	0					; "Exposed"
																							default :	0
																						endswitch  }
	"Set SlabFloor:ExposedArea"		SlabFloor:ExposedArea	= {	switch (Surface)
																							case  0 :	Area * 0.2		; "Default (80% carpeted/covered, 20% exposed)"
																							case  1 :	0					; "Carpeted"
																							case  2 :	Area				; "Exposed"
																							default :	0
																						endswitch  }
	"Set SlabFloor:CondZnExposedArea"	SlabFloor:CondZnExposedArea	= {	if (ParentComponentType() != "Zone") then  0
																									else if (Parent( Type ) < 10) then  ExposedArea
																									else  0  endif endif  }
	"Set SlabFloor:CondZnArea"				SlabFloor:CondZnArea				= {	if (ParentComponentType() != "Zone") then  0
																									else if (Parent( Type ) < 10) then  Area
																									else  0  endif endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: ExteriorFloor Rules
   ;--------------------------------------------------------------------
    ;       ExteriorFloor:Type                BEMP_Sym,  1, "",                 0, "",         0, "",             6012, "Exterior floor type" 
    ;       ExteriorFloor:Area                BEMP_Flt,  1, "ft2",              0, "",         0, "",             6010, "Floor area" 
    ;       ExteriorFloor:FloorZ              BEMP_Flt,  1, "ft",               0,  0,                        6010, "Floor elevation (Z)"    ; SAC 1/26/13 - added reference to FloorZ
    ;       ExteriorFloor:Construction        BEMP_Obj,  1, "",                 0, "Cons",     4, "CanAssignTo",  6012, "Construction assembly" 

	"Set ExteriorFloor:MinFloorZ"					ExteriorFloor:MinFloorZ	= {	if (ParentComponentType() == "Zone") then  Parent( Bottom )  else  0  endif  }

;	"Set ExteriorFloor:AreaAboveExterior"		ExteriorFloor:AreaAboveExterior	= {	if (LocalCompAssigned( Construction ) == 0) then  0
;																												else if (LocalRef( Construction:FlrExtConditions ) == 0) then  Local( Area )	; "Exterior"
;																												else  0   endif endif  }
;	"Set ExteriorFloor:AreaAboveCrawl"			ExteriorFloor:AreaAboveCrawl		= {	if (LocalCompAssigned( Construction ) == 0) then  0
;																												else if (LocalRef( Construction:FlrExtConditions ) == 1) then  Local( Area )	; "Conventional Crawl Space"
;																												else  0   endif endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: FloorOverCrawl Rules
   ;--------------------------------------------------------------------
    ;       FloorOverCrawl:Area                BEMP_Flt,  1, "ft2",              0, "",         0, "",             6010, "Floor area" 
    ;       FloorOverCrawl:FloorZ              BEMP_Flt,  1, "ft",               0,  0,                        6010, "Floor elevation (Z)"    ; SAC 1/26/13 - added reference to FloorZ
    ;       FloorOverCrawl:Construction        BEMP_Obj,  1, "",                 0, "Cons",     4, "CanAssignTo",  6012, "Construction assembly" 

	"Set FloorOverCrawl:MinFloorZ"					FloorOverCrawl:MinFloorZ	= {	if (ParentComponentType() == "Zone") then  Parent( Bottom )  else  0  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: InteriorFloor Rules
   ;--------------------------------------------------------------------
    ;       InteriorFloor:Area                BEMP_Flt,  1, "ft2",              0, "",         0, "",             6010, "Floor area" 
    ;       InteriorFloor:FloorZ              BEMP_Flt,  1, "ft",               0,  0,                        6010, "Floor elevation (Z)"    ; SAC 1/26/13 - added reference to FloorZ
    ;       InteriorFloor:Construction        BEMP_Obj,  1, "",                 0, "Cons",     3, "CanAssignTo",  6012, "Construction assembly" 
    
	; SAC 4/28/15 - address backward compatibility for OutsideDiffUnit property - take its value and set corresponding properties for its replacement, then flag this property as undefined
	"Backward compat for InteriorFloor:OutsideDiffUnit"	InteriorFloor:Action	= {	if (LocalStatus( OutsideDiffUnit ) < 5) then  UNCHANGED		; do nothing if user did NOT define this property
																												else	EvalRulelist( "BackwardCompat_InteriorFloor_OutsideDiffUnit", 1 )  endif  }
     ;	EM 4/9/15 
    "Default InteriorFloor:IsPartySurface"			InteriorFloor:IsPartySurface		= {	0  }
	"Default InteriorFloor:OtherSideModeled"		InteriorFloor:OtherSideModeled	= {	if (Proj:IsMultiFamily > 0.5) then  1  else  0  endif  }		; prevent selection of OtherSideModeled for SFam models
	"Set InteriorFloor:PartyEdgeArea"				InteriorFloor:PartyEdgeArea		= {	if (IsPartySurface > 0.5) then  Area  else  0  endif  }


	"Set InteriorFloor:MinFloorZ"			InteriorFloor:MinFloorZ	= {	if (ParentComponentType() == "Zone") then  Parent( Bottom )  else  0  endif  }

	"Default InteriorFloor:Outside"		InteriorFloor:Outside = {	Parent( Name )  }

	"Set InteriorFloor:ParCndZnAdjGarArea"		InteriorFloor:ParCndZnAdjGarArea	= {	if (Proj:HasGarage < 0.1 .OR. Area < 0.1) then  0
																												else if (ParentComponentType() == "Zone")
																												then	if (Parent( Type ) == 1 .AND. LocalCompAssigned( Outside ) == ComponentType( "Garage" ))
																														then  Area
																														else  0  endif
																												else  0  endif endif  }
;	"Set InteriorFloor:ParGarAdjCndZnArea"		InteriorFloor:ParGarAdjCndZnArea	= {	if (Proj:HasGarage < 0.1 .OR. Area < 0.1) then  0
;																												else if (ParentComponentType() == "Garage")
;																												then	if (LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
;																														then	if (Outside:Type < 10)		; => Type = conditioned, sleeping or living (NOT unconditioned)
;																																then  Area
;																																else  0  endif
;																														else  0  endif
;																												else  0  endif endif  }

	"Set InteriorFloor:IsDemising"		InteriorFloor:IsDemising	= {
									if (LocalCompAssigned( Outside ) == 0) then  0
									else if (ParentComponentType() == "Zone")
									then	if (	LocalCompAssigned( Outside ) == ComponentType( "Garage" ) .AND.
													Parent( Type ) < 10 ) then  1
											else if (LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
											then	if (	(Parent( Type ) < 10 .AND. Outside:Type > 9 ) .OR.
															(Parent( Type ) > 9  .AND. Outside:Type < 10) ) then  1
													else  0  endif
											else  0  endif endif
									else if (ParentComponentType() == "Garage")
									then	if (LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
											then	if (Outside:Type < 10 ) then  1
													else  0  endif
											else  0  endif
									else  0  endif endif endif  }
	"Set InteriorFloor:DemisingArea"		InteriorFloor:DemisingArea	= {	if (IsDemising < 0.5) then  0  else  Area  endif  }		; SAC 9/10/13


   ;--------------------------------------------------------------------
   ; ProposedInput: UndFloor Rules
   ;--------------------------------------------------------------------

			;  UndFloor:Area,              BEMP_Flt,  1, "ft2",  - no default

	"Default UndFloor:Surface"				UndFloor:Surface				= {	if (ParentComponentType() == "Garage") then  2   ; Exposed
																									else  0  endif  }		; "Default (80% carpeted/covered, 20% exposed)"

; SAC 10/23/14 - moved here from CSE sim prep rulelist to be accessible for Proposed reporting
   "Set UndFloor:CarpetedFrac"			UndFloor:CarpetedFrac	= {	switch ( Surface )
																								case  1 :	1.0    ; "Carpeted"                                    
																								case  2 :	0.0    ; "Exposed"                                     
																								default :	0.8	 ; "Default (80% carpeted/covered, 20% exposed)" 
																							endswitch  }

	"Set UndFloor:CarpetedArea"		UndFloor:CarpetedArea		= {	ValidOr( Area, 0 ) *      ValidOr( CarpetedFrac, 0 )   }
	"Set UndFloor:ExposedArea"			UndFloor:ExposedArea			= {	ValidOr( Area, 0 ) * (1 - ValidOr( CarpetedFrac, 1 ))  }
	"Set UndFloor:CondZnExposedArea"	UndFloor:CondZnExposedArea	= {	if (ParentComponentType() != "Zone") then  0
																							else if (Parent( Type ) < 10) then  ExposedArea
																							else  0  endif endif  }
	"Set UndFloor:CondZnArea"			UndFloor:CondZnArea			= {	if (ParentComponentType() != "Zone") then  0
																							else if (Parent( Type ) < 10) then  Area
																							else  0  endif endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: Zone (inter-zone surface area) Rules
   ;--------------------------------------------------------------------

	"Set IntWall:InterCondZnArea"				IntWall:InterCondZnArea				= {
						if (ParentComponentType() == "Zone" .AND. LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
						then	if (Parent( Type ) < 10 .AND.	Outside:Type < 10 .AND. Parent( Name ) != Outside:Name)
								then  Area  else  0  endif
						else  0  endif  }

	"Set InteriorCeiling:InterCondZnArea"	InteriorCeiling:InterCondZnArea	= {
						if (ParentComponentType() == "Zone" .AND. LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
						then	if (Parent( Type ) < 10 .AND. Outside:Type < 10 .AND. Parent( Name ) != Outside:Name)
								then  Area  else  0  endif
						else  0  endif  }

	"Set InteriorFloor:InterCondZnArea"		InteriorFloor:InterCondZnArea		= {
						if (ParentComponentType() == "Zone" .AND. LocalCompAssigned( Outside ) == ComponentType( "Zone" ))
						then	if (Parent( Type ) < 10 .AND. Outside:Type < 10 .AND. Parent( Name ) != Outside:Name)
								then  Area  else  0  endif
						else  0  endif  }

	"Set Zone:InterCondZnArea"		Zone:InterCondZnArea		= {
						if (Type > 9) then  0
						else	SumChildren(         IntWall:InterCondZnArea ) +
								SumChildren( InteriorCeiling:InterCondZnArea ) +
								SumChildren(   InteriorFloor:InterCondZnArea ) +
								SumRevRef(         IntWall:Outside,         IntWall:InterCondZnArea ) +
								SumRevRef( InteriorCeiling:Outside, InteriorCeiling:InterCondZnArea ) +
								SumRevRef(   InteriorFloor:Outside,   InteriorFloor:InterCondZnArea )    endif  }

	"Set Zone:PartyEdgeArea"		Zone:PartyEdgeArea		= {	SumChildren( IntWall:PartyEdgeArea ) + SumChildren( InteriorFloor:PartyEdgeArea ) + SumChildren( InteriorCeiling:PartyEdgeArea )}


   ;--------------------------------------------------------------------
   ; ProposedInput: cseSURFACE Rules
   ;--------------------------------------------------------------------

			;            "sfType",            BEMP_Sym,  - symbol defaulted

			;            "UI_Con",            BEMP_Sym,  - symbol defaulted

;	"Set cseSURFACE:sfCon"
;		cseSURFACE:sfCon 		= {	Local( UI_Con )  }

			;            "sfArea",            BEMP_Flt,  1, "ft2",    - no default

	"Default cseSURFACE:sfTilt"
		cseSURFACE:sfTilt		= {	switch (Local( sfType ))
												case  1:  180    ; Floor
												case  3:    0    ; Ceiling
												default:   90    ; Wall or IntMass*
											endswitch  }

	"Default cseSURFACE:sfAzm"
		cseSURFACE:sfAzm		= {	if (Local( sfTilt ) != 0 .AND. Local( sfTilt ) != 180)
											then  0  else  UNDEFINED  endif  }

			;            "sfExAbs",           BEMP_Flt,  - no default ?

			;            "sfModel",           BEMP_Sym,  - symbol defaulted


   ;--------------------------------------------------------------------
   ; ProposedInput: WindowType Rules   - SAC 8/26/13
   ;--------------------------------------------------------------------
	; no default: WindowType:SpecMethod,        Default,   0,    1,   1,    1,  1,  1

	"Default WindowType:Area"		WindowType:Area		= {	if (SpecMethod == 2) then  UNDEFINED		; no default if SpecMthd = "Overall Window Area"
															else if (LocalStatus( Height ) < 2 .OR. LocalStatus( Width ) < 2) then  UNDEFINED
															else if (Local( Height ) > 0 .AND. Local( Width ) > 0)
															then  Local( Height ) * Local( Width )  else  UNDEFINED  endif endif endif  }

	"Default WindowType:Height"	WindowType:Height	= {	if (SpecMethod == 1 .OR. LocalStatus( Area ) < 2) then  UNDEFINED		; no default if SpecMthd = "Window Dimensions..."  (or is Area undefined)
															else if (Area > 0) then  sqrt( Area )
															else  UNDEFINED  endif endif  }
	"Default WindowType:Width"		WindowType:Width	= {	if (LocalStatus( Height ) < 2 .OR. LocalStatus( Area ) < 2) then  UNDEFINED
															else if (Area > 0 .AND. Height > 0) then  Area / Height
															else  UNDEFINED  endif endif  }
; mjb 1/12/15 - mods to use new CAClimateZoneCodeBase for code level lookups
	"Default WindowType:NFRCUfactor from CTZ-based code requirements"
		WindowType:NFRCUfactor	= {	if (Global( Proj:ClimateZone ) < 0.5) then  UNDEFINED
												else  CAClimateZoneCodeBase:WindowUfactor( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase )  endif  }

	"Default WindowType:NFRCSHGC from CTZ-based code requirements"
		WindowType:NFRCSHGC		= {	if (Global( Proj:ClimateZone ) < 0.5) then  UNDEFINED
												else  CAClimateZoneCodeBase:WindowSHGC( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase )  endif  }

	;  symbol default:   "ExteriorShade"

	"Default WindowType:ModelFinsOverhang"		WindowType:ModelFinsOverhang	= {	if (SpecMethod == 1) then  1  else  0  endif  }

	"Set WindowType:FinOverhangMsg"		WindowType:FinOverhangMsg	= {
				if (SpecMethod != 1) then	"Window spec. method must be set to 'Window Dimensions...' to view fin/overhang data"
				else if (LocalStatus( Height ) < 2 .OR. LocalStatus( Width ) < 2) then  "Window Height and Width must be specified to model fins/overhang"
				else if (Height <= 0 .OR. Width <= 0) then  "Window Height and Width must be > 0 in order to model fins/overhang"
				else if (ModelFinsOverhang < 0.5) then  "Window fin/overhang modeling is toggled off on main Window Data tab"
				else  UNDEFINED  endif endif endif endif  }
	"Set WindowType:ShowFinsOverhang"		WindowType:ShowFinsOverhang	= {	if (LocalStatus( FinOverhangMsg ) > 1) then  0  else  1  endif  }

	"Default WindowType:OverhangDepth"		WindowType:OverhangDepth 	= {	0  }
   "Default WindowType:OverhangDistUp"		WindowType:OverhangDistUp	= {   0  }
   "Default WindowType:OverhangExL"			WindowType:OverhangExL		= {   0  }
   "Default WindowType:OverhangExR"			WindowType:OverhangExR		= {   0  }
   "Default WindowType:OverhangFlap"		WindowType:OverhangFlap		= {   0  }
   "Default WindowType:LeftFinDepth"		WindowType:LeftFinDepth		= {   0  }
   "Default WindowType:LeftFinTopUp"		WindowType:LeftFinTopUp		= {   0  }
   "Default WindowType:LeftFinDistL"		WindowType:LeftFinDistL		= {   0  }
   "Default WindowType:LeftFinBotUp"		WindowType:LeftFinBotUp		= {   0  }
   "Default WindowType:RightFinDepth"		WindowType:RightFinDepth	= {   0  }
   "Default WindowType:RightFinTopUp"		WindowType:RightFinTopUp	= {   0  }
   "Default WindowType:RightFinDistR"		WindowType:RightFinDistR	= {   0  }
   "Default WindowType:RightFinBotUp"		WindowType:RightFinBotUp	= {   0  }


   ;--------------------------------------------------------------------
   ; ProposedInput: Win Rules   (Windows entered via UI)
   ;--------------------------------------------------------------------

	"Default Win:Multiplier"		Win:Multiplier			= {	1  }

	; Win:WinType,  - SAC 8/27/13 - added new assignment

	;	Win:SpecMethod,  1
	;	             1,    "Window Dimensions (required for fins/overhangs)"
	;	             2,    "Overall Window Area"
	"Default Win:SpecMethod"		Win:SpecMethod	= {	if (LocalCompAssigned( WinType )) then  WinType:SpecMethod  else  UNCHANGED  endif  }

	"Set Win:DefaultViaWinType"			Win:DefaultViaWinType	= {	if (LocalCompAssigned( WinType ))
																							then	if (SpecMethod == WinType:SpecMethod) then  1  else  0  endif
																							else  0  endif  }

	"Default Win:ModelFinsOverhang"		Win:ModelFinsOverhang	= {	if (DefaultViaWinType) then  WinType:ModelFinsOverhang
																							else if (SpecMethod == 1) then  1  else  0  endif endif  }

	"Set Win:FinOverhangMsg"		Win:FinOverhangMsg	= {
				if (SpecMethod != 1) then	"Window spec. method must be set to 'Window Dimensions...' to view fin/overhang data"
				else if (LocalStatus( Height ) < 2 .OR. LocalStatus( Width ) < 2) then  "Window Height and Width must be specified to model fins/overhang"
				else if (Height <= 0 .OR. Width <= 0) then  "Window Height and Width must be > 0 in order to model fins/overhang"
				else if (ModelFinsOverhang < 0.5) then  "Window fin/overhang modeling is toggled off on main Window Data tab"
				else  UNDEFINED  endif endif endif endif  }
	"Set Win:ShowFinsOverhang"		Win:ShowFinsOverhang	= {	if (LocalStatus( FinOverhangMsg ) > 1) then  0  else  1  endif  }

; SAC 1/13/14 - revised ruleset to leave FORCE height/width to be UNDEFINED when Win:SpecMethod = "Overall Window Area"
  ; SAC 8/29/13 - first round - just default Height/Width from WinType for SpecMethod = dimensions...
	"Default Win:Width"		Win:Width	= {	if (DefaultViaWinType)
															then	if (SpecMethod == 1 .AND. LocalStatus( WinType:Width ) > 0) then  WinType:Width
																	else  UNCHANGED  endif
															else  UNCHANGED  endif  }
	"Default Win:Height"		Win:Height	= {	if (DefaultViaWinType)
															then	if (SpecMethod == 1 .AND. LocalStatus( WinType:Height ) > 0) then  WinType:Height
																	else  UNCHANGED  endif
															else  UNCHANGED  endif  }

	"Force Win Area to UNDEFFINED when SpecMethod = 'Window Dimensions (...'"		Win:Action = {			; SAC 1/13/14
				if (SpecMethod == 1 .AND. LocalStatus( Area ) > 4) then  EvalRulelist( "ForceWinAreaToUndefined", 1 )  else  UNCHANGED  endif  }

	"Default Win:Area"		Win:Area		= {	if (SpecMethod == 1)
															then	if (LocalStatus( Height ) < 2 .OR. LocalStatus( Width ) < 2) then  UNDEFINED
																	else	Local( Height ) * Local( Width )  endif
															else if (DefaultViaWinType) then  WinType:Area
															else	UNDEFINED		; no default if SpecMthd = "Overall Window Area"
															endif endif  }

;	"Default Win:Width"		Win:Width	= {	if (SpecMethod == 2)
;															then	if (LocalStatus( Area ) < 2) then  UNDEFINED
;																	else  sqrt( (Area * Multiplier) )  endif
	"Default Win:Width"		Win:Width	= {	if (SpecMethod == 2) then  UNDEFINED
															else if (DefaultViaWinType) then  UNCHANGED   ; covered above
															else  UNDEFINED				; no default if SpecMthd = "Window Dimensions..."  (or is Area undefined)
															endif endif  }
;	"Default Win:Height"		Win:Height	= {	if (SpecMethod == 2)
;															then	if (LocalStatus( Area ) > 1 .AND. LocalStatus( Width ) > 1)
;																	then  if (Area > 0 .AND. Width > 0) then  (Area * Multiplier) / Width
;																			else  UNDEFINED  endif
;																	else if (LocalStatus( Area ) > 1) then  sqrt( (Area * Multiplier) )
;																	else  UNDEFINED  endif endif
	"Default Win:Height"		Win:Height	= {	if (SpecMethod == 2) then  UNDEFINED
															else if (DefaultViaWinType) then  UNCHANGED   ; covered above
															else  UNDEFINED				; no default if SpecMthd = "Window Dimensions..."  (or is Area undefined)
															endif endif  }
	"Overwrite Win Height/Width/Multiplier when SpecMethod = 'Overall Window Area'"		Win:Action = {			; SAC 1/13/14
				if ( SpecMethod == 2 .AND. 
           ( LocalStatus( Width ) > 0 .OR. 
             LocalStatus( Height ) > 0 .OR.
             LocalStatus( Multiplier ) > 0 ) ) 
        then  EvalRulelist( "OverwriteWinWidthHeightMultiplier", 1 )  else  UNCHANGED  endif  }



; mjb 1/12/15 - mods to use new CAClimateZoneCodeBase for code level lookups
	"Default Win:NFRCUfactor from CTZ-based code requirements"
		Win:NFRCUfactor	= {	if (LocalCompAssigned( WinType )) then  WinType:NFRCUfactor
										else if (Global( Proj:ClimateZone ) < 0.5) then  UNDEFINED
										else  CAClimateZoneCodeBase:WindowUfactor( "ClimateZone", Global( Proj:ClimateZone ), "CodeBase", Global( Proj:StdDesignBase ) )  endif endif  }

	"Default Win:NFRCSHGC from CTZ-based code requirements"
		Win:NFRCSHGC		= {	if (LocalCompAssigned( WinType )) then  WinType:NFRCSHGC
										else if (Global( Proj:ClimateZone ) < 0.5) then  UNDEFINED
										else  CAClimateZoneCodeBase:WindowSHGC( "ClimateZone", Global( Proj:ClimateZone ), "CodeBase", Global( Proj:StdDesignBase ) )  endif endif  }

			;            "ExteriorShade",     BEMP_Sym,  - symbol defaulted

	; SAC 2/20/15 - for EAA addition window areas
	"Set Win:IsEAAAddZoneGChild"	Win:IsEAAAddZoneGChild	= {	Parent( ExtWall:IsEAAAddZoneChild )  }

; SAC 12/3/13 - revise rules to handle scaling of all window areas
; SAC 2/20/15 - modified to REMOVE E+A+A Additions window/skylight area from New (item 2) and added separate Additions array element
	"Set Win:TotAreaInclMult[1] - total"					Win:TotAreaInclMult[1]	= {	Area * Multiplier  }
	"Set Win:TotAreaInclMult[3] - existing"				Win:TotAreaInclMult[3]	= {	if (Proj:RunScope == 2 .AND. Status == 1) then  TotAreaInclMult[1]  else  0  endif  }
	"Set Win:TotAreaInclMult[2] - new/alt (not add)"	Win:TotAreaInclMult[2]	= {	if (IsEAAAddZoneGChild == 0) then  TotAreaInclMult[1] - TotAreaInclMult[3]  else  0  endif  }
	"Set Win:TotAreaInclMult[4] - additions"				Win:TotAreaInclMult[4]	= {	if (IsEAAAddZoneGChild) then  TotAreaInclMult[1]  else  0  endif  }

	; for AirNet...
	"Default Win:VentArea"			Win:VentArea			= {	TotAreaInclMult[1] * 0.1  }   ; SAC 8/28/12 - was Area * ...

	; CSE window shade stuff
	"Default Win:OverhangDepth"	Win:OverhangDepth 	= {	                                      if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:OverhangDepth   else  0  endif  }
   "Default Win:OverhangDistUp"	Win:OverhangDistUp	= {   if (OverhangDepth <= 0) then  0  else if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:OverhangDistUp  else  0  endif endif  }
   "Default Win:OverhangExL"		Win:OverhangExL		= {   if (OverhangDepth <= 0) then  0  else if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:OverhangExL     else  0  endif endif  }
   "Default Win:OverhangExR"		Win:OverhangExR		= {   if (OverhangDepth <= 0) then  0  else if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:OverhangExR     else  0  endif endif  }
   "Default Win:OverhangFlap"		Win:OverhangFlap		= {   if (OverhangDepth <= 0) then  0  else if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:OverhangFlap    else  0  endif endif  }
   "Default Win:LeftFinDepth"		Win:LeftFinDepth		= {                                         if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:LeftFinDepth    else  0  endif  }
   "Default Win:LeftFinTopUp"		Win:LeftFinTopUp		= {   if (LeftFinDepth  <= 0) then  0  else if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:LeftFinTopUp    else  0  endif endif  }
   "Default Win:LeftFinDistL"		Win:LeftFinDistL		= {   if (LeftFinDepth  <= 0) then  0  else if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:LeftFinDistL    else  0  endif endif  }
   "Default Win:LeftFinBotUp"		Win:LeftFinBotUp		= {   if (LeftFinDepth  <= 0) then  0  else if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:LeftFinBotUp    else  0  endif endif  }
   "Default Win:RightFinDepth"	Win:RightFinDepth		= {                                         if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:RightFinDepth   else  0  endif  }
   "Default Win:RightFinTopUp"	Win:RightFinTopUp		= {   if (RightFinDepth <= 0) then  0  else if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:RightFinTopUp   else  0  endif endif  }
   "Default Win:RightFinDistR"	Win:RightFinDistR		= {   if (RightFinDepth <= 0) then  0  else if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:RightFinDistR   else  0  endif endif  }
   "Default Win:RightFinBotUp"	Win:RightFinBotUp		= {   if (RightFinDepth <= 0) then  0  else if (DefaultViaWinType .AND. WinType:ModelFinsOverhang == ModelFinsOverhang) then  WinType:RightFinBotUp   else  0  endif endif  }

;	mjb	default existing window properties	9/17/13
; LDH 7/20/2016  Update existing window property rules to update/reset when toggling between Win:SpecMthd = 0 or 1
	"Default existing Height"		Win:exHeight = {          ; LDH 7/20/2016 
    if ( SpecMethod == 1 .AND. LocalStatus( Height ) > 0 )
    then Height
    else UNDEFINED
    endif }
		  
	"Default existing Width"		Win:exWidth = {          ; LDH 7/20/2016 
    if ( SpecMethod == 1 .AND. LocalStatus( Width ) > 0 )
    then Width
    else UNDEFINED
    endif }

	"Force Win exArea to UNDEFINED when SpecMethod = 'Window Dimensions (...'"		Win:Action = {          ; LDH 7/20/2016  
		if (SpecMethod == 1 .AND. LocalStatus( exArea ) > 4) 
    then  EvalRulelist( "ForceWinExAreaToUndefined", 1 ) 
    else UNCHANGED 
    endif  }

	"Default Win:exArea"   Win:exArea = {          ; LDH 7/20/2016 	
    if (SpecMethod == 1)
	  then if ( LocalStatus( exHeight ) >= 2 .OR. LocalStatus( exWidth ) >= 2 ) 
      then  exHeight * exWidth
		  else	if ( LocalStatus( Height ) >= 2 .OR. LocalStatus( Width ) >= 2 ) 
      then  Height * Width 
      else UNDEFINED
      endif endif
		else if ( LocalStatus( Area ) >= 2 )
    then Area
		else	UNDEFINED		; no default if SpecMthd = "Overall Window Area"
		endif endif  }

	"Overwrite Win exHeight/exWidth/exMultiplier when SpecMethod = 'Overall Window Area'"		Win:Action = {          ; LDH 7/20/2016 			
    if (SpecMethod == 2 .AND. 
       (LocalStatus( exWidth ) > 0 .OR. 
        LocalStatus( exHeight ) > 0 .OR.
        LocalStatus( exMultiplier ) > 0 ) ) 
    then  EvalRulelist( "OverwriteExistingWinWidthHeightMultiplier", 1 )  
    else  UNCHANGED
    endif  }


   ; SAC 1/13/14 - revised rules to ensure height/width valid before referencing those values to define the ex* properties
	"Default existing Multiplier"		Win:exMultiplier = { Win:Multiplier }
	"Default existing NFRCUfactor"		Win:exNFRCUfactor = { Win:NFRCUfactor }
	"Default existing NFRCSHGC"		Win:exNFRCSHGC = { Win:NFRCSHGC }
	"Default existing ExteriorShade"	Win:exExteriorShade = { Win:ExteriorShade }
	"Default existing OverhangDepth"	Win:exOverhangDepth = { Win:OverhangDepth }
	"Default existing OverhangDistUp"	Win:exOverhangDistUp = { Win:OverhangDistUp }
	"Default existing OverhangExL"		Win:exOverhangExL = { Win:OverhangExL }
	"Default existing OverhangExR"		Win:exOverhangExR = { Win:OverhangExR }
	"Default existing OverhangFlap"	Win:exOverhangFlap = { Win:OverhangFlap }
	"Default existing LeftFinDepth"	Win:exLeftFinDepth = { Win:LeftFinDepth }
	"Default existing LeftFinTopUp"	Win:exLeftFinTopUp = { Win:LeftFinTopUp }
	"Default existing LeftFinDistL"	Win:exLeftFinDistL = { Win:LeftFinDistL }
	"Default existing LeftFinBotUp"	Win:exLeftFinBotUp = { Win:LeftFinBotUp }
	"Default existing RightFinDepth"	Win:exRightFinDepth = { Win:RightFinDepth }
	"Default existing RightFinTopUp"	Win:exRightFinTopUp = { Win:RightFinTopUp }
	"Default existing RightFinDistR"	Win:exRightFinDistR = { Win:RightFinDistR }
	"Default existing RightFinBotUp"	Win:exRightFinBotUp = { Win:RightFinBotUp }

	"Default IsStdCondZoneWin" 	Win:IsStdCondZoneWin	= {	0  }		; SAC 2/11/14

; TESTING
;	"Set Win:ParOrientation"        Win:ParOrientation      	= {	EnumString( Orientation       )  }		; ParentSymbolString(     Orientation       )  }
;	"Set Win:ParRefConsType"        Win:ParRefConsType      	= {	EnumString( Construction:Type )  }		; ParentRefSymbolString(  Construction:Type )  }
;	"Set Win:Par2ZoneType"          Win:Par2ZoneType        	= {	EnumString( Type              )  }		; Parent2SymbolString(    Type              )  }
;	"Set Win:Par2RefZoneHVACType"   Win:Par2RefZoneHVACType 	= {	EnumString( HVACSystem:Type   )  }		; Parent2RefSymbolString( HVACSystem:Type   )  }
;	"Set Win:Par3ProjClimZone"      Win:Par3ProjClimZone    	= {	EnumString( ClimateZone       )  }		; Parent3SymbolString(    ClimateZone       )  }


   ;--------------------------------------------------------------------
   ; ProposedInput: Skylt Rules   (Sklylights entered via UI)
   ;--------------------------------------------------------------------

;	"Default Skylt:Area"				Skylt:Area					= {	...   - compulsory input

	"Default Skylt:Multiplier"		Skylt:Multiplier			= {	1  }

;	"Default Skylt:NFRCUfactor"	Skylt:NFRCUfactor			= {	...   - compulsory input
;	"Default Skylt:NFRCSHGC"		Skylt:NFRCSHGC				= {	...   - compulsory input

	; SAC 2/20/15 - for EAA addition window areas
	"Set Skylt:IsEAAAddZoneGChild"	Skylt:IsEAAAddZoneGChild	= {	Parent( CathedralCeiling:IsEAAAddZoneChild )  }

; mjb	2/19/14	added array element designation (needed for reporting consistent with Window area reporting)
;	"Set Skylt:TotAreaInclMult"	Skylt:TotAreaInclMult[1]	= {	Area * Multiplier  }
; SAC 7/23/14 - added more complete setting of TotAreaInclMult[*] - consistent w/ rules elsewhere
; SAC 2/20/15 - modified to REMOVE E+A+A Additions window/skylight area from New (item 2) and added separate Additions array element
	"Calculate SkyLt:TotAreaInclMult[1] - total"								SkyLt:TotAreaInclMult[1]		= {	Area * Multiplier  }
	"Calculate SkyLt:TotAreaInclMult[3] - existing"							SkyLt:TotAreaInclMult[3]		= {	if (Proj:RunScope == 2 .AND. Status == 1) then  TotAreaInclMult[1]  else  0  endif  }
	"Calculate SkyLt:TotAreaInclMult[2] - new (not add)"			  SkyLt:TotAreaInclMult[2]		= {	if (Status == 3 .AND. IsEAAAddZoneGChild == 0) then  TotAreaInclMult[1]  else  0  endif  }
	"Calculate SkyLt:TotAreaInclMult[4] - additions"						SkyLt:TotAreaInclMult[4]		= {	if (IsEAAAddZoneGChild) then  TotAreaInclMult[1]  else  0  endif  }

;	; for AirNet...
;	"Default Skylt:VentArea"		Skylt:VentArea				= {	TotAreaInclMult[1] * 0.1  }

; LH - added rules to default existing window properties
  "Default Skylight Existing UfactorSHGCSource"  Skylt:exUfactorSHGCSource = {
    if( IfValidAnd( Skylt:UfactorSHGCSource > 0 ) .AND.
        IfValidAnd( Skylt:IsVerified > 0 ) )
    then Skylt:UfactorSHGCSource
    else UNCHANGED
    endif }

  "Default Skylight Existing Area"  Skylt:exArea = {
    if( IfValidAnd( Skylt:Area > 0 ) .AND.
        IfValidAnd( Skylt:IsVerified > 0 ) )
    then Skylt:Area
    else UNCHANGED
    endif }

  "Default Skylight Existing Ufactor"  Skylt:exNFRCUfactor = {
    if( IfValidAnd( Skylt:NFRCUfactor > 0 ) .AND.
        IfValidAnd( Skylt:IsVerified > 0 ) .AND.
        IfValidAnd( Skylt:exUfactorSHGCSource = 1 ) )
    then Skylt:NFRCUfactor
    else UNCHANGED
    endif }

  "Default Skylight Existing SHGC"  Skylt:exNFRCSHGC = {
    if( IfValidAnd( Skylt:NFRCSHGC > 0 ) .AND.
        IfValidAnd( Skylt:IsVerified > 0 ) .AND.
        IfValidAnd( Skylt:exUfactorSHGCSource = 1 ) )
    then Skylt:NFRCSHGC
    else UNCHANGED
    endif }

   ;--------------------------------------------------------------------
   ; ProposedInput: cseWINDOW Rules   (Windows simulated via CSE)
   ;--------------------------------------------------------------------
			;            "wnHeight",          BEMP_Flt,  1, "ft",   - no default
			;            "wnWidth",           BEMP_Flt,  1, "ft",   - no default

	"Default cseWINDOW:wnArea"
		cseWINDOW:wnArea		= {	if (Local( wnHeight ) > 0 .AND. Local( wnWidth ) > 0)
										then  Local( wnHeight ) * Local( wnWidth )  else  UNDEFINED  endif  }

			;            "wnModel",           BEMP_Sym,  - symbol defaulted

	"Default cseWINDOW:wnMult"
		cseWINDOW:wnMult		= {	1  }

	"Default cseWINDOW:wnFMult"
		cseWINDOW:wnFMult		= {	1  }

			;            "wnUnfrc",           BEMP_Flt,  1, "Btuh/ft2-F",   - no default
			;            "wnSHGC",            BEMP_Flt,  1, "",              - no default

	"Default cseWINDOW:wnNGlz"  ; based on logic present in default CSE files
		cseWINDOW:wnNGlz		= {	if (Local( wnUnfrc ) > 0.8) then  1  else  2  endif  }

	"Default cseWINDOW:wnDirtLoss"
		cseWINDOW:wnDirtLoss	= {	0.1  }

			;            "wnExShd",           BEMP_Sym,  - symbol defaulted
			;            "wnInShd",           BEMP_Sym,  - symbol defaulted


   ;--------------------------------------------------------------------
   ; ProposedInput: Door Rules
   ;--------------------------------------------------------------------

			;            "Area",              BEMP_Flt,  1, "ft2",           - no default

;	"Default Door:Ufactor"		Door:Ufactor	= {	if (ParentComponentType() == "Garage") then  1.0  else  0.5  endif  }   ; SAC 1/29/13 - added default (from BAW over phone)
	"Default Door:Ufactor"		Door:Ufactor	= {	if (ParentComponentType() == "ExtWall" .AND. Parent( ExtWall:ParentType ) == 2) then  1.0  else  0.5  endif  }   ; SAC 1/29/13 - added default (from BAW over phone)

	"Default existing Ufactor"		Door:exUfactor = { Ufactor }		; SAC 2/11/14

	"Default IsStdCondZoneDoor" 	Door:IsStdCondZoneDoor	= {	0  }		; SAC 2/11/14


   ;--------------------------------------------------------------------
   ; ProposedInput: DOOR Rules
   ;--------------------------------------------------------------------

			;            "drArea",            BEMP_Flt,  1, "ft2",           - no default
			;            "drU",               BEMP_Flt,  1, "Btuh/ft2-F",   - no default


   ;--------------------------------------------------------------------
   ; ProposedInput: Attic Rules (second subset)
   ;--------------------------------------------------------------------
  ; SAC 1/11/13 - revised RoofSolReflect defaulting
	"Default Attic:RoofSolReflect"	Attic:RoofSolReflect	= {	0.1   }
	"Default Attic:RoofEmiss"			Attic:RoofEmiss		= {	0.85  }

	"Set Attic:TreeDescrip"		Attic:TreeDescrip = {	if (Local( FloorArea ) > 0.1)
																		then  Format( "%s SqFt", FltToStr( Local( FloorArea ) ) )
																		else  "activate by creating a 'Ceiling (below attic)'"  endif  }

;	"Set Attic:ScreenDescrip"	Attic:ScreenDescrip = {	if (Local( FloorArea ) > 0.1)
;																		then  " "
;																		else  "activate by creating a 'Ceiling (below attic)'"  endif  }

;	1,           "VentAreaChoice",    BEMP_Sym,  1, "",                 0, "",         0, "",             3204, "Choice of vent area as attic area /300 or /150"    
; mjb 5/17/13 - remove vent area choice and default to 1/300 
;	"Set Attic:AVentFraction"			Attic:AVentFraction	= {	if (VentAreaChoice <= 0) then  0

	"Default Attic:AVentFraction"			Attic:AVentFraction	= {	1 / 300   }
	"Default Attic:FractionHigh"		Attic:FractionHigh	= {	0  }   ; SAC 9/9/12 - added default of 0.3 from AirNetAlgorithm8 // SAC 1/15/13 - switched default to 0 per GC issue #18

	"Set Attic:Height"         Attic:Height      = {   if (Local( FloorArea ) < 0.01) then  0
																		else  (Local( RoofPitch ) * sqrt( Local( FloorArea ) )) / 2  endif  }
;	"Set Attic:Bottom"         Attic:Bottom      = {   ???  }
;	"Set Attic:VentArea"       Attic:VentArea    = {   ??? -   0.5 * 0.25 * (1 - FractionHigh) * Max(AtticVent * AtticFloorArea, Fanvent, .00001)   }
	
	"Set Attic:RoofFramingFactor => fraction of gross wall area that includes frame" 
		Attic:RoofFramingFactor	= {	LocalRef( Construction:FramingFactor )  }

  ; SAC 11/5/12 - added to support attic edge modeling
  ; SAC 12/4/12 - replaced new attic edge length algorithm with one closer to the original that does not rely on summing exterior wall lengths
	"Default Attic:EdgeLengthFactor"			Attic:EdgeLengthFactor		= {	0.7  }		; Factor to adjust total attic edge accounting for gable roof
;	"Default ExtWall:AtcEdg_TopLength"		ExtWall:AtcEdg_TopLength	= {	if (ParentComponentType() == "Zone")
; 																									then	if (Parent( FloorHeight ) > 0 .AND. Parent( NumStories ) > 0)
;																											then	Area / (Parent( FloorHeight ) * Parent( NumStories ))
;																											else	0  endif
;																									else	0  endif  }
;	"Default Zone:AtcEdg_Length"				Zone:AtcEdg_Length			= {	if (ComponentCount(Attic) > 0)
;																									then	SumChildren( ExtWall:AtcEdg_TopLength ) * Attic:EdgeLengthFactor
;																									else	0  endif  }
	"Set Attic:EdgeLength"						Attic:EdgeLength  			= {	sqrt( FloorArea ) * 4 * EdgeLengthFactor  }
	"Default Zone:AtcEdg_CeilBlwAtcArea"	Zone:AtcEdg_CeilBlwAtcArea	= {	SumChildren( CeilingBelowAttic:Area )  }
;	"Default CeilingBelowAttic:AtcEdg_Length"		CeilingBelowAttic:AtcEdg_Length	= {	if (ParentComponentType() == "Zone")
;																													then	if (Parent( AtcEdg_CeilBlwAtcArea ) > 0)
;																															then	Parent( AtcEdg_Length ) * Area / Parent( AtcEdg_CeilBlwAtcArea )
	; SAC 1/17/13 - revise rule to prevent error when no Attic objects exist
	"Default CeilingBelowAttic:AtcEdg_Length"		CeilingBelowAttic:AtcEdg_Length	= {	if (ParentComponentType() == "Zone" .AND. LocalCompAssigned( AtticZone ) > 0.5)
																													then	if (IfValidAnd( AtticZone:FloorArea > 0.1 ))
																															then	ValidOr( AtticZone:EdgeLength, 0 ) * Area / AtticZone:FloorArea
																															else	0  endif
																													else	0  endif  }
	"Default CeilingBelowAttic:AtcEdg_WAArea"		CeilingBelowAttic:AtcEdg_WAArea	= {	ValidOr( AtcEdg_WA, 0 ) * AtcEdg_Length  }
																											;		if (LocalCompAssigned( Construction ))
																											;		then	Construction:AtcEdg_WA * AtcEdg_Length
																											;		else	0  endif  }
	"Default CeilingBelowAttic:AtcEdg_WBArea"		CeilingBelowAttic:AtcEdg_WBArea	= {	ValidOr( AtcEdg_WB, 0 ) * AtcEdg_Length  }
																											;		if (LocalCompAssigned( Construction ))
																											;		then	Construction:AtcEdg_WB * AtcEdg_Length
																											;		else	0  endif  }
	"Default CeilingBelowAttic:AtcEdg_TotArea"	CeilingBelowAttic:AtcEdg_TotArea	= {	AtcEdg_WAArea + AtcEdg_WBArea  }
	"Set CeilingBelowAttic:AtcEdg_Msg"	CeilingBelowAttic:AtcEdg_Msg	= {	Format( "Attic Edge:  Len=%.1f / WAArea=%.1f / WBArea=%.1f / TotArea=%.1f",
																												AtcEdg_Length, AtcEdg_WAArea, AtcEdg_WBArea, AtcEdg_TotArea )  }

	"Set Attic:EdgeArea"			Attic:EdgeArea    = {	min( SumRevRef( CeilingBelowAttic:AtticZone, CeilingBelowAttic:AtcEdg_TotArea ), (FloorArea * 0.75) )  }
	"Set Attic:EdgeArea_Msg"	Attic:EdgeArea_Msg	= {	if (FloorArea < 0.1) then  " "
																			else if (SumRevRef( CeilingBelowAttic:AtticZone, CeilingBelowAttic:AtcEdg_TotArea ) > (FloorArea * 0.75))
																			then	Format( "Attic Edge issue: edge area estimate (%.1f) exceeds 75%% of attic floor area (%.1f)", 
																									SumRevRef( CeilingBelowAttic:AtticZone, CeilingBelowAttic:AtcEdg_TotArea ), FloorArea )
																			else	Format( "Attic edge area (%.1f) represents attic floor area (%.1f) x %.3f", EdgeArea, FloorArea,
																									(EdgeArea / FloorArea) )
																			endif endif  }
;;	"Set Attic:EdgeWidth"		Attic:EdgeWidth   = {	2  }									; algorithm under development, assume 2 ft for now
;	"Set Attic:EdgeWidth"		Attic:EdgeWidth   = {	0  }  ; until attic edge stuff implemented
;	"Set Attic:EdgeLength"		Attic:EdgeLength  = {	sqrt( FloorArea ) * 0.7  }		; algorithm under development, assume sqrt(ACeilGross)*.7
;	"Set Attic:EdgeArea"			Attic:EdgeArea    = {	EdgeWidth * EdgeLength  }

	"Set Attic:CeilArea"			Attic:CeilArea    = {	max( 0, Local( FloorArea ) - Local( EdgeArea ) )  }
	"Set Attic:CeilFact"			Attic:CeilFact    = {	if (Local( FloorArea ) <= 0) then  0
																		else  Local( CeilArea ) / Local( FloorArea )  endif  }
	"Set Attic:TrussArea"		Attic:TrussArea   = {	Local( CeilArea ) * 2  }

	; SAc 1/26/13 - GC issue #25 - install fixed 30" attic height for flat (or close to flat) roofs (< 3"/12" rise)
	"Set Attic:Volume"         Attic:Volume      = {   if (RoofRise < 3)
																		then  CeilArea * 2.5					; define static 30" attic for flat (or close to flat) roofs
																		else  CeilArea * Height / 3  endif  }

	; SAC 12/28/14 - prevent Attic:ClVentableVolume from being > 0 when the attic NOT over any conditioned area
	"Set Attic:ClVentableVolume"					Attic:ClVentableVolume					= {	if (Type == 0 .AND. IfValidAnd( FloorAreaOverCond > 1 )) then  Volume  else  0  endif  }
	"Set CeilingBelowAttic:ClVentableVolume"	CeilingBelowAttic:ClVentableVolume	= {	if (ParentComponentType() != "Garage" .AND. LocalCompAssigned( AtticZone ) > 0) then AtticZone:ClVentableVolume 
																													else 0 endif  }
	"Set CeilingBelowAttic:ClVentableArea"		CeilingBelowAttic:ClVentableArea		= {	if (ParentComponentType() != "Garage" .AND. LocalCompAssigned( AtticZone ) > 0) then Area    else  0  endif  }
	"Set Zone:ClVentableClgArea"					Zone:ClVentableClgArea					= {	SumChildren( CeilingBelowAttic:ClVentableArea )  }

; SAC 4/28/14 - moved up to above attic edge calcs (where it can now be referenced) 
;	"Set Attic:RoofTilt"			Attic:RoofTilt		= {	if (Local( RoofPitch ) == 0) then  0
;																		else  atan( Local( RoofPitch ) ) * 180 / 3.14159265  endif  }

	"Set Attic:DeckArea"			Attic:DeckArea		= {	Local( CeilArea ) * sqrt( 1 + (Local( RoofPitch ) * Local( RoofPitch )) )  }

	"Set CeilingBelowAttic:UncondAtticArea"	CeilingBelowAttic:UncondAtticArea	= {	if (IfValidAnd( AtticZone:Type == 0 )) then  AtticZone:FloorArea  else  0  endif  }
	"Set Zone:UncondAtticArea"						Zone:UncondAtticArea						= {	if (Type > 9) then  0  else  SumChildren( CeilingBelowAttic:UncondAtticArea )  endif  }
	"Set Zone:AtticArea"								Zone:AtticArea								= {	SumChildren( CeilingBelowAttic:Area )  }

			; to support multiple attics
	"Set Zone:MaxClVentableVolume"		Zone:MaxClVentableVolume	= {	MaxChild(     CeilingBelowAttic:ClVentableVolume )  }
	"Set Zone:MaxClVentableCeiling"		Zone:MaxClVentableCeiling	= {	MaxChildComp( CeilingBelowAttic:ClVentableVolume )  }
	"Set Zone:MaxClVentableAttic"			Zone:MaxClVentableAttic		= {	if (	LocalCompAssigned( MaxClVentableCeiling ) > 0.5 .AND.
																										LocalCompAssigned( MaxClVentableCeiling:AtticZone ) > 0.5 ) then  MaxClVentableCeiling:AtticZone
																								else  UNDEFINED  endif  }

; SAC 10/20/14 - moved here from CSE simulation prep so that it is accessible in model checking
	; SAC 5/2/13 - new rulelists to handle Cooling Ventilation (ClVent) summing into referenced ZONES
	"Set Zone:ClVent*"	Proj:Action	= {	if (IsMultiFamily < 0.5)
														then  EvalRulelist( "Set_ZoneClVent_SFam" )
														else	EvalRulelist( "Set_ZoneClVent_MFam" )  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: Zone, Proj & DwellUnit Rules pertaining to central multifamily laundry
   ;--------------------------------------------------------------------

	"Default Proj:CentralMFamLaundry"		Proj:CentralMFamLaundry		= {	0  }		; Whether or not there is centralized multi-family laundry equipment
	"Default Proj:DfltMFamLaundryZn"			Proj:DfltMFamLaundryZn		= {	     if (MaxAll(     Zone:UncondFloorArea ) > 0)		; Default central laundry equipment zone
																									then		MaxAllComp( Zone:UncondFloorArea )
																									else if (MaxAll(     Zone:LvgCondFloorArea ) > 0)
																									then		MaxAllComp( Zone:LvgCondFloorArea )
																									else if (MaxAll(     Zone:CondFloorArea ) > 0)
																									then		MaxAllComp( Zone:CondFloorArea )
																									else if (MaxAll(     Zone:SlpCondFloorArea ) > 0)
																									then		MaxAllComp( Zone:SlpCondFloorArea )
																									else  UNCHANGED  endif endif endif endif  }

	"Default DwellUnit:WasherZoneRef"		DwellUnit:WasherZoneRef		= {	if (IfValidAnd( Proj:CentralMFamLaundry > 0.5 ) .AND. GlobalCompAssigned( Proj:DfltMFamLaundryZn ))
																									then	Proj:DfltMFamLaundryZn
																									else	Parent( Name )  endif  }
	"Default DwellUnit:DryerZoneRef"			DwellUnit:DryerZoneRef		= {   if (HaveWasher > 0.5 .AND. HaveDryer > 0.5 .AND. LocalCompAssigned( WasherZoneRef ))
																									then	WasherZoneRef
																									else if (IfValidAnd( Proj:CentralMFamLaundry > 0.5 ) .AND. GlobalCompAssigned( Proj:DfltMFamLaundryZn ))
																									then	Proj:DfltMFamLaundryZn
																									else	Parent( Name )  endif endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: HVAC System Rules
   ;--------------------------------------------------------------------

;	"Set Zone:Top"						Zone:Top 				= {	Local( Bottom ) + (Local( FloorHeight ) * Local( NumStories ))  }
	"Set Zone:Top"						Zone:Top 				= {	Bottom + (FloorHeight * (NumStories - 1)) + CeilingHeight  }
;	"Set Zone:CondFloorArea"		Zone:CondFloorArea	= {	if (Local( Type ) < 10) then  Local( FloorArea )  else  0  endif  }
;	"Default Zone:HVACSystem"		Zone:HVACSystem		= {
;	"Default Zone:CoolVentSystem"	Zone:CoolVentSystem	= {
;	"Default Zone:IAQVentSystem"	Zone:IAQVentSystem	= {

	; SAC 10/22/12 - should work reasonably well for floors < 4-5 and floor & ceiling heights fairly close to each other
	; SAC 4/8/13 - added "2 +" into formulaa to resolve issue believed to be decimal precision related, causing Proj:NumStories to truncate to 0
	"Set Proj:NumStories"			Proj:NumStories		= {	if (ComponentCount( Zone ) < 1) then  1
																				else if (SumAll( Zone:CeilingHeight ) < 1) then  1
																				else  (2 + MaxAll( Zone:Top ) - MinAll( Zone:Bottom )) / 
																						(SumAll( Zone:CeilingHeight ) / ComponentCount( Zone ))
																				endif endif  }
;	mjb	10/27/14	Force assignment of HVACSystem from ActiveHVACSystem for AA & E+A+A when HVAC is existing
	"Force HVAC assignment for Additions Alone"	Zone:Action	=	{ if ( (Proj:IsAddAlone > 0.5 .OR. Proj:RunScope == 2) .AND. HVACSysStatus == 1) then  EvalRulelist( "ForceDefault_Zone_HVAC", 1 )  else  UNCHANGED  endif  }

	"Consolidate all HVAC defaulting rules"	Proj:Action	= {	EvalRulelist( "Default_AllHVAC" )  }

; SAC 12/31/15 - added new calcs & message to estimate & report attic relief vent free area for display in cool vent tab of project tabbed dialog (ticket #596)
	"Set Proj:ClVentAtticRelief"	Proj:ClVentAtticRelief	= {
														if (SumAll( Attic:ClVentableVolume ) < 0.1) then  0
														else if (UnitClVentOption == 3)		; CFI Cool Vent
														then	SumAll( HVACSys:AirNet_CoolVent   ) * UnitClVenTAreaMult / CAClimateZoneCodeBase:WHFatticrelief( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase )
														else	ValidOr( Proj:UnitClVentCFMTot, 0 ) * UnitClVenTAreaMult / CAClimateZoneCodeBase:WHFatticrelief( "ClimateZone", ClimateZone, "CodeBase", StdDesignBase )		endif endif  }
	"Set Proj:ClVentAtticRelMsg"	Proj:ClVentAtticRelMsg	= {	if (ClVentAtticRelief < 0.01) then  " "
																					else  Format( "%.1f ft2 of Attic Relief Vent Free Area", ClVentAtticRelief )  endif  }

   ;--------------------------------------------------------------------
   ; ProposedInput: Final Calcs
   ;--------------------------------------------------------------------

	"Set ExtWall:ChildAreaSum => Sum of child window & door areas"    ; SAC 5/22/12 - added to fix CBECCbug003 from BW 5/18/12
		ExtWall:ChildAreaSum		= {	SumChildren( Win:TotAreaInclMult[1] ) + SumChildren( Door:Area )  }

	"Set ExtWall:NetWallArea => gross wall area minus sum of child window & door area" 
		ExtWall:NetWallArea		= {	Local( Area ) - Local( ChildAreaSum )  }

	"Set ExtWall:FramingFactor => fraction of gross wall area that includes frame" 
		ExtWall:FramingFactor	= {	LocalRef( Construction:FramingFactor )  }

	"Set IntWall:ChildAreaSum => Sum of child door areas"    ; SAC 5/8/15 - added in conjunction w/ fix to issue 585
		IntWall:ChildAreaSum		= {	SumChildren( Door:Area )  }
	"Set IntWall:NetWallArea => gross wall area minus sum of child door area" 		; SAC 11/3/14 - added to fix rule eval error (GC issue 394)
		IntWall:NetWallArea		= {	Local( Area ) - ValidOr( ChildAreaSum, 0 )  }

; mjb	2/19/14	added array element designation (needed for reporting consistent with Window reporting)
	"Set CathedralCeiling:ChildAreaSum => Sum of child skylight areas"    ; SAC 5/22/12 - added to fix CBECCbug003 from BW 5/18/12
		CathedralCeiling:ChildAreaSum[1]		= {	SumChildren( Skylt:TotAreaInclMult[1] )  }

	"Set CathedralCeiling:NetWallArea => gross ceiling area minus sum of child skylight area" 
		CathedralCeiling:NetWallArea		= {	Local( Area ) - Local( ChildAreaSum[1] )  }

	"Set CathedralCeiling:FramingFactor => fraction of gross ceiling area that includes frame" 
		CathedralCeiling:FramingFactor	= {	LocalRef( Construction:FramingFactor )  }

	"Set InteriorCeiling:FramingFactor => fraction of gross ceiling area that includes frame" 
		InteriorCeiling:FramingFactor	= {	LocalRef( Construction:FramingFactor )  }

	"Set UndWall:FramingFactor => fraction of gross wall area that includes frame" 
		UndWall:FramingFactor	= {	LocalRef( Construction:FramingFactor )  }

	"Set IntWall:FramingFactor => fraction of gross wall area that includes frame" 
		IntWall:FramingFactor	= {	LocalRef( Construction:FramingFactor )  }

	"Set ExteriorFloor:FramingFactor => fraction of gross floor area that includes frame" 
		ExteriorFloor:FramingFactor	= {	LocalRef( Construction:FramingFactor )  }

	"Set FloorOverCrawl:FramingFactor => fraction of gross floor area that includes frame" 
		FloorOverCrawl:FramingFactor	= {	LocalRef( Construction:FramingFactor )  }

	"Set InteriorFloor:FramingFactor => fraction of gross floor area that includes frame" 
		InteriorFloor:FramingFactor	= {	LocalRef( Construction:FramingFactor )  }

	"Set UndFloor:FramingFactor => fraction of gross floor area that includes frame" 
		UndFloor:FramingFactor	= {	0 }  ; LocalRef( Construction:FramingFactor )  }

	; SAC 5/22/12 - added properties used in range checks to ensure that (parent) net wall areas don't go negative (CBECCbug003 5/18/12)
	"Set Win:MaxArea"				Win:MaxArea			= {	if (Local( Multiplier ) > 0.0001)
																		then	(Parent( NetWallArea ) + Local( TotAreaInclMult[1] )) / Local( Multiplier )
																		else	100000  endif  }
	"Set Win:MaxHeight"			Win:MaxHeight		= {	if (LocalStatus( Area ) < 5 .AND. IfValidAnd( Width > 0.0001 ) .AND. IfValidAnd( Multiplier > 0.0001 ))
																		then	(Parent( NetWallArea ) + Local( TotAreaInclMult[1] )) / (Local( Width ) * Local( Multiplier ))
																		else	100000  endif  }
	"Set Win:MaxWidth"			Win:MaxWidth		= {	if (LocalStatus( Area ) < 5 .AND. IfValidAnd( Height > 0.0001 ) .AND. IfValidAnd( Multiplier > 0.0001 ))
																		then	(Parent( NetWallArea ) + Local( TotAreaInclMult[1] )) / (Local( Height ) * Local( Multiplier ))
																		else	100000  endif  }
	"Set Win:MaxMultiplier"		Win:MaxMultiplier	= {	if (Local( Area ) > 0.0001)
																		then	(Parent( NetWallArea ) + Local( TotAreaInclMult[1] )) / Local( Area )
																		else	100000  endif  }

	; SAC 4/7/13 - properties referenced in range checks to ensure that (parent) net roof areas don't go negative
	"Set Skylt:MaxArea"			Skylt:MaxArea			= {	if (Local( Multiplier ) > 0.0001)
																			then	(Parent( NetWallArea ) + Local( TotAreaInclMult )) / Local( Multiplier )
																			else	100000  endif  }
	"Set Skylt:MaxMultiplier"	Skylt:MaxMultiplier	= {	if (Local( Area ) > 0.0001)
																			then	(Parent( NetWallArea ) + Local( TotAreaInclMult )) / Local( Area )
																			else	100000  endif  }

	; SAC 5/24/12 - added properties used in range checks to ensure that (parent) net wall areas don't go negative (CBECCbug003 5/18/12)
	"Set Door:MaxArea"			Door:MaxArea		= {	Parent( NetWallArea ) + Local( Area )  }

	; SAC 7/18/13 - added new boolean indicating whether or not DHW systems are defined (& assigned to zones?) (and should be modeled)
; PERHAPS REPLACE w/ "SumAll( Zone:DHWFloorArea ) > 0"
;	"Set Proj:ModelingDHW"		Proj:ModelingDHW	= {	if (SumAll( DHWSys:NumDHWHeaters ) > 0) then  1  else  0  endif  }		- SAC 10/7/15 - replaced w/ below to ensure that the DHWSys objects are actually assigned to zones or DUTs
	"Set Proj:ModelingDHW"		Proj:ModelingDHW	= {	if (SumAcrossIf( DHWSys:NumDHWHeaters, DHWSys:FloorAreaServed[1] > 0 ) > 0) then  1  else  0  endif  }


   ;--------------------------------------------------------------------
   ; ProposedInput: E+A+A Defaults and Flag Settings
   ;--------------------------------------------------------------------
	"Default ACH50 IsVerified flag"					Proj:IsVerified = { 0 }
	"Default ExtWall IsVerified flag"				ExtWall:IsVerified = { 0 }
	"Default Win IsVerified flag"						Win:IsVerified = { 0 }
	"Default Door IsVerified flag"					Door:IsVerified = { 0 }		; SAC 2/11/14
	"Default ExteriorFloor IsVerified flag"		ExteriorFloor:IsVerified = { 0 }
	"Default FloorOverCrawl IsVerified flag"		FloorOverCrawl:IsVerified = { 0 }
	"Default CathedralCeiling IsVerified flag"	CathedralCeiling:IsVerified = { 0 }
	"Default CeilingBelowAttic IsVerified flag"	CeilingBelowAttic:IsVerified = { 0 }
	"Default InteriorCeiling IsVerified flag"		InteriorCeiling:IsVerified = { 0 }
	"Default IntWall IsVerified flag"				IntWall:IsVerified = { 0 }
	"Default UndWall IsVerified flag"				UndWall:IsVerified = { 0 }
	"Default UndFloor IsVerified flag"				UndFloor:IsVerified = { 0 }
	"Default InteriorFloor IsVerified flag"		InteriorFloor:IsVerified = { 0 }		; SAC 2/11/14
	"Default SlabFloor IsVerified flag"				SlabFloor:IsVerified = { 0 }
	"Default Attic IsVerified flag"					Attic:IsVerified = { 0 }
	"Default Skylt IsVerified flag"					Skylt:IsVerified = { 0 }

	"Default Zone:HVACSysVerified"	Zone:HVACSysVerified		= {	0  }
	"Default Zone:DHWSys1Verified"	Zone:DHWSys1Verified		= {	0  }
	"Default Zone:DHWSys2Verified"	Zone:DHWSys2Verified		= {	0  }

;	"Default HVACHeat IsVerified flag"				HVACHeat:IsVerified = { 0 }
;	"Default HVACCool IsVerified flag"				HVACCool:IsVerified = { 0 }
;	"Default HVACHtPump IsVerified flag"			HVACHtPump:IsVerified = { 0 }
	"Default HVACDist IsVerified flag"				HVACDist:IsVerified = { 0 }
	"Default HVACFan IsVerified flag"				HVACFan:IsVerified = { 0 }

;	mjb 6/4/14	force consistent defaults of all flags derived from Status
	"Default Zone status flags"						Zone:Action						= {	EvalRulelist( "ForceDefaults_Zone_Status", 1 )  }
	"Default ExtWall status flags"					ExtWall:Action					= {	EvalRulelist( "ForceDefaults_ExtWall_Status", 1 )  }
	"Default Win status flags"							Win:Action						= {	EvalRulelist( "ForceDefaults_Win_Status", 1 )  }
	"Default Door status flags"						Door:Action						= {	EvalRulelist( "ForceDefaults_Door_Status", 1 )  }
	"Default ExteriorFloor status flags"			ExteriorFloor:Action			= {	EvalRulelist( "ForceDefaults_ExteriorFloor_Status", 1 )  }
	"Default FloorOverCrawl status flags"			FloorOverCrawl:Action		= {	EvalRulelist( "ForceDefaults_FloorOverCrawl_Status", 1 )  }
	"Default CathedralCeiling status flags"		CathedralCeiling:Action		= {	EvalRulelist( "ForceDefaults_CathedralCeiling_Status", 1 )  }
	"Default CeilingBelowAttic status flags"		CeilingBelowAttic:Action	= {	EvalRulelist( "ForceDefaults_CeilingBelowAttic_Status", 1 )  }
	"Default InteriorCeiling status flags"			InteriorCeiling:Action		= {	EvalRulelist( "ForceDefaults_InteriorCeiling_Status", 1 )  }
	"Default IntWall status flags"					IntWall:Action					= {	EvalRulelist( "ForceDefaults_IntWall_Status", 1 )  }
	"Default UndWall status flags"					UndWall:Action					= {	EvalRulelist( "ForceDefaults_UndWall_Status", 1 )  }
	"Default UndFloor status flags"					UndFloor:Action				= {	EvalRulelist( "ForceDefaults_UndFloor_Status", 1 )  }
	"Default InteriorFloor status flags"			InteriorFloor:Action			= {	EvalRulelist( "ForceDefaults_InteriorFloor_Status", 1 )  }
	"Default SlabFloor status flags"					SlabFloor:Action				= {	EvalRulelist( "ForceDefaults_SlabFloor_Status", 1 )  }
	"Default Attic status flags"						Attic:Action					= {	EvalRulelist( "ForceDefaults_Attic_Status", 1 )  }
	"Default Skylt status flags"						Skylt:Action					= {	EvalRulelist( "ForceDefaults_Skylt_Status", 1 )  }
	"Init HVACCool Is* status flags"					HVACCool:Action				= {	EvalRulelist( "Initialize_HVACCool_Status", 1 )  }
	"Default HVACSys status flags"					HVACSys:Action					= {	EvalRulelist( "ForceDefaults_HVACSys_Status", 1 )  }
	"Default HVACHeat status flags"					HVACHeat:Action				= {	EvalRulelist( "ForceDefaults_HVACHeat_Status", 1 )  }
;	"Default HVACCool status flags"					HVACCool:Action				= {	EvalRulelist( "ForceDefaults_HVACCool_Status", 1 )  }    ; SAC 8/28/16 - removed to address tic #728
	"Default HVACHtPump status flags"				HVACHtPump:Action				= {	EvalRulelist( "ForceDefaults_HVACHtPump_Status", 1 )  }
	"Default HVACDist status flags"					HVACDist:Action				= {	EvalRulelist( "ForceDefaults_HVACDist_Status", 1 )  }
;	"Default HVACFan status flags"					HVACFan:Action					= {	EvalRulelist( "ForceDefaults_HVACFan_Status", 1 )  }	;	mjb	8/21/14 - removed to implement CEC decision to NOT allow E+A+A Fan mods independent of HVACSys mods
	"Default DHWSys status flags"						DHWSys:Action					= {	EvalRulelist( "ForceDefaults_DHWSys_Status", 1 )  }
	"Default DHWHeater status flags"					DHWHeater:Action				= {	EvalRulelist( "ForceDefaults_DHWHeater_Status", 1 )  }

; mjb	7/31/14	- moved to after forced defaults
	"Default HVACSys IsVerified flag"				HVACSys:IsVerified = { if (Proj:RunScope == 2 .AND. SumRevRef( Zone:AltHVACSystem, Zone:HVACSysVerified ) > 0) then  1  else  0  endif  }

	"Default DHWSys IsVerified flag"					Zone:AltDHWSys1:IsVerified = { if (Proj:RunScope == 2 .AND. DHWSys1Verified > 0.5) then  1  else  0  endif  }
	"Default DHWSys IsVerified flag"					Zone:AltDHWSys2:IsVerified = { if (Proj:RunScope == 2 .AND. DHWSys2Verified > 0.5) then  1  else  UNCHANGED  endif  }

; SAC 4/28/15 - added logic to check all envelope IsVerified flags to set Proj:ExistingCondVerif
	"Default Proj:ExistingCondVerif -1"		Proj:ExistingCondVerif	= {	if ( RunScope == 2 .AND. MinChild(Zone:Status) < 1.5 ) then 
																					;				if ( MaxChild(Zone:HVACSysVerified) > 0.5 .OR. MaxChild(Zone:DHWSys1Verified) > 0.5  .OR. MaxChild(Zone:DHWSys2Verified) > 0.5  .OR. IfValidAnd(Proj:IsVerified > 0.5) .OR. IfValidAnd(Attic:IsVerified > 0.5) ) 
																									if ( MaxChild(Zone:HVACSysVerified) > 0.5 .OR. MaxChild(Zone:DHWSys1Verified) > 0.5  .OR. MaxChild(Zone:DHWSys2Verified) > 0.5  .OR. IfValidAnd(Proj:IsVerified > 0.5) ) 
																									then 1
																									else if (SumAll( Attic:IsVerified ) > 0.5)
																									then 1
																						;			else if (ComponentCount( Attic ) > 0.5)
																						;			then	if (IfValidAnd(Attic:IsVerified > 0.5))
																						;					then 1 else  0  endif
																									else if (MaxChild( ExtWall:IsVerified ) > 0.5 .OR. MaxChild( IntWall:IsVerified ) > 0.5 .OR. MaxChild( UndWall:IsVerified ) > 0.5 .OR. MaxChild( CathedralCeiling:IsVerified ) > 0.5 .OR. 
																												MaxChild( CeilingBelowAttic:IsVerified ) > 0.5 .OR. MaxChild( InteriorCeiling:IsVerified ) > 0.5 .OR. MaxChild( SlabFloor:IsVerified ) > 0.5 .OR. MaxChild( ExteriorFloor:IsVerified ) > 0.5)
																									then 1
																									else if (MaxChild( FloorOverCrawl:IsVerified ) > 0.5 .OR. MaxChild( InteriorFloor:IsVerified ) > 0.5 .OR. MaxChild( UndFloor:IsVerified ) > 0.5 .OR. MaxChild( Win:IsVerified ) > 0.5 .OR. 
																												MaxChild( Skylt:IsVerified ) > 0.5 .OR. MaxChild( Door:IsVerified ) > 0.5)
																									then 1
																									else 0 endif endif endif endif
																								else 0 endif	}
;	"debug Proj:ExistingCondVerif - 1"			Proj:Action = { PostWarning( "Default 1 - ExistingCondVerif:  %g", ExistingCondVerif )  }
;	mjb	10/31/14	- make sure rules to not bonk if there are no Ext Walls in project
	"Default Zone:IsVerified -1"				Zone:IsVerified		= { Max( 0, MaxChild( ExtWall:IsVerified) )  }
	"Default Zone:IsVerified -2"				Zone:IsVerified		= { Max( IsVerified, MaxChild( ExteriorFloor:IsVerified) )  }
	"Default Zone:IsVerified -3"				Zone:IsVerified		= { Max( IsVerified, MaxChild( FloorOverCrawl:IsVerified) )  }
	"Default Zone:IsVerified -4"				Zone:IsVerified		= { Max( IsVerified, MaxChild( CathedralCeiling:IsVerified) )  }
	"Default Zone:IsVerified -5"				Zone:IsVerified		= { Max( IsVerified, MaxChild( CeilingBelowAttic:IsVerified) )  }
	"Default Zone:IsVerified -6"				Zone:IsVerified		= { Max( IsVerified, MaxChild( UndWall:IsVerified) )  }
	"Default Zone:IsVerified -7"				Zone:IsVerified		= { Max( IsVerified, MaxChild( UndFloor:IsVerified) )  }
	"Default Zone:IsVerified -8"				Zone:IsVerified		= { Max( IsVerified, MaxChild( SlabFloor:IsVerified) )  }

;	mjb	8/5/14	- corrected placement of ) in MaxChild() function below
	"Default Proj:ExistingCondVerif -2"		Proj:ExistingCondVerif	= {	if ( ExistingCondVerif > 0.5 ) then UNCHANGED else
																									if ( MaxChild(Zone:IsVerified) > 0.5 ) then 1 else 0 endif endif	}
;	"debug Proj:ExistingCondVerif - 2"			Proj:Action = { PostWarning( "Default 2 - ExistingCondVerif:  %g", ExistingCondVerif )  }
																							
   ;--------------------------------------------------------------------
   ; ProposedInput: Defaulting of HVAC & DHW reporting object properties
   ;--------------------------------------------------------------------
  ; mjb  4/21/14 - "Mech1" replaced with "SCSysRpt" in data model
	"Default SCSysRpt properties - general"		SCSysRpt:Action	= {	EvalRulelist( "Default_SCSysReportObject", 1 )  }
;	"Default SCSysRpt properties - general"		SCSysRpt:Action	= {	if (ParentComponentType() == "HVACSys" .OR. ParentComponentType() == "DwellUnit")
;																								then  EvalRulelist( "Default_SCSysReportObject", 1 )
;																								else	UNCHANGED  endif  }

	"Default DHWSysRpt properties - general"		DHWSysRpt:Action	= {	     if (ParentComponentType() == "DHWSys") then  EvalRulelist( "Default_DHWSysReportObject_DHWSysParent", 1 )
																								else if (ParentComponentType() == "DwellUnit" .AND. LocalCompAssigned( DHWSysRef )) then  EvalRulelist( "Default_DHWSysReportObject_DwellUnitParent", 1 )
																								else  UNCHANGED  endif endif  }

	; SAC 10/12/15 - added to ensure only one New DHWSys in standard design model
	; SAC 10/24/15 - split into central and non-central DHWSys assignments
	"Set Proj:MaxNewCntrlDHWSys"		Proj:MaxNewCntrlDHWSys	= {	if (RunID == "Standard" .OR. RunAbbrev == "dr" .OR. RunScope != 1) then  UNCHANGED
																						else	MaxAllComp( DHWSys:NewCntrlAreaServed[1] )  endif  }
	"Set Proj:MaxNewNCntrlDHWSys"		Proj:MaxNewNCntrlDHWSys	= {	if (RunID == "Standard" .OR. Proj:RunAbbrev == "dr" .OR. RunScope != 1) then  UNCHANGED
																						else	MaxAllComp( DHWSys:AreaServedDetails[1] )  endif  }		; SAC 2/25/16 - previously summed DHWSys:NewNCntrlAreaServed[1]
	; SAC 2/24/16 - additions to address ticket #607 - EAA DHW assignments
	"Set Proj:SFamAreaByDHWCateg[1] - New"			Proj:SFamAreaByDHWCateg[1]	= {	if (Proj:IsMultiFamily > 0.5)	then  0
																											else	SumAll( Zone:DHWSys1NewCondFloorArea ) + SumAll( Zone:DHWSys2NewCondFloorArea )  endif  }
	"Set Proj:SFamAreaByDHWCateg[2] - Altered"	Proj:SFamAreaByDHWCateg[2]	= {	if (Proj:IsMultiFamily > 0.5)	then  0
																											else	SumAll( Zone:DHWSys1AltCondFloorArea ) + SumAll( Zone:DHWSys2AltCondFloorArea )  endif  }
	"Set Proj:SFamAreaByDHWCateg[3] - Existing"	Proj:SFamAreaByDHWCateg[3]	= {	if (Proj:IsMultiFamily > 0.5)	then  0
																											else	SumAll( Zone:DHWSys1ExCondFloorArea  ) + SumAll( Zone:DHWSys2ExCondFloorArea  )  endif  }
	"Set Proj:MaxDHWSysByCateg[1] - New, Non-central"			Proj:MaxDHWSysByCateg[1]	= {	if (RunID == "Standard" .OR. RunAbbrev == "dr") then  UNCHANGED
																															else if (MaxAll( DHWSys:AreaServedDetails[1] ) > 0.5) then  MaxAllComp( DHWSys:AreaServedDetails[1] )  else  UNDEFINED  endif endif  }
	"Set Proj:MaxDHWSysByCateg[2] - Altered, Non-central"		Proj:MaxDHWSysByCateg[2]	= {	if (RunID == "Standard" .OR. RunAbbrev == "dr") then  UNCHANGED
																															else if (MaxAll( DHWSys:AreaServedDetails[2] ) > 0.5) then  MaxAllComp( DHWSys:AreaServedDetails[2] )  else  UNDEFINED  endif endif  }
	"Set Proj:MaxDHWSysByCateg[3] - Existing, Non-central"	Proj:MaxDHWSysByCateg[3]	= {	if (RunID == "Standard" .OR. RunAbbrev == "dr") then  UNCHANGED
																															else if (MaxAll( DHWSys:AreaServedDetails[3] ) > 0.5) then  MaxAllComp( DHWSys:AreaServedDetails[3] )  else  UNDEFINED  endif endif  }
	"Set Proj:MaxDHWSysByCateg[4] - New, Central"				Proj:MaxDHWSysByCateg[4]	= {	if (RunID == "Standard" .OR. RunAbbrev == "dr") then  UNCHANGED
																															else if (MaxAll( DHWSys:AreaServedDetails[4] ) > 0.5) then  MaxAllComp( DHWSys:AreaServedDetails[4] )  else  UNDEFINED  endif endif  }
	"Set Proj:MaxDHWSysByCateg[5] - Altered, Central"			Proj:MaxDHWSysByCateg[5]	= {	if (RunID == "Standard" .OR. RunAbbrev == "dr") then  UNCHANGED
																															else if (MaxAll( DHWSys:AreaServedDetails[5] ) > 0.5) then  MaxAllComp( DHWSys:AreaServedDetails[5] )  else  UNDEFINED  endif endif  }
	"Set Proj:MaxDHWSysByCateg[6] - Existing, Central"			Proj:MaxDHWSysByCateg[6]	= {	if (RunID == "Standard" .OR. RunAbbrev == "dr") then  UNCHANGED
																															else if (MaxAll( DHWSys:AreaServedDetails[6] ) > 0.5) then  MaxAllComp( DHWSys:AreaServedDetails[6] )  else  UNDEFINED  endif endif  }

; SAC 12/12/13 - new flag indicating whether or not to SIMULATE Standard design DHW systems/heaters (expected only for E+A+A scenarios)
; SAC 7/1/14 - revised logic to prevent resetting SimulateStdDHW to zero after having set it to '1' for E+A+A standard design run
	"Set Proj:SimulateStdDHW - (0/1) indicating whether or not to simulate DHW systems in the Standard design model (to support E+A+A - 0 for New, 1 for EAA)"
				Proj:SimulateStdDHW	= {	if ((RunID == "Standard" .OR. RunAbbrev == "dr") .AND. LocalStatus( SimulateStdDHW ) > 5)
													then	UNCHANGED  else  0  endif  }

; SAC 12/4/13 - added UI control labels for HVAC & DHW system assignments
;	"Set Zone:UILabel_HVACSys[1]"		Zone:UILabel_HVACSys[1]	= {	     if (Proj:IsMultiFamily > 0.5 .OR.
;																						         Proj:RunScope == 1) then  "       HVAC System:"
;																						else if (HVACSysStatus == 3) then  "New HVAC System:"
;																						else if (HVACSysStatus == 2) then  "Altered HVAC Sys:"
;																															  else  "Existing HVAC Sys:"  endif endif endif  }
;	mjb	9/30/14 - mod label for IsAddAlone
	"Set Zone:UILabel_HVACSys[1]"		Zone:UILabel_HVACSys[1]	= {	     if (Proj:IsMultiFamily > 0.5 .OR.
																									(Proj:RunScope == 1 .AND. Proj:IsAddAlone < 1)) then  "       HVAC System:"
																						else if (HVACSysStatus == 3) then  "New HVAC System:"
																						else if (HVACSysStatus == 2) then  "Altered HVAC Sys:"
																															  else  "Existing HVAC Sys:"  endif endif endif  }
	"Set Zone:UILabel_HVACSys[2]"		Zone:UILabel_HVACSys[2]	= {	if (Proj:IsMultiFamily < 0.5 .AND. Proj:RunScope == 2 .AND. HVACSysStatus == 2 .AND. HVACSysVerified) then  "Existing HVAC Sys:"  else  " "  endif  }

	"Set Zone:UILabel_DHWSys1[1]"		Zone:UILabel_DHWSys1[1]	= {	     if (Proj:IsMultiFamily > 0.5 .OR.
																						         Proj:RunScope == 1) then  "       DHW System 1:"
																						else if (DHWSys1Status == 3) then  "New DHW System 1:"
																						else if (DHWSys1Status == 2) then  "Altered DHW Sys 1:"
																															  else  "Existing DHW Sys 1:"  endif endif endif  }
	"Set Zone:UILabel_DHWSys1[2]"		Zone:UILabel_DHWSys1[2]	= {	if (Proj:IsMultiFamily < 0.5 .AND. Proj:RunScope == 2 .AND. DHWSys1Status == 2 .AND. DHWSys1Verified) then  "Existing DHW Sys 1:"  else  " "  endif  }

	"Set Zone:UILabel_DHWSys2[1]"		Zone:UILabel_DHWSys2[1]	= {	     if (Proj:IsMultiFamily > 0.5) then  " "
																						else if (Proj:RunScope == 1) then  "       DHW System 2:"
																						else if (DHWSys2Status == 3) then  "New DHW System 2:"
																						else if (DHWSys2Status == 2) then  "Altered DHW Sys 2:"
																															  else  "Existing DHW Sys 2:"  endif endif endif endif  }
	"Set Zone:UILabel_DHWSys2[2]"		Zone:UILabel_DHWSys2[2]	= {	if (Proj:IsMultiFamily < 0.5 .AND. Proj:RunScope == 2 .AND. DHWSys2Status == 2 .AND. DHWSys2Verified) then  "Existing DHW Sys 2:"  else  " "  endif  }

  ; SAC 1/6/16 - RESET Proj:Fuel_HaveOther flag if it was set to 0 but there are Propane use selections (and the ruleset version is < 2016) (tic 374)
	"Set flag - Proj:Fuel_HaveOther"		Proj:Fuel_HaveOther		= {	if (Fuel_HaveOther < 0.5 .AND. StandardsVersion < 2016)
																							then	if (IsMultiFamily < 0.5 .AND. ((Appl_HaveDryer[1] > 0.5 .AND. ApplDryerFuel[1] = 3) .OR.
																																			 (Appl_HaveCook[ 1] > 0.5 .AND. ApplCookFuel[ 1] = 3))) then  1
																									else if (SumAll( DHWHeater:AreaServedByFuel[3] ) > 1 .OR. SumAll( DHWHeater:AreaServedByFuel[5] ) > 1) then  1
																									else  UNCHANGED  endif endif
																							else	UNCHANGED  endif  }

   ;--------------------------------------------------------------------
   ; ProposedInput: Blast all LayerParams objects following ProposedInput defaulting
   ;--------------------------------------------------------------------

; SAC 3/17/14 - to be REMOVED
; "store BEMProc details"		Proj:Action = {  StoreBEMProc( "Before LayerParams-Mat cleanup", 0 )  }

	"Blast all LayerParams objects"			Proj:Action	= {	DeleteAllComps( LayerParams )  }
	"Blast Mats marked for deletion"			Mat:Action	= {	if (IfValidAnd( MarkForDeletion == 1 )) then  DeleteComp()  else  UNCHANGED  endif  }		; SAC 3/17/14
;	"Blast Mats not referenced by Cons:*"	Mat:Action	= {	if (CountRefs( Cons:CavityPathMats ) < 1 .AND. CountRefs( Cons:FramePathMats ) < 1) then  DeleteComp()  else  UNCHANGED  endif  }		; SAC 3/21/14

; SAC 3/17/14 - to be REMOVED
; "store BEMProc details"		Proj:Action = {  StoreBEMProc( "After LayerParams-Mat cleanup", 0 )  }
; "debug"		Proj:Action	= {	MessageBox( "LayerParams-Mat cleanup done." )  }

; SAC 2/2/15 - new rulelist evaluation calls to ensure that AirNet ELA properties are defaulted in ProposedInput - ONLY FOR BypassRuleLimits
	"evaluate ...SummarizeModel rules when in BypassRuleLimits mode"	Proj:Action	= {	if (BypassRuleLimits < 0.5) then  UNCHANGED
																													else  EvalRulelist( "Reporting_SummarizeModel" )  endif  }
	"evaluate ...CSE_AirNet_ELA rules when in BypassRuleLimits mode"	Proj:Action	= {	if (BypassRuleLimits < 0.5) then  UNCHANGED
																													else  EvalRulelist( "Default_CSE_AirNet_ELA" )  endif  }

END

;*************************************************************************

; SAC 4/14/15 - new rulelist to handle ALL Attic defaulting
;*************************************************************************
RULELIST "Default_Attic"  0 0 0 0
;*************************************************************************
  ; SAC 1/17/13 - added default attic roof construction assignment
	"Default Attic:Construction"		Attic:Construction	= {	if (LocalCompAssigned( Construction )) then  UNCHANGED
																					else	RuleLibrary( Cons, "Asphalt Shingle Roof" )  endif  }

  ; default rules that feed into attic edge defaults in the Cons object
	"Default Attic:RoofRise"	Attic:RoofRise		= {	5 }
	"Set Attic:RoofPitch"		Attic:RoofPitch	= {	if (IfValidAnd( RoofRise > 0 )) then  RoofRise / 12  else  0  endif  }
	"Set Attic:SteepSlope"		Attic:SteepSlope	= {	if (IfValidAnd( RoofRise > 2 )) then  1  else  0  endif  }
; SAC 4/28/14 - moved up here from below to ensure that Attic:RoofTilt is set prior to attic edge calcs (where it can now be referenced)
	"Set Attic:RoofTilt"			Attic:RoofTilt		= {	if (IfValidAnd( RoofPitch > 0)) then  atan( RoofPitch ) * 180 / 3.14159265
																		else  0  endif  }

; SAC 11/3/14 - call subordinate rulelist to evaluate certain other attic area rules used to determine when attics are cool-ventable and can be assigned to CathedralCeilings converted to CeilingBelowAttics for std design model
	"Perform more Attic area defaulting"	Attic:Action	= {	EvalRulelist( "Default_AtticAreas", 1 )  }
END

;*************************************************************************
RULELIST "Default_AtticAreas"  0 0 0 0
;*************************************************************************
	"Set Attic:FloorArea"				Attic:FloorArea			= {	SumRevRef( CeilingBelowAttic:AtticZone, CeilingBelowAttic:Area )  }
	"Set Attic:FloorAreaOverCond"		Attic:FloorAreaOverCond	= {	SumRevRef( CeilingBelowAttic:AtticZone, CeilingBelowAttic:AreaOverCond )  }
	"Set Attic:ToBeSimulated"			Attic:ToBeSimulated		= {	if (FloorArea > 0.1) then  1  else  0  endif  }		; SAC 5/11/15 - related to fix for isse 536

		;EM 2/11/15
	"Set Attic:FloorAreaOverNewZone"		Attic:FloorAreaOverNewZone	= {	SumRevRef( CeilingBelowAttic:AtticZone, CeilingBelowAttic:AreaOverNewZone )  }
	
	"Set Attic:OnlyOverUncond"			Attic:OnlyOverUncond		= {	if (IfValidAnd( FloorArea > 0.1 ) .AND. IfValidAnd( FloorAreaOverCond > 0.1 )==0) then  1  else  0  endif  }	; SAC 11/19/14

; SAC 10/14/14 - added properties needed to enable multiple Attic obejcts per model
; SAC 12/14/14 - added logic to prevent ClVentableArea > 0 if this attic not over any conditioned zones
	"Set Attic:ClVentableArea"			Attic:ClVentableArea		= {	if (Type == 0 .AND. IfValidAnd( FloorAreaOverCond > 0.1 )) then  FloorArea  else  0  endif  }

; SAC 11/3/14 - added property to determine which, if any, Attic objects can be used to link to proposed model CathedralCeilings that are converted to CeilingBelowAttic for the standard design model
	"Set Attic:StdCathClgAtticArea"	Attic:StdCathClgAtticArea	= {	if ((Status == 2 .OR. Status == 3) .AND. Type == 0)	; New or Altered -and- Ventilated Attic
																							then  FloorArea  else  0  endif  }

	; SAC 9/23/15 - properties used to setup 2016 standard design roof constructions based on roof pitch
	"Set Attic:SteepRoofArea"			Attic:SteepRoofArea		= {	if (IfValidAnd( FloorArea > 0.1 ) .AND. IfValidAnd( SteepSlope > 0.5 )) then  FloorArea  else  0  endif  }
	"Set Attic:FlatRoofArea"			Attic:FlatRoofArea		= {	if (IfValidAnd( FloorArea > 0.1 ) .AND. IfValidAnd( SteepSlope < 0.5 )) then  FloorArea  else  0  endif  }
END


; SAC 10/6/15 - separate out rules to force reset of DHWSys assignments and set NumDHWSysAssigns, DHWSysAssignFrac & DHWSysFlrArea (to facilitate DHW BudgetConversion)
;*************************************************************************
RULELIST "Default_DwellUnitType_DHWSysRefs"  0 0 0 0

  ; SAC 11/20/14 - rules to FORCE reset of array elements beyond those valid based on NumDHWSysTypes
	"Force reset of DwellUnitType:DHWSysRef[1]"		DwellUnitType:Action		= {	if (NumDHWSysTypes >= 1 .OR. LocalStatus( DHWSysRef[1] ) < 6) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_DHWSysRef_1", 1 )  endif  }
	"Force reset of DwellUnitType:DHWSysRef[2]"		DwellUnitType:Action		= {	if (NumDHWSysTypes >= 2 .OR. LocalStatus( DHWSysRef[2] ) < 6) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_DHWSysRef_2", 1 )  endif  }
	"Force reset of DwellUnitType:DHWSysRef[3]"		DwellUnitType:Action		= {	if (NumDHWSysTypes >= 3 .OR. LocalStatus( DHWSysRef[3] ) < 6) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_DHWSysRef_3", 1 )  endif  }
	"Force reset of DwellUnitType:DHWSysRef[4]"		DwellUnitType:Action		= {	if (NumDHWSysTypes >= 4 .OR. LocalStatus( DHWSysRef[4] ) < 6) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_DHWSysRef_4", 1 )  endif  }
	"Force reset of DwellUnitType:DHWSysRef[5]"		DwellUnitType:Action		= {	if (NumDHWSysTypes >= 5 .OR. LocalStatus( DHWSysRef[5] ) < 6) then  UNCHANGED
																											else	EvalRulelist( "ForceReset_DwellUnitType_DHWSysRef_5", 1 )  endif  }
	; "Default DwellUnitType:DHWSysRef"
	"Set DwellUnitType:NumDHWSysAssigns - Number of DHWSys assignments - 1"
																DwellUnitType:NumDHWSysAssigns	= {	if (NumDHWSysTypes >= 1 .AND. LocalCompAssigned( DHWSysRef[1] ))
																													then	if (DHWSysRef[1]:NumDHWHeaters > 0.5) then  1  else  0  endif		else	0  endif  }
	"Set DwellUnitType:NumDHWSysAssigns - 2"		DwellUnitType:NumDHWSysAssigns	= {	if (NumDHWSysTypes >= 2 .AND. LocalCompAssigned( DHWSysRef[2] ))
																													then	if (DHWSysRef[2]:NumDHWHeaters > 0.5) then  NumDHWSysAssigns + 1  else  UNCHANGED  endif		else	UNCHANGED  endif  }
	"Set DwellUnitType:NumDHWSysAssigns - 3"		DwellUnitType:NumDHWSysAssigns	= {	if (NumDHWSysTypes >= 3 .AND. LocalCompAssigned( DHWSysRef[3] ))
																													then	if (DHWSysRef[3]:NumDHWHeaters > 0.5) then  NumDHWSysAssigns + 1  else  UNCHANGED  endif		else	UNCHANGED  endif  }
	"Set DwellUnitType:NumDHWSysAssigns - 4"		DwellUnitType:NumDHWSysAssigns	= {	if (NumDHWSysTypes >= 4 .AND. LocalCompAssigned( DHWSysRef[4] ))
																													then	if (DHWSysRef[4]:NumDHWHeaters > 0.5) then  NumDHWSysAssigns + 1  else  UNCHANGED  endif		else	UNCHANGED  endif  }
	"Set DwellUnitType:NumDHWSysAssigns - 5"		DwellUnitType:NumDHWSysAssigns	= {	if (NumDHWSysTypes >= 5 .AND. LocalCompAssigned( DHWSysRef[5] ))
																													then	if (DHWSysRef[5]:NumDHWHeaters > 0.5) then  NumDHWSysAssigns + 1  else  UNCHANGED  endif		else	UNCHANGED  endif  }
	"Set DwellUnitType:DHWSysAssignFrac"			DwellUnitType:DHWSysAssignFrac	= {	if (IfValidAnd( NumDHWSysAssigns > 0 )) then  1 / NumDHWSysAssigns  else  0  endif  }
	"Set DwellUnitType:DHWFlrAreaPerSys - Conditioned floor area (per unit) per assigned DHWSys" 	
																DwellUnitType:DHWFlrAreaPerSys	= {	if (IfValidAnd( DHWSysAssignFrac > 0 )==0) then  0
																													else if (IfValidAnd( CondFlrArea > 0 )) then  min( CondFlrArea, 2500 ) * DHWSysAssignFrac  else  0  endif endif  }
END
;*************************************************************************

; SAC 10/6/15 - extracted rules from ProposedInput related to setting DHWHeater floor area served & hydronic heating properties to facilitate their evaluation during BudgetConversion
;*************************************************************************
RULELIST "Default_DHWHeater_AreaServedAndHydronic"  0 0 0 0

; SAC 10/6/15 - not ever referenced (?)
;	"Set Zone:DHWSys1Assigned"			Zone:DHWSys1Assigned		= {	if (LocalCompAssigned( DHWSys1 ) > 0) then  1  else  0  endif  }	; SAC 6/27/14 - may require adjustment for MFam DwellUnit, but no apparent use right now
;	"Set Zone:DHWSys2Assigned"			Zone:DHWSys2Assigned		= {	if (LocalCompAssigned( DHWSys2 ) > 0) then  1  else  0  endif  }

	; SAC 3/1/16 - add logic to account for Existing systems in AddAlone models (tic #607)
	"Set Zone:NumDHWSysAssigns - 1"	Zone:NumDHWSysAssigns	= {	if (Proj:IsMultiFamily > 0.5) then  0		; not used for MFam
																						else if (((Proj:RunScope == 1 .AND. Proj:IsAddAlone < 1) .OR. DHWSys1Status == 3) .AND. LocalCompAssigned( DHWSys1 ) > 0) then  1
																						else if (  Proj:RunScope == 2 .AND. DHWSys1Status == 2 .AND. LocalCompAssigned( AltDHWSys1 ) > 0) then  1
																						else if ( (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0) .AND. DHWSys1Status == 1 .AND. LocalCompAssigned(  exDHWSys1 ) > 0) then  1
																						else  0  endif endif endif endif  }
	"Set Zone:NumDHWSysAssigns - 2"	Zone:NumDHWSysAssigns	= {	if (Proj:IsMultiFamily > 0.5) then  UNCHANGED		; not used for MFam
																						else if (((Proj:RunScope == 1 .AND. Proj:IsAddAlone < 1) .OR. DHWSys2Status == 3) .AND. LocalCompAssigned( DHWSys2 ) > 0) then  NumDHWSysAssigns + 1
																						else if (  Proj:RunScope == 2 .AND. DHWSys2Status == 2 .AND. LocalCompAssigned( AltDHWSys2 ) > 0) then  NumDHWSysAssigns + 1
																						else if ( (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0) .AND. DHWSys2Status == 1 .AND. LocalCompAssigned(  exDHWSys2 ) > 0) then  NumDHWSysAssigns + 1
																						else  UNCHANGED  endif endif endif endif  }
	"Set Zone:DHWSysAssignFrac"		Zone:DHWSysAssignFrac	= {	if (IfValidAnd( NumDHWSysAssigns > 0 )==0) then  0  else  1 / NumDHWSysAssigns  endif  }

; SAC 7/26/16 - moved down from above to set it after DHWSysAssignFrac is set - DHWSysAssignFrac set in above rulelist eval, and now referenced in the following rules (tic #711)
   "Set Zone:DHWFloorArea - 1"   Zone:DHWFloorArea   = {   if (Proj:IsMultiFamily > 0.5) then  SumChildren( DwellUnit:TotalDHWFlrArea )
                                                           else if (LocalCompAssigned( DHWSys1 ) == 0) then  0
                                                           else if (DHWSys1:NumDHWHeaters  > 0.5) then  (FloorArea * DHWSysAssignFrac)  else  0  endif endif endif  }
   "Set Zone:DHWFloorArea - 2"   Zone:DHWFloorArea   = {   if (Proj:IsMultiFamily > 0.5 .OR. LocalCompAssigned( DHWSys2 ) == 0) then  UNCHANGED
                                                           else if (DHWSys2:NumDHWHeaters  > 0.5) then  DHWFloorArea + (FloorArea * DHWSysAssignFrac)  else  UNCHANGED  endif endif  }

	"Set Zone:HasDHWUse"					Zone:HasDHWUse				= {	if (IfValidAnd( CondFloorArea > 0.1 )==0) then  0  else  1  endif  }		; SAC 10/12/15 - needed for below rule setting 
	; HW consumption based on Res ACM, App E, Sec E3.1
	; SAC 10/12/15 - revised logic to use CondFloorArea for entire dwelling and divide the load across each Zone in the model
	; SAC 3/1/16 - add logic to reduce DHW load in New Cons Addition Alone models (tic #607)
; SAC 3/10/16 - RESNET rules affecting DHW use NOT integrated from MJB update
; SAC 8/31/16 - added adjustment to split load across multiple systems assigned to this zone (Zone:DHWSysAssignFrac) (tic #739)
	"Set Zone:DHWDailyConsPerSys"		Zone:DHWDailyConsPerSys	= {	if (Proj:IsMultiFamily > 0.5 .OR. HasDHWUse < 0.5) then  0		; not used for MFam (or no CondFloorArea)
																				;		else	21.4 + (0.00679 * min( CondFloorArea, 2500 ))  endif  }
																						else if (Proj:RunScope == 1 .AND. Proj:IsAddAlone > 0 .AND. IfValidAnd( Proj:AdditionCFAFrac > 0 ) .AND. IfValidAnd( Proj:AddAloneTotalArea > 0 ))
																						then  ( (21.4 + (0.00679 * min( SumAll( Proj:AddAloneTotalArea ), 2500 ))) * DHWSysAssignFrac / SumAll( Zone:HasDHWUse ) ) * Proj:AdditionCFAFrac
																						else	  (21.4 + (0.00679 * min( SumAll( Zone:CondFloorArea     ), 2500 ))) * DHWSysAssignFrac / SumAll( Zone:HasDHWUse )  endif endif  }

  ; SAC 2/26/16 - added for error checking associated w/ ticket #607
	"Set Zone:DHWUnassignedFloorArea[1] - New"		Zone:DHWUnassignedFloorArea[1]	= {	if (NumDHWSysAssigns > 0) then  0
																														else if (Proj:IsMultiFamily > 0.5) then  0		; MFam via DwellUnit(Type) ??
																														else if (Proj:RunScope == 1 .OR. DHWSys1Status == 3) then  CondFloorArea
																														else	0  endif endif endif  }
	"Set Zone:DHWUnassignedFloorArea[2] - Altered"	Zone:DHWUnassignedFloorArea[2]	= {	if (NumDHWSysAssigns > 0) then  0
																														else if (Proj:IsMultiFamily > 0.5) then  0		; MFam via DwellUnit(Type) ??
																														else if (Proj:RunScope == 2 .AND. DHWSys1Status == 2) then  CondFloorArea
																														else	0  endif endif endif  }
	"Set Zone:DHWUnassignedFloorArea[3] - Existing"	Zone:DHWUnassignedFloorArea[3]	= {	if (NumDHWSysAssigns > 0) then  0
																														else if (Proj:IsMultiFamily > 0.5) then  0		; MFam via DwellUnit(Type) ??
																														else if (Proj:RunScope == 2 .AND. DHWSys1Status == 1) then  CondFloorArea
																														else	0  endif endif endif  }

   "Set Zone:DHWSys1NewCondFloorArea"     Zone:DHWSys1NewCondFloorArea  = {   if (Proj:IsMultiFamily > 0.5)
                                                                              then  if (DHWFloorArea > 0) 
                                                                                    then  CondFloorArea  else  0  endif
                                                                              else if (Proj:RunScope == 2)
                                                                              then  if (DHWSys1Status == 3 .AND. LocalCompAssigned( DHWSys1 ) > 0) 
                                                                                    then  min( CondFloorArea, 2500 ) * DHWSysAssignFrac  else  0  endif
                                                                              else  min( CondFloorArea, 2500 ) * DHWSysAssignFrac  endif endif  }
   "Set Zone:DHWSys1AltCondFloorArea"     Zone:DHWSys1AltCondFloorArea  = {   if (Proj:IsMultiFamily < 0.5 .AND.  Proj:RunScope == 2 .AND. DHWSys1Status == 2 .AND. LocalCompAssigned( AltDHWSys1 ) > 0) then  min( CondFloorArea, 2500 ) * DHWSysAssignFrac  else  0  endif  }
  ; SAC 3/1/16 - altered logic to allow Existing DHW for AddAlone projects (#607)
   "Set Zone:DHWSys1ExCondFloorArea"		Zone:DHWSys1ExCondFloorArea	= {	if (Proj:IsMultiFamily < 0.5 .AND. (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0) .AND. DHWSys1Status == 1 .AND. LocalCompAssigned(  exDHWSys1 ) > 0) then  min( CondFloorArea, 2500 ) * DHWSysAssignFrac  else  0  endif  }

	"Set Zone:DHWSys2NewCondFloorArea"		Zone:DHWSys2NewCondFloorArea	= {	if (Proj:IsMultiFamily > 0.5) then  0
																										else if (Proj:RunScope == 2)
																								         then	if (DHWSys2Status == 3 .AND. LocalCompAssigned( DHWSys2 ) > 0) then  min( CondFloorArea, 2500 ) * DHWSysAssignFrac  else  0  endif
																								      else	min( CondFloorArea, 2500 ) * DHWSysAssignFrac  endif endif  }
	"Set Zone:DHWSys2AltCondFloorArea"		Zone:DHWSys2AltCondFloorArea	= {	if (Proj:IsMultiFamily < 0.5 .AND.  Proj:RunScope == 2 .AND. DHWSys2Status == 2 .AND. LocalCompAssigned( AltDHWSys2 ) > 0) then  min( CondFloorArea, 2500 ) * DHWSysAssignFrac  else  0  endif  }
	"Set Zone:DHWSys2ExCondFloorArea"		Zone:DHWSys2ExCondFloorArea	= {	if (Proj:IsMultiFamily < 0.5 .AND. (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0) .AND. DHWSys2Status == 1 .AND. LocalCompAssigned(  exDHWSys2 ) > 0) then  min( CondFloorArea, 2500 ) * DHWSysAssignFrac  else  0  endif  }
;	"debug"		Zone:Action	= {	MessageBox( "PROP INPUT -- Zone '%s':  DHWSys1NewCondFloorArea = %g, DHWSys1AltCondFloorArea = %g, DHWSys1ExCondFloorArea = %g", Name, DHWSys1NewCondFloorArea, DHWSys1AltCondFloorArea, DHWSys1ExCondFloorArea )  }

; mjb 12/18/13 - need to keep track of floor area served by DHWSys
; SAC 6/27/14 - rules to track MFam DwellUnit floor area served by each DHWSys
; SAC 9/23/15 - added 'Proj:IsMultiFamily > 0.5 .AND. ' to following rules to ensure that DUT & DU objects milling around in SFam models don't effect setting of these properties
	"Set DHWSys:FloorAreaServed[1] - Init"		DHWSys:FloorAreaServed[1]	= {	0  }
	"Set DHWSys:FloorAreaServed[1] - MFam-1"	DwellUnit:DwellUnitTypeRef:DHWSysRef[1]:FloorAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. DwellUnitTypeRef:NumDHWSysTypes > 0) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[1]:FloorAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:FloorAreaServed[1] - MFam-2"	DwellUnit:DwellUnitTypeRef:DHWSysRef[2]:FloorAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. DwellUnitTypeRef:NumDHWSysTypes > 1) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[2]:FloorAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:FloorAreaServed[1] - MFam-3"	DwellUnit:DwellUnitTypeRef:DHWSysRef[3]:FloorAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. DwellUnitTypeRef:NumDHWSysTypes > 2) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[3]:FloorAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:FloorAreaServed[1] - MFam-4"	DwellUnit:DwellUnitTypeRef:DHWSysRef[4]:FloorAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. DwellUnitTypeRef:NumDHWSysTypes > 3) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[4]:FloorAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:FloorAreaServed[1] - MFam-5"	DwellUnit:DwellUnitTypeRef:DHWSysRef[5]:FloorAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. DwellUnitTypeRef:NumDHWSysTypes > 4) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[5]:FloorAreaServed[1]  else  UNCHANGED  endif  }
	; SAC 12/23/14 - extension of above, but individually for existing/altered/new
	; SAC 4/25/16 - fix bug where Zone:Status used as basis of Ex/Alt/New floor area served, rather than Zone:DHWSys1Status (reported by LF 4/15/16 & 4/22/16)
	"Set DHWSys:ExFlrAreaServed[1] - Init"		DHWSys:ExFlrAreaServed[1]	= {	0  }
	"Set DHWSys:ExFlrAreaServed[1] - MFam-1"	DwellUnit:DwellUnitTypeRef:DHWSysRef[1]:ExFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0) .AND. Zone:DHWSys1Status == 1 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 1) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[1]:ExFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:ExFlrAreaServed[1] - MFam-2"	DwellUnit:DwellUnitTypeRef:DHWSysRef[2]:ExFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0) .AND. Zone:DHWSys1Status == 1 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 2) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[2]:ExFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:ExFlrAreaServed[1] - MFam-3"	DwellUnit:DwellUnitTypeRef:DHWSysRef[3]:ExFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0) .AND. Zone:DHWSys1Status == 1 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 3) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[3]:ExFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:ExFlrAreaServed[1] - MFam-4"	DwellUnit:DwellUnitTypeRef:DHWSysRef[4]:ExFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0) .AND. Zone:DHWSys1Status == 1 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 4) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[4]:ExFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:ExFlrAreaServed[1] - MFam-5"	DwellUnit:DwellUnitTypeRef:DHWSysRef[5]:ExFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. (Proj:RunScope == 2 .OR. Proj:IsAddAlone > 0) .AND. Zone:DHWSys1Status == 1 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 5) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[5]:ExFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:AltFlrAreaServed[1] - Init"	DHWSys:AltFlrAreaServed[1]	= {	0  }
	"Set DHWSys:AltFlrAreaServed[1] - MFam-1"	DwellUnit:DwellUnitTypeRef:DHWSysRef[1]:AltFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. Proj:RunScope == 2 .AND. Zone:DHWSys1Status == 2 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 1) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[1]:AltFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:AltFlrAreaServed[1] - MFam-2"	DwellUnit:DwellUnitTypeRef:DHWSysRef[2]:AltFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. Proj:RunScope == 2 .AND. Zone:DHWSys1Status == 2 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 2) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[2]:AltFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:AltFlrAreaServed[1] - MFam-3"	DwellUnit:DwellUnitTypeRef:DHWSysRef[3]:AltFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. Proj:RunScope == 2 .AND. Zone:DHWSys1Status == 2 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 3) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[3]:AltFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:AltFlrAreaServed[1] - MFam-4"	DwellUnit:DwellUnitTypeRef:DHWSysRef[4]:AltFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. Proj:RunScope == 2 .AND. Zone:DHWSys1Status == 2 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 4) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[4]:AltFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:AltFlrAreaServed[1] - MFam-5"	DwellUnit:DwellUnitTypeRef:DHWSysRef[5]:AltFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. Proj:RunScope == 2 .AND. Zone:DHWSys1Status == 2 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 5) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[5]:AltFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:NewFlrAreaServed[1] - Init"	DHWSys:NewFlrAreaServed[1]	= {	0  }
	"Set DHWSys:NewFlrAreaServed[1] - MFam-1"	DwellUnit:DwellUnitTypeRef:DHWSysRef[1]:NewFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. Zone:DHWSys1Status == 3 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 1) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[1]:NewFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:NewFlrAreaServed[1] - MFam-2"	DwellUnit:DwellUnitTypeRef:DHWSysRef[2]:NewFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. Zone:DHWSys1Status == 3 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 2) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[2]:NewFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:NewFlrAreaServed[1] - MFam-3"	DwellUnit:DwellUnitTypeRef:DHWSysRef[3]:NewFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. Zone:DHWSys1Status == 3 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 3) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[3]:NewFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:NewFlrAreaServed[1] - MFam-4"	DwellUnit:DwellUnitTypeRef:DHWSysRef[4]:NewFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. Zone:DHWSys1Status == 3 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 4) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[4]:NewFlrAreaServed[1]  else  UNCHANGED  endif  }
	"Set DHWSys:NewFlrAreaServed[1] - MFam-5"	DwellUnit:DwellUnitTypeRef:DHWSysRef[5]:NewFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .AND. Zone:DHWSys1Status == 3 .AND. DwellUnitTypeRef:NumDHWSysTypes >= 5) then  TotalDHWFlrArea + DwellUnitTypeRef:DHWSysRef[5]:NewFlrAreaServed[1]  else  UNCHANGED  endif  }

  ; SAC 2/26/16 - removed reference to DHWSys:Status (which is NOT yet set) in determining Ex/Alt/NewFlrAreaServed
	"Set DHWSys:FloorAreaServed[1] - SFam"		DHWSys:FloorAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5)	then  UNCHANGED
																										else	SumRevRef( Zone:DHWSys1,	Zone:DHWSys1NewCondFloorArea ) + SumRevRef( Zone:AltDHWSys1, Zone:DHWSys1AltCondFloorArea ) +
																												SumRevRef( Zone:ExDHWSys1,	Zone:DHWSys1ExCondFloorArea  ) +
																												SumRevRef( Zone:DHWSys2,	Zone:DHWSys2NewCondFloorArea ) + SumRevRef( Zone:AltDHWSys2, Zone:DHWSys2AltCondFloorArea ) +
																												SumRevRef( Zone:ExDHWSys2,	Zone:DHWSys2ExCondFloorArea  )   endif  }
	"Set DHWSys:ExFlrAreaServed[1] - SFam"		DHWSys:ExFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .OR. (Proj:RunScope == 1 .AND. Proj:IsAddAlone < 0.5))	then  UNCHANGED
																										else	SumRevRef( Zone:ExDHWSys1,	 Zone:DHWSys1ExCondFloorArea  ) + SumRevRef( Zone:ExDHWSys2,  Zone:DHWSys2ExCondFloorArea  )   endif  }
	"Set DHWSys:AltFlrAreaServed[1] - SFam"	DHWSys:AltFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5 .OR. (Proj:RunScope == 1 .AND. Proj:IsAddAlone < 0.5))	then  UNCHANGED
																										else	SumRevRef( Zone:AltDHWSys1, Zone:DHWSys1AltCondFloorArea ) + SumRevRef( Zone:AltDHWSys2, Zone:DHWSys2AltCondFloorArea )   endif  }
	"Set DHWSys:NewFlrAreaServed[1] - SFam"	DHWSys:NewFlrAreaServed[1]	= {	if (Proj:IsMultiFamily > 0.5)	then  UNCHANGED
																										else	SumRevRef( Zone:DHWSys1,    Zone:DHWSys1NewCondFloorArea ) + SumRevRef( Zone:DHWSys2,    Zone:DHWSys2NewCondFloorArea )   endif  }

  ; SAC 2/26/16 - new rule to SET DHWSys:Status
	"Set DHWSys:Status"		DHWSys:Status	= {	if (Proj:RunScope == 1 .AND. Proj:IsAddAlone < 0.5) then  3
																else if (NewFlrAreaServed[1] >= AltFlrAreaServed[1] .AND. NewFlrAreaServed[1] >= ExFlrAreaServed[1]) then  3
																else if (AltFlrAreaServed[1] >  NewFlrAreaServed[1] .AND. AltFlrAreaServed[1] >= ExFlrAreaServed[1]) then  2  else  1  endif endif endif  }

	"Set DHWSys:FloorAreaServed[2]"	   DHWSys:FloorAreaServed[2]	= {	FloorAreaServed[1]  }
	"Set DHWSys:FloorAreaServed[3]"	   DHWSys:FloorAreaServed[3]	= {	FloorAreaServed[1]  }
	"Set DHWSys:FloorAreaServed[4]"	   DHWSys:FloorAreaServed[4]	= {	FloorAreaServed[1]  }
	"Set DHWSys:FloorAreaServed[5]"	   DHWSys:FloorAreaServed[5]	= {	FloorAreaServed[1]  }
	"Set DHWSys:FloorAreaServed[6]"	   DHWSys:FloorAreaServed[6]	= {	FloorAreaServed[1]  }
;	"debug"		DHWSys:Action	= {	MessageBox( "PROP INPUT -- DHWSys '%s':  FloorAreaServed = %g", Name, FloorAreaServed  )  }
	"Set DHWSys:ExFlrAreaServed[2]"	   DHWSys:ExFlrAreaServed[2]	= {	ExFlrAreaServed[1]  }
	"Set DHWSys:ExFlrAreaServed[3]"	   DHWSys:ExFlrAreaServed[3]	= {	ExFlrAreaServed[1]  }
	"Set DHWSys:ExFlrAreaServed[4]"	   DHWSys:ExFlrAreaServed[4]	= {	ExFlrAreaServed[1]  }
	"Set DHWSys:ExFlrAreaServed[5]"	   DHWSys:ExFlrAreaServed[5]	= {	ExFlrAreaServed[1]  }
	"Set DHWSys:ExFlrAreaServed[6]"	   DHWSys:ExFlrAreaServed[6]	= {	ExFlrAreaServed[1]  }
	"Set DHWSys:AltFlrAreaServed[2]"	   DHWSys:AltFlrAreaServed[2]	= {	AltFlrAreaServed[1]  }
	"Set DHWSys:AltFlrAreaServed[3]"	   DHWSys:AltFlrAreaServed[3]	= {	AltFlrAreaServed[1]  }
	"Set DHWSys:AltFlrAreaServed[4]"	   DHWSys:AltFlrAreaServed[4]	= {	AltFlrAreaServed[1]  }
	"Set DHWSys:AltFlrAreaServed[5]"	   DHWSys:AltFlrAreaServed[5]	= {	AltFlrAreaServed[1]  }
	"Set DHWSys:AltFlrAreaServed[6]"	   DHWSys:AltFlrAreaServed[6]	= {	AltFlrAreaServed[1]  }
	"Set DHWSys:NewFlrAreaServed[2]"	   DHWSys:NewFlrAreaServed[2]	= {	NewFlrAreaServed[1]  }
	"Set DHWSys:NewFlrAreaServed[3]"	   DHWSys:NewFlrAreaServed[3]	= {	NewFlrAreaServed[1]  }
	"Set DHWSys:NewFlrAreaServed[4]"	   DHWSys:NewFlrAreaServed[4]	= {	NewFlrAreaServed[1]  }
	"Set DHWSys:NewFlrAreaServed[5]"	   DHWSys:NewFlrAreaServed[5]	= {	NewFlrAreaServed[1]  }
	"Set DHWSys:NewFlrAreaServed[6]"	   DHWSys:NewFlrAreaServed[6]	= {	NewFlrAreaServed[1]  }

	"Set DHWSys:NewCntrlAreaServed[1]"		DHWSys:NewCntrlAreaServed[1]	= {	if (IfValidAnd( CentralDHW > 0.5 )) then  NewFlrAreaServed[1] + AltFlrAreaServed[1]  else  0  endif  }
	"Set DHWSys:NewCntrlAreaServed[2]"		DHWSys:NewCntrlAreaServed[2]	= {	NewCntrlAreaServed[1]  }
	"Set DHWSys:NewCntrlAreaServed[3]"		DHWSys:NewCntrlAreaServed[3]	= {	NewCntrlAreaServed[1]  }
	"Set DHWSys:NewCntrlAreaServed[4]"		DHWSys:NewCntrlAreaServed[4]	= {	NewCntrlAreaServed[1]  }
	"Set DHWSys:NewCntrlAreaServed[5]"		DHWSys:NewCntrlAreaServed[5]	= {	NewCntrlAreaServed[1]  }
	"Set DHWSys:NewCntrlAreaServed[6]"		DHWSys:NewCntrlAreaServed[6]	= {	NewCntrlAreaServed[1]  }

	; SAC 2/24/16 - additions to address ticket #607 - EAA DHW assignments
	"Set DHWSys:AreaServedDetails[1] - New, Non-central"			DHWSys:AreaServedDetails[1]	= {	if (IfValidAnd( CentralDHW < 0.5 )) then  NewFlrAreaServed[1]  else  0  endif  }
	"Set DHWSys:AreaServedDetails[2] - Altered, Non-central"		DHWSys:AreaServedDetails[2]	= {	if (IfValidAnd( CentralDHW < 0.5 )) then  AltFlrAreaServed[1]  else  0  endif  }
	"Set DHWSys:AreaServedDetails[3] - Existing, Non-central"	DHWSys:AreaServedDetails[3]	= {	if (IfValidAnd( CentralDHW < 0.5 )) then   ExFlrAreaServed[1]  else  0  endif  }
	"Set DHWSys:AreaServedDetails[4] - New, Central"				DHWSys:AreaServedDetails[4]	= {	if (IfValidAnd( CentralDHW > 0.5 )) then  NewFlrAreaServed[1]  else  0  endif  }
	"Set DHWSys:AreaServedDetails[5] - Altered, Central"			DHWSys:AreaServedDetails[5]	= {	if (IfValidAnd( CentralDHW > 0.5 )) then  AltFlrAreaServed[1]  else  0  endif  }
	"Set DHWSys:AreaServedDetails[6] - Existing, Central"			DHWSys:AreaServedDetails[6]	= {	if (IfValidAnd( CentralDHW > 0.5 )) then   ExFlrAreaServed[1]  else  0  endif  }

	; SAC 7/7/15
	"Set DHWSys:DailyHWConsumption - Init"		DHWSys:DailyHWConsumption	= {	0  }
	"Set DHWSys:DailyHWConsumption - MFam-1"	DwellUnit:DwellUnitTypeRef:DHWSysRef[1]:DailyHWConsumption	= {	if (DwellUnitTypeRef:NumDHWSysTypes > 0) then  (DwellUnitTypeRef:DHWDailyConsPerSys * Count) + DwellUnitTypeRef:DHWSysRef[1]:DailyHWConsumption  else  UNCHANGED  endif  }
	"Set DHWSys:DailyHWConsumption - MFam-2"	DwellUnit:DwellUnitTypeRef:DHWSysRef[2]:DailyHWConsumption	= {	if (DwellUnitTypeRef:NumDHWSysTypes > 1) then  (DwellUnitTypeRef:DHWDailyConsPerSys * Count) + DwellUnitTypeRef:DHWSysRef[2]:DailyHWConsumption  else  UNCHANGED  endif  }
	"Set DHWSys:DailyHWConsumption - MFam-3"	DwellUnit:DwellUnitTypeRef:DHWSysRef[3]:DailyHWConsumption	= {	if (DwellUnitTypeRef:NumDHWSysTypes > 2) then  (DwellUnitTypeRef:DHWDailyConsPerSys * Count) + DwellUnitTypeRef:DHWSysRef[3]:DailyHWConsumption  else  UNCHANGED  endif  }
	"Set DHWSys:DailyHWConsumption - MFam-4"	DwellUnit:DwellUnitTypeRef:DHWSysRef[4]:DailyHWConsumption	= {	if (DwellUnitTypeRef:NumDHWSysTypes > 3) then  (DwellUnitTypeRef:DHWDailyConsPerSys * Count) + DwellUnitTypeRef:DHWSysRef[4]:DailyHWConsumption  else  UNCHANGED  endif  }
	"Set DHWSys:DailyHWConsumption - MFam-5"	DwellUnit:DwellUnitTypeRef:DHWSysRef[5]:DailyHWConsumption	= {	if (DwellUnitTypeRef:NumDHWSysTypes > 4) then  (DwellUnitTypeRef:DHWDailyConsPerSys * Count) + DwellUnitTypeRef:DHWSysRef[5]:DailyHWConsumption  else  UNCHANGED  endif  }
	"Set DHWSys:DailyHWConsumption - SFam"		DHWSys:DailyHWConsumption	= {	if (Proj:IsMultiFamily > 0.5)	then  UNCHANGED
																										else	SumRevRef( Zone:DHWSys1,	Zone:DHWDailyConsPerSys ) + SumRevRef( Zone:AltDHWSys1, Zone:DHWDailyConsPerSys ) +
																												SumRevRef( Zone:ExDHWSys1,	Zone:DHWDailyConsPerSys ) +
																												SumRevRef( Zone:DHWSys2,	Zone:DHWDailyConsPerSys ) + SumRevRef( Zone:AltDHWSys2, Zone:DHWDailyConsPerSys ) +
																												SumRevRef( Zone:ExDHWSys2,	Zone:DHWDailyConsPerSys )   endif  }
	"Set Proj:DailyHWConsumption"			Proj:DailyHWConsumption		= {	SumAll( DHWSys:DailyHWConsumption )  }

	; SAC 10/21/15
	"Set DHWSys:NumDUsServed - Init"		DHWSys:NumDUsServed	= {	0  }
	"Set DHWSys:NumDUsServed - MFam-1"	DwellUnit:DwellUnitTypeRef:DHWSysRef[1]:NumDUsServed	= {	if (DwellUnitTypeRef:NumDHWSysTypes > 0) then  Count + DwellUnitTypeRef:DHWSysRef[1]:NumDUsServed  else  UNCHANGED  endif  }
	"Set DHWSys:NumDUsServed - MFam-2"	DwellUnit:DwellUnitTypeRef:DHWSysRef[2]:NumDUsServed	= {	if (DwellUnitTypeRef:NumDHWSysTypes > 1) then  Count + DwellUnitTypeRef:DHWSysRef[2]:NumDUsServed  else  UNCHANGED  endif  }
	"Set DHWSys:NumDUsServed - MFam-3"	DwellUnit:DwellUnitTypeRef:DHWSysRef[3]:NumDUsServed	= {	if (DwellUnitTypeRef:NumDHWSysTypes > 2) then  Count + DwellUnitTypeRef:DHWSysRef[3]:NumDUsServed  else  UNCHANGED  endif  }
	"Set DHWSys:NumDUsServed - MFam-4"	DwellUnit:DwellUnitTypeRef:DHWSysRef[4]:NumDUsServed	= {	if (DwellUnitTypeRef:NumDHWSysTypes > 3) then  Count + DwellUnitTypeRef:DHWSysRef[4]:NumDUsServed  else  UNCHANGED  endif  }
	"Set DHWSys:NumDUsServed - MFam-5"	DwellUnit:DwellUnitTypeRef:DHWSysRef[5]:NumDUsServed	= {	if (DwellUnitTypeRef:NumDHWSysTypes > 4) then  Count + DwellUnitTypeRef:DHWSysRef[5]:NumDUsServed  else  UNCHANGED  endif  }
	"Set DHWSys:NumDUsServed - SFam"		DHWSys:NumDUsServed	= {	if (Proj:IsMultiFamily > 0.5 .OR. IfValidAnd( DailyHWConsumption > 0 )==0)	then  UNCHANGED
																						else  1  endif  }

	; SAC 10/22/15 - based on stds, table 120.3-A, which for all pipe diameters >= 1 in. and in the temperature range 105-140 is simply 1.5 in.
	"Default DHWSys:LoopPipeInsulThk"	DHWSys:LoopPipeInsulThk		= {	1.5  }

	"Set DHWSys:NumDHWHeaters"		DHWSys:NumDHWHeaters	= {	     if (LocalCompAssigned( DHWHeater[6] )) then  6
																				else if (LocalCompAssigned( DHWHeater[5] )) then  5
																				else if (LocalCompAssigned( DHWHeater[4] )) then  4
																				else if (LocalCompAssigned( DHWHeater[3] )) then  3
																				else if (LocalCompAssigned( DHWHeater[2] )) then  2
																				else if (LocalCompAssigned( DHWHeater[1] )) then  1  else  0  endif endif endif endif endif endif  }

; SAC 1/14/14 - expand to array of 6 to facilitate defaulting of FloorAreaServed for assigned DHWHeaters  (GC issue #264)
	"Set DHWHeater:FloorAreaServed"		DHWHeater:FloorAreaServed 	= {	SumRevRef( DHWSys:DHWHeater, DHWSys:FloorAreaServed ) +
																								SumRevRef( HVACHeat:CHWHeater, HVACHeat:CHFloorAreaServed )  }
	"Set DHWHeater:ExFlrAreaServed"		DHWHeater:ExFlrAreaServed 	= {	SumRevRef( DHWSys:DHWHeater, DHWSys:ExFlrAreaServed ) +
																								SumRevRef( HVACHeat:CHWHeater, HVACHeat:CHExFlrAreaServed )  }
	"Set DHWHeater:AltFlrAreaServed"		DHWHeater:AltFlrAreaServed = {	SumRevRef( DHWSys:DHWHeater, DHWSys:AltFlrAreaServed ) +
																								SumRevRef( HVACHeat:CHWHeater, HVACHeat:CHAltFlrAreaServed )  }
	"Set DHWHeater:NewFlrAreaServed"		DHWHeater:NewFlrAreaServed = {	SumRevRef( DHWSys:DHWHeater, DHWSys:NewFlrAreaServed ) +
																								SumRevRef( HVACHeat:CHWHeater, HVACHeat:CHNewFlrAreaServed )  }
	"Set DHWHeater:AreaServedByFuel[1] - Elec"	DHWHeater:AreaServedByFuel[1]	= {	if (HeaterElementType == 0) then  FloorAreaServed  else  0  endif  }
	"Set DHWHeater:AreaServedByFuel[2] - Gas"		DHWHeater:AreaServedByFuel[2]	= {	if (HeaterElementType == 1) then  FloorAreaServed  else  0  endif  }
	"Set DHWHeater:AreaServedByFuel[3] - Prop"	DHWHeater:AreaServedByFuel[3]	= {	if (HeaterElementType == 2) then  FloorAreaServed  else  0  endif  }
	"Set DHWHeater:AreaServedByFuel[4] - HtPmp"	DHWHeater:AreaServedByFuel[4]	= {	if (HeaterElementType == 3) then  FloorAreaServed  else  0  endif  }
	"Set DHWHeater:AreaServedByFuel[5] - Oil"		DHWHeater:AreaServedByFuel[5]	= {	if (HeaterElementType == 4) then  FloorAreaServed  else  0  endif  }

	; SAC 10/27/15 - identify area this heater serves which is by new/altered AND central DHW systems
	"Set DHWHeater:NewCntrlAreaServed"		DHWHeater:NewCntrlAreaServed		= {	SumRevRef( DHWSys:DHWHeater, DHWSys:NewCntrlAreaServed )  }

; mjb 3/24/14 - set new property used to identify sum of all DHW equip units across all new, altered or existing/verified systems (used for generating DHWSysRpt records)
	"Set DHWSys:TotNumDHWHeaters - 1"	DHWSys:TotNumDHWHeaters	= {	if (NumDHWHeaters > 0 .AND. LocalCompAssigned( DHWHeater[1]  )) then                     HeaterMult[1]   else      0      endif  }
	"Set DHWSys:TotNumDHWHeaters - 2"	DHWSys:TotNumDHWHeaters	= {	if (NumDHWHeaters > 1 .AND. LocalCompAssigned( DHWHeater[2]  )) then  TotNumDHWHeaters + HeaterMult[2]   else  UNCHANGED  endif  }
	"Set DHWSys:TotNumDHWHeaters - 3"	DHWSys:TotNumDHWHeaters	= {	if (NumDHWHeaters > 2 .AND. LocalCompAssigned( DHWHeater[3]  )) then  TotNumDHWHeaters + HeaterMult[3]   else  UNCHANGED  endif  }
	"Set DHWSys:TotNumDHWHeaters - 4"	DHWSys:TotNumDHWHeaters = {	if (NumDHWHeaters > 3 .AND. LocalCompAssigned( DHWHeater[4]  )) then  TotNumDHWHeaters + HeaterMult[4]   else  UNCHANGED  endif  }
	"Set DHWSys:TotNumDHWHeaters - 5"	DHWSys:TotNumDHWHeaters = {	if (NumDHWHeaters > 4 .AND. LocalCompAssigned( DHWHeater[5]  )) then  TotNumDHWHeaters + HeaterMult[5]   else  UNCHANGED  endif  }
	"Set DHWSys:TotNumDHWHeaters - 6"	DHWSys:TotNumDHWHeaters	= {	if (NumDHWHeaters > 5 .AND. LocalCompAssigned( DHWHeater[6]  )) then  TotNumDHWHeaters + HeaterMult[6]   else  UNCHANGED  endif  }
	"Set Proj:NumDHWEquipUnits"		Proj:NumDHWEquipUnits	= {	SumAll( DHWSys:TotNumDHWHeaters )  }

;	mjb	3/24/14 - set DHWSys:IsHydronic for DHWSysRpt object
	"Set DHWHeater:IsHydronic"		DHWHeater:IsHydronic  =	{	if ( SumRevRef( HVACHeat:CHWHeater, HVACHeat:CHFloorAreaServed ) > 0.5 ) then 1 else 0 endif	}
;	"Set DHWSys:IsHydronic"			DHWSys:IsHydronic     =	{	if ( SumAll( DHWHeater:IsHydronic ) > 0.5 ) then 1 else 0 endif	}
; SAC 4/30/15 - fix bug in above rule where DHWSys:IsHydronic set to TRUE for ALL DHWSys objects if ANY DHWHeater:IsHydronic flag in the model is set (issue 533)
	"Set DHWSys:IsHydronic - 1"	DHWSys:IsHydronic     =	{	if ( NumDHWHeaters >= 1 .AND. IfValidAnd( HeaterMult[1] > 0 ) .AND. LocalCompAssigned( DHWHeater[1] ) == ComponentType( "DHWHeater" ))
																				then   if (IfValidAnd( DHWHeater[1]:IsHydronic > 0.5 )) then 1 else 0 endif   else 0 endif  }
	"Set DHWSys:IsHydronic - 2"	DHWSys:IsHydronic     =	{	if ( IsHydronic > 0 .OR. NumDHWHeaters < 2 .OR. IfValidAnd( HeaterMult[2] > 0 )==0 .OR. LocalCompAssigned( DHWHeater[2] ) != ComponentType( "DHWHeater" ) ) 
																				then   UNCHANGED  else if (IfValidAnd( DHWHeater[2]:IsHydronic > 0.5 )) then  1  else  UNCHANGED  endif endif  }
	"Set DHWSys:IsHydronic - 3"	DHWSys:IsHydronic     =	{	if ( IsHydronic > 0 .OR. NumDHWHeaters < 3 .OR. IfValidAnd( HeaterMult[3] > 0 )==0 .OR. LocalCompAssigned( DHWHeater[3] ) != ComponentType( "DHWHeater" ) ) 
																				then   UNCHANGED  else if (IfValidAnd( DHWHeater[3]:IsHydronic > 0.5 )) then  1  else  UNCHANGED  endif endif  }
	"Set DHWSys:IsHydronic - 4"	DHWSys:IsHydronic     =	{	if ( IsHydronic > 0 .OR. NumDHWHeaters < 4 .OR. IfValidAnd( HeaterMult[4] > 0 )==0 .OR. LocalCompAssigned( DHWHeater[4] ) != ComponentType( "DHWHeater" ) ) 
																				then   UNCHANGED  else if (IfValidAnd( DHWHeater[4]:IsHydronic > 0.5 )) then  1  else  UNCHANGED  endif endif  }
	"Set DHWSys:IsHydronic - 5"	DHWSys:IsHydronic     =	{	if ( IsHydronic > 0 .OR. NumDHWHeaters < 5 .OR. IfValidAnd( HeaterMult[5] > 0 )==0 .OR. LocalCompAssigned( DHWHeater[5] ) != ComponentType( "DHWHeater" ) ) 
																				then   UNCHANGED  else if (IfValidAnd( DHWHeater[5]:IsHydronic > 0.5 )) then  1  else  UNCHANGED  endif endif  }
	"Set DHWSys:IsHydronic - 6"	DHWSys:IsHydronic     =	{	if ( IsHydronic > 0 .OR. NumDHWHeaters < 6 .OR. IfValidAnd( HeaterMult[6] > 0 )==0 .OR. LocalCompAssigned( DHWHeater[6] ) != ComponentType( "DHWHeater" ) ) 
																				then   UNCHANGED  else if (IfValidAnd( DHWHeater[6]:IsHydronic > 0.5 )) then  1  else  UNCHANGED  endif endif  }

	"Set DHWHeater:RecovEffActive"	DHWHeater:RecovEffActive	= {	if ( IsHydronic .AND. CanBeCHWHeater .AND. IfValidAnd( TankType != 8 ) )	then  1  else  0  endif  }		; SAC 2/17/15

  ; SAC 10/28/15 - enable access for ANY valid MFamDistType  - THEN restored original rule that requires a HERS verified option to access num loops option --- SAC 11/10/15 - restored for all selection > 0
  ; "Set DHWSys:DisplayNumLoops"		DHWSys:DisplayNumLoops	= {	if (Proj:IsMultiFamily > 0.5 .AND. MFamDistType > 8388608 .AND. (UseDefaultLoops = 0 .OR. Proj:DHWCalcMethod > 0)) then  1  else  0  endif  }
   "Set DHWSys:DisplayNumLoops"		DHWSys:DisplayNumLoops	= {	if (Proj:IsMultiFamily > 0.5 .AND. MFamDistType > 0 .AND. (UseDefaultLoops = 0 .OR. Proj:DHWCalcMethod > 0)) then  1  else  0  endif  }

END
;*************************************************************************


; SAC 3/2/16 - added rulelist to swap PV Credit inputs from PVRatedPower (kW dc) to PVCompCredit (toggle) (for 2016-) (tic #609)
; LDH 8/22/16 - Added Logic from "Swap PV Credit inputs from PVRatedPower (kW dc) to PVCompCredit (toggle) (for 2016-)" rule
;*************************************************************************
RULELIST "Force_2016PVCreditOn" 1 0 1 0
	"Force Proj:PVCompCredit On"	Proj:PVCompCredit		= { 
    if( EnablePVCredit > 0 .AND.
        IfValidAnd( PVRatedPower > 0 ) )
    then 1
    else UNCHANGED
    endif }
	"Blast Proj:PVRatedPower"		Proj:PVRatedPower		= {	UNDEFINED }
END
;*************************************************************************

; SAC 3/21/16 - added rulelist to force defaulting of DesignRatingBase to 'RESNET2014'
;*************************************************************************
RULELIST "ForceDefault_DesignRatingBase_RESNET2014" 1 0 0 0
	"Force Proj:DesignRatingBase to 'RESNET2014'"	Proj:DesignRatingBase	= {	2014  }
END
;*************************************************************************


;	mjb	8/1/14	- added rulelist to force default of EER based on UseEERinAnalysis
;*************************************************************************
RULELIST "ForceDefault_HVACCool_EER" 1 0 0 0
;*************************************************************************

	"Reset EER if UseEERinAnalysis not checked"		
	HVACCool:EER	= {	
		if (LocalStatus( SEER ) < 1) then UNCHANGED
		else if (	CA13CoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0 .AND.
							SEER == CA13CoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
		then CA13CoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )
		else if (SEER >= 16) then  13
		else if (SEER >= 13)	then  11.3 + (0.57 * (SEER - 13  ))
		else 10   + (0.84 * (SEER - 11.5))
		endif endif endif endif  }
	"Reset HVACCool:EERRpt"		HVACCool:EERRpt	= {	if (IfValidAnd( EER > 0 )) then  FltToStr( EER, 11 )  else  "N/A"  endif   }
;	"debug HVAC"			HVACCool:Action = { if (FloorAreaServed > 0.5) then PostWarning( "ForceDefault_HVACCool_EER  HVACCool: '%s'  EER: %g   EERRpt: %g",  Name, EER, EERRpt ) else UNCHANGED endif  }
END


; SAC 1/13/14 - added rulelists to FORCE Window Height/Width to be UNDEFINED when Win:SpecMethod = "Overall Window Area" and Area to be defaulted when Win:SpecMethod = "...Dimensions..."

;	em	10/30/14	- added rulelist to force default of EER based on UseEERinAnalysis
;*************************************************************************
RULELIST "ForceDefault_HVACHtPump_EER" 1 0 0 0
;*************************************************************************

	"Reset EER if UseEERinAnalysis not checked"
	HVACHtPump:EER	= {	
		if (LocalStatus( SEER ) < 1) then UNCHANGED
		else if (	CA13CoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) > 0 .AND.
					SEER == CA13CoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ))
		then			CA13CoolingEquipment:EER(  "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )
		else if (SEER >= 16) then  13
		else if (SEER >= 13)	then  11.3 + (0.57 * (SEER - 13  ))
		else 10 + (0.84 * (SEER - 11.5))
 		endif endif endif endif  }
	;"Reset HVACHtPump:EERRpt"		HVACHtPump:EERRpt	= {	EER   }
END

;*************************************************************************
RULELIST "OverwriteWinWidthHeightMultiplier"  1 0 0 0
	"Blast Win:Width data"		    Win:Width	= {	UNDEFINED  }
	"Blast Win:Height data"		    Win:Height	= {	UNDEFINED  }
	"Blast Win:Multiplier data"		Win:Multiplier	= {	1 }
END
RULELIST "ForceWinAreaToUndefined"  1 0 0 0
	"Toggle Win:Area status to rule-defined"		Win:Area	= {	UNDEFINED }
END
;*************************************************************************

;*************************************************************************
RULELIST "OverwriteExistingWinWidthHeightMultiplier"  1 0 0 0
	"Blast Win:exWidth data"		    Win:exWidth	= {	UNDEFINED  }
	"Blast Win:exHeight data"		    Win:exHeight	= {	UNDEFINED  }
	"Blast Win:exMultiplier data"		Win:exMultiplier	= {	UNDEFINED  }
END
RULELIST "ForceWinExAreaToUndefined"  1 0 0 0
  "Toggle Win:exArea status to rule-defined"  Win:exArea	= {	UNDEFINED }
END
;*************************************************************************

;*************************************************************************
RULELIST "ForceDefault_Proj_ACH50" 1 0 0 0
;*************************************************************************
	"Redefault Proj:ACH50"		Proj:ACH50	= {	UNDEFINED  }
END

;*************************************************************************
RULELIST "ForceDefault_Zone_Type" 1 0 0 0
;*************************************************************************
	"Redefault Zone:Type"		Zone:Type	= {	UNDEFINED  }
END


; SAC 10/1/13 - address backward compatibility for IntWall:OutsideDiffUnit property - take its value and set corresponding properties for its replacement, then flag this property as undefined
;*************************************************************************
RULELIST "BackwardCompat_IntWall_OutsideDiffUnit"  1 0 1 1
	"Set IntWall:IsPartySurface based on IntWall:OutsideDiffUnit"		IntWall:IsPartySurface		= {	if (Proj:IsMultiFamily < 0.5) then  UNCHANGED
																																		else	OutsideDiffUnit  endif  }
	"Set IntWall:OtherSideModeled based on IntWall:OutsideDiffUnit"	IntWall:OtherSideModeled	= {	if (Proj:IsMultiFamily < 0.5) then  UNCHANGED
																																		else	OutsideDiffUnit  endif  }
	"Mark IntWall:OutsideDiffUnit as undefined"		IntWall:OutsideDiffUnit	= {	UNDEFINED  }
END
; SAC 4/28/15 - address backward compatibility for InteriorCeiling & InteriorFloor:OutsideDiffUnit property - take its value and set corresponding properties for its replacement, then flag this property as undefined
;*************************************************************************
RULELIST "BackwardCompat_InteriorCeiling_OutsideDiffUnit"  1 0 1 1
	"Set InteriorCeiling:IsPartySurface based on InteriorCeiling:OutsideDiffUnit"		InteriorCeiling:IsPartySurface	= {	if (Proj:IsMultiFamily < 0.5) then  UNCHANGED
																																									else	OutsideDiffUnit  endif  }
	"Set InteriorCeiling:OtherSideModeled based on InteriorCeiling:OutsideDiffUnit"	InteriorCeiling:OtherSideModeled	= {	if (Proj:IsMultiFamily < 0.5) then  UNCHANGED
																																									else	OutsideDiffUnit  endif  }
	"Mark InteriorCeiling:OutsideDiffUnit as undefined"		InteriorCeiling:OutsideDiffUnit	= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BackwardCompat_InteriorFloor_OutsideDiffUnit"  1 0 1 1
	"Set InteriorFloor:IsPartySurface based on InteriorFloor:OutsideDiffUnit"		InteriorFloor:IsPartySurface		= {	if (Proj:IsMultiFamily < 0.5) then  UNCHANGED
																																								else	OutsideDiffUnit  endif  }
	"Set InteriorFloor:OtherSideModeled based on InteriorFloor:OutsideDiffUnit"	InteriorFloor:OtherSideModeled	= {	if (Proj:IsMultiFamily < 0.5) then  UNCHANGED
																																								else	OutsideDiffUnit  endif  }
	"Mark InteriorFloor:OutsideDiffUnit as undefined"		InteriorFloor:OutsideDiffUnit	= {	UNDEFINED  }
END

;*************************************************************************  - SAC 8/28/14
RULELIST "BackwardCompat_IsCAHPProj"  1 0 1 1
	"Set new CAHP program selection"		Proj:CAHPProgram	= {	if (IfValidAnd( IsMultiFamily > 0.5 ))
																					then  11		; "California Advanced Homes Program MultiFamily (CAHP-MF)"
																					else	 1		; "California Advanced Homes Program Single Family (CAHP)"
																					endif  }
	"Blast Proj:IsCAHPProj"					Proj:IsCAHPProj	= {	UNDEFINED  }
END
;*************************************************************************

;*************************************************************************  - SAC 5/18/16
RULELIST "ForceDefault_DHWHeater_ASHPType"  1 0 1 1
	"Force DHWHeater:HeaterElementType to 'Heat Pump'"					DHWHeater:HeaterElementType	= {	5  }
	"Force DHWHeater:HPWH_NEEARated to 0 w/out resetting HP perf"	DHWHeater:HPWH_NEEARated		= {	0  }
	"Blast DHWHeater:ASHPType (w/out resetting dependencies)"		DHWHeater:ASHPType				= {	0  }
END
;*************************************************************************  - SAC 5/18/16
RULELIST "BackwardCompat_DHWHeater_ASHPType"  1 0 1 1
	"Force DHWHeater:HPWH_NEEARated to 1 w/out resetting HP perf"	DHWHeater:HPWH_NEEARated	= {	1  }
END
;*************************************************************************

;*************************************************************************
RULELIST "Default_DwellingUnitData_SFam"  0 0 0 0
;*************************************************************************

	; SAC 7/3/15 - added properties to disable all IAQ ventilation
	"Default Proj:DisableIAQ flag"	Proj:DisableIAQ	= {	0  }		; option to toggle OFF all IAQ ventilation
	"Set Proj:IAQDisabled"				Proj:IAQDisabled	= {	if (BypassRuleLimits > 0 .AND. DisableIAQ > 0) then  1  else  0  endif  }		; Flag indicating that IAQ vent has been toggled OFF

  ; SFam IAQ input defaulting ----------
; 	mjb	4/14/14	modify defaults to account for Additions <= 1000 sf, which do not need IAQ Fans
;  mjb   7/10/14  remove floor area constraint on new construction
; SAC 9/23/15 - replaced AdditionCFA w/ CondFloorArea in calc of min IAQ CFM for EAA where AdditionCFA > 1000 (tic 571) -AND- prevent > 0 min IAQ CFM for New Cons, Addition Alone where addition < 1000 SF (tic 569)
; SAC 12/28/15 - added logic to calculate minimum IAQ CFM based on difference between (final) whole home and existing home areas & # bedrooms for AdditionAlone analyses
; SAC 8/12/16 - revised logic again, REMOVING mods from 12/28/15, so that IAQ CFM reported on screen and in compliance report reflect entire dwelling (tic #729)
   "Set Proj:UnitMinIAQCFM[1]"		Proj:UnitMinIAQCFM[1]   	= {	if ( RunScope == 1 .AND. (IfValidAnd( IsAddAlone > 0.5 )==0 .OR. AdditionCFA > 1000) ) then
   																							if (IfValidAnd( IsAddAlone > 0.5 ) .AND. IfValidAnd( AddAloneTotalArea > 0 ))
   																							then	 (0.01 * AddAloneTotalArea) + (7.5 * (Max( (NumBedrooms + NumAddBedrooms), 1 ) + 1))
   																							else	 (0.01 * CondFloorArea) + (7.5 * (Max( NumBedrooms, 1 ) + 1))
   																							endif
   																						else if ( RunScope == 2 .AND. AdditionCFA > 1000 ) then
   																								(0.01 * CondFloorArea) + (7.5 * (Max( NumBedrooms, 1 ) + 1))
   																						else  0  endif endif	}
   ; SAC 8/12/16 - added new Proj:DefaultSimIAQCFM to track simulation differences for addition alone analyses (in place of Proj:UnitMinIAQCFM[1]) (tic #729) 
   "Set Proj:DefaultSimIAQCFM"      Proj:DefaultSimIAQCFM   = {
      if ( RunScope == 1 .AND. (IfValidAnd( IsAddAlone > 0.5 )==0 .OR. AdditionCFA > 1000) )
      then  if (IfValidAnd( IsAddAlone > 0.5 ) .AND. IfValidAnd( AddAloneTotalArea > 0 ))
            then   (0.01 * AddAloneTotalArea) + (7.5 * (Max( (NumBedrooms + NumAddBedrooms), 1 ) + 1))  -
                  ((0.01 * AddAloneExistArea) + (7.5 * (Max( NumBedrooms, 1 ) + 1)))
            else  UnitMinIAQCFM[1]   endif
      else        UnitMinIAQCFM[1]   endif  }

	"Set Proj:UnitIAQNumFanRefs[1]"	Proj:UnitIAQNumFanRefs[1]	= {	if (UnitIAQOption[1] != 2 .OR. IAQDisabled > 0) then  0
																							else if (LocalCompAssigned( UnitIAQFan4[1]  )) then  4
																							else if (LocalCompAssigned( UnitIAQFan3[1]  )) then  3
																							else if (LocalCompAssigned( UnitIAQFan2[1]  )) then  2
																							else if (LocalCompAssigned( UnitIAQFan1[1]  )) then  1  else  0  endif endif endif endif endif  }
;  mjb   7/10/14  remove floor area constraint on new construction
	"Default Proj:UnitIAQFanCnt1[1]" 	Proj:UnitIAQFanCnt1[1] 	= {	if (IAQDisabled > 0) then  0
   																						else if ( RunScope == 1 ) then 1
;   																							if ( CondFloorArea > 1000 ) then 1 else 0 endif
   																						else if ( AdditionCFA > 1000 ) then 1 else 0 endif endif endif }		
	"Default Proj:UnitIAQFanCnt2[1]" 	Proj:UnitIAQFanCnt2[1] 	= {	if (IAQDisabled > 0) then  0
   																						else if ( RunScope == 1 ) then 1
;   																							if ( CondFloorArea > 1000 ) then 1 else 0 endif
   																						else if ( AdditionCFA > 1000 ) then 1 else 0 endif endif	endif }
	"Default Proj:UnitIAQFanCnt3[1]" 	Proj:UnitIAQFanCnt3[1] 	= {	if (IAQDisabled > 0) then  0
   																						else if ( RunScope == 1 ) then 1
;   																							if ( CondFloorArea > 1000 ) then 1 else 0 endif
   																						else if ( AdditionCFA > 1000 ) then 1 else 0 endif endif endif	}		
	"Default Proj:UnitIAQFanCnt4[1]" 	Proj:UnitIAQFanCnt4[1] 	= {	if (IAQDisabled > 0) then  0
   																						else if ( RunScope == 1 ) then 1
;   																							if ( CondFloorArea > 1000 ) then 1 else 0 endif
   																						else if ( AdditionCFA > 1000 ) then 1 else 0 endif endif endif	}
   "Default Proj:UnitIAQZone1[1]" 		Proj:UnitIAQZone1[1] 	= {	if (ComponentCount( Zone ) > 0.5) then  MaxAllComp( Zone:CondFloorArea )  else  UNDEFINED  endif  }
   "Default Proj:UnitIAQZone2[1]" 		Proj:UnitIAQZone2[1] 	= {	if (ComponentCount( Zone ) > 0.5) then  MaxAllComp( Zone:CondFloorArea )  else  UNDEFINED  endif  }
   "Default Proj:UnitIAQZone3[1]" 		Proj:UnitIAQZone3[1] 	= {	if (ComponentCount( Zone ) > 0.5) then  MaxAllComp( Zone:CondFloorArea )  else  UNDEFINED  endif  }
   "Default Proj:UnitIAQZone4[1]" 		Proj:UnitIAQZone4[1] 	= {	if (ComponentCount( Zone ) > 0.5) then  MaxAllComp( Zone:CondFloorArea )  else  UNDEFINED  endif  }

	"Set Proj:UnitIAQCFM1[1]" 			Proj:UnitIAQCFM1[1] 			= {	if (IAQDisabled > 0) then  0
   																				 else if (UnitIAQOption[1] == 1) then  UnitMinIAQCFM[1]
																					 else if (UnitIAQOption[1] != 2 .OR. LocalCompAssigned( UnitIAQFan1[1] ) < 0.5 .OR. LocalCompAssigned( UnitIAQZone1[1] ) < 0.5 .OR. IAQDisabled > 0) then  0  else  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1]   endif endif endif  }
	"Set Proj:UnitIAQCFM2[1]" 			Proj:UnitIAQCFM2[1] 			= {	if (UnitIAQOption[1] != 2 .OR. LocalCompAssigned( UnitIAQFan2[1] ) < 0.5 .OR. LocalCompAssigned( UnitIAQZone2[1] ) < 0.5 .OR. IAQDisabled > 0) then  0  else  UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1]   endif  }
	"Set Proj:UnitIAQCFM3[1]" 			Proj:UnitIAQCFM3[1] 			= {	if (UnitIAQOption[1] != 2 .OR. LocalCompAssigned( UnitIAQFan3[1] ) < 0.5 .OR. LocalCompAssigned( UnitIAQZone3[1] ) < 0.5 .OR. IAQDisabled > 0) then  0  else  UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1]   endif  }
	"Set Proj:UnitIAQCFM4[1]" 			Proj:UnitIAQCFM4[1] 			= {	if (UnitIAQOption[1] != 2 .OR. LocalCompAssigned( UnitIAQFan4[1] ) < 0.5 .OR. LocalCompAssigned( UnitIAQZone4[1] ) < 0.5 .OR. IAQDisabled > 0) then  0  else  UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1]   endif  }
	"Set Proj:UnitIAQCFMTot[1]" 		Proj:UnitIAQCFMTot[1] 		= {	UnitIAQCFM1[1]  + UnitIAQCFM2[1]  + UnitIAQCFM3[1]  + UnitIAQCFM4[1]  }

	"Set Proj:UnitMinIAQCFMLbl[1]"	Proj:UnitMinIAQCFMLbl[1]   = {	if (IAQDisabled > 0) then  Format( "IAQ Ventilation disabled (%s required but not met)", FltToStr( UnitMinIAQCFM[1] , 1 ) )
																							else if (UnitMinIAQCFM[1]  < 0.5) then  " "  else if (UnitIAQOption[1]  == 3) then  "CFI (Central Fan Integrated) IAQ  - NOT YET IMPLEMENTED -"
																							else if (UnitIAQCFMTot[1]  < UnitMinIAQCFM[1] ) then	Format( "Min IAQ Vent -NOT MET-:  %s required, %s entered (CFM)", FltToStr( UnitMinIAQCFM[1] , 1 ), FltToStr( UnitIAQCFMTot[1] , 1 ) )
																							else if (UnitIAQOption[1]  == 2) then  Format( "Minimum IAQ Ventilation:  %s CFM  (%s entered)", FltToStr( UnitMinIAQCFM[1] , 1 ), FltToStr( UnitIAQCFMTot[1] , 1 ) )
																							else  Format( "Minimum IAQ Ventilation:  %s CFM", FltToStr( UnitMinIAQCFM[1] , 1 ) )  endif endif endif endif endif  }

  ; SFam Cooling Ventilation input defaulting ----------
		;  "UnitClVentFan",     BEMP_Obj,  6,  0,  0, "",                 0,  1, "ClVentFan", 0, "",       1080, "cooling ventilation fan object" 
	"Set Proj:UnitClVentNumFans[1]"	Proj:UnitClVentNumFans[1]	= {	if (EnableClVent < 0.5) then  0
																							else if (LocalCompAssigned( UnitClVentFan[6] )) then  6
																							else if (LocalCompAssigned( UnitClVentFan[5] )) then  5
																							else if (LocalCompAssigned( UnitClVentFan[4] )) then  4
																							else if (LocalCompAssigned( UnitClVentFan[3] )) then  3
																							else if (LocalCompAssigned( UnitClVentFan[2] )) then  2
																							else if (LocalCompAssigned( UnitClVentFan[1] )) then  1  else  0  endif endif endif endif endif endif endif  }
   "Default Proj:UnitClVentZone[1]" 	Proj:UnitClVentZone[1] 	= {	if (EnableClVent > 0.5 .AND. ComponentCount( Zone ) > 0.5) then  MaxAllComp( Zone:CondClgBlwAtticArea )  else  UNDEFINED  endif  }
   "Default Proj:UnitClVentZone[2]" 	Proj:UnitClVentZone[2] 	= {	if (EnableClVent > 0.5 .AND. ComponentCount( Zone ) > 0.5) then  MaxAllComp( Zone:CondClgBlwAtticArea )  else  UNDEFINED  endif  }
   "Default Proj:UnitClVentZone[3]" 	Proj:UnitClVentZone[3] 	= {	if (EnableClVent > 0.5 .AND. ComponentCount( Zone ) > 0.5) then  MaxAllComp( Zone:CondClgBlwAtticArea )  else  UNDEFINED  endif  }
   "Default Proj:UnitClVentZone[4]" 	Proj:UnitClVentZone[4] 	= {	if (EnableClVent > 0.5 .AND. ComponentCount( Zone ) > 0.5) then  MaxAllComp( Zone:CondClgBlwAtticArea )  else  UNDEFINED  endif  }
   "Default Proj:UnitClVentZone[5]" 	Proj:UnitClVentZone[5] 	= {	if (EnableClVent > 0.5 .AND. ComponentCount( Zone ) > 0.5) then  MaxAllComp( Zone:CondClgBlwAtticArea )  else  UNDEFINED  endif  }
   "Default Proj:UnitClVentZone[6]" 	Proj:UnitClVentZone[6] 	= {	if (EnableClVent > 0.5 .AND. ComponentCount( Zone ) > 0.5) then  MaxAllComp( Zone:CondClgBlwAtticArea )  else  UNDEFINED  endif  }

; KN 04/14/2016 replaced with new cfm/ft2 if 2016. Code might be needed here to default Proj:DesignRatingBase is 2016
; 																					else if (UnitClVentOption == 1) then	2 * CondFloorArea
	"Set Proj:UnitClVentCFM[1]"	Proj:UnitClVentCFM[1]	= {	if (EnableClVent < 0.5 .OR. UnitClVentOption < 1) then  0
 																					else if (UnitClVentOption == 1) then 	CAClimateZoneCodeBase:WHFcfmpersf( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase ) * CondFloorArea
																					else if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[1] )) then	 UnitClVentFan[1]:CoolingVent  else  0  endif endif endif  }
	"Set Proj:UnitClVentCFM[2]"	Proj:UnitClVentCFM[2]	= {	if (EnableClVent < 0.5 .OR. UnitClVentOption < 1) then  0
																					else if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[2] )) then	 UnitClVentFan[2]:CoolingVent  else  0  endif endif  }
	"Set Proj:UnitClVentCFM[3]"	Proj:UnitClVentCFM[3]	= {	if (EnableClVent < 0.5 .OR. UnitClVentOption < 1) then  0
																					else if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[3] )) then	 UnitClVentFan[3]:CoolingVent  else  0  endif endif  }
	"Set Proj:UnitClVentCFM[4]"	Proj:UnitClVentCFM[4]	= {	if (EnableClVent < 0.5 .OR. UnitClVentOption < 1) then  0
																					else if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[4] )) then	 UnitClVentFan[4]:CoolingVent  else  0  endif endif  }
	"Set Proj:UnitClVentCFM[5]"	Proj:UnitClVentCFM[5]	= {	if (EnableClVent < 0.5 .OR. UnitClVentOption < 1) then  0
																					else if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[5] )) then	 UnitClVentFan[5]:CoolingVent  else  0  endif endif  }
	"Set Proj:UnitClVentCFM[6]"	Proj:UnitClVentCFM[6]	= {	if (EnableClVent < 0.5 .OR. UnitClVentOption < 1) then  0
																					else if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[6] )) then	 UnitClVentFan[6]:CoolingVent  else  0  endif endif  }
	"Set Proj:UnitClVentCFMTot"	Proj:UnitClVentCFMTot	= {	if (EnableClVent < 0.5 .OR. UnitClVentOption < 1) then  0
																					else  UnitClVentCFM[1] + UnitClVentCFM[2] + UnitClVentCFM[3] + UnitClVentCFM[4] + UnitClVentCFM[5] + UnitClVentCFM[6]  endif  }

  ; SAC 3/7/16 - added to enable access by report generator for new CF1R
	"Set Proj:UnitClVentCFMpSF"	Proj:UnitClVentCFMpSF	= {	if (EnableClVent < 0.5 .OR. UnitClVentOption < 1 .OR. CondFloorArea < 0.1) then  0
																					else if (UnitClVentOption == 1 .OR. UnitClVentOption == 2) then  UnitClVentCFMTot / CondFloorArea
																					else if (UnitClVentOption == 3) then  0 / CondFloorArea		; CFI cool vent
																					else  0  endif endif endif  }
		; ??? how to handle CFi cool vent reporting ???
		; 	possibly based on ...
		;   "Default ClVentFan:CoolingVent"			ClVentFan:CoolingVent    = {	if (Proj:EnableClVent > 0.5 .AND. Proj:UnitClVentOption == 3 .AND.
		;																										SumAll( HVACSys:CFIClVentFlow ) > 0.5 .AND. CountRefs( HVACSys:CFIClVentFan ) > 0.5)		; SumRevRef( HVACSys:CFIClVentFan, HVACSys:CFIClVentFlow ) > 0.5)
		;																								then  0.5 * SumRevRef( HVACSys:CFIClVentFan, HVACSys:FloorAreaServed[1] ) / CountRefs( HVACSys:CFIClVentFan )		; SumRevRef( HVACSys:CFIClVentFan, HVACSys:CFIClVentFlow )

	"Set Proj:UnitClVentLabel"		Proj:UnitClVentLabel	= {	if (EnableClVent < 0.5 .OR. UnitClVentOption < 1) then  " "
																				else if (UnitClVentOption  == 3) then  "CFI Cool Vent specified in HVAC System inputs"
																				else  Format( "Cooling Ventilation:  %s CFM  (%s CFM/ft2)", FltToStr( UnitClVentCFMTot ), FltToStr( (UnitClVentCFMTot / CondFloorArea), 2 ) )  endif endif  }
	"Set Proj:ShowClVentZone"		Proj:ShowClVentZone	= {	if (EnableClVent > 0.5 .AND. (UnitClVentOption == 1 .OR. UnitClVentOption == 2)) then  1  else  0  endif  }
END

;*************************************************************************
RULELIST "Default_DwellingUnitData"  0 0 0 0
;*************************************************************************

	; SAC 7/8/15 - added properties to disable all IAQ ventilation
	"Default Proj:DisableIAQ flag"	Proj:DisableIAQ	= {	0  }		; option to toggle OFF all IAQ ventilation
	"Set Proj:IAQDisabled"				Proj:IAQDisabled	= {	if (BypassRuleLimits > 0 .AND. DisableIAQ > 0) then  1  else  0  endif  }		; Flag indicating that IAQ vent has been toggled OFF

	"Set Proj:UnitTotCondFlrArea"			Proj:UnitTotCondFlrArea		= {	SumAll( DwellUnit:TotalCondFlrArea )  }
	"Set DwellUnit:TotalNumBedrooms"		DwellUnit:TotalNumBedrooms	= {	if (ParentComponentType() == "Zone") then  ValidOr( DwellUnitTypeRef:NumBedrooms, 0 ) * Count  else  0  endif  }
	"Set Proj:NumBedrooms"					Proj:NumBedrooms				= {	SumAll( DwellUnit:TotalNumBedrooms )  }
	"Set Proj:SimNumBedrooms"				Proj:SimNumBedrooms			= {	NumBedrooms  }

	; SAC 5/10/16 - added default of project-wide cool vent values to 0 for MFam models
	"Init Proj:UnitClVentCFMTot"	Proj:UnitClVentCFMTot	= {	0  }
	"Init Proj:UnitClVentCFMpSF"	Proj:UnitClVentCFMpSF	= {	0  }

  ; Interior Lighting Gains - docu from IntgainAlgorithm6.txt dated 9/4/12:
  ;			a.   //Lights  Returns Btu/day-CFA - based on ElectricityInteriorLights = (214+ 0.601CFA)(FractPortable + (1-FractPortable)PAMInterior )  //HTM Eqn 11, p. 30
  ;			 		#define FractPortable .22    //fixed for now, variable later for HERS
  ;			 		#define Paminterior 0.625    //fixed for now, variable later for HERS
  ;		 			#Redefine LightsGainperCFA (((214. + 0.601 * CFAperUnit) * (FractPortable + (1-FractPortable) * Paminterior ) * 3413. / 365) * DwellingUnits /CFA)
	"Set DwellUnit:UnitLtgGain"				DwellUnit:UnitLtgGain	= {	if (Proj:IntGainsMethod <= 2013)
																								then	(214 +  0.601  * CondFlrArea ) * (Ltg_FracPort + ((1-Ltg_FracPort) * Ltg_PwrAdjMult)) / 365
																								else	(100 + (0.1775 * min( 4150, CondFlrArea ))) * 3412 / 365  endif  }
	"Set DwellUnit:TotalLtgGain"				DwellUnit:TotalLtgGain	= {	if (ParentComponentType() == "Zone") then  UnitLtgGain * Count  else  0  endif  }
	"Set Proj:AvgLtgGainPerCFA (MFam)"		Proj:AvgLtgGainPerCFA	= {	if (Proj:IsMultiFamily < 0.5) then  UNCHANGED
																								else if (UnitTotCondFlrArea < 0.1) then  0
																								else	SumAll( DwellUnit:TotalLtgGain ) / UnitTotCondFlrArea  endif endif  }
  ; SAC 4/13/16 - added TV, STB & Comp gains for T24-2016
	"Set DwellUnit:UnitTVGain"					DwellUnit:UnitTVGain		= {	if (Proj:IntGainsMethod <= 2013) then  0
																								else	(265 + (31.8 * ValidOr( DwellUnitTypeRef:NumBedrooms, 0 ))) * 3412 / 365  endif  }
	"Set DwellUnit:TotalTVGain"				DwellUnit:TotalTVGain	= {	if (ParentComponentType() == "Zone") then  UnitTVGain * Count  else  0  endif  }
	"Set DwellUnit:UnitSTBGain"				DwellUnit:UnitSTBGain	= {	if (Proj:IntGainsMethod <= 2013) then  0
																								else	(76 + (59.4 * ValidOr( DwellUnitTypeRef:NumBedrooms, 0 ))) * 3412 / 365  endif  }
	"Set DwellUnit:TotalSTBGain"				DwellUnit:TotalSTBGain	= {	if (ParentComponentType() == "Zone") then  UnitSTBGain * Count  else  0  endif  }
	"Set DwellUnit:UnitCompGain"				DwellUnit:UnitCompGain	= {	if (Proj:IntGainsMethod <= 2013) then  0
																								else	(79 + (55.4 * ValidOr( DwellUnitTypeRef:NumBedrooms, 0 ))) * 3412 / 365  endif  }
	"Set DwellUnit:TotalCompGain"				DwellUnit:TotalCompGain	= {	if (ParentComponentType() == "Zone") then  UnitCompGain * Count  else  0  endif  }

  ; Internal Gains due to Occupants - docu from IntgainAlgorithm6.txt dated 9/4/12:
  ;		   b.  People    Returns BTU/day-CFA - 100% is internal gain 57.3% sensible, 42.7% latent  Based on HTM and  BA existing bldgs Sensible 220, Latent 164 BTU
  ;						#redefine PeopleperUnit (1.75 + 0.4 * BRperUnit)           - 0.5 added to formulas below to ensure average # people following integer truncation
  ;						#Redefine PeopleGainperCFA ((3900/0.573) * PeopleperUnit * DwellingUnits / CFA) 
	; SAC 5/6/13 - revised to be fractional (not round to nearest person)
	"Set Proj:PeoplePerUnit[1]"		Proj:PeoplePerUnit[1]	= {	if (IfValidAnd( NumDwellingUnits > 0 )) then  ((1.75 * NumDwellingUnits) + (0.4 * SimNumBedrooms)) / NumDwellingUnits   else  0  endif  }
	"Set Proj:UnitPeopleGain[1]"		Proj:UnitPeopleGain[1]	= {	PeoplePerUnit[1]  * (3900/0.573)  }
	"Set Proj:AvgPplGainPerCFA"		Proj:AvgPplGainPerCFA	= {	if (UnitTotCondFlrArea < 0.1) then  0
																						else	UnitPeopleGain[1] * NumDwellingUnits / UnitTotCondFlrArea  endif  }

  ; Miscellaneous Electric Gains - docu from IntgainAlgorithm6.txt dated 9/4/12:
  ;			c.  Misc Electricity  Returns BTU/day-CFA - 100% is internal gain
  ;		 			#Redefine MiscGainperCFA ((723. + (0.706 * CFAperUnit))* DwellingUnits * 3413. / 365.)/CFA  //Rev 6 120831
	;	"Set Proj:UnitMscElecGain[1]"		Proj:UnitMscElecGain[1]		= {	if (IfValidAnd( NumDwellingUnits > 0 )) then  (723. + (0.706 * UnitTotCondFlrArea )) / 365 / NumDwellingUnits  else  0  endif  }
	;	"Set Proj:AvgMscEGainPerCFA"		Proj:AvgMscEGainPerCFA		= {	if (UnitTotCondFlrArea < 0.1) then  0
	;																							else	UnitMscElecGain[1] * NumDwellingUnits / UnitTotCondFlrArea  endif  }
	; SAC 4/13/16 - added logic for T24-2016
	"Set DwellUnit:UnitMscElecGain"	DwellUnit:UnitMscElecGain	= {	if (Proj:IntGainsMethod <= 2013)
																							then	(723 + (0.706 * CondFlrArea )) / 365  		; kWh/day-DwlgUnt
																							else	(570 + (198.9 * ValidOr( DwellUnitTypeRef:NumBedrooms, 0 ))) * 3412 / 365  endif  }
	"Set DwellUnit:TotalMscElecGain"	DwellUnit:TotalMscElecGain	= {	UnitMscElecGain * Count  }
	"Set Proj:AvgMscEGainPerCFA"		Proj:AvgMscEGainPerCFA		= {	if (UnitTotCondFlrArea < 0.1) then  0
																							else	SumAll( DwellUnit:TotalMscElecGain ) / UnitTotCondFlrArea  endif  }

  ; Dishwasher Electric Gains - docu from IntgainAlgorithm6.txt dated 9/4/12:
  ;		b.  Dishwasher.  0 based choose returns BTU/day  // uses Table based in INTEGER bedrooms per dwelling.  
  ;	 			#Redefine DishwasherGain (choose (BRperUnit,90,90,126,126,126,145,145,174,174,174,default 203) * DwellingUnits * 3413. / 365.) 
	; already set for DwellUnitType objects
	;	"Set Proj:UnitDishElecGain[1]"	Proj:UnitDishElecGain[1]  = {  if (UnitInputValid[1]  > 0.5) then  switch (UnitNumBedrooms[1] )  case 0: 90	case 1: 90
	;																								case 2: 126   case 3: 126   case 4: 126   case 5: 145   case 6: 145   case 7: 174
	;																								case 8: 174   case 9: 174   default: 203  	endswitch  else  0  endif  }
	; SAC 4/14/16 - revised for T24-2016 gains
	"Set DwellUnit:TotalDishUsage"		DwellUnit:TotalDishUsage		= {	if (IfValidAnd( DwellUnitTypeRef:HaveDish > 0.5 ))
																									then	if (Proj:IntGainsMethod <= 2013)
																											then	DwellUnitTypeRef:DishElecUsage * Count
																											else	DwellUnitTypeRef:DishElecUsage * ValidOr( UnitTotCondFlrArea, 0 )		; kWh*CFA/gal
																											endif
																									else  0  endif  }

  ; Cooking Gains - docu from IntgainAlgorithm6.txt dated 9/4/12:
  ;	   c.  Stove and Oven   -  Assumes both are gas with electonic igniter  Returns BTU/day - Full Energy Use, 90% is internal Gain
  ;	 			define CookGain (((31. + (.008 * CFAperUnit))* 0.43* 0.9)* DwellingUnits * 100000. / 365.)  //Added the 0.43 for the electronic ignition  12/4  BAW
	;	"Set Proj:UnitCookGain[1]"		Proj:UnitCookGain[1]		= {	if (UnitInputValid[1]  > 0.5) then  ((31. + (.008 * UnitCondFlrArea[1] )) * 0.43 * 0.9) * 100000. / 365.  else  0  endif  }
	; SAC 4/14/16 - split into Elec & Gas gain and added logic for T24-2016
	"Set DwellUnit:UnitCookElecGain"		DwellUnit:UnitCookElecGain		= {	if (Proj:IntGainsMethod <= 2013 .AND. DwellUnitTypeRef:CookFuel == 1)
																									then	((31. + (.008 * CondFlrArea )) * 0.43 * 0.9) * 100000. / 365.
																									else if (Proj:IntGainsMethod > 2013)
																									then	if (DwellUnitTypeRef:CookFuel == 1)
																											then	(213  + (26.3 * ValidOr( DwellUnitTypeRef:NumBedrooms, 0 ))) * 3412 / 365		; elec cooking
																											else	( 16  + ( 1.9 * ValidOr( DwellUnitTypeRef:NumBedrooms, 0 ))) * 3412 / 365		; elec aux for gas cooking
																											endif
																									else	0  endif endif  }
	"Set DwellUnit:UnitCookGasGain"		DwellUnit:UnitCookGasGain		= {	if (DwellUnitTypeRef:CookFuel == 1) then  0
																									else if (Proj:IntGainsMethod <= 2013)
																									then	((31. + (.008 * CondFlrArea )) * 0.43 * 0.9) * 100000. / 365.
																									else	(10 + (1.3 * ValidOr( DwellUnitTypeRef:NumBedrooms, 0 ))) * 100000 / 365
																									endif endif  }
	"Set DwellUnit:TotalCookGasGain"		DwellUnit:TotalCookGasGain		= {	if (DwellUnitTypeRef:CookFuel == 2) then  UnitCookGasGain  * Count  else  0  endif  }
	"Set DwellUnit:TotalCookElecGain"	DwellUnit:TotalCookElecGain	= {															UnitCookElecGain * Count						}
	"Set DwellUnit:TotalCookOthrGain"	DwellUnit:TotalCookOthrGain	= {	if (DwellUnitTypeRef:CookFuel == 3) then  UnitCookGasGain  * Count  else  0  endif  }

  ; Clothes Washer Gains - docu from IntgainAlgorithm6.txt dated 9/4/12:
  ;		d.  Clothes Washer  -   // Returns BTU/day
  ;	         #Redefine WasherGain ((-64 + 0.108 * CFAperUnit) * DwellingUnits * 3413. / 365.)
	;	"Set Proj:UnitClthWashGain[1]"	Proj:UnitClthWashGain[1]	= {	if (UnitInputValid[1]  > 0.5) then  (-64 + (0.108 * UnitCondFlrArea[1] )) / 365.  else  0  endif  }
	; SAC 4/15/16 - revised for T24-2016 gains
	"Set DwellUnit:UnitClthWashGain"		DwellUnit:UnitClthWashGain		= {	if (ValidOr( HaveWasher, 0 ) > 0.5)
																									then	if (Proj:IntGainsMethod <= 2013)
																											then  (-64 + (0.108 * CondFlrArea )) / 365.
																											else	0.010067   ; kWh/gal
																											endif
																									else  0  endif  }
	"Set DwellUnit:TotalClthWashGain"	DwellUnit:TotalClthWashGain	= {	UnitClthWashGain * Count  }

  ; Clothes Dryer Gains - docu from IntgainAlgorithm6.txt dated 9/4/12:
  ;		e.  Clothes Dryer  -  Assumes gas with electonic igniter  Returns BTU/day - Full energy Use, 30% is internal gain
  ;	 			define DryerGAin (13. + (.01 * CFAperUnit))* DwellingUnits * 100000. / 365.  //Added the 0.43 for the electronic ignition  //120831
	;	"Set Proj:UnitClthDryGain[1]"		Proj:UnitClthDryGain[1]		= {	if (UnitInputValid[1]  > 0.5) then  (13. + (.01 * UnitCondFlrArea[1] )) * 100000. / 365.  else  0  endif  }
	; SAC 4/15/16 - expanded into separate elec/gas gains and revised for T24-2016 gains
	"Set DwellUnit:UnitClthDryGasGain"		DwellUnit:UnitClthDryGasGain		= {	if (ValidOr( HaveDryer, 0 ) < 0.5 .OR. DwellUnitTypeRef:DryerFuel == 1) then  0
																											else if (Proj:IntGainsMethod <= 2013)
																											then	(13. + (.01 * CondFlrArea )) * 100000. / 365.
																											else  299.91		; T24-2016 therm/gal
																											endif endif }
	"Set DwellUnit:UnitClthDryElecGain"		DwellUnit:UnitClthDryElecGain		= {	if (ValidOr( HaveDryer, 0 ) < 0.5) then  0
																											else if (Proj:IntGainsMethod <= 2013 .AND. DwellUnitTypeRef:DryerFuel == 1)
																											then	(13. + (.01 * CondFlrArea )) * 100000. / 365.
																											else if (Proj:IntGainsMethod > 2013)
																											then	if (DwellUnitTypeRef:DryerFuel == 1) then  0.08509  else  0.004252  endif  ; T24-2016 kWh/gal
																											else	0  endif endif endif  }
	"Set DwellUnit:TotalClthDryGasGain"		DwellUnit:TotalClthDryGasGain		= {	if (DwellUnitTypeRef:DryerFuel == 2) then  UnitClthDryGasGain  * Count  else  0  endif  }
	"Set DwellUnit:TotalClthDryElecGain"	DwellUnit:TotalClthDryElecGain	= {															 UnitClthDryElecGain * Count                  }
	"Set DwellUnit:TotalClthDryOthrGain"	DwellUnit:TotalClthDryOthrGain	= {	if (DwellUnitTypeRef:DryerFuel == 3) then  UnitClthDryGasGain  * Count  else  0  endif  }

;			"Dflt Proj:Appl_RefrigUsage[1]" 	Proj:Appl_RefrigUsage[1] 	= {	669  }		"Dflt Proj:Appl_RefrigUsage[2]" 	Proj:Appl_RefrigUsage[2] 	= {	669  }		"Dflt Proj:Appl_RefrigUsage[3]" 	Proj:Appl_RefrigUsage[3] 	= {	669  }
	"Set DwellUnit:TotalRefrigUsage"		DwellUnit:TotalRefrigUsage		= {	if (IfValidAnd( DwellUnitTypeRef:HaveRefrig > 0.5 )) then  DwellUnitTypeRef:RefrigElecUsage * Count  else  0  endif  }

; APPLIANCE INTERNAL GAINS - by assigned zone...
  ; refigerator gain - handled by assignment of zones
	"Set Zone:Appl_RefrigGain - unit #1"	Zone:Appl_RefrigGain		= {	SumChildren( DwellUnit:TotalRefrigUsage )  / 365  }

  ; cooking gain-Electric - handled by assignment of zones
	"Set Zone:Appl_CookGain-Elec - unit #1"		Zone:Appl_CookGain[1]	= {	SumChildren( DwellUnit:TotalCookElecGain )  }

  ; cooking gain-NatGas - handled by assignment of zones
	"Set Zone:Appl_CookGain-NGas - unit #1"		Zone:Appl_CookGain[2]	= {	SumChildren( DwellUnit:TotalCookGasGain )  }

  ; cooking gain-OtherFuel - handled by assignment of zones
	"Set Zone:Appl_CookGain-Othr - unit #1"		Zone:Appl_CookGain[3]	= {	SumChildren( DwellUnit:TotalCookOthrGain )  }

  ; dishwasher gain - handled by assignment of zones
	; SAC 4/14/16 - revised for T24-2016 gains
	"Set Zone:Appl_DishGain - unit #1"		Zone:Appl_DishGain		= {	if (Proj:IntGainsMethod <= 2013)
																								then	SumChildren( DwellUnit:TotalDishUsage )  / 365
																								else if (IfValidAnd( CondFloorArea > 0 ))
																								then	SumChildren( DwellUnit:TotalDishUsage )  / CondFloorArea
																								else	0  endif endif  }
  ; clothes washer gain - handled by assignment of zones
	"Set Zone:Appl_WasherGain - unit #1"			Zone:Appl_WasherGain		= {	SumRevRef( DwellUnit:WasherZoneRef, DwellUnit:TotalClthWashGain )  }

  ; clothes dryer gain-Electric - handled by assignment of zones
	"Set Zone:Appl_DryerGain-Elec - unit #1"		Zone:Appl_DryerGain[1]	= {	SumRevRef( DwellUnit:DryerZoneRef, DwellUnit:TotalClthDryElecGain )  }

  ; clothes dryer gain-NatGas - handled by assignment of zones
	"Set Zone:Appl_DryerGain-NGas - unit #1"		Zone:Appl_DryerGain[2]	= {	SumRevRef( DwellUnit:DryerZoneRef, DwellUnit:TotalClthDryGasGain )  }

  ; clothes dryer gain-OtherFuel - handled by assignment of zones
	"Set Zone:Appl_DryerGain-Othr - unit #1"		Zone:Appl_DryerGain[3]	= {	SumRevRef( DwellUnit:DryerZoneRef, DwellUnit:TotalClthDryOthrGain )  }

END
;*************************************************************************


; SAC 10/20/14 - moved here from CSE simulation prep so that it is accessible in model checking
;*************************************************************************
RULELIST "Set_ZoneClVent_SFam"  0 0 0 0
;*************************************************************************
	"Init Zone:ClVentAirFlow"			Zone:ClVentAirFlow	= {	0  }
	"Init Zone:ClVentPower"				Zone:ClVentPower		= {	0  }

; SAC 10/23/13 - fixed bug where UnitClVentZone[2-6]:ClVentPower were summing previous ClVentAirFlow rather than ClVentPower from earlier rules (GC issue #217)
	"Set Proj:UnitClVentZone[1]:ClVentAirFlow"	Proj:UnitClVentZone[1]:ClVentAirFlow	= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	UnitClVentCFM[1]  endif  }
	"Set Proj:UnitClVentZone[1]:ClVentPower"		Proj:UnitClVentZone[1]:ClVentPower		= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	if (UnitClVentOption == 1) then	0.1 * UnitClVentCFM[1]
																																	else if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[1] ))
																																	then  UnitClVentFan[1]:WperCFMCool * UnitClVentCFM[1]
																																	else  UNCHANGED  endif endif		endif  }

	"Set Proj:UnitClVentZone[2]:ClVentAirFlow"	Proj:UnitClVentZone[2]:ClVentAirFlow	= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	UnitClVentZone[2]:ClVentAirFlow + UnitClVentCFM[2]  endif  }
	"Set Proj:UnitClVentZone[2]:ClVentPower"		Proj:UnitClVentZone[2]:ClVentPower		= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[2] ))
																												;					then  UnitClVentZone[2]:ClVentAirFlow + (UnitClVentFan[2]:WperCFMCool * UnitClVentCFM[2])
																																	then  UnitClVentZone[2]:ClVentPower + (UnitClVentFan[2]:WperCFMCool * UnitClVentCFM[2])
																																	else  UNCHANGED  endif		endif  }

	"Set Proj:UnitClVentZone[3]:ClVentAirFlow"	Proj:UnitClVentZone[3]:ClVentAirFlow	= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	UnitClVentZone[3]:ClVentAirFlow + UnitClVentCFM[3]  endif  }
	"Set Proj:UnitClVentZone[3]:ClVentPower"		Proj:UnitClVentZone[3]:ClVentPower		= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[3] ))
																																	then  UnitClVentZone[3]:ClVentPower + (UnitClVentFan[3]:WperCFMCool * UnitClVentCFM[3])
																																	else  UNCHANGED  endif		endif  }

	"Set Proj:UnitClVentZone[4]:ClVentAirFlow"	Proj:UnitClVentZone[4]:ClVentAirFlow	= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	UnitClVentZone[4]:ClVentAirFlow + UnitClVentCFM[4]  endif  }
	"Set Proj:UnitClVentZone[4]:ClVentPower"		Proj:UnitClVentZone[4]:ClVentPower		= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[4] ))
																																	then  UnitClVentZone[4]:ClVentPower + (UnitClVentFan[4]:WperCFMCool * UnitClVentCFM[4])
																																	else  UNCHANGED  endif		endif  }

	"Set Proj:UnitClVentZone[5]:ClVentAirFlow"	Proj:UnitClVentZone[5]:ClVentAirFlow	= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	UnitClVentZone[5]:ClVentAirFlow + UnitClVentCFM[5]  endif  }
	"Set Proj:UnitClVentZone[5]:ClVentPower"		Proj:UnitClVentZone[5]:ClVentPower		= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[5] ))
																																	then  UnitClVentZone[5]:ClVentPower + (UnitClVentFan[5]:WperCFMCool * UnitClVentCFM[5])
																																	else  UNCHANGED  endif		endif  }

	"Set Proj:UnitClVentZone[6]:ClVentAirFlow"	Proj:UnitClVentZone[6]:ClVentAirFlow	= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	UnitClVentZone[6]:ClVentAirFlow + UnitClVentCFM[6]  endif  }
	"Set Proj:UnitClVentZone[6]:ClVentPower"		Proj:UnitClVentZone[6]:ClVentPower		= {	if (EnableClVent < 0.5) then  UNCHANGED
																															else	if (UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[6] ))
																																	then  UnitClVentZone[6]:ClVentPower + (UnitClVentFan[6]:WperCFMCool * UnitClVentCFM[6])
																																	else  UNCHANGED  endif		endif  }
END
;*************************************************************************
RULELIST "Set_ZoneClVent_MFam"  0 0 0 0
;*************************************************************************
	"Init Zone:ClVentAirFlow"			Zone:ClVentAirFlow	= {	0  }
	"Init Zone:ClVentPower"				Zone:ClVentPower		= {	0  }
; NO RULES HERE SETTING these values - until such a time as the MFam buildings support whole house fans
END
;*************************************************************************


;*************************************************************************
RULELIST "BlastInputs_PVWInputs_Simplified"  1 0 0 1
	"Blast Proj:PVWInverterEff[1]"		Proj:PVWInverterEff[1]		= {	UNDEFINED  }
	"Blast Proj:PVWInverterEff[2]"		Proj:PVWInverterEff[2]		= {	UNDEFINED  }
	"Blast Proj:PVWInverterEff[3]"		Proj:PVWInverterEff[3]		= {	UNDEFINED  }
	"Blast Proj:PVWInverterEff[4]"		Proj:PVWInverterEff[4]		= {	UNDEFINED  }
	"Blast Proj:PVWInverterEff[5]"		Proj:PVWInverterEff[5]		= {	UNDEFINED  }
	"Blast Proj:PVWArrayType[1]"			Proj:PVWArrayType[1]			= {	UNDEFINED  }
	"Blast Proj:PVWArrayType[2]"			Proj:PVWArrayType[2]			= {	UNDEFINED  }
	"Blast Proj:PVWArrayType[3]"			Proj:PVWArrayType[3]			= {	UNDEFINED  }
	"Blast Proj:PVWArrayType[4]"			Proj:PVWArrayType[4]			= {	UNDEFINED  }
	"Blast Proj:PVWArrayType[5]"			Proj:PVWArrayType[5]			= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastInputs_PVWCalFlexInstall_1"  1 0 0 1
	"Blast Proj:PVWArrayTiltInput[1]"	Proj:PVWArrayTiltInput[1]	= {	UNDEFINED  }
	"Blast Proj:PVWArrayTiltPitch[1]"	Proj:PVWArrayTiltPitch[1]	= {	UNDEFINED  }
	"Blast Proj:PVWArrayTiltDeg[1]"		Proj:PVWArrayTiltDeg[1]		= {	UNDEFINED  }
	"Blast Proj:PVWAzm[1]"					Proj:PVWAzm[1]					= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastInputs_PVWCalFlexInstall_2"  1 0 0 1
	"Blast Proj:PVWArrayTiltInput[2]"	Proj:PVWArrayTiltInput[2]	= {	UNDEFINED  }
	"Blast Proj:PVWArrayTiltPitch[2]"	Proj:PVWArrayTiltPitch[2]	= {	UNDEFINED  }
	"Blast Proj:PVWArrayTiltDeg[2]"		Proj:PVWArrayTiltDeg[2]		= {	UNDEFINED  }
	"Blast Proj:PVWAzm[2]"					Proj:PVWAzm[2]					= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastInputs_PVWCalFlexInstall_3"  1 0 0 1
	"Blast Proj:PVWArrayTiltInput[3]"	Proj:PVWArrayTiltInput[3]	= {	UNDEFINED  }
	"Blast Proj:PVWArrayTiltPitch[3]"	Proj:PVWArrayTiltPitch[3]	= {	UNDEFINED  }
	"Blast Proj:PVWArrayTiltDeg[3]"		Proj:PVWArrayTiltDeg[3]		= {	UNDEFINED  }
	"Blast Proj:PVWAzm[3]"					Proj:PVWAzm[3]					= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastInputs_PVWCalFlexInstall_4"  1 0 0 1
	"Blast Proj:PVWArrayTiltInput[4]"	Proj:PVWArrayTiltInput[4]	= {	UNDEFINED  }
	"Blast Proj:PVWArrayTiltPitch[4]"	Proj:PVWArrayTiltPitch[4]	= {	UNDEFINED  }
	"Blast Proj:PVWArrayTiltDeg[4]"		Proj:PVWArrayTiltDeg[4]		= {	UNDEFINED  }
	"Blast Proj:PVWAzm[4]"					Proj:PVWAzm[4]					= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastInputs_PVWCalFlexInstall_5"  1 0 0 1
	"Blast Proj:PVWArrayTiltInput[5]"	Proj:PVWArrayTiltInput[5]	= {	UNDEFINED  }
	"Blast Proj:PVWArrayTiltPitch[5]"	Proj:PVWArrayTiltPitch[5]	= {	UNDEFINED  }
	"Blast Proj:PVWArrayTiltDeg[5]"		Proj:PVWArrayTiltDeg[5]		= {	UNDEFINED  }
	"Blast Proj:PVWAzm[5]"					Proj:PVWAzm[5]					= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "Force_PVWArrayType_to_FixedOpenRack"  1 0 0 0
	"Force Proj:PVWArrayType[1] to 'Fixed (open rack)'"		Proj:PVWArrayType[1]		= {	"Fixed (open rack)"  }
	"Force Proj:PVWArrayType[2] to 'Fixed (open rack)'"		Proj:PVWArrayType[2]		= {	"Fixed (open rack)"  }
	"Force Proj:PVWArrayType[3] to 'Fixed (open rack)'"		Proj:PVWArrayType[3]		= {	"Fixed (open rack)"  }
	"Force Proj:PVWArrayType[4] to 'Fixed (open rack)'"		Proj:PVWArrayType[4]		= {	"Fixed (open rack)"  }
	"Force Proj:PVWArrayType[5] to 'Fixed (open rack)'"		Proj:PVWArrayType[5]		= {	"Fixed (open rack)"  }
END
;*************************************************************************
  ; SAC 4/15/16 - blast user input PVRatedPower (for any 2016+ model - as this is no longer an input and its presence screws up PV compliance credit) 
  ; LDH 8/22/16 - functionality was combined with RULELIST "Force_2016PVCreditOn"
;RULELIST "ForceDefault_PVRatedPower"  1 0 0 0
;	"Blast Proj:PVRatedPower"		Proj:PVRatedPower	= {	UNDEFINED  }
;END
RULELIST "Force_PVRatedPower_to_PVWDCSysTotal"  1 0 0 0
	"Override Proj:PVRatedPower with PVWDCSysTotal"		Proj:PVRatedPower	= {	PVWDCSysTotal  }
END
;*************************************************************************
RULELIST "BlastInputs_PVWArrayTiltPitch_1"  1 0 0 0
	"Blast PVWArrayTiltPitch[1]"		Proj:PVWArrayTiltPitch[1]		= {	UNDEFINED  }
END
RULELIST "BlastInputs_PVWArrayTiltPitch_2"  1 0 0 0
	"Blast PVWArrayTiltPitch[2]"		Proj:PVWArrayTiltPitch[2]		= {	UNDEFINED  }
END
RULELIST "BlastInputs_PVWArrayTiltPitch_3"  1 0 0 0
	"Blast PVWArrayTiltPitch[3]"		Proj:PVWArrayTiltPitch[3]		= {	UNDEFINED  }
END
RULELIST "BlastInputs_PVWArrayTiltPitch_4"  1 0 0 0
	"Blast PVWArrayTiltPitch[4]"		Proj:PVWArrayTiltPitch[4]		= {	UNDEFINED  }
END
RULELIST "BlastInputs_PVWArrayTiltPitch_5"  1 0 0 0
	"Blast PVWArrayTiltPitch[5]"		Proj:PVWArrayTiltPitch[5]		= {	UNDEFINED  }
END
;*************************************************************************
RULELIST "BlastInputs_PVWArrayTiltDeg_1"  1 0 0 0
	"Blast PVWArrayTiltDeg[1]"		Proj:PVWArrayTiltDeg[1]		= {	UNDEFINED  }
END
RULELIST "BlastInputs_PVWArrayTiltDeg_2"  1 0 0 0
	"Blast PVWArrayTiltDeg[2]"		Proj:PVWArrayTiltDeg[2]		= {	UNDEFINED  }
END
RULELIST "BlastInputs_PVWArrayTiltDeg_3"  1 0 0 0
	"Blast PVWArrayTiltDeg[3]"		Proj:PVWArrayTiltDeg[3]		= {	UNDEFINED  }
END
RULELIST "BlastInputs_PVWArrayTiltDeg_4"  1 0 0 0
	"Blast PVWArrayTiltDeg[4]"		Proj:PVWArrayTiltDeg[4]		= {	UNDEFINED  }
END
RULELIST "BlastInputs_PVWArrayTiltDeg_5"  1 0 0 0
	"Blast PVWArrayTiltDeg[5]"		Proj:PVWArrayTiltDeg[5]		= {	UNDEFINED  }
END
;*************************************************************************


;*************************************************************************
RULELIST "Create_Garage" 1 0 0 0
;-------------------------------------------------------------------------
   "Create Garage component"		Proj:Action		= {	CreateComp( Garage, "Garage" )  }
END
;;*************************************************************************
;RULELIST "Create_Attic" 1 0 0 0
;;-------------------------------------------------------------------------
;   "Create Attic component"		Proj:Action		= {	CreateComp( Attic, "Attic" )  }
;END
;*************************************************************************
RULELIST "Create_CrawlSpace" 1 0 0 0
;-------------------------------------------------------------------------
   "Create CrawlSpace component"		Proj:Action		= {	CreateComp( CrawlSpace, "Crawl Space" )  }
END
;*************************************************************************


;*************************************************************************
RULELIST "ForceDefaults_Proj_Status" 1 0 0 0
;*************************************************************************
	"Force Default of Proj IsNew"   			Proj:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of Proj IsAltered"   	Proj:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force consistent Proj IsVerified"		Proj:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_Zone_Status" 1 0 0 0
;*************************************************************************
	"Force Default of Zone IsNew"   			Zone:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of Zone IsAltered"   	Zone:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of Zone IsExisting"   	Zone:IsExisting	= { if (Status == 1) then 1 else 0 endif }
END
;*************************************************************************
RULELIST "ForceDefaults_ExtWall_Status" 1 0 0 0
;*************************************************************************
	"Force Default of ExtWall IsNew"   			ExtWall:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of ExtWall IsAltered"   	ExtWall:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of ExtWall IsExisting"   	ExtWall:IsExisting	= { if (Status == 1) then 1 else 0 endif }
	"Force consistent ExtWall IsVerified"		ExtWall:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_Win_Status" 1 0 0 0
;*************************************************************************
	"Force Default of Win IsNew"   			Win:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of Win IsAltered"   		Win:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of Win IsExisting"   	Win:IsExisting		= { if (Status == 1) then 1 else 0 endif }
	"Force consistent Win IsVerified"		Win:IsVerified		= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_Door_Status" 1 0 0 0
;*************************************************************************
	"Force Default of Door IsNew"   			Door:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of Door IsAltered"   	Door:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of Door IsExisting"   	Door:IsExisting	= { if (Status == 1) then 1 else 0 endif }
	"Force consistent Door IsVerified"		Door:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_ExteriorFloor_Status" 1 0 0 0
;*************************************************************************
	"Force Default of ExteriorFloor IsNew"   			ExteriorFloor:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of ExteriorFloor IsAltered"   	ExteriorFloor:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of ExteriorFloor IsExisting"   	ExteriorFloor:IsExisting	= { if (Status == 1) then 1 else 0 endif }
	"Force consistent ExteriorFloor IsVerified"		ExteriorFloor:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_FloorOverCrawl_Status" 1 0 0 0
;*************************************************************************
	"Force Default of FloorOverCrawl IsNew"   		FloorOverCrawl:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of FloorOverCrawl IsAltered"   	FloorOverCrawl:IsAltered	= { if (Status == 2) then 1 else 0 endif }
	"Force Default of FloorOverCrawl IsExisting"   	FloorOverCrawl:IsExisting	= { if (Status == 1) then 1 else 0 endif }
	"Force consistent FloorOverCrawl IsVerified"		FloorOverCrawl:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_CathedralCeiling_Status" 1 0 0 0
;*************************************************************************
	"Force Default of CathedralCeiling IsNew"   			CathedralCeiling:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of CathedralCeiling IsAltered"   	CathedralCeiling:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of CathedralCeiling IsExisting"   	CathedralCeiling:IsExisting	= { if (Status == 1) then 1 else 0 endif }
	"Force consistent CathedralCeiling IsVerified"		CathedralCeiling:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_CeilingBelowAttic_Status" 1 0 0 0
;*************************************************************************
	"Force Default of CeilingBelowAttic IsNew"   		CeilingBelowAttic:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of CeilingBelowAttic IsAltered"   	CeilingBelowAttic:IsAltered	= { if (Status == 2) then 1 else 0 endif }
	"Force Default of CeilingBelowAttic IsExisting"   	CeilingBelowAttic:IsExisting	= { if (Status == 1) then 1 else 0 endif }
	"Force consistent CeilingBelowAttic IsVerified"		CeilingBelowAttic:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_InteriorCeiling_Status" 1 0 0 0
;*************************************************************************
	"Force Default of InteriorCeiling IsNew"   		InteriorCeiling:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of InteriorCeiling IsAltered"   	InteriorCeiling:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of InteriorCeiling IsExisting"   InteriorCeiling:IsExisting		= { if (Status == 1) then 1 else 0 endif }
	"Force consistent InteriorCeiling IsVerified"	InteriorCeiling:IsVerified		= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_IntWall_Status" 1 0 0 0
;*************************************************************************
	"Force Default of IntWall IsNew"   			IntWall:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of IntWall IsAltered"   	IntWall:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of IntWall IsExisting"   	IntWall:IsExisting	= { if (Status == 1) then 1 else 0 endif }
	"Force consistent IntWall IsVerified"		IntWall:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_UndWall_Status" 1 0 0 0
;*************************************************************************
	"Force Default of UndWall IsNew"   			UndWall:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of UndWall IsAltered"   	UndWall:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of UndWall IsExisting"   	UndWall:IsExisting	= { if (Status == 1) then 1 else 0 endif }
	"Force consistent UndWall IsVerified"		UndWall:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_InteriorFloor_Status" 1 0 0 0
;*************************************************************************
	"Force Default of InteriorFloor IsNew"   			InteriorFloor:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of InteriorFloor IsAltered"   	InteriorFloor:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of InteriorFloor IsExisting"   	InteriorFloor:IsExisting	= { if (Status == 1) then 1 else 0 endif }
	"Force consistent InteriorFloor IsVerified"		InteriorFloor:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_UndFloor_Status" 1 0 0 0
;*************************************************************************
	"Force Default of UndFloor IsNew"   			UndFloor:IsNew				= { if (Status == 3) then 1 else 0 endif }
	"Force Default of UndFloor IsAltered"   		UndFloor:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of UndFloor IsExisting"   		UndFloor:IsExisting		= { if (Status == 1) then 1 else 0 endif }
	"Force consistent UndFloor IsVerified"			UndFloor:IsVerified		= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_SlabFloor_Status" 1 0 0 0
;*************************************************************************
	"Force Default of SlabFloor IsNew"   			SlabFloor:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of SlabFloor IsAltered"   		SlabFloor:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of SlabFloor IsExisting"   	SlabFloor:IsExisting		= { if (Status == 1) then 1 else 0 endif }
	"Force consistent SlabFloor IsVerified"		SlabFloor:IsVerified		= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_Attic_Status" 1 0 0 0
;*************************************************************************
	"Force Default of Attic IsNew"   			Attic:IsNew				= { if (Status == 3) then 1 else 0 endif }
	"Force Default of Attic IsAltered"   		Attic:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of Attic IsExisting"   		Attic:IsExisting		= { if (Status == 1) then 1 else 0 endif }
	"Force consistent Attic IsVerified"			Attic:IsVerified		= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_Skylt_Status" 1 0 0 0
;*************************************************************************
	"Force Default of Skylt IsNew"   			Skylt:IsNew				= { if (Status == 3) then 1 else 0 endif }
	"Force Default of Skylt IsAltered"   		Skylt:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of Skylt IsExisting"   		Skylt:IsExisting		= { if (Status == 1) then 1 else 0 endif }
	"Force consistent Skylt IsVerified"			Skylt:IsVerified		= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_HVACSys_Status" 1 0 0 0
;*************************************************************************
	"Force Default of HVACSys IsNew"   			HVACSys:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of HVACSys IsAltered"   	HVACSys:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of HVACSys IsExisting"   	HVACSys:IsExisting	= { if (Status == 1) then 1 else 0 endif }
	"Force consistent HVACSys IsVerified"		HVACSys:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
; mjb		8/21/14	- added to implement CEC decision to ONLY allow fan E+A+A mods that are consistent with HVACSys mods
; SAC 8/28/16 - NOTE: the following logic will NOT result in consistent settings if the same Fan object is referenced by a combination of systems w/ differing Status settings - needs more attention
	"Force Default of HVACSys:Fan Status"   			HVACSys:Fan:Status			= { Status }
	"Force Default of HVACSys:Fan IsNew"   			HVACSys:Fan:IsNew				= { if (Status == 3) then 1 else 0 endif }
	"Force Default of HVACSys:Fan IsAltered"   		HVACSys:Fan:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of HVACSys:Fan IsExisting"   		HVACSys:Fan:IsExisting		= { if (Status == 1) then 1 else 0 endif }
	"Force consistent HVACSys:fan IsVerified"			HVACSys:Fan:IsVerified		= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
; SAC 8/28/16 - added logic to set HVACCool:Is* status flags - multiple MAY be set, and they could equal values > 1, depending on how many references there are
	"Increment HVACSys:CoolSystem[1]:IsNew"      HVACSys:CoolSystem[1]:IsNew   = {
	   if (IsNew = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 1 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
	   else  CoolSystem[1]:IsNew + 1  endif  }
	"Increment HVACSys:CoolSystem[2]:IsNew"      HVACSys:CoolSystem[2]:IsNew   = {
	   if (IsNew = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 2 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[2]:IsNew + 1  endif  }
	"Increment HVACSys:CoolSystem[3]:IsNew"      HVACSys:CoolSystem[3]:IsNew   = {
	   if (IsNew = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 3 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[3]:IsNew + 1  endif  }
	"Increment HVACSys:CoolSystem[4]:IsNew"      HVACSys:CoolSystem[4]:IsNew   = {
	   if (IsNew = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 4 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[4]:IsNew + 1  endif  }
	"Increment HVACSys:CoolSystem[5]:IsNew"      HVACSys:CoolSystem[5]:IsNew   = {
	   if (IsNew = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 5 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[5]:IsNew + 1  endif  }
	"Increment HVACSys:CoolSystem[6]:IsNew"      HVACSys:CoolSystem[6]:IsNew   = {
	   if (IsNew = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 6 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[6]:IsNew + 1  endif  }
	"Increment HVACSys:CoolSystem[7]:IsNew"      HVACSys:CoolSystem[7]:IsNew   = {
	   if (IsNew = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 7 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[7]:IsNew + 1  endif  }
	"Increment HVACSys:CoolSystem[8]:IsNew"      HVACSys:CoolSystem[8]:IsNew   = {
	   if (IsNew = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 8 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[8]:IsNew + 1  endif  }
	"Increment HVACSys:CoolSystem[9]:IsNew"      HVACSys:CoolSystem[9]:IsNew   = {
	   if (IsNew = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 9 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[9]:IsNew + 1  endif  }
	"Increment HVACSys:CoolSystem[10]:IsNew"     HVACSys:CoolSystem[10]:IsNew  = {
	   if (IsNew = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 10 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[10]:IsNew + 1  endif  }

	"Increment HVACSys:CoolSystem[1]:IsAltered"  HVACSys:CoolSystem[1]:IsAltered  = {
	   if (IsAltered = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 1 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[1]:IsAltered + 1  endif  }
	"Increment HVACSys:CoolSystem[2]:IsAltered"  HVACSys:CoolSystem[2]:IsAltered  = {
	   if (IsAltered = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 2 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[2]:IsAltered + 1  endif  }
	"Increment HVACSys:CoolSystem[3]:IsAltered"  HVACSys:CoolSystem[3]:IsAltered  = {
	   if (IsAltered = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 3 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[3]:IsAltered + 1  endif  }
	"Increment HVACSys:CoolSystem[4]:IsAltered"  HVACSys:CoolSystem[4]:IsAltered  = {
	   if (IsAltered = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 4 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[4]:IsAltered + 1  endif  }
	"Increment HVACSys:CoolSystem[5]:IsAltered"  HVACSys:CoolSystem[5]:IsAltered  = {
	   if (IsAltered = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 5 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[5]:IsAltered + 1  endif  }
	"Increment HVACSys:CoolSystem[6]:IsAltered"  HVACSys:CoolSystem[6]:IsAltered  = {
	   if (IsAltered = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 6 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[6]:IsAltered + 1  endif  }
	"Increment HVACSys:CoolSystem[7]:IsAltered"  HVACSys:CoolSystem[7]:IsAltered  = {
	   if (IsAltered = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 7 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[7]:IsAltered + 1  endif  }
	"Increment HVACSys:CoolSystem[8]:IsAltered"  HVACSys:CoolSystem[8]:IsAltered  = {
	   if (IsAltered = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 8 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[8]:IsAltered + 1  endif  }
	"Increment HVACSys:CoolSystem[9]:IsAltered"  HVACSys:CoolSystem[9]:IsAltered  = {
	   if (IsAltered = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 9 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[9]:IsAltered + 1  endif  }
	"Increment HVACSys:CoolSystem[10]:IsAltered" HVACSys:CoolSystem[10]:IsAltered = {
	   if (IsAltered = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 10 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[10]:IsAltered + 1  endif  }

	"Incremnt HVACSys:CoolSystem[1]:IsExisting"  HVACSys:CoolSystem[1]:IsExisting = {
	   if (IsExisting = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 1 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[1]:IsExisting + 1  endif  }
	"Incremnt HVACSys:CoolSystem[2]:IsExisting"  HVACSys:CoolSystem[2]:IsExisting = {
	   if (IsExisting = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 2 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[2]:IsExisting + 1  endif  }
	"Incremnt HVACSys:CoolSystem[3]:IsExisting"  HVACSys:CoolSystem[3]:IsExisting = {
	   if (IsExisting = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 3 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[3]:IsExisting + 1  endif  }
	"Incremnt HVACSys:CoolSystem[4]:IsExisting"  HVACSys:CoolSystem[4]:IsExisting = {
	   if (IsExisting = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 4 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[4]:IsExisting + 1  endif  }
	"Incremnt HVACSys:CoolSystem[5]:IsExisting"  HVACSys:CoolSystem[5]:IsExisting = {
	   if (IsExisting = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 5 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[5]:IsExisting + 1  endif  }
	"Incremnt HVACSys:CoolSystem[6]:IsExisting"  HVACSys:CoolSystem[6]:IsExisting = {
	   if (IsExisting = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 6 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[6]:IsExisting + 1  endif  }
	"Incremnt HVACSys:CoolSystem[7]:IsExisting"  HVACSys:CoolSystem[7]:IsExisting = {
	   if (IsExisting = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 7 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[7]:IsExisting + 1  endif  }
	"Incremnt HVACSys:CoolSystem[8]:IsExisting"  HVACSys:CoolSystem[8]:IsExisting = {
	   if (IsExisting = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 8 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[8]:IsExisting + 1  endif  }
	"Incremnt HVACSys:CoolSystem[9]:IsExisting"  HVACSys:CoolSystem[9]:IsExisting = {
	   if (IsExisting = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 9 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[9]:IsExisting + 1  endif  }
	"Incremnt HVACSys:CoolSystem[10]:IsExisting" HVACSys:CoolSystem[10]:IsExisting = {
	   if (IsExisting = 0 .OR. IfValidAnd( NumCoolSystemTypes >= 10 )==0 .OR.
	       IfValidAnd( FloorAreaServed[1] > 0.5 )==0) then  UNCHANGED
      else  CoolSystem[10]:IsExisting + 1  endif  }
END
;*************************************************************************
RULELIST "ForceDefaults_HVACHeat_Status" 1 0 0 0
;*************************************************************************
	"Force Default of HVACHeat IsNew"   		HVACHeat:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of HVACHeat IsAltered"   	HVACHeat:IsAltered	= { if (Status == 2) then 1 else 0 endif }
	"Force Default of HVACHeat IsExisting"   	HVACHeat:IsExisting	= { if (Status == 1) then 1 else 0 endif }
;	"Force consistent HVACHeat IsVerified"		HVACHeat:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "Initialize_HVACCool_Status" 1 0 0 0
	"Initialize HVACCool IsNew"   		HVACCool:IsNew			= { 0 }
	"Initialize HVACCool IsAltered"   	HVACCool:IsAltered	= { 0 }
	"Initialize HVACCool IsExisting"   	HVACCool:IsExisting	= { 0 }
END
;*************************************************************************
; SAC 8/28/16 - these flags now set above in 'ForceDefaults_HVACSys_Status' based on assignments from HVACSys (tic #728)
;RULELIST "ForceDefaults_HVACCool_Status" 1 0 0 0
;	"Force Default of HVACCool IsNew"   		HVACCool:IsNew			= { if (Status == 3) then 1 else 0 endif }
;	"Force Default of HVACCool IsAltered"   	HVACCool:IsAltered	= { if (Status == 2) then 1 else 0 endif }
;	"Force Default of HVACCool IsExisting"   	HVACCool:IsExisting	= { if (Status == 1) then 1 else 0 endif }
;;	"Force consistent HVACCool IsVerified"		HVACCool:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
;END
;*************************************************************************
RULELIST "ForceDefaults_HVACHtPump_Status" 1 0 0 0
;*************************************************************************
	"Force Default of HVACHtPump IsNew"   			HVACHtPump:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of HVACHtPump IsAltered"   	HVACHtPump:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of HVACHtPump IsExisting"   	HVACHtPump:IsExisting	= { if (Status == 1) then 1 else 0 endif }
;	"Force consistent HVACHtPump IsVerified"		HVACHtPump:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
;RULELIST "ForceDefaults_HVACFan_Status" 1 0 0 0			; mjb		8/21/14	- removed to implement CEC decision to NOT allow fan E+A+A mods independent of HVACSys mods
;*************************************************************************
;	"Force Default of HVACFan IsNew"   			HVACFan:IsNew			= { if (Status == 3) then 1 else 0 endif }
;	"Force Default of HVACFan IsAltered"   	HVACFan:IsAltered		= { if (Status == 2) then 1 else 0 endif }
;	"Force Default of HVACFan IsExisting"   	HVACFan:IsExisting	= { if (Status == 1) then 1 else 0 endif }
;	"Force consistent HVACFan IsVerified"		HVACFan:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
;END
;*************************************************************************
RULELIST "ForceDefaults_HVACDist_Status" 1 0 0 0
;*************************************************************************
	"Force Default of HVACDist IsNew"   		HVACDist:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of HVACDist IsAltered"   	HVACDist:IsAltered	= { if (Status == 2) then 1 else 0 endif }
	"Force Default of HVACDist IsExisting"   	HVACDist:IsExisting	= { if (Status == 1) then 1 else 0 endif }
	"Force consistent HVACDist IsVerified"		HVACDist:IsVerified	= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_DHWSys_Status" 1 0 0 0
;*************************************************************************
	"Force Default of DHWSys IsNew"   			DHWSys:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of DHWSys IsAltered"   		DHWSys:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of DHWSys IsExisting"   	DHWSys:IsExisting		= { if (Status == 1) then 1 else 0 endif }
	"Force consistent DHWSys IsVerified"		DHWSys:IsVerified		= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
RULELIST "ForceDefaults_DHWHeater_Status" 1 0 0 0
;*************************************************************************
	"Force Default of DHWHeater IsNew"   			DHWHeater:IsNew			= { if (Status == 3) then 1 else 0 endif }
	"Force Default of DHWHeater IsAltered"   		DHWHeater:IsAltered		= { if (Status == 2) then 1 else 0 endif }
	"Force Default of DHWHeater IsExisting"   	DHWHeater:IsExisting		= { if (Status == 1) then 1 else 0 endif }
;	"Force consistent DHWHeater IsVerified"		DHWHeater:IsVerified		= { if (IsNew > 0.5) then 0 else UNCHANGED endif }
END
;*************************************************************************
;*************************************************************************
RULELIST "ForceDefault_Zone_HVAC" 1 0 0 0
;*************************************************************************
;	mjb	10/14/14	assign HVACSystem from ActiveHVACSystem for IsAddAlone
	"Set HVACSystem to ActiveHVACSystem"	Zone:HVACSystem			=	{	ActiveHVACSystem	}
   "Force HVACSys Status to Existing"		Zone:HVACSystem:Status	=  {  1 }
   ; SAC 4/10/15 - modified rule to allow selection of New or Existing+New for New Cons Addition Alone
   "Force HVACDist Status to Existing (in some cases)"
   		Zone:HVACSystem:DistribSystem:Status	= {	if (Proj:RunScope == 2) then  UNCHANGED	; need to keep Status as is for EAA
   																	else if (Proj:IsAddAlone > 0.5 .AND. IfValidAnd( HVACSystem:DistribSystem:Status = 2)) then  1
   																	else if (Proj:IsAddAlone < 0.5) then  1
   																	else  UNCHANGED  endif endif endif  }
END


;*************************************************************************
;*************************************************************************
;22222
RULELIST "PostProposedInput" 1 0 0 1
;
;   Rules which are executed on the input building description following
;   the completion of user input but prior to any simulation(s).
;   These mainly include rules which define conditionally prescribed
;   values and rules which prepare for the Proposed model simulation.
;
;*************************************************************************
;*************************************************************************

   ;--------------------------------------------------------------------
	; Old/Invalid CSE object clean-up    - added SAC 10/3/13
   ;--------------------------------------------------------------------
	"Blast all cseEXPORT components"		Proj:Action		= {	DeleteAllComps( cseEXPORT )  }
	"Blast all cseMETER components"		Proj:Action		= {	DeleteAllComps( cseMETER )  }
	"Blast all cseDHWMETER components"	Proj:Action		= {	DeleteAllComps( cseDHWMETER )  }		; SAC 4/25/16


   ;--------------------------------------------------------------------
	; Remove Attic if it is not going to be simulated.  This ensures that the presence of an attic does
	;	not impact the final standard model when generation of a new attic is required that model.    - added SAC 10/3/13
   ;--------------------------------------------------------------------
	"Delete Attic if not to be simulated"		Attic:Action	= {	if (FloorArea <= 0) then  DeleteComp()  else  UNCHANGED  endif  }


   ;--------------------------------------------------------------------
	; Project data
   ;--------------------------------------------------------------------
  ; SAC 8/29/13 - added copy of weather file setting rule here to ensure no user over-ride (when performing compliance only)
	"Set Proj:WeatherFileName"		Proj:WeatherFileName = {
				if (AnalysisType == 0) then  UNCHANGED		; Research mode
				else	switch (Global( Proj:ClimateZone ))
							case   1 :	"CTZ01S13b.CSW"
							case   2 :	"CTZ02S13b.CSW"
							case   3 :	"CTZ03S13b.CSW"
							case   4 :	"CTZ04S13b.CSW"
							case   5 :	"CTZ05S13b.CSW"
							case   6 :	"CTZ06S13b.CSW"
							case   7 :	"CTZ07S13b.CSW"
							case   8 :	"CTZ08S13b.CSW"
							case   9 :	"CTZ09S13b.CSW"
							case  10 :	"CTZ10S13b.CSW"
							case  11 :	"CTZ11S13b.CSW"
							case  12 :	"CTZ12S13b.CSW"
							case  13 :	"CTZ13S13b.CSW"
							case  14 :	"CTZ14S13b.CSW"
							case  15 :	"CTZ15S13b.CSW"
							case  16 :	"CTZ16S13b.CSW"
							default :	Format( "<unknown wthr file mapping for Proj:ClimateZone = %.0f>", Global( Proj:ClimateZone ) )
						endswitch  endif  }

; SAC 4/9/14 - comment out during testing - probably restore in release version
;	"Set Proj:SeasonChangeSetpt when BypassRuleLimits not specified"		Proj:SeasonChangeSetpt	= {	if (BypassRuleLimits < 0.1) then  60  else  UNCHANGED  endif  }		; SAC 4/3/14
;	"Set Proj:FanVentLockoutTemp when BypassRuleLimits not specified"		Proj:FanVentLockoutTemp	= {	if (BypassRuleLimits < 0.1) then  66  else  UNCHANGED  endif  }		; SAC 4/9/14

; SAC 12/23/15 - MOVED to OneTimeAnalysisPrep to get it done BEFORE it is used to set final people heat gains
;  ; SAC 8/20/14 - rule to force reset of Proj:NumBedrooms for MFam models (GC #354 note#1)
;	"Set Proj:NumBedrooms"		Proj:NumBedrooms	= {	if (IfValidAnd( IsMultiFamily > 0.5 )) then  SumAll( DwellUnit:TotalNumBedrooms )
;																		else  UNCHANGED  endif  }


   ;--------------------------------------------------------------------
   ; Ensure SlabFloor:EdgeInsul* properties are zeroed out if they are toggled off in the interface    - SAC 10/7/13
   ;--------------------------------------------------------------------
  ; SAC 1/21/14 - revised rules to include resetting of *EdgeInsulOption to new setting of '- none -' (when insulation not present) and also set EdgeInsul* numeric values to UNDEFINED
	"Blast SlabFloor:EdgeInsulOption"		SlabFloor:EdgeInsulOption	= {	if (EdgeInsulation < 0.5) then  0  else  UNCHANGED  endif  }
	"Blast SlabFloor:EdgeInsulDepth"			SlabFloor:EdgeInsulDepth	= {	if (EdgeInsulation < 0.5 .OR. EdgeInsulOption < 1 ) then  0  else  UNCHANGED  endif  }
	"Blast SlabFloor:EdgeInsulRValue"		SlabFloor:EdgeInsulRValue	= {	if (EdgeInsulation < 0.5 .OR. EdgeInsulDepth < 0.1) then  0  else  UNCHANGED  endif  }

	"Blast SlabFloor:exEdgeInsulOption"		SlabFloor:exEdgeInsulOption	= {	if (IsAltered .AND. IsVerified .AND. IfValidAnd( exEdgeInsulation > 0.5 )) then  UNCHANGED  else  0  endif  }		; SAC 8/18/14 - switched for IfValidAnd fix
	"Blast SlabFloor:exEdgeInsulDepth"		SlabFloor:exEdgeInsulDepth		= {	if (IsAltered .AND. IsVerified .AND. IfValidAnd( exEdgeInsulation > 0.5 ) .AND. IfValidAnd( exEdgeInsulOption > 1  )) then  UNCHANGED  else  0  endif  }
	"Blast SlabFloor:exEdgeInsulRValue"		SlabFloor:exEdgeInsulRValue	= {	if (IsAltered .AND. IsVerified .AND. IfValidAnd( exEdgeInsulation > 0.5 ) .AND. IfValidAnd( exEdgeInsulDepth > 0.1 )) then  UNCHANGED  else  0  endif  }


   ;--------------------------------------------------------------------
   ; All PostProposedInput HVAC rules added to separate rulelist
   ;--------------------------------------------------------------------
	"Evaluate PostProposedInput HVAC rules"	Proj:Action	= {	EvalRulelist( "PostProposedInput_HVAC" )  }

END
;*************************************************************************


;*************************************************************************
RULELIST  "Reporting_SummarizeModel" 1 0 0 0
;*************************************************************************
;--------------------------------------------------------------------
; Building-wide window area multiplier rules - related to Res ACM section 2.3.5.5
;--------------------------------------------------------------------
;MJB 12/19/13 - update to match E+A+A rules
; mjb	2/19/14 - add SkyLt area into WinArea totals; add area-weighted window U-factor pre-calc
; SAC 2/20/15 - modified to REMOVE E+A+A Additions window/skylight area from New (item 2) and added separate Additions array element
	"Re-calculate Win:TotAreaInclMult[1] - total"								Win:TotAreaInclMult[1]		= {	Area * Multiplier  }
	"Re-calculate Win:TotAreaInclMult[3] - existing"							Win:TotAreaInclMult[3]		= {	if (Proj:RunScope == 2 .AND. Status == 1) then  TotAreaInclMult[1]  else  0  endif  }
	"Re-calculate Win:TotAreaInclMult[2] - new (not add)"						Win:TotAreaInclMult[2]		= {	if (Status == 3 .AND. IsEAAAddZoneGChild == 0) then  TotAreaInclMult[1]  else  0  endif  }
	"Re-calculate Win:TotAreaInclMult[4] - additions"							Win:TotAreaInclMult[4]		= {	if (IsEAAAddZoneGChild) then  TotAreaInclMult[1]  else  0  endif  }
	"Calculate Win:AreaUfactorMult"													Win:AreaUfactorMult			= {	if (Status != 1) then Area * Multiplier  * NFRCUfactor  else  0  endif   }
	"Calculate SkyLt:TotAreaInclMult[1] - total"									SkyLt:TotAreaInclMult[1]		= {	Area * Multiplier  }
	"Calculate SkyLt:TotAreaInclMult[3] - existing"								SkyLt:TotAreaInclMult[3]		= {	if (Proj:RunScope == 2 .AND. Status == 1) then  TotAreaInclMult[1]  else  0  endif  }
	"Calculate SkyLt:TotAreaInclMult[2] - new (not add)"						SkyLt:TotAreaInclMult[2]		= {	if (Status == 3 .AND. IsEAAAddZoneGChild == 0) then  TotAreaInclMult[1]  else  0  endif  }
	"Calculate SkyLt:TotAreaInclMult[4] - additions"							SkyLt:TotAreaInclMult[4]		= {	if (IsEAAAddZoneGChild) then  TotAreaInclMult[1]  else  0  endif  }
	"Calculate SkyLt:AreaUfactorMult"												SkyLt:AreaUfactorMult			= {	if (Status != 1) then Area * Multiplier  * NFRCUfactor  else  0  endif   }
	"Sum window area into parent ExtWall objects[1] - total" 	     		ExtWall:TotWinArea[1]		= {	SumChildren( Win:TotAreaInclMult[1] )  }
	"Sum window area into parent ExtWall objects[3] - existing" 	  		ExtWall:TotWinArea[3]		= {	SumChildren( Win:TotAreaInclMult[3] )  }
	"Sum window area into parent ExtWall objects[2] - new (not add)"		ExtWall:TotWinArea[2]		= {	SumChildren( Win:TotAreaInclMult[2] )  }
	"Sum window area into parent ExtWall objects[4] - additions"			ExtWall:TotWinArea[4]		= {	SumChildren( Win:TotAreaInclMult[4] )  }
	"Sum skylight area into parent CCeiling objects[1] - total"				CathedralCeiling:ChildAreaSum[1]		= {	SumChildren( Skylt:TotAreaInclMult[1] )  }
	"Sum skylight area into parent CCeiling objects[3] - existing"			CathedralCeiling:ChildAreaSum[3]		= {	SumChildren( Skylt:TotAreaInclMult[3] )  }
	"Sum skylight area into parent CCeiling objects[2] - new (not add)"	CathedralCeiling:ChildAreaSum[2]		= {	SumChildren( Skylt:TotAreaInclMult[2] )  }
	"Sum skylight area into parent CCeiling objects[4] - additions"		CathedralCeiling:ChildAreaSum[4]		= {	SumChildren( Skylt:TotAreaInclMult[4] )  }
	"Sum window area into parent Zone objects[1] - total"						Zone:TotCondZoneWinArea[1]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[1] ) + SumChildren( CathedralCeiling:ChildAreaSum[1] ) else  0  endif  }
	"Sum window area into parent Zone objects[3] - existing"    			Zone:TotCondZoneWinArea[3]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[3] ) + SumChildren( CathedralCeiling:ChildAreaSum[3] ) else  0  endif  }
	"Sum window area into parent Zone objects[2] - new (not add)"			Zone:TotCondZoneWinArea[2]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[2] ) + SumChildren( CathedralCeiling:ChildAreaSum[2] ) else  0  endif  }
	"Sum window area into parent Zone objects[4] - additions"				Zone:TotCondZoneWinArea[4]	= {	if (Type < 10) then  SumChildren( ExtWall:TotWinArea[4] ) + SumChildren( CathedralCeiling:ChildAreaSum[4] ) else  0  endif  }
	"Sum cond zone window across entire model[1] - total"						Proj:TotCondZoneWinArea[1]	= {	SumAll( Zone:TotCondZoneWinArea[1] )  }
	"Sum cond zone window across entire model[3] - existing"					Proj:TotCondZoneWinArea[3]	= {	SumAll( Zone:TotCondZoneWinArea[3] )  }
	"Sum cond zone window across entire model[2] - new (not add)"			Proj:TotCondZoneWinArea[2]	= {	SumAll( Zone:TotCondZoneWinArea[2] )  }
	"Sum cond zone window across entire model[4] - additions"				Proj:TotCondZoneWinArea[4]	= {	SumAll( Zone:TotCondZoneWinArea[4] )  }
	"Set model's TOTAL win area / cond floor area ratio"		Proj:CondWinAreaCFARat	= {	if (CondFloorArea > 0) then  TotCondZoneWinArea[1] / CondFloorArea  else  0  endif  }

	; SAC 2/20/15 - new rules to set addition window area ratios based on prescriptive additions table
	"Set Proj:CondAddWinAreaCFARat"		Proj:CondAddWinAreaCFARat	= {	if (CondAdditionSize < 0.1) then  0  else  TotCondZoneWinArea[4] / CondAdditionSize  endif  }
	"Set Proj:MaxAddWinAreaCFARat"		Proj:MaxAddWinAreaCFARat	= {	if (CondAdditionSize < 0.1) then  0
																								else  max(	PrescripAdditions_MaxGlazingArea:MaxWinArea(     "AdditionSize", AdditionSize ) / CondAdditionSize,
																												PrescripAdditions_MaxGlazingArea:MaxFracWinArea( "AdditionSize", AdditionSize ) )		endif  }

;	"Set model's cond zone Existing win area multiplier"		Proj:CondExWinAreaMult	= {	if (CondWinAreaCFARat <= 0.2 .OR. CondFloorArea <= 0 .OR. TotCondZoneWinArea[3] <= 0) then  1.0
;																														else if (TotCondZoneWinArea[3] / CondFloorArea <= 0.2) then  1.0
;																														else  0.2 / (TotCondZoneWinArea[3] / CondFloorArea)  endif endif  }
;	"Set model's cond zone New/Altered win area multiplier"	Proj:CondNewWinAreaMult	= {	if (CondWinAreaCFARat <= 0.2 .OR. CondFloorArea <= 0 .OR. TotCondZoneWinArea[2] <= 0) then  1.0
;																														else if (TotCondZoneWinArea[3] > 0 .AND. CondExWinAreaMult < 1.0) then  0.0
;																														else  ((0.2 * CondFloorArea) - (TotCondZoneWinArea[3] / (TotCondZoneWinArea[1] - TotCondZoneWinArea[3]))) endif endif  }
; SAC 7/14/14 - apply same fix to above rules as was applied in BudgetConversion rules 12/31/13 - fixing bug where CondNewWinAreaMult invalid when New win area exceeds limit of 0.2 Win/CFA
; SAC 2/20/15 - revised logic to use floor and window areas that exclude AdditionSize
	"Set model's cond zone Existing win area multiplier"		Proj:CondExWinAreaMult	= {	1.0	}
	"Set model's cond zone New/Altered win area multiplier"	Proj:CondNewWinAreaMult	= {	if (AdditionSize < 0.1)
																														then  if (CondWinAreaCFARat <= 0.2 .OR. (CondFloorArea - CondAdditionSize) <= 0 .OR. TotCondZoneWinArea[2] <= 0) then  1.0
																																else  (0.2 * (CondFloorArea - CondAdditionSize)) / TotCondZoneWinArea[2]  endif
																														else	if (CondAddWinAreaCFARat <= MaxAddWinAreaCFARat .OR. CondAdditionSize <= 0 .OR. TotCondZoneWinArea[4] <= 0) then  1.0
																																else  (MaxAddWinAreaCFARat * CondAdditionSize) / TotCondZoneWinArea[4]  endif
																														endif  }

	"Set Win:WinAreaMult"	Win:WinAreaMult	= {	if (IsNew .OR. IsAltered) then  Proj:CondNewWinAreaMult  else  Proj:CondExWinAreaMult  endif  }

; 	"Debug log message - ExtWall Window Area in Report Sum"			ExtWall:Action		= {	PostMessageToLog( "ExtWall '%s' TotWinArea = %g", Name, TotWinArea[1] )  }

	"Sum window area into parent ExtWall objects"	ExtWall:RptTotWinArea		= {	TotWinArea[1]  }
	"Sum window area into parent Zone objects"		Zone:RptTotCondZoneWinArea	= {	TotCondZoneWinArea[1] }
	"Sum cond zone window across entire model"		Proj:RptTotCondZoneWinArea	= {	TotCondZoneWinArea[1]  }
	"Set model's win area / cond floor area ratio"	Proj:RptCondWinAreaCFARat	= {	CondWinAreaCFARat  }

; mjb	2/19/14	calculate area-weighted Window U-factor
; SAC 2/24 14 - mod to prevent division by zero (triggered by TDS run T12R02)
	"Calc area-weighted window Ufactor across entire model"			Proj:RptWinAreaWgtUfactor = {
																if (TotCondZoneWinArea[1] <= TotCondZoneWinArea[3]) then  0
																else  ( SumAll( Win:AreaUfactorMult ) + SumAll( Skylt:AreaUfactorMult ) ) / ( TotCondZoneWinArea[1] - TotCondZoneWinArea[3] )  endif  }

; 	"Debug log message - ExtWall Rpt Window Area in Report Sum"			ExtWall:Action		= {	PostMessageToLog( "ExtWall '%s' RptTotWinArea = %g", Name, RptTotWinArea )  }

;--------------------------------------------------------------------
; Building-wide window vent area sums for reporting
;--------------------------------------------------------------------									
	"Set ExtWall:WinVentArea"	ExtWall:WinVentArea	= {	SumChildren( Win:VentArea )  }
	"Set Zone:WinVentArea"		Zone:WinVentArea	= {	SumChildren( ExtWall:WinVentArea )  }
;--------------------------------------------------------------------
; Building-wide surface area sums for reporting
;--------------------------------------------------------------------									
	"Setup Wall/Window/Door Area Totals"		Proj:Action	= {	EvalRulelist( "SetupWallWindowDoorAreaTotals" )  }
; SAC 2/27/14 - moved following rules into above rulelist so that reporting rules can use the exact same logic
;		"Set ExtWall:AreaByWallType[1] - wood framed"	ExtWall:AreaByWallType[1] = {	if (LocalCompAssigned( Construction ) == 0) then  0	else if (Construction:Type == 0) then  Area  else  0  endif endif  }
;		"Set ExtWall:AreaByWallType[2] - steel framed"	ExtWall:AreaByWallType[2] = {	if (LocalCompAssigned( Construction ) == 0) then  0	else if (Construction:Type == 1) then  Area  else  0  endif endif  }
;		"Set ExtWall:AreaByWallType[3] - concrete/CMU"	ExtWall:AreaByWallType[3] = {	if (LocalCompAssigned( Construction ) == 0) then  0	else if (Construction:Type == 9) then  Area  else  0  endif endif  }
;		"Set ExtWall:WinAreaByWallType[1] - wood framed"	ExtWall:WinAreaByWallType[1]	= {	if (AreaByWallType[1] > 0) then  TotWinArea[1]  else  0  endif  }
;		"Set ExtWall:WinAreaByWallType[2] - steel framed"	ExtWall:WinAreaByWallType[2]	= {	if (AreaByWallType[2] > 0) then  TotWinArea[1]  else  0  endif  }
;		"Set ExtWall:WinAreaByWallType[3] - concrete/CMU"	ExtWall:WinAreaByWallType[3]	= {	if (AreaByWallType[3] > 0) then  TotWinArea[1]  else  0  endif  }
;		"Set ExtWall:TotDoorArea"	ExtWall:TotDoorArea	= {	SumChildren( Door:Area )  }
;		"Set ExtWall:DoorAreaByWallType[1] - wood framed"	ExtWall:DoorAreaByWallType[1]	= {	if (AreaByWallType[1] > 0) then  TotDoorArea  else  0  endif  }
;		"Set ExtWall:DoorAreaByWallType[2] - steel framed"	ExtWall:DoorAreaByWallType[2]	= {	if (AreaByWallType[2] > 0) then  TotDoorArea  else  0  endif  }
;		"Set ExtWall:DoorAreaByWallType[3] - concrete/CMU"	ExtWall:DoorAreaByWallType[3]	= {	if (AreaByWallType[3] > 0) then  TotDoorArea  else  0  endif  }
;	
;	  ; SAC 2/26/14 - added 4th array element rules for all Zone & Garage ExtWall*AreaByWallType[] properties to track TOTALS across all wall types
;		"Set Zone:ExtWallAreaByWallType[1] - wood framed"	Zone:ExtWallAreaByWallType[1]	= {	SumChildren( ExtWall:AreaByWallType[1]    )  }
;		"Set Zone:ExtWallAreaByWallType[2] - steel framed"	Zone:ExtWallAreaByWallType[2]	= {   SumChildren( ExtWall:AreaByWallType[2]    )  }
;		"Set Zone:ExtWallAreaByWallType[3] - concrete/CMU"	Zone:ExtWallAreaByWallType[3]	= {   SumChildren( ExtWall:AreaByWallType[3]    )  }
;		"Set Zone:ExtWallAreaByWallType[4] - total"			Zone:ExtWallAreaByWallType[4] = {   ExtWallAreaByWallType[1] + ExtWallAreaByWallType[2] + ExtWallAreaByWallType[3]  }
;		"Set Zone:ExtWallWinAreaByWallType[1] - wood framed"	Zone:ExtWallWinAreaByWallType[1] = {   SumChildren( ExtWall:WinAreaByWallType[1] )  }
;		"Set Zone:ExtWallWinAreaByWallType[2] - steel framed" Zone:ExtWallWinAreaByWallType[2] = {   SumChildren( ExtWall:WinAreaByWallType[2] )  }
;		"Set Zone:ExtWallWinAreaByWallType[3] - concrete/CMU" Zone:ExtWallWinAreaByWallType[3] = {   SumChildren( ExtWall:WinAreaByWallType[3] )  }
;		"Set Zone:ExtWallWinAreaByWallType[4] - total"			Zone:ExtWallWinAreaByWallType[4] = {   ExtWallWinAreaByWallType[1] + ExtWallWinAreaByWallType[2] + ExtWallWinAreaByWallType[3]  }
;		"Set Zone:ExtWallDoorArea"	Zone:ExtWallDoorArea	= {   SumChildren( ExtWall:TotDoorArea )  }
;	
;		"Set Garage:ExtWallAreaByWallType[1] - wood framed"		Garage:ExtWallAreaByWallType[1]     = {   SumChildren( ExtWall:AreaByWallType[1]    )  }
;		"Set Garage:ExtWallAreaByWallType[2] - steel framed"		Garage:ExtWallAreaByWallType[2]     = {   SumChildren( ExtWall:AreaByWallType[2]    )  }
;		"Set Garage:ExtWallAreaByWallType[3] - concrete/CMU"		Garage:ExtWallAreaByWallType[3]     = {   SumChildren( ExtWall:AreaByWallType[3]    )  }
;		"Set Garage:ExtWallAreaByWallType[4] - total"				Garage:ExtWallAreaByWallType[4]     = {   ExtWallAreaByWallType[1] + ExtWallAreaByWallType[2] + ExtWallAreaByWallType[3]  }
;	;	"Set Garage:ExtWallWinAreaByWallType[1] - wood framed"	Garage:ExtWallWinAreaByWallType[1]  = {   SumChildren( ;ExtWall:WinAreaByWallType[1] )  }
;	;	"Set Garage:ExtWallWinAreaByWallType[2] - steel framed"	Garage:ExtWallWinAreaByWallType[2]  = {   SumChildren( ;ExtWall:WinAreaByWallType[2] )  }
;	;	"Set Garage:ExtWallWinAreaByWallType[3] - concrete/CMU"	Garage:ExtWallWinAreaByWallType[3]  = {   SumChildren( ;ExtWall:WinAreaByWallType[3] )  }
;		"Set Garage:ExtWallDoorAreaByWallType[1] - wood framed"	Garage:ExtWallDoorAreaByWallType[1] = {   SumChildren( ExtWall:DoorAreaByWallType[1] )  }
;		"Set Garage:ExtWallDoorAreaByWallType[2] - steel framed"	Garage:ExtWallDoorAreaByWallType[2] = {   SumChildren( ExtWall:DoorAreaByWallType[2] )  }
;		"Set Garage:ExtWallDoorAreaByWallType[3] - concrete/CMU"	Garage:ExtWallDoorAreaByWallType[3] = {   SumChildren( ExtWall:DoorAreaByWallType[3] )  }
;		"Set Garage:ExtWallDoorAreaByWallType[4] - total"			Garage:ExtWallDoorAreaByWallType[4] = {   ExtWallDoorAreaByWallType[1] + ExtWallDoorAreaByWallType[2] + ExtWallDoorAreaByWallType[3]  }

	"Set Zone:ExtWallArea"				Zone:ExtWallArea				= {	SumChildren( ExtWall:Area )  }
	"Set Zone:UndWallArea"				Zone:UndWallArea				= {	SumChildren( UndWall:Area )  }
	"Set Zone:ClgBlwAtticArea"			Zone:ClgBlwAtticArea			= {	SumChildren( CeilingBelowAttic:Area )  }
	"Set Zone:CathCeilingArea"			Zone:CathCeilingArea			= {	SumChildren( CathedralCeiling:Area )  }
	"Set Zone:CondClgBlwAtticArea"	Zone:CondClgBlwAtticArea	= {	if (Type < 10) then  ClgBlwAtticArea  else  0  endif  }
	"Set Zone:SlabFloorArea"			Zone:SlabFloorArea			= {	SumChildren( SlabFloor:Area )  }
	"Set Zone:UndFloorArea"				Zone:UndFloorArea				= {	SumChildren( UndFloor:Area )  }
	"Set Zone:ExtFloorArea"				Zone:ExtFloorArea 			= {	SumChildren( ExteriorFloor:Area ) + SumChildren( FloorOverCrawl:Area )  }
;	"Set Zone:FlrOverGarageArea"		Zone:FlrOverGarageArea		= {	SumChildren( InteriorFloor:GarAdjCndZnArea )  }
	"Set Zone:AdjGarageWallArea"		Zone:AdjGarageWallArea		= {	SumChildren( IntWall:ParCndZnAdjGarArea)	}
	"Set Proj:BldgExtWallArea"			Proj:BldgExtWallArea			= {	SumAll( Zone:ExtWallArea     )  }
	"Set Proj:BldgClgBlwAtticArea"	Proj:BldgClgBlwAtticArea	= {	SumAll( Zone:ClgBlwAtticArea )  }
	"Set Proj:BldgCathCeilingArea"	Proj:BldgCathCeilingArea	= {	SumAll( Zone:CathCeilingArea )  }
	"Set Proj:BldgExtFloorArea"		Proj:BldgExtFloorArea		= {	SumAll( Zone:ExtFloorArea    )  }
;	"Set Proj:BldgSlabFloorArea"		Proj:BldgSlabFloorArea		= {	SumAll( Zone:SlabFloorArea   )  }
;	"Set Proj:CptSlabFloorArea"		Proj:CptSlabFloorArea		= {	SumAll( SlabFloor:CarpetedArea )  }
;	"Set Proj:ExpSlabFloorArea"		Proj:ExpSlabFloorArea		= {	SumAll( SlabFloor:ExposedArea  )  }
	"Set Proj:BldgUndWallArea"			Proj:BldgUndWallArea			= {	SumAll( Zone:UndWallArea     )  }

	"Set ExtWall:Azimuth"		ExtWall:Azimuth	= {	ExtWall:OrientationValue + Proj:FrontOrientation  }
	"Correct Azimuth for radial deg"			ExtWall:Azimuth	= {	if ( ExtWall:Azimuth >= 360 ) then ExtWall:Azimuth - 360
															else UNCHANGED endif  }
;	mjb-10/9/13	added azimuth calc for underfloor walls and cathedral ceilings
;	"Set UndWall:Azimuth"		UndWall:Azimuth	= {	UndWall:OrientationValue + Proj:FrontOrientation  }
;	"Correct Azimuth for radial deg"	UndWall:Azimuth	= {	if ( Azimuth >= 360 ) then Azimuth - 360
;										else UNCHANGED endif  }
	"Set CathedralCeiling:Azimuth"		CathedralCeiling:Azimuth	= {	CathedralCeiling:OrientationValue + Proj:FrontOrientation  }
	"Correct Azimuth for radial deg"	CathedralCeiling:Azimuth	= {	if ( Azimuth >= 360 ) then Azimuth - 360
												else UNCHANGED endif  }

;	mjb	2/19/14 added fenestration level Azimuth for CF1R reporting only
	"Set Win:Azimuth"		Win:Azimuth		=	{	Parent( Azimuth )	}
	"Set SkyLt:Azimuth"	Skylt:Azimuth	=	{	Parent( Azimuth )	}

;--------------------------------------------------------------------
; rules below this were picked out of HERS/Special features to perform misc model summarization
;--------------------------------------------------------------------

; SAC 9/10/13 - moved setting of Cons:AssignedCondZoneArea up here from below to define BEFORE first reference
;	mjb	8/21/14	- used ZoneArea/FloorAreaOverCond to keep track of surface areas only in conditioned zones
	"Sum Cons Surface Areas"			Cons:AssignedCondZoneArea = { switch ( CanAssignTo )
											case  0: SumRevRef( ExtWall:Construction, ExtWall:ZoneArea )
											case 20: SumRevRef( UndWall:Construction, UndWall:ZoneArea )
											case  1: SumRevRef( Attic:Construction, Attic:FloorAreaOverCond )
											case  2: SumRevRef( CathedralCeiling:Construction, CathedralCeiling:ZoneArea )
											case  3: SumRevRef( CeilingBelowAttic:Construction, CeilingBelowAttic:ZoneArea )
											case  6: SumRevRef( InteriorCeiling:Construction, InteriorCeiling:ZoneArea )
											case  4: SumRevRef( InteriorFloor:Construction, InteriorFloor:ZoneArea )
											case  5: SumRevRef( ExteriorFloor:Construction, ExteriorFloor:ZoneArea )
											case  9: SumRevRef( FloorOverCrawl:Construction, FloorOverCrawl:ZoneArea )
											default: 0
										     endswitch }
	"Sum Cons Demising Areas"			Cons:AssignedDemisingArea = { switch ( CanAssignTo )
											case  4: SumRevRef( InteriorFloor:Construction, InteriorFloor:DemisingArea )
											case 10: SumRevRef( IntWall:Construction, IntWall:DemisingArea )
											case  6: SumRevRef( InteriorCeiling:Construction, InteriorCeiling:DemisingArea )		; SAC 11/21/14
											default: 0
										     endswitch }

	"Set Proj:BldgSlabFloorArea"			Proj:BldgSlabFloorArea	= { SumAll( Zone:SlabFloorArea   )  }
	"Set Proj:BldgCondZnSlabFlrArea"		Proj:BldgCondZnSlabFlrArea	= { SumAcrossif( Zone:SlabFloorArea, Zone:Type < 10 )  }		; SAC 9/10/13
	"Set Proj:BldgCondZnUndFlrArea"		Proj:BldgCondZnUndFlrArea	= { SumAcrossif( Zone:UndFloorArea, Zone:Type < 10 )  }		; SAC 11/20/14 - 
	"Set Proj:CptSlabFloorArea"			Proj:CptSlabFloorArea	= { SumAll( SlabFloor:CarpetedArea )  }
; revise ExpSlabFloorArea to report only conditioned zone exposed slab area - SAC 9/10/13
;	"Set Proj:ExpSlabFloorArea"			Proj:ExpSlabFloorArea	= { SumAll( SlabFloor:ExposedArea  )  }
	"Set Proj:ExpSlabFloorArea"			Proj:ExpSlabFloorArea	= { SumAll( SlabFloor:CondZnExposedArea  )  }

	"Set Proj:CptUndFloorArea"			Proj:CptUndFloorArea			= {	SumAll( UndFloor:CarpetedArea )  }		; SAC 11/20/14 - 
	"Set Proj:ExpUndFloorArea"			Proj:ExpUndFloorArea			= {	SumAll( UndFloor:ExposedArea  )  }

	; SAC 6/21/16 - set SCSysRptDUCount[*] to ensure proper SCSysRpt:ReferenceCount setting (tic #688)
	"Set DwellUnitType:SCSysRptDUCount[1]"		DwellUnitType:SCSysRptDUCount[1]		= {	if (LocalStatus( SCSysRptCount[1] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[1], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[2]"		DwellUnitType:SCSysRptDUCount[2]		= {	if (LocalStatus( SCSysRptCount[2] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[2], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[3]"		DwellUnitType:SCSysRptDUCount[3]		= {	if (LocalStatus( SCSysRptCount[3] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[3], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[4]"		DwellUnitType:SCSysRptDUCount[4]		= {	if (LocalStatus( SCSysRptCount[4] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[4], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[5]"		DwellUnitType:SCSysRptDUCount[5]		= {	if (LocalStatus( SCSysRptCount[5] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[5], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[6]"		DwellUnitType:SCSysRptDUCount[6]		= {	if (LocalStatus( SCSysRptCount[6] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[6], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[7]"		DwellUnitType:SCSysRptDUCount[7]		= {	if (LocalStatus( SCSysRptCount[7] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[7], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[8]"		DwellUnitType:SCSysRptDUCount[8]		= {	if (LocalStatus( SCSysRptCount[8] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[8], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[9]"		DwellUnitType:SCSysRptDUCount[9]		= {	if (LocalStatus( SCSysRptCount[9] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[9], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
	"Set DwellUnitType:SCSysRptDUCount[10]"	DwellUnitType:SCSysRptDUCount[10]	= {	if (LocalStatus( SCSysRptCount[10] ) < 1) then  UNDEFINED
																													else    ValidOr( SCSysRptCount[10], 0 ) * ValidOr( NumAssigningDUs, 0 )  endif  }
;	; SAC 6/21/16 - set SCSysRptDUCount[*] to ensure proper SCSysRpt:ReferenceCount setting (tic #688)
;	"Setup HVAC equipment counts"		Proj:Action		= {	if (IsMultiFamily > 0.5)
;																			then	EvalRulelist( "Reporting_SummarizeModel_HVACEquip_MFam" )
;																			else	EvalRulelist( "Reporting_SummarizeModel_HVACEquip_SFam" )  endif  }
END

;; SAC 6/21/16 - set SCSysRptDUCount[*] to ensure proper SCSysRpt:ReferenceCount setting (tic #688)
;;*************************************************************************
;RULELIST  "Reporting_SummarizeModel_HVACEquip_SFam" 1 0 0 0
;;*************************************************************************
;	"Init HVACCool:ReferenceCount"		HVACCool:ReferenceCount		= {	0  }
;	"Init HVACHeat:ReferenceCount"		HVACHeat:ReferenceCount		= {	0  }
;	"Init HVACHtPump:ReferenceCount"		HVACHtPump:ReferenceCount	= {	0  }
;
;	"Incrament Zone:
;HVACHtPump:ReferenceCount,    NotInput,   0,    0,   0,    1,  1,  1
;HVACCool:ReferenceCount,    NotInput,   0,    0,   0,    1,  1,  1
;
;END
;
;;*************************************************************************
;RULELIST  "Reporting_SummarizeModel_HVACEquip_MFam" 1 0 0 0
;;*************************************************************************
;
;END


; SAC 10/22/14 - split out HERS/Special features rules out of 'Reporting_SummarizeModel' and into this new rulelist 'Reporting_HERS_SpecialFeaturesSummary'
;*************************************************************************
RULELIST  "Reporting_HERS_SpecialFeaturesSummary" 1 0 0 0
;*************************************************************************

;--------------------------------------------------------------------
; Create lists of Special Features and HERS Verification measures for reporting
;	mjb	2/20/14	populate HERSSummary array of messages
;--------------------------------------------------------------------
;
; some Project level HERS Verifications
;
	"Ensure Proj:HERSProj exists"		Proj:Action	= {	if (LocalCompAssigned( HERSProj )) then  UNCHANGED
												else  EvalRulelist( "CreateAndAssignAsUserDefined_Proj_HERSOther", 1 )  endif  }

	"Check for Exist. Conditions Verification" 	Proj:HERSProj:VerifyExistCond = { if ( ExistingCondVerif > 0.5 ) then 1 else 0 endif }
	"Populate Ex. Conditions Verification msg"	Proj:HERSProj:ExCondRptMsg = { if ( HERSProj:VerifyExistCond > 0.5 ) then 1 else 0 endif }

	"Check for QII" 				Proj:HERSProj:QII = { if ( Project:InsulConsQuality > 1.5 ) then 1 else 0 endif }
	"Populate QII msg"				Proj:HERSProj:QIIRptMsg = { if ( HERSProj:QII > 0.5 ) then 1 else 0 endif }

; SAC 9/4/13 - added logic to fix ACH50 defaulting bug (GC issue 169)
;	"Check for Low Bldg Leakage" 			Proj:HERSProj:LowBldgLkg = { if ( Project:ACH50 < 5.0 ) then 1 else 0 endif }
;  mjb   9/15/14  - no bldg leakage verifications for multi-family
;	"Check for Low Bldg Leakage" 			Proj:HERSProj:LowBldgLkg = { if ( ( Proj:IsMultiFamily > 0.5 .AND. Project:ACH50 < 7.0 ) .OR.
;																								 ( Proj:IsMultiFamily < 0.5 .AND. Project:ACH50 < 5.0 ) ) then 1 else 0 endif }

; mjb 1/30/15 - mod to lookup std. ACH50 from CAClimateZoneCodeBase
;	"Check for Low Bldg Leakage" 			Proj:HERSProj:LowBldgLkg = { if ( Proj:IsMultiFamily < 0.5 .AND. Project:ACH50 < 5.0 ) then 1 else 0 endif }
; SAC 4/15/15 - adjust for MFam duplex/townhomes options (based on Proj:IsMFamDupOrTownhm)
; SAC 5/3/16 - revised to check ACH50 vs. default that takes into account presence of VLLDCS (low-lkg ducts) (tic #627)
	"Check for Low Bldg Leakage" 			Proj:HERSProj:LowBldgLkg = { if ( (Proj:IsMultiFamily < 0.5 .OR. Proj:IsMFamDupOrTownhm > 0.5) .AND.
																								  Project:ACH50 < Proj:DefaultACH50 ) then 1 else 0 endif }
																						;		  Project:ACH50 < CAClimateZoneCodeBase:sfACH50( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase ) ) then 1 else 0 endif }
	"Write Low Bldg Leakage Msg" 			Proj:HERSProj:LowBldgLkgRptMsg = { if ( HERSProj:LowBldgLkg > 0.5 ) then FltToStr( Proj:CFM50, 1, 0, 3 ) else UNCHANGED endif }

;	mjb	 mod to always set HERS IAQ flag to 1	9/12/13
;	mjb	mode to conditionally set HERS IAQ flag	6/17/14
	; SAC 12/29/14 - mod to ensure IAQFanRptMsg & IAQFan are set for case where RunScope = 'Addition and/or Alteration' (2) & AdditionCFA >= 1000
	"Populate IAQ Fan msg"							Proj:HERSProj:IAQFanRptMsg = {  if ( Proj:RunScope == 1 ) then 
																											if ( IsAddAlone == 0 ) then 1 
																											else if ( AdditionCFA > 1000 ) then 1 else 0 endif endif
																										else if (RunScope == 2 .AND. IfValidAnd( AdditionCFA > 1000 )) then  1
																										else 0 endif endif   }
	"IAQ Fan - flag set same as msg" 		   Proj:HERSProj:IAQFan = {  if ( Proj:RunScope == 1 ) then 
																											if ( IsAddAlone == 0 ) then 1 
																											else if ( AdditionCFA > 1000 ) then 1 else 0 endif endif
																										else if (RunScope == 2 .AND. IfValidAnd( AdditionCFA > 1000 )) then  1
																										else 0 endif endif  	}	
	"Check for Centrally Integrated IAQ" 		Proj:HERSProj:CentralIAQ = { if (IfValidAnd( IsMultiFamily < 0.5 ) .AND. Project:UnitIAQOption[1] == 3 ) then 1 else 0 endif }

	"Populate Central IAQ msg"			Proj:HERSProj:CIAQRptMsg = { if (IfValidAnd( HERSProj:CentralIAQ > 0.5 )) then 1 else 0 endif }

	"Check for Fan Efficacy if CI-IAQ"		Proj:HERSFan:AHUFanEff = { if (IfValidAnd( HERSProj:CentralIAQ > 0.5 )) then 1 else 0 endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[1] > 0.5 )) then 1 else 0 endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[2] > 0.5 )) then 1 else UNCHANGED endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[3] > 0.5 )) then 1 else UNCHANGED endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[4] > 0.5 )) then 1 else UNCHANGED endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[5] > 0.5 )) then 1 else UNCHANGED endif }
;	"Check for Cool Vent System"			Proj:HERSProj:CoolVent = { if (IfValidAnd( UnitClVentNumFans[6] > 0.5 )) then 1 else UNCHANGED endif }
;	"Populate Cool Vent msg"			Proj:HERSProj:CoolVentRptMsg = { if (IfValidAnd( HERSProj:CoolVent > 0.5 )) then 1 else 0 endif }

	"Check for Zonal Cooling"			Proj:HERSProj:ZonalCoolSys = { if ( Maxall( HVACSys:CoolSystem:IsZonal ) > 0.5 ) then 1 else 0 endif }
	"Populate Zonal Cooling"			Proj:HERSProj:ZonalRptMsg = { if (IfValidAnd( HERSProj:ZonalCoolSys > 0.5 )) then 1 else 0 endif }
	; SAC 5/3/16 - added project-wide HERS ZonalSysBypassDuct (tic #634)
	"Check for Zonal systems w/ Bypass Ducts within Proj"		Proj:HERSProj:ZonalSysBypassDuct = { if ( MaxAll( HVACSys:ZonalSysBypassDuct ) > 0.5 ) then 1 else 0 endif }
	"Write Proj Zonal systems w/ Bypass Ducts msg" 				Proj:HERSProj:ZonalSysBypassDuctRptMsg = { if (MaxAll( HVACSys:ZonalSysBypassDuct ) > 0.5) then "Bypass duct conditions in zonal system(s)" else UNDEFINED endif }

	"Check for non-std Spray Foam Ins" 		Cons:RptNonStd = { if (IfValidAnd( AssignedCondZoneArea > 0.5 ) .AND. IfValidAnd( NonStdSprayFoam > 0.5 )) then 1 else 0 endif }
	"Check for High Spray Foam R-values"		Proj:HERSProj:SprayFoamHighR = { if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
	"Populate High Spray Foam msg"			Proj:HERSProj:SprayFoamRptMsg = { if (IfValidAnd( HERSProj:SprayFoamHighR > 0.5 )) then 1 else 0 endif }

;
; HVAC HERS Verification measures
;	mjb	mods needed to make work with HERSCool, HERSDist and HERSFan	9/1/13
;	mjb	add HERS flags to HVACHtPump objects	9/1/13
;  mjb	do not produce HVAC Cooling verification requirements when there is no cooling or no ducts	2/19/14
;	mjb	do not produce HVAC verification reqs. when equipment does not match what was modeled for Prop. Design	4/17/14
;
	"Ensure HVACCool:HERSCheck exists"			HVACCool:Action	= {	if (LocalCompAssigned( HERSCheck )) then  UNCHANGED
																							else if (FloorAreaServed > 0.5) then 
																										EvalRulelist( "CreateAndAssignAsUserDefined_HVACCool_HERSCool", 1 )
																									else UNCHANGED endif
																							endif  }
	"Ensure HVACHtPump:HERSCheck exists"		HVACHtPump:Action = {	if (LocalCompAssigned( HERSCheck )) then  UNCHANGED
																							else if (FloorAreaServed > 0.5) then 
																										EvalRulelist( "CreateAndAssignAsUserDefined_HVACHtPump_HERSCool", 1 )
																									else UNCHANGED endif
																							endif  }
	"Ensure HVACDist:HERSCheck exists"			HVACDist:Action	= {	if (LocalCompAssigned( HERSCheck )) then  UNCHANGED
																							else if (FloorAreaServed > 0.5) then 
																										EvalRulelist( "CreateAndAssignAsUserDefined_HVACDist_HERSDist", 1 )
																									else UNCHANGED endif
																							endif  }
	; SAC 12/22/14 - revised logic to reference new HVACFan:ClFlrAreaServed property instead of FloorAreaServed since this flag only pertains to Fans for Cooling (GC issue 450)
	"Ensure HVACFan:HERSCheck exists"			HVACFan:Action	= {	if (LocalCompAssigned( HERSCheck )) then  UNCHANGED
																						else if (IfValidAnd( ClFlrAreaServed > 0.5 )) then 
																									EvalRulelist( "CreateAndAssignAsUserDefined_HVACFan_HERSFan", 1 )
																								else UNCHANGED endif
																						endif  }
;	"debug"		HVACSys:Action	= {	MessageBox( "reporting -- HVACFan '%s':  Fan:TypeRpt = %g", Name, Fan:TypeRpt )  }
; mjb	6/2/14	- add checks for No Cooling within HERSCool parameter assignments
;	mjb	7/17/14	modify Fan watt check to set flag only for ducted systems, and set flag regardless of No Cooling system selection
;	mjb	10/30/14	- mods to make all reporting rules work without special reporting parameters that are no longer needed because of improved project model reporting
;	"Check for Watts per CFM" 						HVACFan:HERSCheck:AHUFanEff = { if ( FloorAreaServed > 0.5 .AND. MaxRevRef( HVACSys:Fan, HVACSys:NoCoolingRpt ) < 0.5 .AND. IfValidAnd(TypeRpt > 0.5) .AND. Status != 1 ) then 1 else 0 endif }
;	"Check for Watts per CFM" 						HVACFan:HERSCheck:AHUFanEff = { if ( FloorAreaServed > 0.5 .AND. MaxRevRef( HVACSys:Fan, HVACSys:CoolDuctedRpt ) > 0.5 .AND. Status != 1 ) then 1 else 0 endif }
;	"Check for Watts per CFM" 						HVACFan:HERSCheck:AHUFanEff = { if ( FloorAreaServed > 0.5 .AND. Status != 1 ) then 1 else 0 endif }
; SAC 8/28/16 - revised again to ensure flag NOT set for Altered systems where WperCFMCool >= Mandatory Level (0.58 for 2013-16) (tic #728)
   "Check for Watts per CFM"                 HVACFan:HERSCheck:AHUFanEff = {
      if ( FloorAreaServed < 0.5 .OR. Status = 1 ) then  0
      else if (Status = 2 .AND. IfValidAnd( WperCFMCool >= 0.58 ))
;          CAClimateZoneCodeBase:WperCFM( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase )))
      then  0
      else  1  endif endif  }
	"Write Watts per CFM Msg" 						HVACFan:HERSCheck:FanEffRptMsg = { if ( HERSCheck:AHUFanEff > 0.5 ) then FltToStr( WperCFMCool, 2, 0, 4 ) else UNDEFINED endif }

;	mjb	7/17/14	modify HVACCool airflow check to set flag only for ducted systems, and set flag regardless of No Cooling system selection
;	"Check for CFM per Ton" 						HVACCool:HERSCheck:AHUAirFlow = { 	if ( FloorAreaServed > 0.5 .AND. TypeRpt > 1 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) ) then
;																												if ( Type > 1 .AND. Type < 16 ) then 1 else 0 endif 
;																										  	else 0 endif }
;	"Check for CFM per Ton" 						HVACCool:HERSCheck:AHUAirFlow = { 	if ( FloorAreaServed > 0.5 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) .AND. MaxRevRef( HVACSys:CoolSystem, HVACSys:CoolDuctedRpt ) > 0.5 .AND. MaxRevRef( HVACSys:CoolSystem, HVACSys:Status ) > 1.5 )
;																												then 1 else 0 endif	}
; SAC 11/20/14 - modified logic to prevent setting of airflow flag for system types NoCooling & RoomAirCond (per DAR request to fix problem w/ EnergyPro runs which come through w/ CFMperTon even for NoCooling systems)
; SAC 4/23/15 - added check to ensure that CoolDuctedRpt is set for at least one system that references this equipment
; SAC 8/28/16 - added check to prevent setting HERS air flow for Altered systems where CFMperTon <= 
   "Check for CFM per Ton"                   HVACCool:HERSCheck:AHUAirFlow = {
      if (FloorAreaServed > 0.5 .AND. Type != 1 .AND. Type != 5 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) .AND.
          MaxRevRef( HVACSys:CoolSystem, HVACSys:StatusArray ) > 1.5 .AND.
          MaxRevRef( HVACSys:CoolSystem, HVACSys:CoolDuctedRpt ) > 0.5 )
      then  if (IsAltered > 0 .AND. IsNew < 1 .AND. IsExisting < 1 .AND. IfValidAnd( CFMperTon <= 350 ))
;                CAClimateZoneCodeBase:CFMperTon( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase ))
            then  0
            else  1  endif
      else  0  endif   }
   "Write CFM per Ton Msg"                   HVACCool:HERSCheck:AirFlowRptMsg = { if ( HERSCheck:AHUAirFlow > 0.5 ) then FltToStr( CFMperTon, 0, 0, 1 ) else UNDEFINED endif }

  ; SAC 12/6/13 - fix for GC issue #242 - lookup table error when retrieving SEER & EER for certain system types
;	"Check for SEER above Std" 				HVACCool:HERSCheck:SEER = { 	if ( FloorAreaServed  > 0.5 .AND. CA13CoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND. IfValidAnd(IsClSysSEER > 0.5) .AND. TypeRpt > 1 ) then
;																									if (SEER > CA13CoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr   ) ) then 1 else 0 endif
;																						 		else  0  endif  }
; SAC 4/23/15 - added logic to NOT flag SEER in HERSCheck is this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
	"Check for SEER above Std" 				HVACCool:HERSCheck:SEER = { 	if ( FloorAreaServed  > 0.5 .AND. CA13CoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND.
																									  IfValidAnd(IsClSysSEER > 0.5) .AND. CA13CoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (SEER > ( CA13CoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
																						 		else  0  endif  }
	"Write SEER above Std Msg" 				HVACCool:HERSCheck:SEERRptMsg = { if ( HERSCheck:SEER > 0.5 ) then FltToStr( SEER, 1, 0, 4 ) else UNDEFINED endif }
;	mjb	4/14/14	do not set HERS flag if EER is not user-defined
;	mjb	8/1/14	added new flag UseEERinAnalysis, and checking it here
;	"debug"		HVACCool:Action	= {	if (FloorAreaServed > 0.5) then PostWarning( "reporting -- HVACCool '%s':  TypeRpt = %g  IsClSysEER = %g  EER Status = %g", Name, TypeRpt, IsClSysEER, LocalStatus(EER) ) else UNCHANGED endif  }
;	"Check for EER above Std" 					HVACCool:HERSCheck:EER = {  	if ( FloorAreaServed > 0.5 .AND. CA13CoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND. UseEERinAnalysis > 0.5 .AND. IfValidAnd(IsClSysEER > 0.5) .AND. TypeRpt > 1 ) then
;																									if (EER > CA13CoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr   ) ) then 1 else 0 endif
;																					 			else  0  endif  }
; SAC 4/23/15 - added logic to NOT flag EER in HERSCheck is this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
	"Check for EER above Std" 					HVACCool:HERSCheck:EER = {  	if ( FloorAreaServed > 0.5 .AND. CA13CoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND. IfValidAnd(UseEERinAnalysis > 0.5 ) .AND.
																									  IfValidAnd(IsClSysEER > 0.5) .AND. CA13CoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (EER > ( CA13CoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
																					 			else  0  endif  }
	"Write EER above Std Msg" 					HVACCool:HERSCheck:EERRptMsg = { if ( HERSCheck:EER > 0.5 ) then FltToStr( EER, 1, 0, 4 ) else UNDEFINED endif }

;	"Check for AC Charge"						HVACCool:HERSCheck:ACCharg = { if ( FloorAreaServed > 0.5 .AND. TypeRpt > 1 .AND. ACCharge > 1.5 ) then 1 else 0 endif }
; SAC 4/23/15 - added logic to NOT flag Refrig Charge in HERSCheck is this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
; SAC 5/4/15 - removed check of CA13CoolingEquipment:PropEqStd() as that no longer effects whether the system requires refrigerant charge reporting (issue 502)
	"Check for AC Charge"						HVACCool:HERSCheck:ACCharg = { if ( FloorAreaServed > 0.5 .AND. ACCharge > 1.5 ) then 1 else 0 endif }
																						;				.AND. CA13CoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then 1 else 0 endif }
	"Write AC Charge Msg" 			   		HVACCool:HERSCheck:ACChargRptMsg = { if ( HERSCheck:ACCharg > 0.5 ) then ACCharge else 0 endif }
 
;	mjb	7/17/14	modify HVACHtPump airflow check to set flag only for ducted systems, and set flag regardless of No Cooling system selection
;	"HtPump - Check for CFM per Ton" 		HVACHtPump:HERSCheck:AHUAirFlow = { if ( FloorAreaServed > 0.5 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) ) then
;																											if ( Type > 1 .AND. Type < 16 ) then 1 else 0 endif 
;											     														else 0 endif }
;	"Check for CFM per Ton" 					HVACHtPump:HERSCheck:AHUAirFlow = { 	if ( FloorAreaServed > 0.5 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:CoolDuctedRpt ) > 0.5 .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:Status ) > 1.5 )
;																												then 1 else 0 endif	}
;	mjb	11/5/14	modify HtPump HERS rules so that ALL HtPump performance info is reported  issue #377
;	"Check for CFM per Ton" 					HVACHtPump:HERSCheck:AHUAirFlow = { 	if ( FloorAreaServed > 0.5 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:Status ) > 1.5 )
;																												then 1 else 0 endif	}
; SAC 4/21/15 - added check for IsClSysCFMperTon > 0.5 before setting AHUAirFlow
; SAC 4/23/15 - added check to ensure that CoolDuctedRpt is set for at least one system that references this equipment
	"Check for CFM per Ton" 					HVACHtPump:HERSCheck:AHUAirFlow = { 	if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed ) > 0.5 .AND. IfValidAnd(IsClSysCFMperTon > 0.5) .AND.
																												  MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:CoolDuctedRpt ) > 0.5 )
																												then 1 else 0 endif	}
	"HtPump - Write CFM per Ton Msg" 		HVACHtPump:HERSCheck:AirFlowRptMsg = { if (IfValidAnd( HERSCheck:AHUAirFlow > 0.5 )) then FltToStr( CFMperTon, 0, 0, 1 ) else UNDEFINED endif }

;	"HtPump - Check for SEER above Std" 	HVACHtPump:HERSCheck:SEER = { if ( FloorAreaServed  > 0.5 .AND. CA13CoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND. IfValidAnd(IsClSysSEER > 0.5) .AND. IfValidAnd(SEER > 0) ) then
;																									if (SEER > CA13CoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr   ) ) then 1 else 0 endif
;											 													else  0  endif  }
; SAC 4/23/15 - added logic to NOT flag SEER in HERSCheck is this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
	"HtPump - Check for SEER above Std" 	HVACHtPump:HERSCheck:SEER = { if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed )  > 0.5 .AND. CA13CoolingEquipment:SEERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND.
																									  IfValidAnd(SEER > 0) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND.
																									  CA13CoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (SEER > ( CA13CoolingEquipment:SEER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
											 													else  0  endif  }
	"HtPump - Write SEER above Std Msg" 	HVACHtPump:HERSCheck:SEERRptMsg = { if (IfValidAnd( HERSCheck:SEER > 0.5 )) then FltToStr( SEER, 1, 0, 4 ) else UNDEFINED endif }

;	"HtPump - Check for EER above Std" 		HVACHtPump:HERSCheck:EER = {  if ( FloorAreaServed > 0.5 .AND. CA13CoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) .AND. LocalStatus(EER) < 7 .AND. IfValidAnd(IsClSysEER > 0.5) .AND. IfValidAnd(EER > 0) ) then
;																									if (EER > CA13CoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr   ) ) then 1 else 0 endif
;											 													else  0  endif  }
; SAC 4/23/15 - added logic to NOT flag EER in HERSCheck is this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
	"HtPump - Check for EER above Std" 		HVACHtPump:HERSCheck:EER = {  if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed ) > 0.5 .AND. CA13CoolingEquipment:EERValid( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr )  .AND. 
																									  UseEERinAnalysis > 0.5 .AND. IfValidAnd(EER > 0) .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND.
																									  CA13CoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then
																									if (EER > ( CA13CoolingEquipment:EER( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) + 0.005 ) ) then 1 else 0 endif
											 													else  0  endif  }
	"HtPump - Write EER above Std Msg" 		HVACHtPump:HERSCheck:EERRptMsg = { if (IfValidAnd( HERSCheck:EER > 0.5 )) then FltToStr( EER, 1, 0, 4 ) else UNDEFINED endif }

; SAC 4/23/15 - added logic to NOT flag Refrig Charge in HERSCheck is this equipment is not modeled as the user entered it (look-up table PropEqStd = 1)
; SAC 5/4/15 - replaced check of CA13CoolingEquipment:PropEqStd() w/ simple check for GSHP system type, since that is the only system type that refrigerant charge reporting is disabled for (issue 502)
	"HtPump - Check for AC Charge"			HVACHtPump:HERSCheck:ACCharg = { if ( MaxRevRef( HVACSys:HtPumpSystem, HVACSys:HtPmpFlrAreaServed ) > 0 .AND. ACCharge > 1.5 .AND. MaxRevRef( HVACSys:HtPumpSystem, HVACSys:StatusArray ) > 1.5 .AND.
																							;			  CA13CoolingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", Proj:StandardsVersion, "SysType", TypeAbbrevStr ) < 0.5 ) then 1 else 0 endif }
																										  Type != 12 ) then 1 else 0 endif }
	"HtPump - Write AC Charge Msg" 			HVACHtPump:HERSCheck:ACChargRptMsg = { if (IfValidAnd( HERSCheck:ACCharg > 0.5 )) then ACCharge else 0 endif }

; mjb 7/9/14 - avoid setting HERS report flag for existing ducts
;	mjb	7/29/14 - use IsLessThanForty flag to keep short additions of ducts from triggering HERS check; also make sure to include Status = 4 (existing + new)
	"Check for Duct Leakage"					HVACDist:HERSCheck:DuctLeakage = { if ( FloorAreaServed  > 0.5 .AND. ( IsNew .OR. IsAltered .OR. Status == 4) ) then
																											if ( Type == 8 .OR. IfValidAnd(IsLessThanFortyFt > 0.5) ) then 0 else 1 endif 
											      										  			else 0 endif  }
;	mjb	7/17/14 - need to set duct leakage flag even if NoCooling; using DuctsCreatedForAnalysis instead of TypeRpt
;	"2nd Check for Duct Leakage"				HVACDist:HERSCheck:DuctLeakage = { if ( MaxRevRef( HVACSys:DistribSystem, HVACSys:NoCoolingRpt ) > 0.5 .OR. IfValidAnd(TypeRpt < 0.5) ) then 0 else UNCHANGED endif  }
;	"2nd Check for Duct Leakage"				HVACDist:HERSCheck:DuctLeakage = { if ( IfValidAnd(DuctsCreatedForAnalysis > 0.5) ) then 0 else UNCHANGED endif  }

;	mjb	mod to account for default duct leakage value	9/10/13
;	mjb	fixed reporting of duct leakage	9/23/13
;	mjb-10/10/13	REALLY fixed reporting of duct leakage
; mjb-10/21/13 REALLY REALLY fixed reporting of duct leakage
; SAC 4/15/15 - adjust for MFam duplex/townhomes options
; SAC 5/9/16 - revised rule to reference DuctLeakageValRpt (sensitive to code vintage) in place of a static '6.0' value
; SAC 6/28/16 - added logic to set DuctLkgRptMsg to "See RA3.1.4.3.8" for HVACDist:Type = LowLlCod... (=12) (tic #627)
	"Write Duct Leakage Msg" 						HVACDist:HERSCheck:DuctLkgRptMsg = { if ( HERSCheck:DuctLeakage > 0.5 ) then 
																											   if (Type == 12)
																											   then  "See RA3.1.4.3.8"
																												else if ( DefaultSystem > 0.5 .OR. LowLkgAH < 0.5 ) then 
																													if ( Proj:IsMultiFamily > 0.5 .AND. Proj:IsMFamDupOrTownhm < 0.5 )
																													then	Format( "total leakage <= 12.0 or leakage to outdoors <= %s", FltToStr( DuctLeakageValRpt, 1, 0, 3 ) )
																													else	Format( "%s", FltToStr( DuctLeakageValRpt, 1, 0, 3 ) )  endif
																												else if ( LowLkgAH > 0.5 .AND. DuctLeakage > 100 ) then 
																													if ( Proj:IsMultiFamily > 0.5 .AND. Proj:IsMFamDupOrTownhm < 0.5 )
																													then	Format( "total leakage <= 12.0 or leakage to outdoors <= %s", FltToStr( DuctLeakageValRpt, 1, 0, 3 ) )
																													else	Format( "%s", FltToStr( DuctLeakageValRpt, 1, 0, 3 ) )  endif	
																												else FltToStr( DuctLeakageValRpt, 1, 0, 3 ) endif endif endif												
																											 else UNDEFINED endif }
;	mjb	8/1/14	- reset HVACDist:DuctLeakage enumeration for CF1R reporting of Existing Ducts
	"Reset DuctLeakage enumeration if Existing"		HVACDist:Action	= {	if ( FloorAreaServed  > 0 .AND. (Status == 1 .OR. (Status == 4 .AND. IfValidAnd(IsLessThanFortyFt > 0.5))) ) then EvalRulelist( "Force_Existing_HVACDist_DuctLeakage", 1 ) else UNCHANGED endif	}
;	mjb	8/5/14	- added check for proposed duct location before setting HERS flag
;  mjb   9/10/14  - changed > to < for proper checking of DuctsCreatedForAnalysis flag
; SAC 12/31/15 - added logic to prevent flagging HERS DuctLocation for Existing ducts (tic 498)
; SAC 1/4/16 - added more logic to prevent HERS DuctLocation flag for Existing+New status where IsLessThanFortyFt is checked (tic 498)
	"Check for HERS Req'd Duct Location"		HVACDist:HERSCheck:DuctLocation = { if ( FloorAreaServed  > 0 .AND. IfValidAnd(DuctsCreatedForAnalysis < 0.5) .AND.
																												  (IsNew .OR. IsAltered .OR. (Status == 4 .AND. IfValidAnd( IsLessThanFortyFt > 0 )==0)) ) then
																												if ( Type == 6 .OR. Type == 7 .OR. Type == 12 ) then 1 else 0 endif
											      														else 0 endif  }
	"Write Duct Location Msg" 						HVACDist:HERSCheck:DuctLocRptMsg = { if ( HERSCheck:DuctLocation > 0.5 ) then Type else UNDEFINED endif }

	"Check for Return Duct Design"				HVACDist:HERSCheck:RetDuctDesign = { if ( FloorAreaServed  > 0.5 ) then
																												if (IfValidAnd( DuctDesign > 0.5 )) then 1 else 0 endif
											      													 	 else 0 endif  }
	"Write Return Duct Surface Area" 			HVACDist:HERSCheck:RetDuctRptMsg = { if (IfValidAnd( HERSCheck:RetDuctDesign > 0.5 )) then FltToStr( ReturnDuctArea, 0, 0, 1 ) else UNDEFINED endif }

	"Check for Supply Duct Design"				HVACDist:HERSCheck:SupDuctDesign = { if ( FloorAreaServed  > 0.5 ) then
																												if (IfValidAnd( DuctDesign > 0.5 )) then 1 else 0 endif
											      													 	 else 0 endif  }
	"Write Supply Duct Surface Area" 			HVACDist:HERSCheck:SupDuctRptMsg = { if (IfValidAnd( HERSCheck:SupDuctDesign > 0.5 )) then FltToStr( SupplyDuctArea, 0, 0, 1 ) else UNDEFINED endif }

	"Check for Buried Ducts"						HVACDist:HERSCheck:BuriedDucts = { 	if ( FloorAreaServed  > 0.5 ) then
																												if (IfValidAnd( AreBuried > 0.5 )) then 1 else 0 endif
											      													 	else 0 endif  }
; SAC 5/3/16 - restored *BuriedDuctsRptMsg (tic #634)
	"Write Buried Ducts msg" 						HVACDist:HERSCheck:BuriedDuctsRptMsg = { if (IfValidAnd( HERSCheck:BuriedDucts > 0.5 )) then "Buried Ducts" else UNDEFINED endif }

	"Check for Deeply Buried Ducts"				HVACDist:HERSCheck:DeeplyBuriedDucts = { 	if ( FloorAreaServed  > 0.5 ) then
																														if (IfValidAnd( AreDeeplyBuried > 0.5 )) then 1 else 0 endif
											      													 			else 0 endif  }
	"Write Deeply Buried Ducts msg" 				HVACDist:HERSCheck:DeeplyBuriedDuctsRptMsg = { if (IfValidAnd( HERSCheck:DeeplyBuriedDucts > 0.5 )) then "Deeply Buried Ducts" else UNDEFINED endif }

;mjb still figuring these out:
;	"Check for Air Filter Design"			HVACDist:HERSCheck:AirFilterDesign = {  }
;AirFltrRptMsg
;
; Project level HERS HVAC Verifications
;
;	mjb	mods to move from HERSHVACSys to HERSCool and HERSDist	9/1/13
;	mjb	add Proj checks for HtPumps	9/1/13

	"Ensure Proj:HERSCool exists"			Proj:HERSCool	= {	if (LocalCompAssigned( HERSCool )) then  UNCHANGED
																				else  CreateComp( HERSCool, Local( Name ) + "-hers-cool-proj" )  endif  }
	"Ensure Proj:HERSDist exists"			Proj:Action	= {	if (LocalCompAssigned( HERSDist )) then  UNCHANGED
																			else  EvalRulelist( "CreateAndAssignAsUserDefined_Proj_HERSDist", 1 )  endif  }
	"Ensure Proj:HERSFan exists"			Proj:Action	= {	if (LocalCompAssigned( HERSFan )) then  UNCHANGED
																			else  EvalRulelist( "CreateAndAssignAsUserDefined_Proj_HERSFan", 1 )  endif  }
	"Check for SEER above Std within Proj" 			Proj:HERSCool:SEER = { if ( MaxAll( HVACCool:HERSCheck:SEER ) > 0.5  ) then 1 else 0 endif }
	"Check for HtPump SEER above Std within Proj" 	Proj:HERSCool:SEER = { if ( MaxAll( HVACHtPump:HERSCheck:SEER ) > 0.5  ) then 1 else UNCHANGED endif }
	"Check for EER above Std within Proj" 				Proj:HERSCool:EER = { if ( MaxAll( HVACCool:HERSCheck:EER ) > 0.5   ) then 1 else 0 endif }
	"Check for HtPump EER above Std within Proj" 	Proj:HERSCool:EER = { if ( MaxAll( HVACHtPump:HERSCheck:EER ) > 0.5   ) then 1 else UNCHANGED endif }
	"Check for Duct Leakage within Proj"				Proj:HERSDist:DuctLeakage = { if ( MaxAll( HVACDist:HERSCheck:DuctLeakage ) > 0.5   ) then 1 else 0 endif }
	"Check for HERS Duct Types within Proj"			Proj:HERSDist:DuctLocation = { if ( MaxAll( HVACDist:HERSCheck:DuctLocation ) > 0.5 ) then 1 else 0 endif }
	"Check for AC Charge within Proj"					Proj:HERSCool:ACCharg = { if ( MaxAll( HVACCool:HERSCheck:ACCharg ) > 0.5 ) then 1 else 0 endif }
	"Check for HtPump AC Charge within Proj"			Proj:HERSCool:ACCharg = { if ( MaxAll( HVACHtPump:HERSCheck:ACCharg ) > 0.5 ) then 1 else UNCHANGED endif }
	"Check for AirFlow within Proj"						Proj:HERSCool:AHUAirFlow = { if ( MaxAll( HVACCool:HERSCheck:AHUAirFlow ) > 0.5 ) then 1 else 0 endif }
	"Check for HtPump AC Charge within Proj"			Proj:HERSCool:AHUAirFlow = { if ( MaxAll( HVACHtPump:HERSCheck:AHUAirFlow ) > 0.5 ) then 1 else UNCHANGED endif }
	"Check for Return Duct Design within Proj"		Proj:HERSDist:RetDuctDesign = { if ( MaxAll( HVACDist:HERSCheck:RetDuctDesign ) > 0.5 ) then 1 else 0 endif }
	"Check for Supply Duct Design within Proj"		Proj:HERSDist:SupDuctDesign = { if ( MaxAll( HVACDist:HERSCheck:SupDuctDesign ) > 0.5 ) then 1 else 0 endif }
	"Check for Fan W/cfm within Proj"					Proj:HERSFan:AHUFanEff = { if ( MaxAll( HVACFan:HERSCheck:AHUFanEff ) > 0.5   ) then 1 else 0 endif }
;	"Check for Air Filter Design within Proj"			Proj:HERSDist:AirFilterDesign = { if ( MaxAll( HVACDist:HERSCheck:AirFilterDesign ) > 0.5 ) then 1 else 0 endif }
	; SAC 5/3/16 - added project-wide HERS *BuriedDucts (tic #634)
	"Check for Buried Ducts within Proj"				Proj:HERSDist:BuriedDucts = { if ( MaxAll( HVACDist:HERSCheck:BuriedDucts ) > 0.5 ) then 1 else 0 endif }
	"Check for Deeply Buried Ducts within Proj"		Proj:HERSDist:DeeplyBuriedDucts = { if ( MaxAll( HVACDist:HERSCheck:DeeplyBuriedDucts ) > 0.5 ) then 1 else 0 endif }
	"Write Proj Buried Ducts msg" 						Proj:HERSDist:BuriedDuctsRptMsg = { if (MaxAll( HVACDist:HERSCheck:BuriedDucts ) > 0.5) then "Buried Ducts" else UNDEFINED endif }
	"Write Proj Deeply Buried Ducts msg" 				Proj:HERSDist:DeeplyBuriedDuctsRptMsg = { if (MaxAll( HVACDist:HERSCheck:DeeplyBuriedDucts ) > 0.5) then "Deeply Buried Ducts" else UNDEFINED endif }

; DHW HERS Verification measures
;  mjb   7/9/14 do not generate HERS reporting for existing DHW systems
;
	"Ensure DHWSys:HERSCheck exists"				DHWSys:Action	= {	if (LocalCompAssigned( HERSCheck )) then  UNCHANGED
																						else  EvalRulelist( "CreateAndAssignAsUserDefined_DHWSys_HERSDHWSys", 1 )  endif  }
	"Check for Compact Distribution"				DHWSys:HERSCheck:Compact = { if ( DHWSys:SystemType == 8394496 .AND. DHWSys:CentralDHW < 0.5 .AND. Status != 1 ) then 1 else 0 endif }
	"Write Compact Dist Msg" 						DHWSys:HERSCheck:CompactRptMsg = { if ( HERSCheck:Compact > 0.5 ) then DHWSys:SystemType else UNDEFINED endif }

;       08/25/16 - CG Updated based on changes to address (tic #707)
; SAC 8/28/16 - effectively removed HERS MFCtrlRecircDualLp flag (tic #670)
	"Check for Multi-family Central Recirculating Dual Loop Design"	
   DHWSys:HERSCheck:MFCtrlRecircDualLp = { 0 }
;    if ( Status != 1 .AND. 
;         DHWSys:CentralDHW > 0.5 .AND. 
;         IfValidAnd( NRecircLoops > 1 ) .AND. 
;         DHWSys:MFamDistType == 5051 ) ; Corect dual loop HERS check 
;    then 1 
;    else 0 
;    endif }

;       08/25/16 - CG Updated based on changes to address (tic #707)    
	"Write Multi-family Central Recirculating Dual Loop Design Msg" 	
   DHWSys:HERSCheck:MFCtrlRecircDualLpRptMsg = { 
    if ( HERSCheck:MFCtrlRecircDualLp > 0.5 ) 
    then DHWSys:MFamDistType ; Correct dual loop HERS message output
    else UNDEFINED 
    endif }

	"Check for Parallel Piping"					DHWSys:HERSCheck:ParallelPipe = { if ( DHWSys:SystemType == 8393216 .AND. DHWSys:CentralDHW < 0.5 .AND. Status != 1 ) then 1 else 0 endif }
	"Write Parallel Piping Msg" 						DHWSys:HERSCheck:ParaPipeRptMsg = { if ( HERSCheck:ParallelPipe > 0.5 ) then DHWSys:SystemType else UNDEFINED endif }
	"Check for All Pipes Insulated"					DHWSys:HERSCheck:AllPipesIns = { if ( DHWSys:SystemType == 8392704 .AND. Status != 1 ) then 1 else 0 endif }
	"Write AllPipesIns Msg" 						DHWSys:HERSCheck:PipeInsRptMsg = { if ( HERSCheck:AllPipesIns > 0.5 ) then DHWSys:SystemType else UNDEFINED endif }
	"Check for Point of Use"					DHWSys:HERSCheck:PointOfUse = { if ( DHWSys:SystemType == 8394240 .AND. DHWSys:CentralDHW < 0.5 .AND. Status != 1 ) then 1 else 0 endif }
	"Write Point of Use Msg" 						DHWSys:HERSCheck:POURptMsg = { if ( HERSCheck:PointOfUse > 0.5 ) then DHWSys:SystemType else UNDEFINED endif }
	"Check for Recirc, Occupancy DC"				DHWSys:HERSCheck:OccRecirc = { if ( DHWSys:SystemType == 8394112 .AND. DHWSys:CentralDHW < 0.5 .AND. Status != 1 ) then 1 else 0 endif }
	"Write Recirc, Occ Msg" 						DHWSys:HERSCheck:OccRptMsg = { if ( HERSCheck:OccRecirc > 0.5 ) then DHWSys:SystemType else UNDEFINED endif }
	"Check for Recirc, Push Button DC"				DHWSys:HERSCheck:PushBtnRecirc = { if ( DHWSys:SystemType == 8393856 .AND. DHWSys:CentralDHW < 0.5 .AND. Status != 1 ) then 1 else 0 endif }
	"Write Recirc, Push Button Msg" 					DHWSys:HERSCheck:PushBtnRptMsg = { if ( HERSCheck:PushBtnRecirc > 0.5 ) then DHWSys:SystemType else UNDEFINED endif }
;	"Check for Ins and Protected Below Grade"			DHWSys:HERSCheck:BelowGrade = { if ( DHWSys:SystemType == 8392960 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write Below Grade Msg" 						DHWSys:HERSCheck:BelowGradeRptMsg = { if ( HERSCheck:BelowGrade > 0.5 ) then DHWSys:SystemType else UNDEFINED endif }
;	"Check for MF Recirc, No Control"				DHWSys:HERSCheck:MFNoControl = { if ( DHWSys:MFamDistType == 8393664 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, NC Msg" 						DHWSys:HERSCheck:MFNoCtrlRptMsg = { if ( HERSCheck:MFNoControl > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Demand Control"				DHWSys:HERSCheck:MFDemandControl = { if ( DHWSys:MFamDistType == 8394944 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, DC Msg" 						DHWSys:HERSCheck:MFDCRptMsg = { if ( HERSCheck:MFDemandControl > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Temp Modulation"				DHWSys:HERSCheck:MFTempMod = { if ( DHWSys:MFamDistType == 8395200 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, Temp Mod Msg" 					DHWSys:HERSCheck:MFTmpModRptMsg = { if ( HERSCheck:MFTempMod > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Temp Mod & Monitor"			DHWSys:HERSCheck:MFTempModMon = { if ( DHWSys:MFamDistType == 8395456 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, Temp, Mod, Mon Msg" 					DHWSys:HERSCheck:MFTmpModMonRptMsg = { if ( HERSCheck:MFTempModMon > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
; SAC 11/10/15 - replace above w/ below to account for MFamDistType options which no longer include HERSVerif options
; SDS 07/28/16 - Below are MFamDistType options thats do not require HERSVerif and have been commented out
;	"Check for MF Recirc, No Control"				DHWSys:HERSCheck:MFNoControl 			= { if ( DHWSys:MFamDistType == 5056 .AND. IfValidAnd( NRecircLoops > 1 ) .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, NC Msg" 						DHWSys:HERSCheck:MFNoCtrlRptMsg 		= { if ( HERSCheck:MFNoControl > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Demand Control"				DHWSys:HERSCheck:MFDemandControl 	= { if ( DHWSys:MFamDistType == 6336 .AND. IfValidAnd( NRecircLoops > 1 ) .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, DC Msg" 						DHWSys:HERSCheck:MFDCRptMsg 			= { if ( HERSCheck:MFDemandControl > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Temp Modulation"				DHWSys:HERSCheck:MFTempMod 			= { if ( DHWSys:MFamDistType == 6592 .AND. IfValidAnd( NRecircLoops > 1 ) .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, Temp Mod Msg" 					DHWSys:HERSCheck:MFTmpModRptMsg 		= { if ( HERSCheck:MFTempMod > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }
;	"Check for MF Recirc, Temp Mod & Monitor"			DHWSys:HERSCheck:MFTempModMon 		= { if ( DHWSys:MFamDistType == 6848 .AND. IfValidAnd( NRecircLoops > 1 ) .AND. Status != 1 ) then 1 else 0 endif }
;	"Write MF Recirc, Temp, Mod, Mon Msg" 					DHWSys:HERSCheck:MFTmpModMonRptMsg	= { if ( HERSCheck:MFTempModMon > 0.5 ) then DHWSys:MFamDistType else UNDEFINED endif }

; Project level HERS DHW Verifications
;
	"Ensure Proj:HERSDHW exists"					Proj:Action	= {	if (LocalCompAssigned( HERSDHW )) then  UNCHANGED
																					else  EvalRulelist( "CreateAndAssignAsUserDefined_Proj_HERSDHWSys", 1 )  endif  }
	"Check for Compact Distribution"				Proj:HERSDHW:Compact = { if ( MaxAll( DHWSys:HERSCheck:Compact ) > 0.5 ) then 1 else 0 endif }
	"Check for Multi-family Central Recirculating Dual Loop Design"	Proj:HERSDHW:Compact = { if ( MaxAll( DHWSys:HERSCheck:Compact ) > 0.5 ) then 1 else 0 endif }
	"Check for Parallel Piping"					Proj:HERSDHW:ParallelPipe = { if ( MaxAll( DHWSys:HERSCheck:ParallelPipe ) > 0.5 ) then 1 else 0 endif }
	"Check for All Pipes Insulated"					Proj:HERSDHW:AllPipesIns = { if ( MaxAll( DHWSys:HERSCheck:AllPipesIns ) > 0.5 ) then 1 else 0 endif }
	"Check for Point of Use"					Proj:HERSDHW:PointOfUse = { if ( MaxAll( DHWSys:HERSCheck:PointOfUse ) > 0.5 ) then 1 else 0 endif }
	"Check for Recirc, Occupancy DC"				Proj:HERSDHW:OccRecirc = { if ( MaxAll( DHWSys:HERSCheck:OccRecirc ) > 0.5 ) then 1 else 0 endif }
	"Check for Recirc, Push Button DC"				Proj:HERSDHW:PushBtnRecirc = { if ( MaxAll( DHWSys:HERSCheck:PushBtnRecirc ) > 0.5 ) then 1 else 0 endif }
;	"Check for Below Grade"						Proj:HERSDHW:BelowGrade = { if ( MaxAll( DHWSys:HERSCheck:BelowGrade ) > 0.5) then 1 else 0 endif }
;	"Check for MF Recirc, No Control"				Proj:HERSDHW:MFNoControl = { if ( MaxAll( DHWSys:HERSCheck:MFNoControl ) > 0.5 ) then 1 else 0 endif }
;	"Check for MF Recirc, Demand Control"				Proj:HERSDHW:MFDemandControl = { if ( MaxAll( DHWSys:HERSCheck:MFDemandControl ) > 0.5 ) then 1 else 0 endif }
;	"Check for MF Recirc, Temp Modulation"				Proj:HERSDHW:MFTempMod = { if ( MaxAll( DHWSys:HERSCheck:MFTempMod ) > 0.5 ) then 1 else 0 endif }
;	"Check for MF Recirc, Temp Mod & Monitor"			Proj:HERSDHW:MFTempModMon = { if ( MaxAll( DHWSys:HERSCheck:MFTempModMon ) > 0.5 ) then 1 else 0 endif }

	"Set Proj:ShowNotRegWatermark - Whether or not the 'not registered' watermark should appear on the compliance report - 1"
;		Proj:ShowNotRegWatermark = {	if ( HERSDHW:MFTempModMon .OR. HERSDHW:MFTempMod .OR. HERSDHW:MFDemandControl .OR. HERSDHW:MFNoControl .OR. HERSDHW:Compact .OR. HERSDHW:PointOfUse .OR. HERSDHW:OccRecirc
;								.OR. HERSDHW:PushBtnRecirc .OR. HERSDHW:BelowGrade .OR. HERSDHW:ParallelPipe .OR. HERSDHW:AllPipesIns ) then 1 else 0 endif	}; SDS 07/28/16 removed checks which were no longer relevant (tic #707)
		Proj:ShowNotRegWatermark = {	if ( HERSDHW:Compact .OR. HERSDHW:PointOfUse .OR. HERSDHW:OccRecirc .OR. HERSDHW:PushBtnRecirc .OR. HERSDHW:ParallelPipe .OR. HERSDHW:AllPipesIns ) then 1 else 0 endif	}

	"Set Proj:ShowNotRegWatermark - Whether or not the 'not registered' watermark should appear on the compliance report - 2"
		Proj:ShowNotRegWatermark = {	if ( LocalRef( HERSCool:SEER ) .OR. LocalRef( HERSCool:EER ) .OR. LocalRef( HERSCool:ACCharg ) .OR. LocalRef( HERSCool:AHUAirFlow ) .OR. LocalRef( HERSDist:DuctLeakage ) 
													.OR. LocalRef( HERSDist:DuctLocation ) .OR. LocalRef( HERSDist:RetDuctDesign ) .OR. LocalRef( HERSDist:SupDuctDesign ) .OR. LocalRef( HERSFan:AHUFanEff ) ) then 1 else UNCHANGED endif	}
	"Set Proj:ShowNotRegWatermark - Whether or not the 'not registered' watermark should appear on the compliance report - 3"
		Proj:ShowNotRegWatermark = {	if ( HERSProj:QII .OR. HERSProj:LowBldgLkg .OR. HERSProj:IAQFan .OR. HERSProj:CentralIAQ .OR. HERSProj:ZonalCoolSys .OR. HERSProj:SprayFoamHighR .OR. HERSProj:VerifyExistCond ) then 1 else UNCHANGED endif	}

; Project level Special Features
;
;mjb doesn't see why to set Special Feature flags for these, since they are already HERS measures:
;VentCool
;DuctLocation      
;NoDucts               

	"Ensure Proj:SpeclFeatrs exists"		Proj:Action = {	if (LocalCompAssigned( SpeclFeatrs )) then  UNCHANGED
											else  EvalRulelist( "CreateAndAssignAsUserDefined_Proj_SpeclFtr", 1 )  endif  }

; removed AllOrientation flag - SAC 9/10/13
;	"Check for AllOrientations" 			Proj:SpeclFeatrs:AllOrientations = { if ( Project:AllOrientations > 0.5 ) then 1 else 0 endif }
;	"Check for AllOrientations" 			Proj:SpeclFeatrs:AllOrientations = { 0 }
	"Check for ZonalControl" 			Proj:SpeclFeatrs:ZonalControl = { if ( Project:ZonalControl > 0.5 ) then 1 else 0 endif }
; mjb-10/11/13 added special feature messages for reporting
	"Write ZonalControl Msg" 			Proj:SpeclFeatrs:ZonalControlMsg = { if ( SpeclFeatrs:ZonalControl > 0.5 ) then 1 else 0 endif }

; SAC 10/14/13 - updated rule to properly reflect PV inputs and limits
; SAC 3/24/16 - revised rule again to acount for PVCompCredit checkbox and EDR inputs and to prevent logging credit for EAA, AddAlone or locations where PV doesn't allow credit
  "Check for PVCredit"         Proj:SpeclFeatrs:PVSysCredit = { 
    if ( PVGenCredit < 0.1 .OR. StandardsVersion <= 2014 .OR. PVCompCredit < 0.5 ) 
    then  0
    else if (Proj:RunScope != 1 .OR. Proj:IsAddAlone > 0 .OR. IfValidAnd(MaxPVPrelimCredit < 0.01)) 
    then  0
    else if ( IfValidAnd( AllowDesignRating > 0.5 ) .AND. 
              IfValidAnd( DesignRatingCalcs > 0.5 ) .AND. 
              IfValidAnd( PVWDCSysTotal >= PVMinRatedPwrRpt )==0) 
    then  0
    else  1  
    endif endif endif }
;	"Check for PVCredit" 				Proj:SpeclFeatrs:PVSysCredit = { if ( Project:PVCredit > 0.1 ) then 1 else 0 endif }
; mjb-10/14/13	changed ELSE msg so that message would show up in XML even when blank
; SAC 3/24/16 - revised logic to report credit value resulting from changes from having user enter PVRatedPower to simply checking the PVCompCredit checkbox
	"Write PV Capacity Msg" 			Proj:SpeclFeatrs:PVSysCreditMsg = { if ( SpeclFeatrs:PVSysCredit > 0.5 ) 
																								then	if (IfValidAnd( AllowDesignRating > 0.5 ) .AND. IfValidAnd( DesignRatingCalcs > 0.5 ) .AND. IfValidAnd( PVWDCSysTotal >= PVMinRatedPwrRpt ))
																										then	"PV System: " + FltToStr( PVWDCSysTotal, 1, 0, 3 ) + " kWdc"
																										else if (IfValidAnd( PVMinRatedPwrRpt > 0 ))
																										then	"PV System: " + FltToStr( PVMinRatedPwrRpt, 1, 0, 3 ) + " kWdc"
																										else if (IfValidAnd( PVRatedPower > 0 ))
																										then	"PV System: " + FltToStr( PVRatedPower, 1, 0, 3 ) + " kWdc"
																										else	" "  endif endif endif 
																								else " " endif }

  ; SAC 10/15/14 - added to facilitate multiple attics
	"Set Attic:AboveDeckRoofIns"		Attic:AboveDeckRoofIns		= {	if (FloorAreaOverCond > 0.5 .AND. IfValidAnd( Construction:AbvDeckInsulLayer > 0.5 )) then  1  else  0  endif  }
	"Set Attic:BelowDeckRoofIns"		Attic:BelowDeckRoofIns		= {	if (FloorAreaOverCond > 0.5 .AND. IfValidAnd( Construction:CavityLayer       > 0.5 )) then  1  else  0  endif  }
;	mjb	8/21/14	- mod from FloorArea to FloorAreaOverCond to eliminate reporting Special Features for Garage
	"Check for Above Deck Attic Insulation" 	Proj:SpeclFeatrs:AboveDeckRoofIns		= {	SumAll( Attic:AboveDeckRoofIns )  }
																													;	if (ComponentCount( Attic ) < 0.5) then  0 
																													;	else if ( Attic:FloorAreaOverCond > 0.5 .AND. Attic:Construction:AbvDeckInsulLayer > 0.5 ) then 1 else 0 endif endif }
	"Write Above RDI Msg" 							Proj:SpeclFeatrs:AboveDeckRoofInsMsg	= {	if ( SpeclFeatrs:AboveDeckRoofIns > 0.5 ) then 1 else 0 endif }

	"Check for Below Deck Attic Insulation" 	Proj:SpeclFeatrs:BelowDeckRoofIns		= {	SumAll( Attic:BelowDeckRoofIns )  }
																													;	if (ComponentCount( Attic ) < 0.5) then  0
																													;	else if ( Attic:FloorAreaOverCond > 0.5 .AND. Attic:Construction:CavityLayer > 0.5 ) then 1 else 0 endif endif }
	"Write Below RDI Msg" 							Proj:SpeclFeatrs:BelowDeckRoofInsMsg	= {	if ( SpeclFeatrs:BelowDeckRoofIns > 0.5 ) then 1 else 0 endif }

; SAC 10/20/14 - added flag that accommodates multiple Attics in setting the global flag Proj:SpeclFeatrs:CoolRoof
	"Set Attic:SolReflSpclFtrs flag"		Attic:SolReflSpclFtrs	= {	if (FloorAreaOverCond < 0.5 .OR. RoofSolReflect <= 0.1) then  0
																							else if (RoofSolReflect >= 0.2) then  2  else  1  endif endif  }

;	mjb	corrected reflectance condition for cool roofs	9/20/13
;	mjb-10/14/13	added reporting for non-standard roofs as well as cool roofs
;	mjb	changed > to >=	7/2/14
;	mjb	changed >= to >	8/4/14
;	mjb	changed > to >= for COOL roofs	8/21/14	
;	mjb	8/21/14	- mod from FloorArea to FloorAreaOverCond to eliminate reporting Special Features for Garage
	"Check for Cool Roof" 				Proj:SpeclFeatrs:CoolRoof = {  MaxAll( Attic:SolReflSpclFtrs )  }
	"Check for Cool Roof-2" 			Proj:SpeclFeatrs:CoolRoof = {  if (LocalStatus( SpeclFeatrs:CoolRoof ) < 0.5) then  0  else  UNCHANGED  endif  }
									; previous logic when only a single Attic could exist
									;			if (ComponentCount( Attic ) < 0.5) then  0 else 
									;			if (SumAll( Attic:FloorAreaOverCond ) > 0.5 ) then
									;				if (Attic:RoofSolReflect >= 0.2 ) then 2 else  
									;					if (Attic:RoofSolReflect > 0.1 ) then 1 else 0 endif 
									;				endif
									;			else 0 endif endif }

	"Write Cool Roof Msg" 				Proj:SpeclFeatrs:CoolRoofMsg = { if ( SpeclFeatrs:CoolRoof > 1.5 ) then 2 else 
												if ( SpeclFeatrs:CoolRoof > 0.5 ) then 1 else 0 endif endif }
;	mjb	8/21/14	- mod to exclude Garage from Special Feature reporting
	"Check for Window Exterior Shading in Zones" 		Zone:ExtShade = { if ( MaxChild( Win:ExteriorShade ) > 1.5 ) then 1 else 0 endif }
;	"Check for Window Exterior Shading in Garage" 		Garage:ExtShade = { if ( MaxChild( Win:ExteriorShade ) > 1.5 ) then 1 else 0 endif }
	"Check for Window Exterior Shading in Garage" 		Garage:ExtShade = {  0  }
	"Check for Window Exterior Shading in Project" 		Proj:SpeclFeatrs:ExtShade = { if ( MaxAll( Zone:ExtShade ) > 0.5 .OR. MaxAll( Garage:ExtShade ) > 0.5 ) then 1 else 0 endif }
	"Write Exterior Shading Msg" 				Proj:SpeclFeatrs:ExtShadeMsg = { if ( SpeclFeatrs:ExtShade > 0.5 ) then 1 else 0 endif }

; mjb-10/14/13	corrected rule logic for reporting overhangs and fins
;	mjb	8/21/14	- mod to exclude Garage from Special Feature reporting
	"Check for Window Overhangs and Fins in Zones" 		Zone:OvrHangsFins = { if ( MaxChild( Win:ModelFinsOverhang ) > 0.5 ) then 1 else 0 endif }
;	"Check for Window Overhangs and Fins in Garage" 	Garage:OvrHangsFins = { if ( MaxChild( Win:ModelFinsOverhang ) > 0.5 ) then 1 else 0 endif }
	"Check for Window Overhangs and Fins in Garage" 	Garage:OvrHangsFins = {  0  }
	"Check for Window Overhangs and Fins in Project" 	Proj:SpeclFeatrs:WinOVerHngFin = { if ( MaxAll( Zone:OvrHangsFins ) > 0.5 .OR. MaxAll( Garage:OvrHangsFins ) > 0.5 ) then 1 else 0 endif }
	"Write Overhangs and Fins Msg" 				Proj:SpeclFeatrs:WinOVerHngFinMsg = { if ( SpeclFeatrs:WinOVerHngFin > 0.5 ) then 1 else 0 endif }

	"Check for Exposed Slab Fraction" 		Proj:SpeclFeatrs:ExposedSlab = { if (Proj:BldgCondZnSlabFlrArea < 1 ) then 0 else
												if ( ( Proj:ExpSlabFloorArea / Proj:BldgCondZnSlabFlrArea ) > 0.25 ) then 1 else 0 endif 
											    endif }
	"Write Exposed Slab Msg" 			Proj:SpeclFeatrs:ExposedSlabMsg = { if ( SpeclFeatrs:ExposedSlab > 0.5 ) then 1 else 0 endif }

	; SAC 6/2/16 - added reporting of SlabEdgeInsul & HeatedSlab (tic #678)
	"Check for SpeclFtr:SlabEdgeInsul" 		Proj:SpeclFeatrs:SlabEdgeInsul		= {	if (SumAcrossIf( SlabFloor:HasEdgeInsul, SlabFloor:CondZnArea > 0.1 )) then  1  else  0  endif  }
	"Write SpeclFtr:SlabEdgeInsul Msg" 		Proj:SpeclFeatrs:SlabEdgeInsulMsg	= {	if ( SpeclFeatrs:SlabEdgeInsul > 0.5 ) then  1  else  0  endif  }
	"Check for SpeclFtr:HeatedSlab" 			Proj:SpeclFeatrs:HeatedSlab			= {	if (SumAcrossIf( SlabFloor:HeatedSlab, SlabFloor:CondZnArea > 0.1 )) then  1  else  0  endif  }
	"Write SpeclFtr:HeatedSlab Msg" 			Proj:SpeclFeatrs:HeatedSlabMsg		= {	if ( SpeclFeatrs:HeatedSlab > 0.5 ) then  1  else  0  endif  }

	; SAC 5/2/16 - added reporting of AWF ExtWall area
	"Set ExtWall:AWFWallsArea"		ExtWall:AWFWallsArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a ExtWall child of a conditioned Zone
																				else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																				else if (IfValidAnd( Construction:FrameLayer = 425 ) .OR.	; "2x4 AWF"
																							IfValidAnd( Construction:FrameLayer = 625 ) )		; "2x6 AWF"
																				then	Area
																				else	0  endif endif endif  }
				; add logic pertaining to Status or Verified or exConstruction ??
	"Check for AWFWalls"		Proj:SpeclFeatrs:AWFWalls		= {	if (SumAll( ExtWall:AWFWallsArea ) > 0.1) then  1  else  0  endif  }
	"Write AWFWalls Msg" 	Proj:SpeclFeatrs:AWFWallsMsg	= {	if (SpeclFeatrs:AWFWalls > 0.5 ) then  1  else  0  endif }

	; SAC 6/2/16 - added reporting of Metal ExtWall area (tic #678)
	"Set ExtWall:MetalFrmArea"		ExtWall:MetalFrmArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a ExtWall child of a conditioned Zone
																				else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																				else if (IfValidAnd( Construction:Type == 1 ))		; "Steel Framed Wall"
																				then	Area
																				else	0  endif endif endif  }
				; add logic pertaining to Status or Verified or exConstruction ??
	"Check for MetalFramedWalls"	Proj:SpeclFeatrs:MetalFramedWalls		= {	if (SumAll( ExtWall:MetalFrmArea ) > 0.1) then  1  else  0  endif  }
	"Write MetalFramedWalls Msg" 	Proj:SpeclFeatrs:MetalFramedWallsMsg	= {	if (SpeclFeatrs:MetalFramedWalls > 0.5 ) then  1  else  0  endif }

	; SAC 6/2/16 - added reporting of SIP wall/floor/roof area (tic #678)
	"Set ExtWall:SIPArea"		ExtWall:SIPArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a child of a conditioned Zone
																		else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																		else if (IfValidAnd( Construction:Type == 5 ))		; "SIPS Wall"
																		then	Area
																		else	0  endif endif endif  }
	"Set Attic:SIPArea"			Attic:SIPArea		= {	if (FloorAreaOverCond < 0.1) then  0		; if no ZoneArea, then this is not a child of a conditioned Zone
																		else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																		else if (IfValidAnd( Construction:Type == 13 ))		; "SIPS Ceiling"
																		then	FloorAreaOverCond
																		else	0  endif endif endif  }
	"Set CathedralCeiling:SIPArea"	CathedralCeiling:SIPArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a child of a conditioned Zone
																							else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																							else if (IfValidAnd( Construction:Type == 13 ))		; "SIPS Ceiling"
																							then	Area
																							else	0  endif endif endif  }
	"Set ExteriorFloor:SIPArea"	ExteriorFloor:SIPArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a child of a conditioned Zone
																					else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																					else if (IfValidAnd( Construction:Type == 24 ))		; "SIPS Floor"
																					then	Area
																					else	0  endif endif endif  }
	"Set FloorOverCrawl:SIPArea"	FloorOverCrawl:SIPArea	= {	if (ZoneArea < 0.1) then  0		; if no ZoneArea, then this is not a child of a conditioned Zone
																					else if (LocalCompAssigned( Construction ) < 1) then  0		; no construction assigned
																					else if (IfValidAnd( Construction:Type == 24 ))		; "SIPS Floor"
																					then	Area
																					else	0  endif endif endif  }
	"Check for SIPAssembly"		Proj:SpeclFeatrs:SIPAssembly		= {	     if (SumAll( ExtWall:SIPArea          ) > 0.1) then  1
																							else if (SumAll( Attic:SIPArea            ) > 0.1) then  1
																							else if (SumAll( CathedralCeiling:SIPArea ) > 0.1) then  1
																							else if (SumAll( ExteriorFloor:SIPArea    ) > 0.1) then  1
																							else if (SumAll( FloorOverCrawl:SIPArea   ) > 0.1) then  1
																							else  0  endif endif endif endif endif  }
	"Write SIPAssembly Msg" 	Proj:SpeclFeatrs:SIPAssemblyMsg	= {	if (SpeclFeatrs:SIPAssembly > 0.5 ) then  1  else  0  endif }

; mjb	5/6/14 - add other assemblies
;  mjb   11/18/14 - modified rule to only set flag to 1 if Cathedral Ceiling is in conditioned zone
	"Check for Cathedral Ceiling in Assigned Cons" 		Cons:RptNonStd = { if ( CanAssignTo == 2 .AND. SumRevRef( CathedralCeiling:Construction, CathedralCeiling:ZoneArea) > 0.5 ) then 1 else 0 endif }
  ; SAC 12/31/15 - toggled OFF reporting of CathedralCeiling special feature flag - ticket #577 related to Cath Clg reported for Skylights (when no cath clg specified by user)
	"Check for Cathedral Ceiling flag" 						Proj:SpeclFeatrs:CathedralCeiling = { 0 }  ; if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
	"Write Cathedral Ceiling Msg" 							Proj:SpeclFeatrs:CathedralCeilingMsg = { if ( SpeclFeatrs:CathedralCeiling > 0.5 ) then 1 else 0 endif }

;em 11/5/14 add R value limits for special feature mesages for raised floor and ceiling below attic
;	mjb	11/14/14 mods to make sure only reported for Conditioned zones and looks for both types of floor insulation reqs. (Raised and Concrete Raised)
; mjb 1/12/15 - changed to new lookup table for code levels
;	"Check for non-standard CBA in Assigned Cons" 		Cons:RptNonStd = { if ( CanAssignTo == 3 .AND. Type > 0 .AND. AssignedCondZoneArea > 0.5 .AND. CavityLayer > ClimateZoneTable( Global( Proj:ClimateZone ), 7 )) then 1 else 0 endif }
;	"Check for HighRvalIns in CeilBelowAttic" 				CeilingBelowAttic:HighRvalIns 			= { if ( Construction:CavityLayer > CA13ClimateZoneDesignDay:CeilIns( "ClimateZone", Proj:ClimateZone ) .AND. IfValidAnd( AreaOverCond > 0.5 ) ) then 1 else 0 endif }
	"Check for HighRvalIns in CeilBelowAttic" 				CeilingBelowAttic:HighRvalIns 			= { if ( Construction:CavityLayer > CAClimateZoneCodeBase:CeilIns( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase ) .AND. IfValidAnd( AreaOverCond > 0.5 ) ) then 1 else 0 endif }
	"Check for HighRvalCeilIns in Zone"							Zone:HighRvalCeilIns							= { if ( ClgBlwAtticArea > 0.5 .AND. MaxChild( CeilingBelowAttic:HighRvalIns ) > 0.5 ) then 1 else 0 endif  }
;	"Check for non-standard Ceiling Below Attic" 		Proj:SpeclFeatrs:NonStdCeilBelowAttic = { if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
	"Check for HighRvalCeilIns in Project" 					Proj:SpeclFeatrs:NonStdCeilBelowAttic 		= { if ( SumAcrossif( Zone:HighRvalCeilIns, Zone:Type < 10 ) > 0.5 ) then 1 else 0 endif }
	"Write non-standard Ceiling Below Attic Msg" 			Proj:SpeclFeatrs:NonStdCeilBelowAtticMsg = { if ( SpeclFeatrs:NonStdCeilBelowAttic > 0.5 ) then 1 else 0 endif }

;	"Check for non-standard Floor in Assigned Cons" 	Cons:RptNonStd = { if ( (CanAssignTo == 5 .OR. CanAssignTo == 8 .OR. CanAssignTo == 9) .AND. Type > 0 .AND. AssignedCondZoneArea > 0.5 .AND. CavityLayer > 19 ) then 1 else 0 endif }
	"Check for HighRvalIns in FloorOverCrawl" 				FloorOverCrawl:HighRvalIns 			   = { if ( Construction:Type < 25 ) then 
;	                                                                                                   if( Construction:CavityLayer > CA13ClimateZoneDesignDay:FloorIns( "ClimateZone", Proj:ClimateZone ) .AND. IfValidAnd( Area > 0.5 ) ) then 1 else 0 endif
	                                                                                                   if( Construction:CavityLayer > CAClimateZoneCodeBase:FloorIns( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase ) .AND. IfValidAnd( Area > 0.5 ) ) then 1 else 0 endif
	                                                                                                 else
;	                                                                                                   if( Construction:CavityLayer > CA13ClimateZoneDesignDay:ConcFloorIns( "ClimateZone", Proj:ClimateZone ) .AND. IfValidAnd( Area > 0.5 ) ) then 1 else 0 endif
	                                                                                                   if( Construction:CavityLayer > CAClimateZoneCodeBase:ConcFloorIns( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase ) .AND. IfValidAnd( Area > 0.5 ) ) then 1 else 0 endif
	                                                                                                 endif }
	"Check for HighRvalIns in ExtFloor" 				      ExteriorFloor:HighRvalIns 			         = { if ( Construction:Type < 25 ) then 
;	                                                                                                   if( Construction:CavityLayer > CA13ClimateZoneDesignDay:FloorIns( "ClimateZone", Proj:ClimateZone ) .AND. IfValidAnd( Area > 0.5 ) ) then 1 else 0 endif
	                                                                                                   if( Construction:CavityLayer > CAClimateZoneCodeBase:FloorIns( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase ) .AND. IfValidAnd( Area > 0.5 ) ) then 1 else 0 endif
	                                                                                                 else
;	                                                                                                   if( Construction:CavityLayer > CA13ClimateZoneDesignDay:ConcFloorIns( "ClimateZone", Proj:ClimateZone ) .AND. IfValidAnd( Area > 0.5 ) ) then 1 else 0 endif
	                                                                                                   if( Construction:CavityLayer > CAClimateZoneCodeBase:ConcFloorIns( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase ) .AND. IfValidAnd( Area > 0.5 ) ) then 1 else 0 endif
	                                                                                                 endif }
	"Check for HighRvalCeilIns in Zone"							Zone:HighRvalFloorIns						= { if ( MaxChild( ExteriorFloor:HighRvalIns ) > 0.5 .OR. MaxChild( FloorOverCrawl:HighRvalIns ) > 0.5 ) then 1 else 0 endif  }
;	"Check for non-standard Floor" 							Proj:SpeclFeatrs:NonStdFloor = { if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
	"Check for HighRvalCeilIns in Project" 					Proj:SpeclFeatrs:NonStdFloor 		= { if ( SumAcrossif( Zone:HighRvalFloorIns, Zone:Type < 10 ) > 0.5 ) then 1 else 0 endif }
	"Write non-standard Floor Msg" 								Proj:SpeclFeatrs:NonStdFloorMsg = { if ( SpeclFeatrs:NonStdFloor > 0.5 ) then 1 else 0 endif }


;	mjb	remove Radiant Barrier as Special Feature	9/10/13
;	"Check for Radiant Barrier in Assigned Cons" 		Cons:RptNonStd = { if (IfValidAnd( Cons:RadiantBarrier > 0.5 ) .AND. IfValidAnd( AssignedCondZoneArea > 0.5 )) then 1 else 0 endif }
;	"Check for Radiant Barrier" 				Proj:SpeclFeatrs:RadiantBarrier = { if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
;	"Set Radiant Barrier flag to zero" 			Proj:SpeclFeatrs:RadiantBarrier = {  0  }
	"Check for Raised Heel Truss in Assigned Cons" 		Cons:RptNonStd = { if (IfValidAnd( Cons:RaisedHeelTruss > 0.5 ) .AND. IfValidAnd( AssignedCondZoneArea > 0.5 )) then 1 else 0 endif }
	"Check for Raised Heel Truss" 				Proj:SpeclFeatrs:RHTruss = { if ( SumAll( Cons:RptNonStd ) > 0.5 ) then 1 else 0 endif }
	"Write Raised Heel Truss Msg" 				Proj:SpeclFeatrs:RHTrussMsg = { if (IfValidAnd( SpeclFeatrs:RHTruss > 0.5 )) then 1 else 0 endif }

; mjb 1/12/15 - changed to new lookup table for code levels
	"Check for High R-value Duct Ins" 			HVACSys:HiRvalDuctIns = { if (IfValidAnd( DistribSystem:FloorAreaServed > 0.5 ) .AND. 
;																									IfValidAnd( DistribSystem:DuctInsRvalue > ClimateZoneTable( Proj:ClimateZone, 4 ) )) then 1 else 0 endif }
																									IfValidAnd( DistribSystem:DuctInsRvalue > CAClimateZoneCodeBase:DuctRval( "ClimateZone", Proj:ClimateZone, "CodeBase", Proj:StdDesignBase ) )) then 1 else 0 endif }
	"Check for High R-value Duct Ins" 			Proj:SpeclFeatrs:DuctInsul = { if ( MaxAll( HVACSys:HiRvalDuctIns ) > 0.5 ) then 1 else 0 endif }
	"Write High R-value Duct Ins Msg" 			Proj:SpeclFeatrs:DuctInsulMsg = { if (IfValidAnd( SpeclFeatrs:DuctInsul > 0.5 )) then 1 else 0 endif }

	; SAC 6/2/16 - added reporting of NonStdDuctLoc (tic #678)
	"Check for HVACSys:NonStdDuctLoc[1] - Crawl" 	HVACSys:NonStdDuctLoc[1] 	= {	if (IfValidAnd( DistribSystem:FloorAreaServed > 0.5 ) .AND. 
																													 IfValidAnd( DistribSystem:Type =  2 ) ) then 1 else 0 endif }
	"Check for HVACSys:NonStdDuctLoc[2] - Other" 	HVACSys:NonStdDuctLoc[2] 	= {	if (IfValidAnd( DistribSystem:FloorAreaServed > 0.5 ) .AND. 
																													 IfValidAnd( DistribSystem:Type =  1 )==0 .AND.
																													 IfValidAnd( DistribSystem:Type =  2 )==0 .AND.
																													 IfValidAnd( DistribSystem:Type =  8 )==0 ) then 1 else 0 endif }
	"Check for SpeclFtr:DuctsInCrawlSpc" 	Proj:SpeclFeatrs:DuctsInCrawlSpc	 	= {	if ( SumAll( HVACSys:NonStdDuctLoc[1] ) > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DuctsInCrawlSpcMsg" 	Proj:SpeclFeatrs:DuctsInCrawlSpcMsg = {	if (IfValidAnd( SpeclFeatrs:DuctsInCrawlSpc > 0.5 )) then 1 else 0 endif }
	"Check for SpeclFtr:NonStdDuctLoc" 		Proj:SpeclFeatrs:NonStdDuctLoc		= {	if ( SumAll( HVACSys:NonStdDuctLoc[2] ) > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:NonStdDuctLocMsg" 		Proj:SpeclFeatrs:NonStdDuctLocMsg 	= {	if (IfValidAnd( SpeclFeatrs:NonStdDuctLoc   > 0.5 )) then 1 else 0 endif }

	; SAC 6/14/16 - revised logic to take into account EnableClVent and to register TRUE when UnitClVentOption = 'Default Prescriptive Whole House Fan' (tic #678)
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 )==0) then  0
																							else if (UnitClVentOption == 1) then  1
																							else if (IfValidAnd( UnitClVentNumFans[1] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[1] > 0.5 )) then 1 else 0 endif endif endif }
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 ) .AND. IfValidAnd( UnitClVentNumFans[2] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[2] > 0.5 )) then 1 else UNCHANGED endif }
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 ) .AND. IfValidAnd( UnitClVentNumFans[3] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[3] > 0.5 )) then 1 else UNCHANGED endif }
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 ) .AND. IfValidAnd( UnitClVentNumFans[4] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[4] > 0.5 )) then 1 else UNCHANGED endif }
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 ) .AND. IfValidAnd( UnitClVentNumFans[5] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[5] > 0.5 )) then 1 else UNCHANGED endif }
	"Check for Cool Vent System"			Proj:SpeclFeatrs:CoolVent = { if (IfValidAnd( EnableClVent > 0.5 ) .AND. IfValidAnd( UnitClVentNumFans[6] > 0.5 ) .AND. IfValidAnd( UnitClVentCFM[6] > 0.5 )) then 1 else UNCHANGED endif }
	"Populate Cool Vent msg"				Proj:SpeclFeatrs:CoolVentRptMsg = { if (IfValidAnd( SpeclFeatrs:CoolVent > 0.5 )) then 1 else 0 endif }

; EM 1/20/15 - set variable and fixed CFI properties as integers
	"Check for varaible CFI vent"				Proj:SpeclFeatrs:VarCFIClVent			= { if ( SumAll( HVACSys:IsVariableCFIClVent ) > 0) then 1 else 0 endif }		; SAC 2/17/15 - fixed bugs in if statements / SumAll() function calls
	"Check for fixed CFI vent"					Proj:SpeclFeatrs:FixCFIClVent			= { if ( SumAll( HVACSys:IsFixedCFIClVent ) > 0) then 1 else 0 endif }
	"Check for varaible CFI vent report"	Proj:SpeclFeatrs:VarCFIClVentRptMsg = { if (IfValidAnd( SpeclFeatrs:VarCFIClVent > 0.5 )) then 1 else 0 endif }
	"Check for fixed CFI vent report"		Proj:SpeclFeatrs:FixCFIClVentRptMsg = { if (IfValidAnd( SpeclFeatrs:FixCFIClVent > 0.5 )) then 1 else 0 endif }

;	mjb	8/22/14	- needs to work for HtPumps too...
;	mjb	10/30/14	- mods to make all reporting rules work without special reporting parameters that are no longer needed
;	"Check for No Cooling in HVACSys" 							HVACSys:NoCoolingRpt 			= { if ( IfValidAnd( CoolSystem:TypeRpt < 2 ) .AND. IfValidAnd( NumHtPumpSystemTypes < 1 ) .AND. IfValidAnd( FloorAreaServed > 0.5 ) ) then 1 else 0 endif }
	"Check for No Cooling in HVACSys" 							HVACSys:NoCoolingRpt 			= { if ( IfValidAnd( CoolSystem:Type < 2 ) .AND. IfValidAnd( NumHtPumpSystemTypes < 1 ) .AND. IfValidAnd( FloorAreaServed > 0.5 ) ) then 1 else 0 endif }
	"Check for No Cooling in Project" 							Proj:SpeclFeatrs:NoCooling 	= { if ( MaxAll(HVACSys:NoCoolingRpt) > 0.5 ) then 1 else 0 endif }
	"Write No Cooling Msg" 											Proj:SpeclFeatrs:NoCoolingMsg = { if ( SpeclFeatrs:NoCooling > 0.5 ) then 1 else 0 endif }
;	"debug"		HVACSys:Action	= {	MessageBox( "reporting -- HVACSys '%s':  CoolSystem:TypeRpt = %g  NoCoolingRpt = %g", Name, CoolSystem:TypeRpt, NoCoolingRpt )  }
;	mjb	7/29/14	added Special Feature message for les than 40ft of added duct
	"Check for Short Ducts in Project" 							Proj:SpeclFeatrs:AddedShortDuct 		= { if ( SumAcrossIf(HVACDist:IsLessThanFortyFt, HVACDist:FloorAreaServed > 0 ) > 0.5 ) then 1 else 0 endif }
	"Write Short Duct Msg" 											Proj:SpeclFeatrs:AddedShortDuctMsg 	= { if ( SpeclFeatrs:AddedShortDuct > 0.5 ) then 1 else 0 endif }

;       Updated based on changes to address (tic #707)
	; SAC 6/2/16 - added reporting of Recird DHW scenarios (tic #678)
;	"Check for DHWSys:SpeclFeatrsFlags[1] - Pipe Insulation, All Lines" 
;					DHWSys:SpeclFeatrsFlags[1]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 4096 .OR. SystemType == 8392704) ) then 1 else 0 endif }
;																	;     4096, "Pipe Insulation, All Lines"  	;  8392704, "(HERS req'd) Pipe Insulation, All Lines" 
;	"Check for DHWSys:SpeclFeatrsFlags[2] - Parallel Piping - Non-Central" 
;					DHWSys:SpeclFeatrsFlags[2]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 4608 .OR. SystemType == 8393216) .AND. IfValidAnd( CentralDHW > 0.5 )==0 ) then 1 else 0 endif }
;																	;     4608, "Parallel Piping"  	;  8393216, "(HERS req'd) Parallel Piping"    - Non-Central
;	"Check for DHWSys:SpeclFeatrsFlags[3] - Parallel Piping - Central" 
;					DHWSys:SpeclFeatrsFlags[3]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 4608 .OR. SystemType == 8393216) .AND. IfValidAnd( CentralDHW > 0.5 ) ) then 1 else 0 endif }
;																	;     4608, "Parallel Piping"  	;  8393216, "(HERS req'd) Parallel Piping"    - Central
;	"Check for DHWSys:SpeclFeatrsFlags[4] - Recirculation, Non-Demand Control" 
;					DHWSys:SpeclFeatrsFlags[4]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND.  SystemType == 4992 ) then 1 else 0 endif }
;																	;     4992, "Recirculation, Non-Demand Control"  
;	"Check for DHWSys:SpeclFeatrsFlags[5] - Recirculation, Demand Control Push Button" 
;					DHWSys:SpeclFeatrsFlags[5]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 5248 .OR. SystemType == 8393856) ) then 1 else 0 endif }
;																	;     5248, "Recirculation, Demand Control Push Button"  	;  8393856, "(HERS req'd) Recirculation, Demand Control Push Button" 
;	"Check for DHWSys:SpeclFeatrsFlags[6] - Recirculation, Demand Control Occupancy/Motion" 
;					DHWSys:SpeclFeatrsFlags[6]		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 5504 .OR. SystemType == 8394112) ) then 1 else 0 endif }
;																	;     5504, "Recirculation, Demand Control Occupancy/Motion"  	;  8394112, "(HERS req'd) Recirculation, Demand Control Occupancy/Motion" 

;       08/24/16 - CG Updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrMFRecircDemCtrl - Multi-family: Recirculation demand control" 
   DHWSys:SpeclFtrMFRecircDemCtrl		= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW > 0.5 ) .AND. 
         IfValidAnd( MFamDistType == 6336) ) ;Special Feture "Multi-family: Recirculation demand control" is fixed
    then 1 
    else 0 
    endif }


 	"Check for DHWSys:SpeclFtrMFNLpNRecirc - Multi-family: No loops or recirc pump"  
   DHWSys:SpeclFtrMFNLpNRecirc		= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW > 0.5 ) .AND. 
         IfValidAnd( MFamDistType == 0 ) ) 
    then 1 
    else 0 
    endif }

;       08/25/16 - CG Updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrMFRecircNDemCtrl - Multi-family: Recirculating with no control (continuous pumping)" 
   DHWSys:SpeclFtrMFRecircNDemCtrl		= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW > 0.5 ) .AND. 
         IfValidAnd(MFamDistType == 5056) ) 
    then 1 
    else 0 
    endif }

;	08/24/16 - CG updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrMFRecircTempMod - Multi-family: Recirculating with temperature modulation" 
   DHWSys:SpeclFtrMFRecircTempMod	= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW > 0.5 ) .AND. 
         IfValidAnd( MFamDistType == 6592) ) 
    then 1 
    else 0 
    endif }

;	08/24/16 - CG updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrMFRecircTempModMon - Multi-family: Recirculating with temperature modulation and monitoring" 
   DHWSys:SpeclFtrMFRecircTempModMon	= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW > 0.5 ) .AND. 
         IfValidAnd( MFamDistType == 6848) ) 
    then 1 
    else 0 
    endif }
 	"Check for DHWSys:SpeclFtrParaPipeCntrl - Central parallel piping"
 					DHWSys:SpeclFtrParaPipeCntrl		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 4608) .AND. IfValidAnd( CentralDHW < 0.5 ) ) then 1 else 0 endif }

;	08/25/16 - CG updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrPipeInsul - Pipe insulation, all lines"
   DHWSys:SpeclFtrPipeInsul		= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd(SystemType == 4096)) ; 08/26/16 - CG updates to logic
    then 1 
    else 0 
    endif }
 					
;	08/25/16 - CG updated based on changes to address (tic #707)
 	"Check for DHWSys:SpeclFtrPointOfUse - Point Of Use"
   DHWSys:SpeclFtrPointOfUse		= { 
    if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. 
         IfValidAnd( CentralDHW < 0.5 ) .AND. 
         IfValidAnd(SystemType == 4609) ) ; Correct System Type ID# for "Point of Use"
    then 1 
    else 0 
    endif }
    
 	"Check for DHWSys:SpeclFtrRecircDemOcc - Recirculation with demand control, occupancy/motion sensor"
 					DHWSys:SpeclFtrRecircDemOcc		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 5504) .AND. IfValidAnd( CentralDHW < 0.5 ) ) then 1 else 0 endif }
 	"Check for DHWSys:SpeclFtrRecircDemPBtn - Recirculation with demand control, push button"
 					DHWSys:SpeclFtrRecircDemPBtn		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 5248) .AND. IfValidAnd( CentralDHW < 0.5 ) ) then 1 else 0 endif }
 	"Check for DHWSys:SpeclFtrRecircNDemCtrl - Recirculation with non-demand control (continuous pumping)"
 					DHWSys:SpeclFtrRecircNDemCtrl		= { if ( IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND. (SystemType == 4992) .AND. IfValidAnd( CentralDHW < 0.5 ) ) then 1 else 0 endif }
					
; Delete two lines below SDS ( being used as a reference)
;        "Check for All Pipes Insulated"				DHWSys:HERSCheck:AllPipesIns = { if ( DHWSys:SystemType == 8392704 .AND. Status != 1 ) then 1 else 0 endif }
;	"Write AllPipesIns Msg" 						DHWSys:HERSCheck:PipeInsRptMsg = { if ( HERSCheck:AllPipesIns > 0.5 ) then DHWSys:SystemType else UNDEFINED endif }

	"Check for SpeclFtr:DHWMFRecircDemCtrl" 	Proj:SpeclFeatrs:DHWMFRecircDemCtrl   	= {	if ( SumAll( DHWSys:SpeclFtrMFRecircDemCtrl ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWMFNLpNRecirc"    	Proj:SpeclFeatrs:DHWMFNLpNRecirc   	= {	if ( SumAll( DHWSys:SpeclFtrMFNLpNRecirc ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWMFRecircNDemCtrl"	Proj:SpeclFeatrs:DHWMFRecircNDemCtrl   	= {	if ( SumAll( DHWSys:SpeclFtrMFRecircNDemCtrl ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWMFRecircTempMod" 	Proj:SpeclFeatrs:DHWMFRecircTempMod     = {	if ( SumAll( DHWSys:SpeclFtrMFRecircTempMod ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWMFRecircTempModMon"  	Proj:SpeclFeatrs:DHWMFRecircTempModMon 	= {	if ( SumAll( DHWSys:SpeclFtrMFRecircTempModMon ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWParaPipeCntrl"   	Proj:SpeclFeatrs:DHWParaPipeCntrl   	= {	if ( SumAll( DHWSys:SpeclFtrParaPipeCntrl ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWPipeInsul"       	Proj:SpeclFeatrs:DHWPipeInsul       	= {	if ( SumAll( DHWSys:SpeclFtrPipeInsul ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWPointOfUse"       	Proj:SpeclFeatrs:DHWPointOfUse       	= {	if ( SumAll( DHWSys:SpeclFtrPointOfUse ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWRecircDemOcc"    	Proj:SpeclFeatrs:DHWRecircDemOcc    	= {	if ( SumAll( DHWSys:SpeclFtrRecircDemOcc ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWRecircDemPBtn"   	Proj:SpeclFeatrs:DHWRecircDemPBtn   	= {	if ( SumAll( DHWSys:SpeclFtrRecircDemPBtn ) > 0.5 ) then 1 else 0 endif }
	"Check for SpeclFtr:DHWRecircNDemCtrl"  	Proj:SpeclFeatrs:DHWRecircNDemCtrl  	= {	if ( SumAll( DHWSys:SpeclFtrRecircNDemCtrl ) > 0.5 ) then 1 else 0 endif }

	"Write SpeclFtr:DHWMFRecircDemCtrlMsg"        	Proj:SpeclFeatrs:DHWMFRecircDemCtrlMsg  = {	if ( SpeclFeatrs:DHWMFRecircDemCtrl 	> 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWMFNLpNRecircMsg"        	Proj:SpeclFeatrs:DHWMFNLpNRecircMsg     = {	if ( SpeclFeatrs:DHWMFNLpNRecirc	> 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWMFRecircNDemCtrlMsg"        	Proj:SpeclFeatrs:DHWMFRecircNDemCtrlMsg = {	if ( SpeclFeatrs:DHWMFRecircNDemCtrl    > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWMFRecircTempModMsg"        	Proj:SpeclFeatrs:DHWMFRecircTempModMsg  = {	if ( SpeclFeatrs:DHWMFRecircTempMod      > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWMFRecircTempModMonMsg"       Proj:SpeclFeatrs:DHWMFRecircTempModMonMsg	= {	if ( SpeclFeatrs:DHWMFRecircTempModMon      > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWParaPipeCntrlMsg"    	Proj:SpeclFeatrs:DHWParaPipeCntrlMsg  	= {	if ( SpeclFeatrs:DHWParaPipeCntrl  	> 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWPipeInsulMsg"        	Proj:SpeclFeatrs:DHWPipeInsulMsg      	= {	if ( SpeclFeatrs:DHWPipeInsul      > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWPointOfUse"        		Proj:SpeclFeatrs:DHWPointOfUseMsg      	= {	if ( SpeclFeatrs:DHWPointOfUse      > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWRecircDemOccMsg"     	Proj:SpeclFeatrs:DHWRecircDemOccMsg   	= {	if ( SpeclFeatrs:DHWRecircDemOcc   > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWRecircDemPBtnMsg"    	Proj:SpeclFeatrs:DHWRecircDemPBtnMsg  	= {	if ( SpeclFeatrs:DHWRecircDemPBtn  > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:DHWRecircNDemCtrlMsg"   	Proj:SpeclFeatrs:DHWRecircNDemCtrlMsg 	= {	if ( SpeclFeatrs:DHWRecircNDemCtrl > 0.5 ) then 1 else 0 endif }
; 	"Check for SpeclFtr:DHWParaPipeNCntrl"  	Proj:SpeclFeatrs:DHWParaPipeNCntrl  	= {	if ( SumAll( DHWSys:SpeclFeatrsFlags[3] ) > 0.5 ) then 1 else 0 endif }
; 	"Write SpeclFtr:DHWParaPipeNCntrlMsg"   	Proj:SpeclFeatrs:DHWParaPipeNCntrlMsg 	= {	if ( SpeclFeatrs:DHWParaPipeNCntrl > 0.5 ) then 1 else 0 endif }

	; SAC 6/2/16 - added reporting of SFamSolarWH (tic #678)
	"Check for DHWSys:SFamSolarWH" 			DHWSys:SFamSolarWH					= { if ( IfValidAnd( Proj:IsMultiFamily < 0.5 ) .AND. IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND.
																										IfValidAnd( SolFracAnnRpt > 0 ) ) then 1 else 0 endif }
	"Check for SpeclFtr:SFamSolarWH" 		Proj:SpeclFeatrs:SFamSolarWH 		= { if ( SumAll( DHWSys:SFamSolarWH ) > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:SFamSolarWH Msg" 		Proj:SpeclFeatrs:SFamSolarWHMsg 	= { if ( SpeclFeatrs:SFamSolarWH > 0.5 ) then 1 else 0 endif }

	; SDS 8/2/16 - added reporting of MFamSolarWH (tic #707)
	"Check for DHWSys:MFamSolarWH" 			DHWSys:MFamSolarWH					= { if ( IfValidAnd( Proj:IsMultiFamily > 0.5 ) .AND. IfValidAnd( FloorAreaServed[1] > 0.1 ) .AND.
																										IfValidAnd( SolFracAnnRpt > 0 ) ) then 1 else 0 endif }
	"Check for SpeclFtr:MFamSolarWH" 		Proj:SpeclFeatrs:MFamSolarWH 		= { if ( SumAll( DHWSys:MFamSolarWH ) > 0.5 ) then 1 else 0 endif }
	"Write SpeclFtr:MFamSolarWH Msg" 		Proj:SpeclFeatrs:MFamSolarWHMsg 	= { if ( SpeclFeatrs:MFamSolarWH > 0.5 ) then 1 else 0 endif }

END


;*************************************************************************
RULELIST "Force_Existing_HVACDist_DuctLeakage" 1 0 0 0
;*************************************************************************
	"Reset DuctLeakage enumeration for Existing"		HVACDist:DuctLeakage	= { 900	}
;	"debug"		HVACDist:Action	= {	MessageBox( "reporting -- HVACDist '%s':  DuctLeakage = %s", Name, LocalSymbolString(DuctLeakage) )  }
END

; SAC 8/12/13 - rulelists that create HERS objects in a manner where their assignment to existing objects in the model are 'user-defined', and therefore persist in project files
; mjb 9/1/13 - mods to delete HERSHVACSys and add HERSCool, HERSDist and HERSFan
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_Proj_HERSOther" 1 0 1 0
	"Create Proj:HERSProj object & assign as user-defined"		Proj:HERSProj	= {	CreateComp( HERSOther, Local( Name ) + "-hers-proj" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_HVACCool_HERSCool" 1 0 1 0
	"Create HVACCool:HERSCheck object & assign as user-defined"		HVACCool:HERSCheck	= {	CreateComp( HERSCool, Local( Name ) + "-hers-cool" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_HVACHtPump_HERSCool" 1 0 1 0
	"Create HVACCool:HERSCheck object & assign as user-defined"		HVACHtPump:HERSCheck	= {	CreateComp( HERSCool, Local( Name ) + "-hers-cool" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_HVACDist_HERSDist" 1 0 1 0
	"Create HVACCool:HERSCheck object & assign as user-defined"		HVACDist:HERSCheck	= {	CreateComp( HERSDist, Local( Name ) + "-hers-dist" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_HVACFan_HERSFan" 1 0 1 0
	"Create HVACCool:HERSCheck object & assign as user-defined"		HVACFan:HERSCheck	= {	CreateComp( HERSFan, Local( Name ) + "-hers-fan" )  }
END
;*************************************************************************
;RULELIST  "CreateAndAssignAsUserDefined_Proj_HERSCool" 1 0 1 0
;	"Create Proj:HERSCool object & assign as user-defined"		Proj:HERSCool	= {	CreateComp( HERSCool, Local( Name ) + "-hers-cool-proj" )  }
;END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_Proj_HERSDist" 1 0 1 0
	"Create Proj:HERSDist object & assign as user-defined"		Proj:HERSDist	= {	CreateComp( HERSDist, Local( Name ) + "-hers-dist-proj" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_Proj_HERSFan" 1 0 1 0
	"Create Proj:HERSFan object & assign as user-defined"		Proj:HERSFan	= {	CreateComp( HERSFan, Local( Name ) + "-hers-fan-proj" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_DHWSys_HERSDHWSys" 1 0 1 0
	"Create DHWSys:HERSCheck object & assign as user-defined"		DHWSys:HERSCheck	= {	CreateComp( HERSDHWSys, Local( Name ) + "-hers-dhw" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_Proj_HERSDHWSys" 1 0 1 0
	"Create Proj:HERSDHW object & assign as user-defined"		Proj:HERSDHW	= {	CreateComp( HERSDHWSys, Local( Name ) + "-hers-dhw-proj" )  }
END
;*************************************************************************
RULELIST  "CreateAndAssignAsUserDefined_Proj_SpeclFtr" 1 0 1 0
	"Create Proj:SpeclFeatrs object & assign as user-defined"		Proj:SpeclFeatrs	= {	CreateComp( SpeclFtr, Local( Name ) + "-specl-featrs" )  }
END
;*************************************************************************


; SAC 11/20/14 - rules to FORCE reset of DHWSysRef assignments beyond those valid based on DwellUnitType:NumDHWSysTypes
;*************************************************************************
RULELIST "ForceReset_DwellUnitType_DHWSysRef_1" 1 0 0 0
	"Force reset of DwellUnitType:DHWSysRef[1]"			DwellUnitType:DHWSysRef[1]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_DHWSysRef_2" 1 0 0 0
	"Force reset of DwellUnitType:DHWSysRef[2]"			DwellUnitType:DHWSysRef[2]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_DHWSysRef_3" 1 0 0 0
	"Force reset of DwellUnitType:DHWSysRef[3]"			DwellUnitType:DHWSysRef[3]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_DHWSysRef_4" 1 0 0 0
	"Force reset of DwellUnitType:DHWSysRef[4]"			DwellUnitType:DHWSysRef[4]		= {	UNDEFINED  }
END
RULELIST "ForceReset_DwellUnitType_DHWSysRef_5" 1 0 0 0
	"Force reset of DwellUnitType:DHWSysRef[5]"			DwellUnitType:DHWSysRef[5]		= {	UNDEFINED  }
END
;*************************************************************************


; SAC 3/23/15 - rulelist to force toggling OFF design rating calcs when they are not allowed
;*************************************************************************
RULELIST "ForceDefault_DesignRatingCalcs" 1 0 0 0
	"Force default Proj:DesignRatingCalcs"		Proj:DesignRatingCalcs	= {	0  }
END
;*************************************************************************

; SAC SAC 4/8/15 - rulelist to force toggling OFF design rating lighting credit inputs
;*************************************************************************
RULELIST "ForceDefault_DRtgLighting" 1 0 0 0
	"Force default Proj:DRtgLtgCredit"			Proj:DRtgLtgCredit		= {	0  }
	"Force default Proj:DRtgLtgReduction"		Proj:DRtgLtgReduction	= {	0  }
END
;*************************************************************************
RULELIST "ForceDefault_DRtgLightingReduction" 1 0 0 0
	"Force default Proj:DRtgLtgReduction"		Proj:DRtgLtgReduction	= {	0  }
END
;*************************************************************************


; SAC 4/10/15 - force reset of addition alone flag/value when RunScope NOT New Cons
;*************************************************************************
RULELIST "ForceDefault_IsAddAlone_AddFrac" 1 0 0 0
	"Force default Proj:IsAddAlone"			Proj:IsAddAlone			= {	0	} 
	"Force default Proj:AdditionCFAFrac"	Proj:AdditionCFAFrac		= {	1	} 
	"Force reset Proj:AddAloneExistArea"	Proj:AddAloneExistArea	= {	UNDEFINED  }		; SAC 12/28/15
	"Force reset Proj:AddAloneAddedArea"	Proj:AddAloneAddedArea	= {	UNDEFINED  }
END
;*************************************************************************
; SAC 12/28/15 - replacement inputs for AdditionCFAFrac
RULELIST "Replace_AdditionCFAFrac_with_AddAloneAreas" 1 0 0 0
	"Set AddAloneAreas"		Proj:Action		= {	EvalRulelist( "Set_AddAloneAreas_basedon_AdditionCFAFrac" )  }
	"Force default Proj:AdditionCFAFrac"	Proj:AdditionCFAFrac		= {	1	} 
END
;*************************************************************************
RULELIST "Set_AddAloneAreas_basedon_AdditionCFAFrac" 1 0 1 0
	"Set Proj:AddAloneAddedArea (based on AdditionCFAFrac)"		Proj:AddAloneAddedArea	= {	if (IfValidAnd( AdditionCFAFrac > 0 ) .AND. IfValidAnd( AdditionCFAFrac <= 1 ))
																															then	SumAll( Zone:FloorArea )
																															else	0  endif  }
	"Set Proj:AddAloneExistArea (based on AdditionCFAFrac)"		Proj:AddAloneExistArea	= {	if (IfValidAnd( AdditionCFAFrac > 0 ) .AND. IfValidAnd( AdditionCFAFrac <= 1 ) .AND. IfValidAnd( AddAloneAddedArea > 0 ))
																															then	AddAloneAddedArea / AdditionCFAFrac
																															else	0  endif  }
END
;*************************************************************************
RULELIST "ForceReset_AddAloneAreas" 1 0 0 0
	"Force reset Proj:AddAloneExistArea"	Proj:AddAloneExistArea	= {	UNDEFINED  }		; SAC 12/28/15
	"Force reset Proj:AddAloneAddedArea"	Proj:AddAloneAddedArea	= {	UNDEFINED  }
END
;*************************************************************************


; SAC 3/25/15 - rulelist to force toggling OFF CAHPProgram when design rating calcs are selected
;*************************************************************************
RULELIST "ForceDefault_CAHPProgram" 1 0 0 0
;*************************************************************************
	"Force default Proj:CAHPProgram"		Proj:CAHPProgram	= {	UNDEFINED  }
END
;*************************************************************************


; SAC 4/28/15 - rulelist to force reset or Proj:MultiFamilyType (and post warning message to log) - pending final implementation plans/design
;*************************************************************************
RULELIST "ForceReset_MultiFamilyType" 1 0 0 0
;*************************************************************************
	"Post warning to log"	Proj:Action	= {	PostWarning( "Proj:MultiFamilyType setting of '%s' replaced with default selection 'Other' pending final duplex/townhome analysis implementation.", EnumString( MultiFamilyType ) )  }
	"Force default of Proj:MultiFamilyType"	Proj:MultiFamilyType	= {	3  }
END
;*************************************************************************


; SAC 11/3/15 - rulelist to force default of DHWCalcMethod = "CSE" (for all runs where BypassRuleLimits not activated)
;*************************************************************************
RULELIST "ForceDefault_DHWCalcMethod_CSE" 1 0 0 0
;*************************************************************************
	"Post warning to log for Proj:DHWCalcMethod change"	Proj:Action	= {	PostWarning( "Proj:DHWCalcMethod setting of '%s' replaced with default selection 'CSE'.", EnumString( DHWCalcMethod ) )  }
	"Force default of Proj:DHWCalcMethod to 'CSE'"		Proj:DHWCalcMethod	= {	"CSE"  }
END
;*************************************************************************


; SAC 12/8/15 - tic 512 ensure wall orientations are reported as 0/90/180/270 for all orientation runs
;*************************************************************************
RULELIST "ForceDefault_FrontOrientation" 1 0 0 0
;*************************************************************************
   "Default Proj:FrontOrientation"		Proj:FrontOrientation	= {	0  }
END
;*************************************************************************


;************************************************************************* SAC 4/14/16
RULELIST "Force_ASHPTankOutside_to_TankOutside" 1 0 1 1
;*************************************************************************
	"Set DHWHeater:TankOutside"			DHWHeater:TankOutside		= {	ASHPTankOutside  }
	"Set DHWHeater:ASHPTankOutside"		DHWHeater:ASHPTankOutside	= {	UNDEFINED  }
END
;************************************************************************* SAC 4/14/16
RULELIST "Force_ASHPTankZone_to_TankZone" 1 0 1 1
;*************************************************************************
	"Set DHWHeater:TankZone"			DHWHeater:TankZone		= {	ASHPTankZone  }
	"Set DHWHeater:ASHPTankZone"		DHWHeater:ASHPTankZone	= {	UNDEFINED  }
END
;*************************************************************************


; SAC 4/15/16 - ensure that user-defined Appl_RefrigUsage[1] is not retained when ApplRefrigEffMethod[1] is not set to '- specify -'
;*************************************************************************
RULELIST "ForceDefault_Proj_RefrigUsage" 1 0 0 0
	"Blast Proj:Appl_RefrigUsage[1]"		Proj:Appl_RefrigUsage[1]	= {	UNDEFINED  }
END
;*************************************************************************

; SAC 4/15/16 - ensure that user-defined Appl_DishUsage[1] is not retained when ApplDishUsageMethod[1] is not set to '- specify -'
;*************************************************************************
RULELIST "ForceDefault_Proj_DishUsage" 1 0 0 0
	"Blast Proj:Appl_DishUsage[1]"		Proj:Appl_DishUsage[1]	= {	UNDEFINED  }
END
;*************************************************************************

; SAC 4/15/16 - ensure that user-defined RefrigElecUsage is not retained when RefrigEffMethod is not set to '- specify -'
;*************************************************************************
RULELIST "ForceDefault_DUT_RefrigElecUsage" 1 0 0 0
	"Blast DwellUnitType:RefrigElecUsage"		DwellUnitType:RefrigElecUsage	= {	UNDEFINED  }
END
;*************************************************************************

; SAC 4/15/16 - ensure that user-defined DishElecUsage is not retained when DishUsageMethod is not set to '- specify -'
;*************************************************************************
RULELIST "ForceDefault_DUT_DishElecUsage" 1 0 0 0
	"Blast DwellUnitType:DishElecUsage"		DwellUnitType:DishElecUsage	= {	UNDEFINED  }
END
;*************************************************************************

; SAC 6/28/16 - rulelist to blast inputs to various recirculation loop inputs that are inconsistent w/ Proj:DHWCalcMethod of "CSE*"
;*************************************************************************
RULELIST "BlastInputs_CSEDHW_RecircLoops" 1 0 0 0
	"Blast DHWSys:UseDefaultLoops"	DHWSys:UseDefaultLoops  = { UNDEFINED }
	"Blast DHWSys:RecircXtraIns"		DHWSys:RecircXtraIns    = { UNDEFINED }
	"Blast DHWSys:RecircPipeLen[1]"	DHWSys:RecircPipeLen[1] = { UNDEFINED }
	"Blast DHWSys:RecircPipeDia[1]"	DHWSys:RecircPipeDia[1] = { UNDEFINED }
	"Blast DHWSys:RecircPipeLen[2]"	DHWSys:RecircPipeLen[2] = { UNDEFINED }
	"Blast DHWSys:RecircPipeDia[2]"	DHWSys:RecircPipeDia[2] = { UNDEFINED }
	"Blast DHWSys:RecircPipeLoc[2]"	DHWSys:RecircPipeLoc[2] = { UNDEFINED }
	"Blast DHWSys:RecircPipeLen[3]"	DHWSys:RecircPipeLen[3] = { UNDEFINED }
	"Blast DHWSys:RecircPipeDia[3]"	DHWSys:RecircPipeDia[3] = { UNDEFINED }
	"Blast DHWSys:RecircPipeLoc[3]"	DHWSys:RecircPipeLoc[3] = { UNDEFINED }
	"Blast DHWSys:RecircPipeLen[4]"	DHWSys:RecircPipeLen[4] = { UNDEFINED }
	"Blast DHWSys:RecircPipeDia[4]"	DHWSys:RecircPipeDia[4] = { UNDEFINED }
	"Blast DHWSys:RecircPipeLoc[4]"	DHWSys:RecircPipeLoc[4] = { UNDEFINED }
	"Blast DHWSys:RecircPipeLen[5]"	DHWSys:RecircPipeLen[5] = { UNDEFINED }
	"Blast DHWSys:RecircPipeDia[5]"	DHWSys:RecircPipeDia[5] = { UNDEFINED }
	"Blast DHWSys:RecircPipeLoc[5]"	DHWSys:RecircPipeLoc[5] = { UNDEFINED }
	"Blast DHWSys:RecircPipeLen[6]"	DHWSys:RecircPipeLen[6] = { UNDEFINED }
	"Blast DHWSys:RecircPipeDia[6]"	DHWSys:RecircPipeDia[6] = { UNDEFINED }
	"Blast DHWSys:RecircPipeLoc[6]"	DHWSys:RecircPipeLoc[6] = { UNDEFINED }
END
;*************************************************************************


;*************************************************************************
;*************************************************************************

ENDFILE














